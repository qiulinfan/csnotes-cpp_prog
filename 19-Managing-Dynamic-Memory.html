<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Overview - umich-eecs280-lec-notes-ch</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Overview";
        var mkdocs_page_input_path = "19-Managing-Dynamic-Memory.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> umich-eecs280-lec-notes-ch
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">01 Command Line Interface (CLI)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="01-Command-Line%20Interface-%28CLI%29.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">02 IDEs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="02-IDEs.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">03 Compilation (Makefile)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="03-Compilation-%28Makefile%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="03-Compilation-%28Makefile%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="03-Compilation-%28Makefile%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="03-Compilation-%28Makefile%29.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">04 Debuggers</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="04-Debuggers.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="04-Debuggers.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="04-Debuggers.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="04-Debuggers.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="04-Debuggers.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="04-Debuggers.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="04-Debuggers.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">05 Version Control (git)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="05-Version-Control-%28git%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="05-Version-Control-%28git%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="05-Version-Control-%28git%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="05-Version-Control-%28git%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="05-Version-Control-%28git%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="05-Version-Control-%28git%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="05-Version-Control-%28git%29.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">06 Text Editors (emacs)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="06-Text-Editors-%28emacs%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="06-Text-Editors-%28emacs%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="06-Text-Editors-%28emacs%29.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="06-Text-Editors-%28emacs%29.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">07 Call Stack Procedural Abstraction and Unit Tests</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">08 Pointers and Arrays</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="08-Pointers-and-Arrays.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="08-Pointers-and-Arrays.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="08-Pointers-and-Arrays.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="08-Pointers-and-Arrays.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">09 const keyword</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="09-const-keyword.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="09-const-keyword.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">10 Compound objects, ADT and Dynamic Allocation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">11 C strings</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="11-C-strings.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="11-C-strings.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="11-C-strings.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="11-C-strings.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="11-C-strings.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="11-C-strings.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">12 Stream and IO</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="12-Stream-and-IO.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="12-Stream-and-IO.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="12-Stream-and-IO.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="12-Stream-and-IO.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="12-Stream-and-IO.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="12-Stream-and-IO.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">13 ADT in C++</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="13-ADT-in-C%2B%2B.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="13-ADT-in-C%2B%2B.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="13-ADT-in-C%2B%2B.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="13-ADT-in-C%2B%2B.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="13-ADT-in-C%2B%2B.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">14 Derived Classes and Inheritance</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="14-Derived-Classes-and-Inheritance.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="14-Derived-Classes-and-Inheritance.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="14-Derived-Classes-and-Inheritance.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="14-Derived-Classes-and-Inheritance.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="14-Derived-Classes-and-Inheritance.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">15 Polymorphism</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="15-Polymorphism.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="15-Polymorphism.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="15-Polymorphism.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="15-Polymorphism.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="15-Polymorphism.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">16 ContainerADT I</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="16-ContainerADT-I.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="16-ContainerADT-I.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="16-ContainerADT-I.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="16-ContainerADT-I.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="16-ContainerADT-I.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">17 ContainerADT II</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="17-ContainerADT-II.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="17-ContainerADT-II.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="17-ContainerADT-II.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="17-ContainerADT-II.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="17-ContainerADT-II.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">18 Memory Model and Dynamic Memory</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="18-Memory-Model-and-Dynamic-Memory.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="18-Memory-Model-and-Dynamic-Memory.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="18-Memory-Model-and-Dynamic-Memory.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="18-Memory-Model-and-Dynamic-Memory.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="18-Memory-Model-and-Dynamic-Memory.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">19 Managing Dynamic Memory</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Overview</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1911-constructor-default-argument">19.1.1 (题外话) constructor 的 default argument</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1912-destructor">19.1.2 Destructor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1913-class-object-dynamic-destructor-delete-class-object">19.1.3 如果 class object 本身是 dynamic 的: destructor 会在 delete class object 时自动运行</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1914-raii-principle-resource-acquisition-is-initialization">19.1.4 RAII principle: Resource Acquisition is Initialization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#192-function-implementations-dynamic-set">19.2 更改其他 function implementations 以适应 dynamic set</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1921-insert">19.2.1 insert</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#193-performance-of-set">19.3 Performance of Set</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#garbage-collection-smart-pointer">题外话: garbage collection 和 smart pointer</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Overview</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1911-constructor-default-argument">19.1.1 (题外话) constructor 的 default argument</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1912-destructor">19.1.2 Destructor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1913-class-object-dynamic-destructor-delete-class-object">19.1.3 如果 class object 本身是 dynamic 的: destructor 会在 delete class object 时自动运行</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1914-raii-principle-resource-acquisition-is-initialization">19.1.4 RAII principle: Resource Acquisition is Initialization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#192-function-implementations-dynamic-set">19.2 更改其他 function implementations 以适应 dynamic set</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1921-insert">19.2.1 insert</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#193-performance-of-set">19.3 Performance of Set</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#garbage-collection-smart-pointer">题外话: garbage collection 和 smart pointer</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Overview</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1911-constructor-default-argument">19.1.1 (题外话) constructor 的 default argument</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1912-destructor">19.1.2 Destructor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1913-class-object-dynamic-destructor-delete-class-object">19.1.3 如果 class object 本身是 dynamic 的: destructor 会在 delete class object 时自动运行</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1914-raii-principle-resource-acquisition-is-initialization">19.1.4 RAII principle: Resource Acquisition is Initialization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#192-function-implementations-dynamic-set">19.2 更改其他 function implementations 以适应 dynamic set</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1921-insert">19.2.1 insert</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#193-performance-of-set">19.3 Performance of Set</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#garbage-collection-smart-pointer">题外话: garbage collection 和 smart pointer</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Overview</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1911-constructor-default-argument">19.1.1 (题外话) constructor 的 default argument</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1912-destructor">19.1.2 Destructor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1913-class-object-dynamic-destructor-delete-class-object">19.1.3 如果 class object 本身是 dynamic 的: destructor 会在 delete class object 时自动运行</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1914-raii-principle-resource-acquisition-is-initialization">19.1.4 RAII principle: Resource Acquisition is Initialization</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#192-function-implementations-dynamic-set">19.2 更改其他 function implementations 以适应 dynamic set</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1921-insert">19.2.1 insert</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#193-performance-of-set">19.3 Performance of Set</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#garbage-collection-smart-pointer">题外话: garbage collection 和 smart pointer</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">20 Deep Copies and the Big Three</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="20-Deep-Copies-and-the-Big-Three.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="20-Deep-Copies-and-the-Big-Three.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="20-Deep-Copies-and-the-Big-Three.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="20-Deep-Copies-and-the-Big-Three.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">21 Linked List</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="21-Linked-List.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="21-Linked-List.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="21-Linked-List.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="21-Linked-List.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">22 Iterator</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="22-Iterator.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="22-Iterator.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="22-Iterator.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="22-Iterator.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">23 Functors and Imposter Syndrome</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="23-Functors-and-Imposter-Syndrome.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="23-Functors-and-Imposter-Syndrome.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="23-Functors-and-Imposter-Syndrome.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="23-Functors-and-Imposter-Syndrome.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">24 Recursion</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="24-Recursion.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="24-Recursion.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="24-Recursion.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="24-Recursion.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">25 BST and Maps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="25-BST-and-Maps.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="25-BST-and-Maps.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="25-BST-and-Maps.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="25-BST-and-Maps.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="25-BST-and-Maps.html">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">280 midterm cheatsheet</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="280-midterm-cheatsheet.html">Overview</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">umich-eecs280-lec-notes-ch</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">19 Managing Dynamic Memory</li>
      <li class="breadcrumb-item active">Overview</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="toc">
<ul>
<li><a href="#19-managing-dynamic-memory">19 Managing Dynamic Memory</a><ul>
<li><a href="#1911-constructor-default-argument">19.1.1 (题外话) constructor 的 default argument</a></li>
<li><a href="#1912-destructor">19.1.2 Destructor</a></li>
<li><a href="#1913-class-object-dynamic-destructor-delete-class-object">19.1.3 如果 class object 本身是 dynamic 的: destructor 会在 delete class object 时自动运行</a></li>
<li><a href="#1914-raii-principle-resource-acquisition-is-initialization">19.1.4 RAII principle: Resource Acquisition is Initialization</a></li>
<li><a href="#192-function-implementations-dynamic-set">19.2 更改其他 function implementations 以适应 dynamic set</a><ul>
<li><a href="#1921-insert">19.2.1 insert</a></li>
</ul>
</li>
<li><a href="#193-performance-of-set">19.3 Performance of Set</a></li>
<li><a href="#garbage-collection-smart-pointer">题外话: garbage collection 和 smart pointer</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="19-managing-dynamic-memory">19 Managing Dynamic Memory</h1>
<p>Review: Memory leaks/errors</p>
<ol>
<li><strong>memory leak</strong>: object 无法 delete</li>
<li><strong>orphaned memory</strong>: 失去 address 的 hold 使得 leak 不可避免</li>
<li><strong>double delete</strong>: 尝试 <code>delete</code> 同一个 heap object 多次</li>
<li><strong>Non-heap delete</strong>: 对一个指向 non-heap object 的 ptr 使用 <code>delete</code></li>
<li><strong>wrong delete</strong>: 错用 <code>delete</code> 和 <code>delete[]</code></li>
<li><strong>use a dead object</strong>: dereference 了一个已经 dead 的 heap object.</li>
</ol>
<p>## 19.1 Building dynamic set with dynamic array</p>
<p>我们之前写的 set 的大小实际上是固定的。我们用了一个 const 的 Capacity 作为 array 大小，在此基础上通过限制用户能够接触到的元素来模拟 set 的大小变动。</p>
<p>这个 set 的一个很大的缺点是：set 的元素的数量上限很明确。如果我们把 <code>Capacity</code> 设为 100，那就只能装 100 个元素；如果我们把 <code>Capacity</code> 设为 10000，那么我们每建立一个 set 就会占据大量的 stack memory，即便我们只需要几个元素的 set.</p>
<p>而现在我们会写 dynamic array 之后，我们可以写一个真正大小动态变化的 set.</p>
<pre><code class="language-c++">template &lt;typename T&gt;
class ordered_set {
private:
  static const int DEFAULT_CAPACITY = 100; // for default ctor
  T *ele;   // dynamic array
  int size;
  int current_capacity; // dynamic capacity
public:
    ordered_set();
  ordered_set(int capacity);
}
</code></pre>
<p>然后我们写 ctors:</p>
<pre><code class="language-c++">template &lt;typename T&gt;
ordered_set&lt;T&gt;::ordered_set() 
  :size(0),
  current_capacity(DEFAULT_CAPACITY) {
    ele = new int[current_capacity];    // 创造 dynamic array
}

// overloaded ctor
template &lt;typename T&gt;
ordered_set&lt;T&gt;::ordered_set(int capacity) 
  :size(0),
  current_capacity(capacity) {
    ele = new int[current_capacity];
}
</code></pre>
<p>这种只需要传一个参数的情况下我们也可以只写一个带有 default argument 的 ctor:</p>
<pre><code class="language-c++">template &lt;typename T&gt;
class ordered_set {
private:
  static const int DEFAULT_CAPACITY = 100; // for default ctor
  T *ele;   // dynamic array
  int size;
  int current_capacity; // dynamic capacity
public:
  ordered_set(int capacity = DEFAULT_CAPACITY);
}
</code></pre>
<h3 id="1911-constructor-default-argument">19.1.1 (题外话) constructor 的 default argument</h3>
<p>C++ 的 class ctor 的 default argument 完全不如 python 灵活。</p>
<ol>
<li>function call 的 arguments 顺序必须和 declaration 中的匹配。</li>
<li><strong>只有 declaration 的 parameter list 中的最后一个 parameter 才允许有 default value！</strong></li>
</ol>
<p>所以基本没什么用。但是这种只有一个参数的 ctor 中还是比较有用的。</p>
<h3 id="1912-destructor">19.1.2 Destructor</h3>
<p>我们发现，我们在 constructor 中创建了一个动态数组，但是我们并没有设置方法来删除它，这会导致 memory leak.</p>
<p>尤其是当我们在一些函数中创建 dynamic set 时：</p>
<pre><code class="language-c++">void foo() {
    Unordered set is;
}
// memory leak when foo() is called
</code></pre>
<p>我们自然地想到一个办法，就是写一个 <code>Unordered_set::delete_array()</code> 之类的方法。但是：1. 它会破坏 encapsulation(封装)；2. 我们每创建一个 dynamic set 都要记得 call 这个函数.</p>
<p>C++ 提供了一个更加好的办法：destructor，简称 dtor. </p>
<p>Destructor run <strong>automatically</strong> when an object is destroyed. 比如当 <code>is</code> 是一个作为 local variable 的 set，它在出 scope 时会自动运行 dtor；当 <code>is</code> 是一个 global variable 时，他在 program 结束的时候会自动运行 dtor.</p>
<p>local variable:</p>
<pre><code class="language-c++">int foo() {
    ordered_set is; // ctor runs
} // dtor runs
</code></pre>
<p>global variable:</p>
<pre><code class="language-c++">ordered_set is; // ctor runs
int main() {}
// dtor runs
</code></pre>
<p>我们可以写一个能够 <code>delete</code> 所有由这个 class object 创建的 dynamic variables 的 destructor.</p>
<p>写法是：</p>
<pre><code class="language-c++">class ordered_set {
public:
  //..
  ~ordered_set();
private:
  //..
};

ordered_set::~ordered_set() {
  delete[] ele;
}
</code></pre>
<h3 id="1913-class-object-dynamic-destructor-delete-class-object">19.1.3 如果 class object 本身是 dynamic 的: destructor 会在 <code>delete</code> class object 时自动运行</h3>
<pre><code class="language-c++">void foo() {
    ordered_set *ptr = new ordered_set(3);
  // memory leak
}
</code></pre>
<p><img src="Assets/Screenshot 2024-03-12 at 14.46.43.png" alt="Screenshot 2024-03-12 at 14.46.43" style="zoom:50%;" /></p>
<p>在这个函数运行结束后，有多少个 Bytes 的 memory 被 leak 了？</p>
<p>（假设 <code>int</code> 为 4B，<code>int *</code> 为 8B）</p>
<pre><code class="language-shell">3 * sizeof(int) // int[3]
+ sizeof(int *) // ele
+ sizeof(int)       // current_capacity
+ sizeof(int)       // size
= 28B (leaked)
</code></pre>
<p>所以我们需要 <code>delete</code> 来防止这些 memory leak.</p>
<pre><code class="language-c++">void foo() {
    ordered_set *ptr = new ordered_set(3);  
    delete ptr; // ok
}
</code></pre>
<p><img src="Assets/Screenshot 2024-03-12 at 14.50.53.png" alt="Screenshot 2024-03-12 at 14.50.53" style="zoom:50%;" /></p>
<p>在我们 <code>delete ptr</code> ，也就是删除了 <code>ptr</code> 指向的 heap 中的 dynamic sorted_set object 之后，该 object 自动运行 dtor 删除了它的 dynamic variables.</p>
<h3 id="1914-raii-principle-resource-acquisition-is-initialization">19.1.4 RAII principle: Resource Acquisition is Initialization</h3>
<p>RAII(Resource Acquisition is Initialization) 的意思是：一个 resource (比如一个 dynamic array) 的 life 应该被 bound to 需要这个 resource 的 object 的 lifetime (比如这个 dynamic array 对应的 sorted_set instance).</p>
<p>在 C++ 中就对应了使用 <code>new</code> 的 constructor 和使用 <code>delete</code> 的 destructor.</p>
<h2 id="192-function-implementations-dynamic-set">19.2 更改其他 function implementations 以适应 dynamic set</h2>
<h3 id="1921-insert">19.2.1 <code>insert</code></h3>
<p>由于对 dynamic array 的使用，我们应该更改原本的 <code>insert</code> 函数使其适应 dynamic set.</p>
<p>我们应该：</p>
<ol>
<li><code>new</code> 一个更大的 dynamic array.</li>
<li>把原本的 dynamic array 复制进去.</li>
<li><code>delete</code> 原本的 dynamic array.</li>
<li>让 ptr 成员指向新的 dynamic array，并更新 capacity</li>
</ol>
<pre><code class="language-c++">template &lt;typename T&gt;
void ordered_set&lt;T&gt;::grow() {
  // new a dynamic array into a temporary ptr var
  int *tmp = new int[current_capacity + 1];
  // copy the original dynamic array into the new one
  for (int i = 0; i &lt; size; i++) {
    tmp[i] = ele[i];
  }

  delete[] elts;  // delete the original dynamic array
  elts = tmp; // reassign the value of tmp to elts
  current_capacity++; // update capacity
}

template &lt;typename T&gt;
void ordered_set&lt;T&gt;::insert(T e) {
  if (contains(e)) return;
  if (size == current_capacity) {grow();} // grow capacity
  ele[size++] = v;  // increase size to catch up capacity; also inserts new element
}
</code></pre>
<p><img src="Assets/Screenshot 2024-03-12 at 15.16.57.png" alt="Screenshot 2024-03-12 at 15.16.57" style="zoom:50%;" /></p>
<h2 id="193-performance-of-set">19.3 Performance of Set</h2>
<p>每当 <code>grow</code> 被 call 的时候，有多少 elements 被 copy 了？</p>
<pre><code class="language-c++">int main() {
  ordered_set&lt;int&gt; is(1);
  int n;
  cin &gt;&gt; n; 
  is.insert(0);
  is.insert(1); // grow(), 1 copy
  is.insert(2); // grow(), 2 copies
  //...
  is.insert(n); // grow(), n copies
  // total = 1+2+...+n = n(1+n)/2 copied
  // So the number of int-copy operations needed is in O(n^2)
}
</code></pre>
<p>我们发现这个算法的时间复杂度非常高</p>
<p>应该优化一下。</p>
<p>注意到我们的条件：</p>
<pre><code class="language-c++">if (size == current_capacity) {grow();} // grow capacity
</code></pre>
<p>直到 <code>size</code> 赶上 <code>capacity</code> 了，我们才使用 <code>grow()</code> 来重新建 array，重新 copy.</p>
<p>因而我们可以在 <code>grow</code> 中不要一格一格 grow，而是选择一次 <code>grow</code> 大一点，比如每次 <code>grow</code> 都把 array 的大小变成两倍</p>
<pre><code class="language-c++">template &lt;typename T&gt;
void ordered_set&lt;T&gt;::grow() {
  int *tmp = new int[current_capacity * 2]; // grow 两倍
  for (int i = 0; i &lt; size; i++) {
    tmp[i] = ele[i];
  }

  delete[] elts;
  elts = tmp; 
  current_capacity *= 2;
}
</code></pre>
<p>这样的话：</p>
<pre><code class="language-c++">int main() {
  Unordered_set is(1);
  is.insert(0);
  is.insert(1); // grow(), 1 copy, new capacity=2
  is.insert(2); // grow(), 2 copies, new capacity=4
  is.insert(3);
  is.insert(4); // grow(), 4 copies, new capacity=8
  is.insert(5);
  is.insert(6);
  is.insert(7);
  is.insert(8); // grow(), 8 copies, new capacity=16
  // …
}
</code></pre>
<p>现在对于创建 N 个元素的 set，copy 的总次数为：
$$
T = (N-1) + (N/2 -1) + (N/4 - 1) + \cdots + 2 + 1 \
&lt; N + N/2 + N/4 + \cdots + 2 + 1 = 2N
$$
因而 time complexity 马上下降到了 $O(n)$.</p>
<p><img src="Assets/Screenshot 2024-03-12 at 17.30.12.png" alt="Screenshot 2024-03-12 at 17.30.12" style="zoom:50%;" /></p>
<h2 id="garbage-collection-smart-pointer">题外话: garbage collection 和 smart pointer</h2>
<p>有一些 languages 允许 compiler 自动删除 dynamic variables，只要它们不再被需要。</p>
<p>这个行为叫做 <strong>garbage collections.</strong></p>
<p>但是这个行为有一定的代价：首先肯定降低了运行速度，其次不清晰灵活：garbage collection behavior may vary, but manual deletion is a clear part of the standard.</p>
<p>我们现在目前为止讨论的都是 <strong>raw pointers</strong>. 而 C++ 11 以上的版本允许使用 <strong>smart pointers</strong>，这些 smart pointers 可以做一些 garbage collector 的事情。</p>
<p><code>unique_ptr</code>: only a single pointer to the dynamic variable is possible</p>
<p><code>shared_ptr</code>: multiple pointers to the dynamic variable are possible. <strong>When all those pointers are destroyed, the dynamic variable is destroyed.</strong></p>
<p><code>weak_ptr</code>: 只要所有指向一个 dynamic variable 的 <code>shared_ptr</code> 被 destroy，那么指向它的 <code>weak-ptr</code> 也马上被 destroy.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="19-Managing-Dynamic-Memory.html" class="btn btn-neutral float-left" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="20-Deep-Copies-and-the-Big-Three.html" class="btn btn-neutral float-right" title="Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="19-Managing-Dynamic-Memory.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="20-Deep-Copies-and-the-Big-Three.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
