{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"index.html","text":"umich-eecs280-lec-notes-ch 23W-eecs-280, Lecture Notes taken by Rynne. \u4e2d\u82f1\u6587\u6df7\u6742\u7684\u7b14\u8bb0\u3002 Official Course Website https://eecs280.org Notes 01 Command Line Interface (CLI) 02 IDEs 03 Compilation (Makefile) 04 Debuggers 05 Version Control (git) 06 Text Editors (emacs) 07 Call Stack Procedural Abstraction and Unit Tests 08 Pointers and Arrays 09 const keyword 10 Compound objects, ADT and Dynamic Allocation 11 C strings 12 Stream and IO 13 ADT in C++ 14 Derived Classes and Inheritance 15 Polymorphism 16 ContainerADT I 17 ContainerADT II 18 Memory Model and Dynamic Memory 19 Managing Dynamic Memory 20 Deep Copies and the Big Three 21 Linked List 22 Iterator 23 Functors and Imposter Syndrome 24 Recursion 25 BST and Maps 280 midterm cheatsheet","title":"Home"},{"location":"index.html#umich-eecs280-lec-notes-ch","text":"23W-eecs-280, Lecture Notes taken by Rynne. \u4e2d\u82f1\u6587\u6df7\u6742\u7684\u7b14\u8bb0\u3002 Official Course Website https://eecs280.org","title":"umich-eecs280-lec-notes-ch"},{"location":"index.html#notes","text":"01 Command Line Interface (CLI) 02 IDEs 03 Compilation (Makefile) 04 Debuggers 05 Version Control (git) 06 Text Editors (emacs) 07 Call Stack Procedural Abstraction and Unit Tests 08 Pointers and Arrays 09 const keyword 10 Compound objects, ADT and Dynamic Allocation 11 C strings 12 Stream and IO 13 ADT in C++ 14 Derived Classes and Inheritance 15 Polymorphism 16 ContainerADT I 17 ContainerADT II 18 Memory Model and Dynamic Memory 19 Managing Dynamic Memory 20 Deep Copies and the Big Three 21 Linked List 22 Iterator 23 Functors and Imposter Syndrome 24 Recursion 25 BST and Maps 280 midterm cheatsheet","title":"Notes"},{"location":"01-Command-Line%20Interface-%28CLI%29.html","text":"1 Command Line Interface (CLI) 1.1 Mac OS CLI tools Installation 1.1.1 Install compiler 1.1.2 Install Homebrew package manager 1.1.3 Install CLI tools 1.1.4 Use CLI tools 1.2 Windows Subsystem for Linux (WSL) Installation 1.2.1 Install WSL 1.2.2 Start an Ubuntu Bash shell 1.2.3 Install CLI tools 1.2.4 Accessing Linux files from Windows 1.2.5 Accessing Windows files from Linux 1.2.6 Pitfalls(\u9700\u8981\u6ce8\u610f\u7684\u9690\u60a3) 1.3 Basic Commands 1.3.1 ls: print files and directories in working directory 1.3.1* Pro-tip: Colorize the output of ls and prompt \u5b9a\u5236\u989c\u8272 for Windows/WSL and Linux (Bash shell): -bash Create file if it doesn't exist 1.3.2 tree: \u4ee5\u6811\u72b6\u6253\u5370directory\u67b6\u6784 1.3.3 pwd: print working directory 1.3.4 mkdir: make directory 1.3.5 touch: create file 1.3.6 rm, rm -rf: remove 1.3.7 cd: change directory \u66f4\u6539\u5de5\u4f5c\u76ee\u5f55 1.3.8 cp: copy and paste a file 1.3.9 open / wslview: Mac/Wsl\u6253\u5f00\u6587\u4ef6 1.3.10 wget: \u4e0b\u8f7d\u6765\u81eaInternet\u7684\u6587\u4ef6 1.3.11 tar: \u89e3\u538b\u538b\u7f29\u5305 1.3.12 diff: \u6bd4\u8f83\u6587\u4ef6 1.3.13 cat: \u6253\u5370\u6587\u4ef6\u5185\u5bb9 1.3.14 grep: \u5728(\u591a\u4e2a)file\u4e2d\u641c\u7d22 1.4 File, Directory, Path 1.4.1 Current directory . 1.4.2 Absolute & Relative Path(\u7edd\u5bf9&\u76f8\u5bf9\u8def\u5f84) 1.4.3 Parent directory .. 1.4.4 Home directory ~ 1.4.5 Root directory / 1.4.6 Glob * 1.5 Redirection 1.5.1 Pipe |: 1.5.2 Input redirection <: \u7528\u6587\u4ef6\u4f5c\u4e3a\u7a0b\u5e8f\u8f93\u5165 1.5.3 Output redirection >: \u50a8\u5b58\u7a0b\u5e8f\u7684\u8f93\u51fa 1.6 Useful Tips 1.6.1 clear: clear the terminal 1.6.2 Tab complete 1.6.3 \u2191\u548c\u2193 1.6.4 Customize prompt: prompt\u6539\u989c\u8272 1.7 Shell Scripting(\u811a\u672c) 1.7.1 Creating a shell script 1.7.2 Adding an executable bit 1.7.3 \u6ce8\u610f\u4e8b\u9879 1 Command Line Interface (CLI) The GUI (Graphic User Interface) is a \u201cpoint and click\u201d way to interact with a computer. The Windows File Explorer and macOS Finder are examples of GUIs. The CLI (Command Line Interface) is a text-based way to interact with a computer. The terminal is another name for the CLI. mac\u4e2d\uff0cCLI\u5c31\u662fterminal\uff0cterminal\u5c31\u662fCLI\uff1b Windows Subsystem for Linux (WSL) \u4e2d\u53eb\u505aubantu (\u6ca1\u9519\u5c31\u662fubantu server\u7684\u865a\u62df\u673a\u7248\u672c). The CLI is fast, easy to automate, and easy to use remotely. 1.1 Mac OS CLI tools Installation 1.1.1 Install compiler Open the Terminal application which comes with macOS. Install a compiler. xcode-select --install Notice that this compiler is really Apple LLVM pretending to be g++ . Your version might be different. g++ --version #Configured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/usr/include/c++/4.2.1 # Apple LLVM version 9.0.0 (clang-900.0.38) # Target: x86_64-apple-darwin16.7.0 #Thread model: posix # InstalledDir: /Library/Developer/CommandLineTools/usr/bin*/) 1.1.2 Install Homebrew package manager /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)\" Homebrew installs to a non-standard location, /opt/homebrew/ . \u91cd\u8981\u7684\u4e00\u6b65\uff1a\u628ahomebrew\u52a0\u5165\u73af\u5883\u53d8\u91cf\uff1a You\u2019ll need to run the following to add Homebrew to your path: echo 'eval \"$(/opt/homebrew/bin/brew shellenv)\"' >> ~/.zprofile Check your install. Your version might be different. brew --version # 3Homebrew 3.6.14 Close your terminal and reopen your terminal. 1.1.3 Install CLI tools Use the Homebrew package manager to install a few command line programs. brew install wget git tree 1.1.4 Use CLI tools \u524d\u9762\u5df2\u7ecf\u8bf4\u4e86\uff0cmacOS\u6240\u6709\u7684CLI\u5c31\u662f\u5728terminal\u4e2d\u6267\u884c. \u5728terminal\u4e2d\u5199command\u65f6\u52a0\u4e0a\u5404\u79cd\u5173\u952e\u8bcd\u5c31\u80fd\u4f7f\u7528\u5404\u79cdCLI\u5de5\u5177. \u5728terminal\u4e2d\u8f93\u5165 zsh \uff0c\u53ef\u4ee5\u6253\u5f00 Zshell , which is typical on macOS. 1.2 Windows Subsystem for Linux (WSL) Installation The Windows Subsystem for Linux (WSL) runs an Ubuntu Linux guest virtual machine on your Windows host machine. When you see $ in this tutorial, you should type into your shell the command that comes after the $ . \u4f60\u770b\u5230 $ \u5c31\u8bf4\u660e\u5728shell\u91cc\u9762\u4e86 1.2.1 Install WSL \u6253\u5f00 PowerShell \u5e76\u4e14 run it as administrator . Check if WSL was already installed. \u5982\u679c\u770b\u5230\u8fd9\u4e2a\uff0cWSL is already installed. wsl -l -v # NAME STATE VERSION #* Ubuntu Stopped 2 \u5982\u679c\u770b\u5230WSL help text\uff0cWSL is not installed. wsl -l -v # Copyright (c) Microsoft Corporation. All rights reserved. # Usage: wsl.exe [Argument] # ... \u5982\u679c\u6ca1installed\uff0cinstall: wsl --install Pitfall: Make sure Windows Update is enabled and your machine is up-to-date. Settings > Update and Security > Windows Update. Pitfall: If you still get an error from wsl --install , try the Manual installation steps . For the Linux distribution, choose the latest version of Ubuntu LTS. At the time of this writing, that\u2019s Ubuntu 22.04 LTS. \u5b89\u88c5\u597d\u4e4b\u540e\u91cd\u542f\u7535\u8111\uff0c\u7136\u540eStart PowerShell as administrator, and check that the VERSION is 2. \u5982\u679c\u663e\u793apowershell\u91cc\u8f93\u5165 wsl -l -v \u540eversion\u663e\u793a\u4e3a1\uff0c\u90a3\u4e48\u8981 wsl --update . 1.2.2 Start an Ubuntu Bash shell \u5728\u641c\u7d22\u680f\u641c\u7d22ubantu\u5e76\u6253\u5f00. \u8fd9\u4e2a\u65f6\u5019\u4f60\u5c31\u5728\u8fd0\u884cWSL\u7684linux\u865a\u62df\u673a\u7684command line. 1.2.3 Install CLI tools \u8fdb\u5165WSL\u7684linux\u865a\u62df\u673a\u7684command line\u4e4b\u540e\uff0cUse the apt package manager to install a few command line programs. \u867d\u7136\u8fd9\u662f\u865a\u62df\u673a\uff0c\u4f46\u662fLinux\u7cfb\u7edf\u91cc\u4e5f\u662f\u7528\u7684\u540c\u6837\u7684 command . sudo apt update sudo apt install g++ make rsync wget git ssh gdb python3 tree 1.2.4 Accessing Linux files from Windows \u70b9\u51fbLinux\u7684icon. Navigate to your home directory: Linux > Ubuntu > home > \u4f60\u7684\u7528\u6237\u540d. To open the File Explorer in any directory at the WSL (Ubuntu) Terminal: 1.2.5 Accessing Windows files from Linux To access Windows files from Linux, navigate to /mnt/c/ . cd\u5c31\u662fchange directory\uff0c\u5c31\u662f\u66f4\u6539\u5f53\u524d\u7684working directory\u4e3a\u8be5\u6587\u4ef6\u5939. \u5982\u679c\u4e0d\u7ed9\u51faabsolute path\u7684\u8bdd\u5c31\u662f\u5728\u5f53\u524d\u7684working directory\u8fdb\u5165\u5176\u4e2d\u7684\u67d0\u4e2a\u5b50\u6587\u4ef6\u5939. \u5982\u679c\u60f3\u8981\u6253\u5f00\u800c\u4e0d\u662f\u8fdb\u5165\u67d0\u4e2a\u6587\u4ef6\u5939/\u6587\u4ef6\u7684\u8bdd\u5c31\u662f open \u4ee5\u53ca wslview . open \u662fMacOS\u7684\u6307\u4ee4\uff0c wslview \u662fwsl\u7684\u6307\u4ee4. cd /mnt/c/Users ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u4e1c\u897f) cd 19680 #\u6211\u7684\u7528\u6237\u540d ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u76ee\u5f55\u548c\u6587\u4ef6, \u5305\u62ecDesktop\u548cDocuments) cd 'My Documents' ... 1.2.6 Pitfalls(\u9700\u8981\u6ce8\u610f\u7684\u9690\u60a3) Avoid Spaces in paths Avoid paths that contain spaces. Spaces causes problems with some command line tools. Bad Example Good Example EECS 280/ eecs280/ Project 1 Stats/ p1-stats/ Project folder in Windows home directory WSL\u4e2dLinux\uff08Ubuntu\uff09\u6709\u4e00\u4e2a\u72ec\u7acb\u7684home directory. \u867d\u7136\u6211\u4eec\u8bb2\u4e86\u600e\u4e48\u5728WSL\u4e2dubantu\u548cwindows\u4e92\u901a\u6587\u4ef6\uff0c\u4f46\u662f\u5c06\u4ee3\u7801\u5b58\u50a8\u5728 Windows \u4e3b\u76ee\u5f55\u4e2d\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fd0\u884c\u901f\u5ea6\u51cf\u6162\uff0c\u56e0\u4e3a WSL \u4f7f\u7528network file share\uff08\u7f51\u7edc\u6587\u4ef6\u5171\u4eab\uff09\u5728 Windows \u548c Linux \u4e4b\u95f4\u4f20\u8f93\u6587\u4ef6. Bad Example Good Example /c/mnt/Users/awdeorio ... /home/awdeorio ... Root user \u907f\u514d\u5728 WSL \u4e2d\u4ee5 root \u7528\u6237\u8eab\u4efd\u8fdb\u884c everyday coding\uff0c\u56e0\u4e3a\u6709\u4e9b\u7a0b\u5e8f\u5728\u4ee5root\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u65f6\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c. When you first installed Ubuntu, you should have been prompted to create a Linux username and password. 1.3 Basic Commands A file stores data like C++ source code ( main.cpp ) or plain text ( example.txt ). A directory contains files and other directories. It\u2019s also called a folder . \u4e5f\u5c31\u662f\u6587\u4ef6\u5939 A path is the location of a file or directory. Sometimes we end a directory path with / . (\u6709\u6ca1\u6709\u4e0d\u91cd\u8981) For example: /Users/ohjun/Desktop/project/main.cpp /Users/ohjun/Desktop/project/stuff/ 1.3.1 ls : print files and directories in working directory ls prints files and directories in the present working directory. ls # example.txt main.cpp stuff 1.3.1* Pro-tip: Colorize the output of ls and prompt \u5b9a\u5236\u989c\u8272 for Windows/WSL and Linux (Bash shell): Verify you\u2019re using the Bash shell, which is typical on WSL Ubuntu Linux. ```cmd echo $0 -bash touch ~/.bash_profile Create file if it doesn't exist wslview ~/.bash_profile alias ls='ls --color' ``` for macOS (z shell): cmd echo $0 touch ~/.zshrc # Create file if it doesn't exist open ~/.zshrc alias ls='ls -G' prompt \u7684\u989c\u8272\u4e5f\u53ef\u4ee5 customize For WSL, \u901a\u8fc7 ~/.bash_profile \u6253\u5f00 bash_profile \u6587\u4ef6\uff0c\u7136\u540e\u5728\u6587\u4ef6\u4e2d\u8f93\u5165: shell export PS1='\\[\\e[0;32m\\][\\u] \\[\\e[0;34m\\]\\w/ \\[\\e[01;34m\\]$ \\[\\e[0m\\]' For macOS, \u901a\u8fc7 ~/.zshrc \u6253\u5f00 zshrc \u6587\u4ef6\uff0c\u7136\u540e\u5728\u6587\u4ef6\u4e2d\u8f93\u5165: shell PROMPT='%F{green}[%n] %F{blue}%~%f %B%F{blue}$%f%b ' 1.3.2 tree : \u4ee5\u6811\u72b6\u6253\u5370directory\u67b6\u6784 tree recursively prints files and directories, which ilss useful for comparing your files against a project spec. \u6253\u5370directory\u7684\u67b6\u6784 tree . \u251c\u2500\u2500 example.txt \u251c\u2500\u2500 main.cpp \u2514\u2500\u2500 stuff \u2514\u2500\u2500 hello.txt \u5982\u679c\u65b0\u7684\u7cfb\u7edf\u6ca1\u5b89\u88c5tree\uff0c\u8fd9\u6837\u5b89\u88c5 cmd sudo apt install tree # WSL, Linux cmd brew install tree # macOS 1.3.3 pwd : print working directory pwd \u987e\u540d\u601d\u4e49\u4e5f\u5c31\u662fprint working directory, \u6253\u5370\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 pwd # /Users/ohjun/Desktop/project 1.3.4 mkdir : make directory mkdir \u5728\u5f53\u524d\u7684working directory creates a directory. \u521b\u9020\u4e00\u4e2a\u7a7a\u76ee\u5f55(\u6587\u4ef6\u5939). mkdir myfolder 1.3.5 touch : create file touch creates an empty file. \u521b\u9020\u4e00\u4e2a\u7a7a\u6587\u4ef6\uff0c\u5e76\u7ed9\u5b83\u547d\u540d touch euchre.cpp 1.3.6 rm , rm -rf : remove rm removes (deletes) a file. \u5220\u9664\u6587\u4ef6 rm -rf removes a directory. \u5220\u9664\u4e00\u6574\u4e2a\u6587\u4ef6\u5939 rm euchre.cpp rm -rf stuff2/ Files deleted by rm are gone forever. You cannot recover them from the Trash. \u8fd9\u548c\u56fe\u5f62\u5316\u754c\u9762\u91cc\u9762\u7684\u5220\u9664\u4e0d\u4e00\u6837\uff01\u6ca1\u6709\u56de\u6536\u7ad9\uff0c\u5220\u4e86\u5c31\u662f\u6c38\u4e45\u5220\u4e86\uff0c\u4e00\u5b9a\u8981\u8c28\u614e\uff01 1.3.7 cd : change directory \u66f4\u6539\u5de5\u4f5c\u76ee\u5f55 cd \u987e\u540d\u601d\u4e49change directory. \u524d\u9762\u5728Accessing Windows files from Linux\u4e2d\u5df2\u7ecf\u8bb2\u8fc7\u4e86\uff0c\u5982\u679c\u4e0d\u7ed9\u51faabsolute path\u7684\u8bdd\u5c31\u662f\u5728\u5f53\u524d\u7684working directory\u8fdb\u5165\u5176\u4e2d\u7684\u67d0\u4e2a\u5b50\u6587\u4ef6\u5939. cd /mnt/c/Users ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u4e1c\u897f) cd 19680 #\u6211\u7684\u7528\u6237\u540d ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u76ee\u5f55\u548c\u6587\u4ef6, \u5305\u62ecDesktop\u548cDocuments) cd 'My Documents' ... 1.3.8 cp : copy and paste a file cp copies a file. \u590d\u5236\u5f53\u524dworking directory\u4e2d\u7684\u4e00\u4e2a\u6587\u4ef6\u5230\u522b\u7684\u5730\u65b9 cp 1.cpp /mnt/c/Users/19680/Desktop #\u4e5f\u53ef\u4ee5\u7528../..\u7b49\u7b49\u8868\u793aparent directiry\uff0c\u4e0d\u7528\u91cd\u65b0\u6253\u4e00\u904d\u4e4b\u524d\u7684\u76ee\u5f55 1.3.9 open / wslview : Mac/Wsl\u6253\u5f00\u6587\u4ef6 \u524d\u9762Accessing Windows files from Linux\u5199\u8fc7\u4e86, macOS \u4e2d\u7528 open \u6765opens a file or directory with the default application; WSL (Windows)\u4e2d\u7528 wslview \u6765opens a file or directory with the default application. \u5982\u679c\u6ca1\u4e0b\u8f7d\u8fd9\u4e2a\u6307\u4ee4\uff0c\u8fd8\u8981\u4e0b\u8f7d\u624d\u80fd\u7528. eg: wslview 1.cpp 1.3.10 wget : \u4e0b\u8f7d\u6765\u81eaInternet\u7684\u6587\u4ef6 wget downloads a file from the internet. For example: wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz ls # starter-files.tar.gz 1.3.11 tar : \u89e3\u538b\u538b\u7f29\u5305 tar unpacks an archive. \u4e5f\u5c31\u662f\u89e3\u538b\u4e00\u4e2a\u538b\u7f29\u5305. For example, unpack the starter files for EECS 280 project 1: tar -xvzf starter-files.tar.gz # starter-files/ # ... tree #. \u251c\u2500\u2500 starter-files \u2502 \u251c\u2500\u2500 Makefile \u2502 \u251c\u2500\u2500 main_test.in \u2502 \u251c\u2500\u2500 main_test.out.correct \u2502 \u251c\u2500\u2500 main_test_data.tsv \u2502 \u251c\u2500\u2500 p1_library.cpp \u2502 \u251c\u2500\u2500 p1_library.hpp \u2502 \u251c\u2500\u2500 stats.hpp \u2502 \u251c\u2500\u2500 stats_public_test.cpp \u2502 \u2514\u2500\u2500 stats_tests.cpp.starter \u2514\u2500\u2500 starter-files.tar.gz 1.3.12 diff : \u6bd4\u8f83\u6587\u4ef6 diff compares two files. \u5982\u679c\u6ca1\u6709output\u8bf4\u660e\u8fd9\u4e24\u4e2afile\u4e00\u6a21\u4e00\u6837\uff08\u9664\u4e86\u540d\u5b57\uff09. \u6bd4\u5982\u4e0b\u9762\u5c31\u662f\u6bd4\u8f83 main_test.out \u548c main_test.out.correct \u8fd9\u4e24\u4e2a\u6587\u4ef6\uff0c\u7ed3\u679c\u4e00\u6a21\u4e00\u6837\uff0c\u4e8e\u662f\u6ca1\u6709\u8f93\u51fa. diff main_test.out main_test.out.correct 1.3.13 cat : \u6253\u5370\u6587\u4ef6\u5185\u5bb9 cat concatenates(\u4e32\u8054) files and prints them. \u4e5f\u5c31\u662f\u4f60cat\u51e0\u4e2afile\u5c31\u4f1a\u4e32\u8054\u5730\u8f93\u51fa\u8fd9\u51e0\u4e2afile\u7684\u5185\u5bb9. For example, \u968f\u4fbf\u5728 1.cpp \u91cc\u9762\u5199\u70b9\u4e1c\u897f cat 1.cpp 1.3.14 grep : \u5728(\u591a\u4e2a)file\u4e2d\u641c\u7d22 grep \uff0c \u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u201c g lobally search for a re gular expression and p rint matching lines\u201d.\uff08\u8fd9\u4e2a\u597d\u50cf\u4e0d\u592a\u987e\u540d\u601d\u4e49\uff0c\uff09 grep vector main.cpp # #include <vector> # vector<double> v = extract_column(filename, column_name); # vector<vector<double> > summary = summarize(v); \u518d\u6bd4\u5982\u66f4\u52a0\u9ad8\u7ea7\uff1aSearch for vector in \u5f53\u524dworking directory\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u9879\u76ee\u4e2d\u6240\u6709\u7684 .cpp files. terminal\u4f1a\u81ea\u52a8\u544a\u8bc9\u4f60\u54ea\u884c\u662f\u5728\u54ea\u4e2a .cpp \u6587\u4ef6\uff0c\u56e0\u800c\u975e\u5e38\u597d\u7528. grep vector *.cpp # main.cpp:#include <vector> # main.cpp: vector<double> v = extract_column(filename, column_name); # main.cpp: vector<vector<double> > summary = summarize(v); # stats.cpp:#include <vector> # ... # stats_tests.cpp:#include <vector> # ... 1.4 File, Directory, Path 1.4.1 Current directory . . refers to the current directory. \u6253\u5f00current directory\u7684\u65b9\u6cd5: macOS: open . Windows/WSL: wslview . 1.4.2 Absolute & Relative Path(\u7edd\u5bf9&\u76f8\u5bf9\u8def\u5f84) An absolute path starts from the root directory / . Eg: cmd /usr/local/bin/python3 /usr/bin/python3 A relative path starts from the current directory. Eg: cmd ./main.exe 1.4.3 Parent directory .. \u7236\u76ee\u5f55\uff1a\u539f\u76ee\u5f55\u7684\u4e0a\u4e00\u7ea7\u76ee\u5f55 .. refers to the parent directory of the current directory. pwd # /Users/ohjun/Desktop/project/stuff cd .. pwd # /Users/ohjun/Desktop/project 1.4.4 Home directory ~ ~ refers to your home directory. cd ~ pwd # /Users/ohjun ls # Applications Pictures Desktop ... 1.4.5 Root directory / / refers to the root directory. This is the top-most directory in your file system, and has no parent. \u6839\u76ee\u5f55\u662f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6700\u9876\u5c42\u7684\u76ee\u5f55\uff0c\u5b83\u6ca1\u6709\u7236\u76ee\u5f55. ls / # Applications cores sbin ... 1.4.6 Glob * A glob is a wildcard path that may match multiple paths. The * symbol matches any string. \u53ef\u4ee5\u8054\u60f3\u4e00\u4e0bpython\u91cc\u9762\u7684 import \u4ec0\u4e48\u4ec0\u4e48.* \uff0c\u5c31\u662fimport\u8fd9\u4e2a\u5305\u91cc\u6240\u6709\u4e1c\u897f. \u4e0b\u9762\u5c31\u662f\u4e00\u4e2a\u793a\u8303\uff0c\u628astarter_files\u8fd9\u4e2adirectory\u91cc\u9762\u6240\u6709\u4e1c\u897f\u90fdcopy and paste\u5230\u5f53\u524d\u7684working directory\u4e2d. cp -v starter_files/* . # './Makefile' # './main_test.in' # ... 1.5 Redirection 1.5.1 Pipe | : The pipe ( | ) sends the output of the left command to the input of the right command. \u628a\u5de6\u8fb9\u547d\u4ee4\u7684\u8f93\u51fa\u653e\u8fdb\u53f3\u8fb9\u547d\u4ee4\u7684\u8f93\u5165\uff0c\u7136\u540e\u6267\u884c\u53f3\u8fb9\u547d\u4ee4. \u770b\u7740\u6709\u70b9\u7ed5. Here\u2019s an example that searches for .cpp files. The output of ls is piped to the input of grep . \u8fd9\u91cc\u662f\u628a ls \u4e5f\u5c31\u662f\u6253\u5370 working directory \u4e2d\u6240\u6709\u6587\u4ef6\u7684\u7ed3\u679c\u5f04\u6210\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\u8ba9grep\u67e5\u67e5\u91cc\u9762\u6709\u51e0\u4e2a .cpp , \u5de7\u5999\u5730\u67e5\u8be2\u4e86\u5f53\u524d directory\u4e2d cpp \u6587\u4ef6\u7684\u6570\u91cf. $ ls | grep cpp main.cpp stats.cpp stats_tests.cpp 1.5.2 Input redirection < : \u7528\u6587\u4ef6\u4f5c\u4e3a\u7a0b\u5e8f\u8f93\u5165 Input redirection sends the contents of a file to the input of a program. Input redirection is useful for automating program input. \u8fd9\u662f\u7a0b\u5e8f\u81ea\u52a8\u5316\u7684\u91cd\u8981\u5185\u5bb9. \u975e\u5e38\u9006\u5929\u7684\u4e00\u4ef6\u4e8b\u60c5\u662fC++\u4e2d\u6211\u4eec\u77e5\u9053 << \u662foutstream\u7684\u65b9\u5411\uff0c >> \u662finstream\u7684\u65b9\u5411. \u800cterminal\u91cc\u9762\u662f\u53cd\u7684\uff0c < \u624d\u662finput\uff0c > \u624d\u662foutput. \u53ef\u80fd\u56e0\u4e3aunix\u7cfb\u7edf\u8bde\u751f\u7684\u65f6\u5019C++\u8fd8\u8fdc\u6ca1\u6709\u51fa\u73b0. Here\u2019s an example program. #include <iostream> #include <string> using namespace std; int main() { cout << \"What's your name?\" << endl; string name; cin >> name; cout << \"Hello \" << name << \"!\\n\"; } \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728terminal\u91cc\u9762\u7528\u7f16\u8bd1\u5668\u6765\u8dd1\u7a0b\u5e8f\uff0c\u521b\u5efa\u4e00\u4e2aexe\u6587\u4ef6\u6765\u8dd1\u7a0b\u5e8f\uff0c\u7528terminal\u4f5c\u4e3a\u8f93\u5165\u548c\u8f93\u51fa\u6d41\u7684\u5de5\u5177: g++ main.cpp -o main.exe ./main.exe # What's your name? # Drew (input) # Hello Drew! Create a file with user input. We\u2019ll call it main_test.in . Drew Redirect file main_test.in to stdin of main.exe . We have automated user input. g++ main.cpp -o main.exe ./main.exe < main_test.in # What's your name? # Hello Drew! \u8fd9\u5c31\u5341\u5206\u751a\u81f3\u4e5d\u5206\u597d\u7528\uff0c\u5c24\u5176\u662f\u4e0d\u5728\u5f00\u53d1\u5927\u9879\u76ee\u800c\u662f\u5199\u4e00\u4e2a\u5c0f\u7a0b\u5e8f\u7684\u65f6\u5019\uff0cIDE\u592a\u5197\u4f59\u800c\u4e14\u81c3\u80bf\u4e86\uff0c\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u5c55\u73b0\u4e00\u4e0b\u9ad8\u8d85\u7684linux\u7d20\u517b\uff08\u8feb\u771f\uff01 \u4e0b\u9762\u662f\u4e00\u6bb5\u7b14\u8005\u7684\u5c55\u793a: 1.5.3 Output redirection > : \u50a8\u5b58\u7a0b\u5e8f\u7684\u8f93\u51fa \u7ee7\u7eed\u521a\u624d\u7684\u7a0b\u5e8f. \u73b0\u5728\u6211\u4eec\u7528 > \u6765\u628a\u7a0b\u5e8f\u7684\u8f93\u51fa\u653e\u8fdb\u4e00\u4e2a\u6587\u4ef6. \u533a\u522b\u4e0d\u540c\u7684\u662f\u8fd9\u91cc\u4e0d\u7528\u518d\u521b\u5efa 1.out \u8fd9\u4e2a\u6587\u4ef6\uff0cterminal\u4f1a\u81ea\u52a8\u5e2e\u6211\u4eec\u521b\u5efa. ./main.exe runs the program < main_test.in redirects main_test.in to stdin > main_test.out redirects stdout to main_test.out ./main.exe < main_test.in > main_test.out \u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u518d\u52a0\u70b9debug\uff01\u6211\u4eec\u53ef\u4ee5\u5728working directory\u521b\u5efa\u4e00\u4e2a\u53eb\u505a main_test.out.correct \u7684\u6587\u4ef6\uff0c\u7136\u540e\u5728\u91cc\u9762\u5199\u9884\u671f\u7684\u7ed3\u679c. \u7136\u540e\u6211\u4eec\u7528 diff \u6765\u68c0\u67e5\u5b83\u548c main_test.out \u7684\u51fa\u5165\uff0c\u770b\u770b\u662f\u5426\u4e00\u81f4\uff0c\u4ee5\u6b64\u6765debug. 1.6 Useful Tips 1.6.1 clear : clear the terminal \u6e05\u7406terminal/ubantu\uff0c\u4e0d\u663e\u793a\u521a\u624d\u5199\u7684\u4e1c\u897f. \u4f46\u662f\u5e76\u4e0d\u4f1a\u6539\u53d8working directory. \u4e5f\u6709\u5feb\u6377\u952e\uff0c\u662fControl + L. 1.6.2 Tab complete \u6309\u4e00\u6b21tab\u81ea\u52a8\u8865\u5168\u53ef\u80fd\u7684directory\uff0c\u6309\u4e24\u6b21tab\u663e\u793a\u53ef\u9009\u9009\u9879. \u6bd4\u5982\u8fd9\u4e2aC++PROJECTS\u4e2d\u6709\u4e24\u4e2a\u5b50\u6587\u4ef6\u5939eecs183\u548ceecs280\uff0c\u8f93\u5165 cd e \u4e4b\u540e\u6309\u4e00\u6b21tab\u4f1a\u5e2e\u4f60\u8865\u5168\u6210 cd eecs , \u518d\u6309\u4e00\u6b21\u4f1a\u663e\u793a\u4f60\u6709eecs183\u548ceecs280\u4e24\u4e2a\u9009\u9879. 1.6.3 \u2191\u548c\u2193 \u6309 \u2191 \u4f1a\u9884\u8f93\u5165\u4f60\u4e0a\u4e00\u4e2acommand\uff0c\u4e5f\u5c31\u662f\u8bf4\u95ee\u4f60\u8981\u4e0d\u8981\u91cd\u590d\u4e0a\u4e2a\u6b65\u9aa4. \u6309\u51e0\u6b21 \u2191 \u5c31\u662f\u4e0a\u51e0\u4e2a\uff0c\u540c\u6837\u5728\u8fc7\u7a0b\u4e2d\u6309 \u2193 \u5c31\u662f\u8fd9\u4e2a\u7684\u4e0b\u4e00\u4e2acommand. \u597d\u5904\u662f\u5982\u679c\u8fde\u7eed\u8f93\u5165\u591a\u4e2a\u7c7b\u4f3ccommand\uff0c\u53ef\u4ee5\u7528\u4e0a\u4e0b\u952e\u6765\u51cf\u5c11\u6253\u5b57\u91cf. \u5982\u679c\u662f\u957f\u547d\u4ee4\u5c31\u66f4\u52a0\u9002\u5408. 1.6.4 Customize prompt: prompt\u6539\u989c\u8272 At this point, you should know whether you are using Bash or Z Shell , and you should have a working .bash_profile or .zshrc file. (1) \u5982\u679c\u662fmac\u7684zshell: \u9996\u5148\u8f93\u5165zsh\u6253\u5f00zshell, \u7136\u540e\u5982\u679c\u6ca1\u521b\u5efa\u8fc7 .zshrc \u6587\u4ef6\u7684\u8bdd\uff0c\u5c31\u8f93\u5165 touch ~/.zshrc \u5728home directory\u521b\u5efa\u4e00\u4e2a\u53eb .zshrc \u7684\u6587\u4ef6\uff0czshell\u4f1a\u81ea\u52a8\u8bc6\u522b\u5b83. \u800c\u540e\u8f93\u5165\u8fd9\u4e00\u884c\u547d\u4ee4 PROMPT='%F{green}[%n] %F{blue}%~%f %B%F{blue}$%f%b ' \u5c31\u4f1a\u66f4\u6539\u4e00\u4e9b\u5173\u952e\u8bcd\u7684\u989c\u8272\u66f4\u52a0\u5bb9\u6613\u8bc6\u522b. \u4e5f\u53ef\u4ee5\u4e86\u89e3\u4e00\u4e0b\u589e\u52a0\u66f4\u591a\u7684\u81ea\u5b9a\u4e49. (2) \u5982\u679c\u662fwsl\u7684bash shell: \u9996\u5148\u6253\u5f00ubantu, \u7136\u540e\u5982\u679c\u6ca1\u521b\u5efa\u8fc7 .bash_profile \u6587\u4ef6\u7684\u8bdd\u8f93\u5165 touch ~/.bash_profile \u5728home directory\u521b\u5efa\u4e00\u4e2a\uff0cbash shell \u4f1a\u81ea\u52a8\u8bc6\u522b\u5b83. \u800c\u540e\u8f93\u5165\u8fd9\u4e00\u884c\u547d\u4ee4 export PS1='\\[\\e[0;32m\\][\\u] \\[\\e[0;34m\\]\\w/ \\[\\e[01;34m\\]$ \\[\\e[0m\\]' \u548cmac\u5dee\u4e0d\u591a\uff0c\u5c31\u662f\u6539\u4e86\u4e00\u4e9b\u5173\u952e\u8bcd. 1.7 Shell Scripting(\u811a\u672c) In this tutorial, you\u2019ll learn to automate command line tasks using a shell script. Each line of code in a shell script is a command that could be entered at the command line. \u4e0b\u9762\u6211\u4eec\u7528\u4e00\u4e2a\u4f8b\u5b50\u6765\u4ecb\u7ecd. wc \u662f\u4e00\u4e2a\u7528\u6765\u8ba1\u6570\u7684command, -l \u8868\u793aline\uff0c\u884c\u6570. wc -l file1 \u5c06\u8fd4\u56de'file1'\u4e2d\u7684\u884c\u6570. \u73b0\u5728\u6211\u4eec\u6765\u5199\u4e00\u4e9bcommand\u7528\u4ee5\u7edf\u8ba1the number of files and directories in the present working directory. ls # bin hello hello_css html insta485 insta485generator pyproject.toml tests echo \"Count of files and folders:\" # Count of files and folders: ls | wc -l # 8 1.7.1 Creating a shell script \u73b0\u5728\u6211\u4eec\u4e0d\u4e00\u884c\u4e00\u884c\u6253\u4e86. \u6211\u4eec\u521b\u5efa\u4e00\u4e2atext file called lscount and add the following contents. Notice that shell scripts may omit a file extension. shell scripts\u7684\u540e\u7f00\u540d\u540d\u4f1a\u88ab\u5ffd\u7565\uff0c\u5e76\u4e0d\u91cd\u8981. #!/bin/bash # # lscount # # List files and folders, followed by a count # Stop on errors, print commands # See https://vaneyckt.io/posts/safer_bash_scripts_with_set_euxo_pipefail/ set -Eeuo pipefail set -x # List ls # Count echo \"Count of files and folders:\" ls | wc -l 1.7.2 Adding an executable bit We can\u2019t yet execute the script because the executable bit is not yet set. The rw means \u201cRead Write\u201d. ** \u90a3\u4e48\u600e\u4e48\u8bbe\u7f6e\u53ef\u6267\u884c\u7684\u6743\u9650\u5462\uff1f\u6211\u4eec\u5728\u8fd0\u884cscript\u4e4b\u524d\u5199\u4e0a chmod +x \u52a0\u4e0ascript\u7684\u540d\u5b57\u5c31\u53ef\u4ee5. \u8fd9\u6837\u5c31\u628a rw \u53ea\u8bfb\u6539\u6210 rwx : \u201cRead Write Execute\u201d. chmod +x lscount \u90a3\u4e48\u600e\u4e48\u68c0\u6d4b\u6709\u6ca1\u6709\u8bbe\u7f6e\u6210\u529f\u5462\uff1f\u6211\u4eec\u4f7f\u7528 ls -l \u6307\u4ee4. ls -l lscount output\u662f\u8fd9\u4e2a -rw \u8bf4\u660e\u6743\u9650\u8fd8\u662f\u53ea\u8bfb. # -rw-rw-r-- 1 awdeorio staff 273 Aug 27 10:15 lscount \u662f\u4e0b\u9762\u8fd9\u4e2a -rwx \u8bf4\u660e\u6743\u9650\u6539\u597d\u4e86. # -rwxrwxr-x 1 awdeorio staff 273 Aug 27 10:15 lscount \u6700\u540e\u5728\u5f53\u524dworking directory\u8fd0\u884cscript. ./lscount \u4e0b\u9762\u662f\u7b14\u8005\u7684\u4e00\u4e2a\u793a\u4f8b. 1.7.3 \u6ce8\u610f\u4e8b\u9879 Shebang Scripts need a special first line, called a shebang . Make sure you didn\u2019t forget it. head -n1 bin/lscount !/bin/bash Stop on errors \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cshell \u811a\u672cerror\u65f6\u4e0d\u4f1astop\u3002\u6bcf\u4e2abash shell \u811a\u672c\u7684\u7b2c\u4e00\u884c\u4ee3\u7801\u90fd\u5e94\u8be5\u5199\u4e0a\u4e0b\u9762\u8fd9\u4e2a\u4e1c\u897f . Here\u2019s why . set -Eeuo pipefail Lines Endings Scripts need to have UNIX line endings to work properly. Windows CRLF line terminators are a problem. ./bin/lscount # -bash: ./bin/lscount: /bin/bash^M: bad interpreter: No such file or directory file ./bin/lscount # bin/lscount: Bourne-Again shell script text executable, ASCII text, with CRLF line terminators Change Windows line endings to UNIX line endings. \u4ee5\u4e0b\u4e09\u4e2a\u65b9\u6cd5\u90fd\u53ef\u4ee5. You might have to install the dos2unix package. dos2unix bin/lscount fromdos bin/lscount sed -ri 's/\\r$//' bin/lscount This is what a correct script file type looks like: file bin/lscount # bin/lscount: Bourne-Again shell script text executable, ASCII text","title":"Overview"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#1-command-line-interface-cli","text":"The GUI (Graphic User Interface) is a \u201cpoint and click\u201d way to interact with a computer. The Windows File Explorer and macOS Finder are examples of GUIs. The CLI (Command Line Interface) is a text-based way to interact with a computer. The terminal is another name for the CLI. mac\u4e2d\uff0cCLI\u5c31\u662fterminal\uff0cterminal\u5c31\u662fCLI\uff1b Windows Subsystem for Linux (WSL) \u4e2d\u53eb\u505aubantu (\u6ca1\u9519\u5c31\u662fubantu server\u7684\u865a\u62df\u673a\u7248\u672c). The CLI is fast, easy to automate, and easy to use remotely.","title":"1 Command Line Interface (CLI)"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#11-mac-os-cli-tools-installation","text":"","title":"1.1 Mac OS CLI tools Installation"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#111-install-compiler","text":"Open the Terminal application which comes with macOS. Install a compiler. xcode-select --install Notice that this compiler is really Apple LLVM pretending to be g++ . Your version might be different. g++ --version #Configured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/usr/include/c++/4.2.1 # Apple LLVM version 9.0.0 (clang-900.0.38) # Target: x86_64-apple-darwin16.7.0 #Thread model: posix # InstalledDir: /Library/Developer/CommandLineTools/usr/bin*/)","title":"1.1.1 Install compiler"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#112-install-homebrew-package-manager","text":"/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)\" Homebrew installs to a non-standard location, /opt/homebrew/ . \u91cd\u8981\u7684\u4e00\u6b65\uff1a\u628ahomebrew\u52a0\u5165\u73af\u5883\u53d8\u91cf\uff1a You\u2019ll need to run the following to add Homebrew to your path: echo 'eval \"$(/opt/homebrew/bin/brew shellenv)\"' >> ~/.zprofile Check your install. Your version might be different. brew --version # 3Homebrew 3.6.14 Close your terminal and reopen your terminal.","title":"1.1.2 Install Homebrew package manager"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#113-install-cli-tools","text":"Use the Homebrew package manager to install a few command line programs. brew install wget git tree","title":"1.1.3 Install CLI tools"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#114-use-cli-tools","text":"\u524d\u9762\u5df2\u7ecf\u8bf4\u4e86\uff0cmacOS\u6240\u6709\u7684CLI\u5c31\u662f\u5728terminal\u4e2d\u6267\u884c. \u5728terminal\u4e2d\u5199command\u65f6\u52a0\u4e0a\u5404\u79cd\u5173\u952e\u8bcd\u5c31\u80fd\u4f7f\u7528\u5404\u79cdCLI\u5de5\u5177. \u5728terminal\u4e2d\u8f93\u5165 zsh \uff0c\u53ef\u4ee5\u6253\u5f00 Zshell , which is typical on macOS.","title":"1.1.4 Use CLI tools"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#12-windows-subsystem-for-linux-wsl-installation","text":"The Windows Subsystem for Linux (WSL) runs an Ubuntu Linux guest virtual machine on your Windows host machine. When you see $ in this tutorial, you should type into your shell the command that comes after the $ . \u4f60\u770b\u5230 $ \u5c31\u8bf4\u660e\u5728shell\u91cc\u9762\u4e86","title":"1.2 Windows Subsystem for Linux (WSL) Installation"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#121-install-wsl","text":"\u6253\u5f00 PowerShell \u5e76\u4e14 run it as administrator . Check if WSL was already installed. \u5982\u679c\u770b\u5230\u8fd9\u4e2a\uff0cWSL is already installed. wsl -l -v # NAME STATE VERSION #* Ubuntu Stopped 2 \u5982\u679c\u770b\u5230WSL help text\uff0cWSL is not installed. wsl -l -v # Copyright (c) Microsoft Corporation. All rights reserved. # Usage: wsl.exe [Argument] # ... \u5982\u679c\u6ca1installed\uff0cinstall: wsl --install Pitfall: Make sure Windows Update is enabled and your machine is up-to-date. Settings > Update and Security > Windows Update. Pitfall: If you still get an error from wsl --install , try the Manual installation steps . For the Linux distribution, choose the latest version of Ubuntu LTS. At the time of this writing, that\u2019s Ubuntu 22.04 LTS. \u5b89\u88c5\u597d\u4e4b\u540e\u91cd\u542f\u7535\u8111\uff0c\u7136\u540eStart PowerShell as administrator, and check that the VERSION is 2. \u5982\u679c\u663e\u793apowershell\u91cc\u8f93\u5165 wsl -l -v \u540eversion\u663e\u793a\u4e3a1\uff0c\u90a3\u4e48\u8981 wsl --update .","title":"1.2.1 Install WSL"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#122-start-an-ubuntu-bash-shell","text":"\u5728\u641c\u7d22\u680f\u641c\u7d22ubantu\u5e76\u6253\u5f00. \u8fd9\u4e2a\u65f6\u5019\u4f60\u5c31\u5728\u8fd0\u884cWSL\u7684linux\u865a\u62df\u673a\u7684command line.","title":"1.2.2 Start an Ubuntu Bash shell"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#123-install-cli-tools","text":"\u8fdb\u5165WSL\u7684linux\u865a\u62df\u673a\u7684command line\u4e4b\u540e\uff0cUse the apt package manager to install a few command line programs. \u867d\u7136\u8fd9\u662f\u865a\u62df\u673a\uff0c\u4f46\u662fLinux\u7cfb\u7edf\u91cc\u4e5f\u662f\u7528\u7684\u540c\u6837\u7684 command . sudo apt update sudo apt install g++ make rsync wget git ssh gdb python3 tree","title":"1.2.3 Install CLI tools"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#124-accessing-linux-files-from-windows","text":"\u70b9\u51fbLinux\u7684icon. Navigate to your home directory: Linux > Ubuntu > home > \u4f60\u7684\u7528\u6237\u540d. To open the File Explorer in any directory at the WSL (Ubuntu) Terminal:","title":"1.2.4 Accessing Linux files from Windows"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#125-accessing-windows-files-from-linux","text":"To access Windows files from Linux, navigate to /mnt/c/ . cd\u5c31\u662fchange directory\uff0c\u5c31\u662f\u66f4\u6539\u5f53\u524d\u7684working directory\u4e3a\u8be5\u6587\u4ef6\u5939. \u5982\u679c\u4e0d\u7ed9\u51faabsolute path\u7684\u8bdd\u5c31\u662f\u5728\u5f53\u524d\u7684working directory\u8fdb\u5165\u5176\u4e2d\u7684\u67d0\u4e2a\u5b50\u6587\u4ef6\u5939. \u5982\u679c\u60f3\u8981\u6253\u5f00\u800c\u4e0d\u662f\u8fdb\u5165\u67d0\u4e2a\u6587\u4ef6\u5939/\u6587\u4ef6\u7684\u8bdd\u5c31\u662f open \u4ee5\u53ca wslview . open \u662fMacOS\u7684\u6307\u4ee4\uff0c wslview \u662fwsl\u7684\u6307\u4ee4. cd /mnt/c/Users ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u4e1c\u897f) cd 19680 #\u6211\u7684\u7528\u6237\u540d ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u76ee\u5f55\u548c\u6587\u4ef6, \u5305\u62ecDesktop\u548cDocuments) cd 'My Documents' ...","title":"1.2.5 Accessing Windows files from Linux"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#126-pitfalls","text":"Avoid Spaces in paths Avoid paths that contain spaces. Spaces causes problems with some command line tools. Bad Example Good Example EECS 280/ eecs280/ Project 1 Stats/ p1-stats/ Project folder in Windows home directory WSL\u4e2dLinux\uff08Ubuntu\uff09\u6709\u4e00\u4e2a\u72ec\u7acb\u7684home directory. \u867d\u7136\u6211\u4eec\u8bb2\u4e86\u600e\u4e48\u5728WSL\u4e2dubantu\u548cwindows\u4e92\u901a\u6587\u4ef6\uff0c\u4f46\u662f\u5c06\u4ee3\u7801\u5b58\u50a8\u5728 Windows \u4e3b\u76ee\u5f55\u4e2d\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fd0\u884c\u901f\u5ea6\u51cf\u6162\uff0c\u56e0\u4e3a WSL \u4f7f\u7528network file share\uff08\u7f51\u7edc\u6587\u4ef6\u5171\u4eab\uff09\u5728 Windows \u548c Linux \u4e4b\u95f4\u4f20\u8f93\u6587\u4ef6. Bad Example Good Example /c/mnt/Users/awdeorio ... /home/awdeorio ... Root user \u907f\u514d\u5728 WSL \u4e2d\u4ee5 root \u7528\u6237\u8eab\u4efd\u8fdb\u884c everyday coding\uff0c\u56e0\u4e3a\u6709\u4e9b\u7a0b\u5e8f\u5728\u4ee5root\u7528\u6237\u8eab\u4efd\u8fd0\u884c\u65f6\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c. When you first installed Ubuntu, you should have been prompted to create a Linux username and password.","title":"1.2.6 Pitfalls(\u9700\u8981\u6ce8\u610f\u7684\u9690\u60a3)"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#13-basic-commands","text":"A file stores data like C++ source code ( main.cpp ) or plain text ( example.txt ). A directory contains files and other directories. It\u2019s also called a folder . \u4e5f\u5c31\u662f\u6587\u4ef6\u5939 A path is the location of a file or directory. Sometimes we end a directory path with / . (\u6709\u6ca1\u6709\u4e0d\u91cd\u8981) For example: /Users/ohjun/Desktop/project/main.cpp /Users/ohjun/Desktop/project/stuff/","title":"1.3 Basic Commands"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#131-ls-print-files-and-directories-in-working-directory","text":"ls prints files and directories in the present working directory. ls # example.txt main.cpp stuff","title":"1.3.1 ls: print files and directories in working directory"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#131-pro-tip-colorize-the-output-of-ls-and-prompt","text":"","title":"1.3.1* Pro-tip: Colorize the output of ls and prompt \u5b9a\u5236\u989c\u8272"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#for-windowswsl-and-linux-bash-shell","text":"Verify you\u2019re using the Bash shell, which is typical on WSL Ubuntu Linux. ```cmd echo $0","title":"for Windows/WSL and Linux (Bash shell):"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#-bash","text":"touch ~/.bash_profile","title":"-bash"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#create-file-if-it-doesnt-exist","text":"wslview ~/.bash_profile alias ls='ls --color' ``` for macOS (z shell): cmd echo $0 touch ~/.zshrc # Create file if it doesn't exist open ~/.zshrc alias ls='ls -G' prompt \u7684\u989c\u8272\u4e5f\u53ef\u4ee5 customize For WSL, \u901a\u8fc7 ~/.bash_profile \u6253\u5f00 bash_profile \u6587\u4ef6\uff0c\u7136\u540e\u5728\u6587\u4ef6\u4e2d\u8f93\u5165: shell export PS1='\\[\\e[0;32m\\][\\u] \\[\\e[0;34m\\]\\w/ \\[\\e[01;34m\\]$ \\[\\e[0m\\]' For macOS, \u901a\u8fc7 ~/.zshrc \u6253\u5f00 zshrc \u6587\u4ef6\uff0c\u7136\u540e\u5728\u6587\u4ef6\u4e2d\u8f93\u5165: shell PROMPT='%F{green}[%n] %F{blue}%~%f %B%F{blue}$%f%b '","title":"Create file if it doesn't exist"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#132-tree-directory","text":"tree recursively prints files and directories, which ilss useful for comparing your files against a project spec. \u6253\u5370directory\u7684\u67b6\u6784 tree . \u251c\u2500\u2500 example.txt \u251c\u2500\u2500 main.cpp \u2514\u2500\u2500 stuff \u2514\u2500\u2500 hello.txt \u5982\u679c\u65b0\u7684\u7cfb\u7edf\u6ca1\u5b89\u88c5tree\uff0c\u8fd9\u6837\u5b89\u88c5 cmd sudo apt install tree # WSL, Linux cmd brew install tree # macOS","title":"1.3.2 tree: \u4ee5\u6811\u72b6\u6253\u5370directory\u67b6\u6784"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#133-pwd-print-working-directory","text":"pwd \u987e\u540d\u601d\u4e49\u4e5f\u5c31\u662fprint working directory, \u6253\u5370\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 pwd # /Users/ohjun/Desktop/project","title":"1.3.3 pwd: print working directory"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#134-mkdir-make-directory","text":"mkdir \u5728\u5f53\u524d\u7684working directory creates a directory. \u521b\u9020\u4e00\u4e2a\u7a7a\u76ee\u5f55(\u6587\u4ef6\u5939). mkdir myfolder","title":"1.3.4 mkdir: make directory"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#135-touch-create-file","text":"touch creates an empty file. \u521b\u9020\u4e00\u4e2a\u7a7a\u6587\u4ef6\uff0c\u5e76\u7ed9\u5b83\u547d\u540d touch euchre.cpp","title":"1.3.5 touch: create file"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#136-rm-rm-rf-remove","text":"rm removes (deletes) a file. \u5220\u9664\u6587\u4ef6 rm -rf removes a directory. \u5220\u9664\u4e00\u6574\u4e2a\u6587\u4ef6\u5939 rm euchre.cpp rm -rf stuff2/ Files deleted by rm are gone forever. You cannot recover them from the Trash. \u8fd9\u548c\u56fe\u5f62\u5316\u754c\u9762\u91cc\u9762\u7684\u5220\u9664\u4e0d\u4e00\u6837\uff01\u6ca1\u6709\u56de\u6536\u7ad9\uff0c\u5220\u4e86\u5c31\u662f\u6c38\u4e45\u5220\u4e86\uff0c\u4e00\u5b9a\u8981\u8c28\u614e\uff01","title":"1.3.6 rm, rm -rf: remove"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#137-cd-change-directory","text":"cd \u987e\u540d\u601d\u4e49change directory. \u524d\u9762\u5728Accessing Windows files from Linux\u4e2d\u5df2\u7ecf\u8bb2\u8fc7\u4e86\uff0c\u5982\u679c\u4e0d\u7ed9\u51faabsolute path\u7684\u8bdd\u5c31\u662f\u5728\u5f53\u524d\u7684working directory\u8fdb\u5165\u5176\u4e2d\u7684\u67d0\u4e2a\u5b50\u6587\u4ef6\u5939. cd /mnt/c/Users ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u4e1c\u897f) cd 19680 #\u6211\u7684\u7528\u6237\u540d ls # ...(\u76ee\u5f55\u91cc\u7684\u5404\u79cd\u76ee\u5f55\u548c\u6587\u4ef6, \u5305\u62ecDesktop\u548cDocuments) cd 'My Documents' ...","title":"1.3.7 cd: change directory \u66f4\u6539\u5de5\u4f5c\u76ee\u5f55"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#138-cp-copy-and-paste-a-file","text":"cp copies a file. \u590d\u5236\u5f53\u524dworking directory\u4e2d\u7684\u4e00\u4e2a\u6587\u4ef6\u5230\u522b\u7684\u5730\u65b9 cp 1.cpp /mnt/c/Users/19680/Desktop #\u4e5f\u53ef\u4ee5\u7528../..\u7b49\u7b49\u8868\u793aparent directiry\uff0c\u4e0d\u7528\u91cd\u65b0\u6253\u4e00\u904d\u4e4b\u524d\u7684\u76ee\u5f55","title":"1.3.8 cp: copy and paste a file"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#139-open-wslview-macwsl","text":"\u524d\u9762Accessing Windows files from Linux\u5199\u8fc7\u4e86, macOS \u4e2d\u7528 open \u6765opens a file or directory with the default application; WSL (Windows)\u4e2d\u7528 wslview \u6765opens a file or directory with the default application. \u5982\u679c\u6ca1\u4e0b\u8f7d\u8fd9\u4e2a\u6307\u4ee4\uff0c\u8fd8\u8981\u4e0b\u8f7d\u624d\u80fd\u7528. eg: wslview 1.cpp","title":"1.3.9 open / wslview: Mac/Wsl\u6253\u5f00\u6587\u4ef6"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#1310-wget-internet","text":"wget downloads a file from the internet. For example: wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz ls # starter-files.tar.gz","title":"1.3.10 wget: \u4e0b\u8f7d\u6765\u81eaInternet\u7684\u6587\u4ef6"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#1311-tar","text":"tar unpacks an archive. \u4e5f\u5c31\u662f\u89e3\u538b\u4e00\u4e2a\u538b\u7f29\u5305. For example, unpack the starter files for EECS 280 project 1: tar -xvzf starter-files.tar.gz # starter-files/ # ... tree #. \u251c\u2500\u2500 starter-files \u2502 \u251c\u2500\u2500 Makefile \u2502 \u251c\u2500\u2500 main_test.in \u2502 \u251c\u2500\u2500 main_test.out.correct \u2502 \u251c\u2500\u2500 main_test_data.tsv \u2502 \u251c\u2500\u2500 p1_library.cpp \u2502 \u251c\u2500\u2500 p1_library.hpp \u2502 \u251c\u2500\u2500 stats.hpp \u2502 \u251c\u2500\u2500 stats_public_test.cpp \u2502 \u2514\u2500\u2500 stats_tests.cpp.starter \u2514\u2500\u2500 starter-files.tar.gz","title":"1.3.11 tar: \u89e3\u538b\u538b\u7f29\u5305"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#1312-diff","text":"diff compares two files. \u5982\u679c\u6ca1\u6709output\u8bf4\u660e\u8fd9\u4e24\u4e2afile\u4e00\u6a21\u4e00\u6837\uff08\u9664\u4e86\u540d\u5b57\uff09. \u6bd4\u5982\u4e0b\u9762\u5c31\u662f\u6bd4\u8f83 main_test.out \u548c main_test.out.correct \u8fd9\u4e24\u4e2a\u6587\u4ef6\uff0c\u7ed3\u679c\u4e00\u6a21\u4e00\u6837\uff0c\u4e8e\u662f\u6ca1\u6709\u8f93\u51fa. diff main_test.out main_test.out.correct","title":"1.3.12 diff: \u6bd4\u8f83\u6587\u4ef6"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#1313-cat","text":"cat concatenates(\u4e32\u8054) files and prints them. \u4e5f\u5c31\u662f\u4f60cat\u51e0\u4e2afile\u5c31\u4f1a\u4e32\u8054\u5730\u8f93\u51fa\u8fd9\u51e0\u4e2afile\u7684\u5185\u5bb9. For example, \u968f\u4fbf\u5728 1.cpp \u91cc\u9762\u5199\u70b9\u4e1c\u897f cat 1.cpp","title":"1.3.13 cat: \u6253\u5370\u6587\u4ef6\u5185\u5bb9"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#1314-grep-file","text":"grep \uff0c \u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u201c g lobally search for a re gular expression and p rint matching lines\u201d.\uff08\u8fd9\u4e2a\u597d\u50cf\u4e0d\u592a\u987e\u540d\u601d\u4e49\uff0c\uff09 grep vector main.cpp # #include <vector> # vector<double> v = extract_column(filename, column_name); # vector<vector<double> > summary = summarize(v); \u518d\u6bd4\u5982\u66f4\u52a0\u9ad8\u7ea7\uff1aSearch for vector in \u5f53\u524dworking directory\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u9879\u76ee\u4e2d\u6240\u6709\u7684 .cpp files. terminal\u4f1a\u81ea\u52a8\u544a\u8bc9\u4f60\u54ea\u884c\u662f\u5728\u54ea\u4e2a .cpp \u6587\u4ef6\uff0c\u56e0\u800c\u975e\u5e38\u597d\u7528. grep vector *.cpp # main.cpp:#include <vector> # main.cpp: vector<double> v = extract_column(filename, column_name); # main.cpp: vector<vector<double> > summary = summarize(v); # stats.cpp:#include <vector> # ... # stats_tests.cpp:#include <vector> # ...","title":"1.3.14 grep: \u5728(\u591a\u4e2a)file\u4e2d\u641c\u7d22"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#14-file-directory-path","text":"","title":"1.4 File, Directory, Path"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#141-current-directory","text":". refers to the current directory. \u6253\u5f00current directory\u7684\u65b9\u6cd5: macOS: open . Windows/WSL: wslview .","title":"1.4.1 Current directory ."},{"location":"01-Command-Line%20Interface-%28CLI%29.html#142-absolute-relative-path","text":"An absolute path starts from the root directory / . Eg: cmd /usr/local/bin/python3 /usr/bin/python3 A relative path starts from the current directory. Eg: cmd ./main.exe","title":"1.4.2 Absolute &amp; Relative Path(\u7edd\u5bf9&amp;\u76f8\u5bf9\u8def\u5f84)"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#143-parent-directory","text":"\u7236\u76ee\u5f55\uff1a\u539f\u76ee\u5f55\u7684\u4e0a\u4e00\u7ea7\u76ee\u5f55 .. refers to the parent directory of the current directory. pwd # /Users/ohjun/Desktop/project/stuff cd .. pwd # /Users/ohjun/Desktop/project","title":"1.4.3 Parent directory .."},{"location":"01-Command-Line%20Interface-%28CLI%29.html#144-home-directory","text":"~ refers to your home directory. cd ~ pwd # /Users/ohjun ls # Applications Pictures Desktop ...","title":"1.4.4 Home directory ~"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#145-root-directory","text":"/ refers to the root directory. This is the top-most directory in your file system, and has no parent. \u6839\u76ee\u5f55\u662f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6700\u9876\u5c42\u7684\u76ee\u5f55\uff0c\u5b83\u6ca1\u6709\u7236\u76ee\u5f55. ls / # Applications cores sbin ...","title":"1.4.5 Root directory /"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#146-glob","text":"A glob is a wildcard path that may match multiple paths. The * symbol matches any string. \u53ef\u4ee5\u8054\u60f3\u4e00\u4e0bpython\u91cc\u9762\u7684 import \u4ec0\u4e48\u4ec0\u4e48.* \uff0c\u5c31\u662fimport\u8fd9\u4e2a\u5305\u91cc\u6240\u6709\u4e1c\u897f. \u4e0b\u9762\u5c31\u662f\u4e00\u4e2a\u793a\u8303\uff0c\u628astarter_files\u8fd9\u4e2adirectory\u91cc\u9762\u6240\u6709\u4e1c\u897f\u90fdcopy and paste\u5230\u5f53\u524d\u7684working directory\u4e2d. cp -v starter_files/* . # './Makefile' # './main_test.in' # ...","title":"1.4.6 Glob *"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#15-redirection","text":"","title":"1.5 Redirection"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#151-pipe","text":"The pipe ( | ) sends the output of the left command to the input of the right command. \u628a\u5de6\u8fb9\u547d\u4ee4\u7684\u8f93\u51fa\u653e\u8fdb\u53f3\u8fb9\u547d\u4ee4\u7684\u8f93\u5165\uff0c\u7136\u540e\u6267\u884c\u53f3\u8fb9\u547d\u4ee4. \u770b\u7740\u6709\u70b9\u7ed5. Here\u2019s an example that searches for .cpp files. The output of ls is piped to the input of grep . \u8fd9\u91cc\u662f\u628a ls \u4e5f\u5c31\u662f\u6253\u5370 working directory \u4e2d\u6240\u6709\u6587\u4ef6\u7684\u7ed3\u679c\u5f04\u6210\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\u8ba9grep\u67e5\u67e5\u91cc\u9762\u6709\u51e0\u4e2a .cpp , \u5de7\u5999\u5730\u67e5\u8be2\u4e86\u5f53\u524d directory\u4e2d cpp \u6587\u4ef6\u7684\u6570\u91cf. $ ls | grep cpp main.cpp stats.cpp stats_tests.cpp","title":"1.5.1 Pipe |:"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#152-input-redirection","text":"Input redirection sends the contents of a file to the input of a program. Input redirection is useful for automating program input. \u8fd9\u662f\u7a0b\u5e8f\u81ea\u52a8\u5316\u7684\u91cd\u8981\u5185\u5bb9. \u975e\u5e38\u9006\u5929\u7684\u4e00\u4ef6\u4e8b\u60c5\u662fC++\u4e2d\u6211\u4eec\u77e5\u9053 << \u662foutstream\u7684\u65b9\u5411\uff0c >> \u662finstream\u7684\u65b9\u5411. \u800cterminal\u91cc\u9762\u662f\u53cd\u7684\uff0c < \u624d\u662finput\uff0c > \u624d\u662foutput. \u53ef\u80fd\u56e0\u4e3aunix\u7cfb\u7edf\u8bde\u751f\u7684\u65f6\u5019C++\u8fd8\u8fdc\u6ca1\u6709\u51fa\u73b0. Here\u2019s an example program. #include <iostream> #include <string> using namespace std; int main() { cout << \"What's your name?\" << endl; string name; cin >> name; cout << \"Hello \" << name << \"!\\n\"; } \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728terminal\u91cc\u9762\u7528\u7f16\u8bd1\u5668\u6765\u8dd1\u7a0b\u5e8f\uff0c\u521b\u5efa\u4e00\u4e2aexe\u6587\u4ef6\u6765\u8dd1\u7a0b\u5e8f\uff0c\u7528terminal\u4f5c\u4e3a\u8f93\u5165\u548c\u8f93\u51fa\u6d41\u7684\u5de5\u5177: g++ main.cpp -o main.exe ./main.exe # What's your name? # Drew (input) # Hello Drew! Create a file with user input. We\u2019ll call it main_test.in . Drew Redirect file main_test.in to stdin of main.exe . We have automated user input. g++ main.cpp -o main.exe ./main.exe < main_test.in # What's your name? # Hello Drew! \u8fd9\u5c31\u5341\u5206\u751a\u81f3\u4e5d\u5206\u597d\u7528\uff0c\u5c24\u5176\u662f\u4e0d\u5728\u5f00\u53d1\u5927\u9879\u76ee\u800c\u662f\u5199\u4e00\u4e2a\u5c0f\u7a0b\u5e8f\u7684\u65f6\u5019\uff0cIDE\u592a\u5197\u4f59\u800c\u4e14\u81c3\u80bf\u4e86\uff0c\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u5c55\u73b0\u4e00\u4e0b\u9ad8\u8d85\u7684linux\u7d20\u517b\uff08\u8feb\u771f\uff01 \u4e0b\u9762\u662f\u4e00\u6bb5\u7b14\u8005\u7684\u5c55\u793a:","title":"1.5.2 Input redirection &lt;: \u7528\u6587\u4ef6\u4f5c\u4e3a\u7a0b\u5e8f\u8f93\u5165"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#153-output-redirection","text":"\u7ee7\u7eed\u521a\u624d\u7684\u7a0b\u5e8f. \u73b0\u5728\u6211\u4eec\u7528 > \u6765\u628a\u7a0b\u5e8f\u7684\u8f93\u51fa\u653e\u8fdb\u4e00\u4e2a\u6587\u4ef6. \u533a\u522b\u4e0d\u540c\u7684\u662f\u8fd9\u91cc\u4e0d\u7528\u518d\u521b\u5efa 1.out \u8fd9\u4e2a\u6587\u4ef6\uff0cterminal\u4f1a\u81ea\u52a8\u5e2e\u6211\u4eec\u521b\u5efa. ./main.exe runs the program < main_test.in redirects main_test.in to stdin > main_test.out redirects stdout to main_test.out ./main.exe < main_test.in > main_test.out \u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u518d\u52a0\u70b9debug\uff01\u6211\u4eec\u53ef\u4ee5\u5728working directory\u521b\u5efa\u4e00\u4e2a\u53eb\u505a main_test.out.correct \u7684\u6587\u4ef6\uff0c\u7136\u540e\u5728\u91cc\u9762\u5199\u9884\u671f\u7684\u7ed3\u679c. \u7136\u540e\u6211\u4eec\u7528 diff \u6765\u68c0\u67e5\u5b83\u548c main_test.out \u7684\u51fa\u5165\uff0c\u770b\u770b\u662f\u5426\u4e00\u81f4\uff0c\u4ee5\u6b64\u6765debug.","title":"1.5.3 Output redirection &gt;: \u50a8\u5b58\u7a0b\u5e8f\u7684\u8f93\u51fa"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#16-useful-tips","text":"","title":"1.6 Useful Tips"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#161-clear-clear-the-terminal","text":"\u6e05\u7406terminal/ubantu\uff0c\u4e0d\u663e\u793a\u521a\u624d\u5199\u7684\u4e1c\u897f. \u4f46\u662f\u5e76\u4e0d\u4f1a\u6539\u53d8working directory. \u4e5f\u6709\u5feb\u6377\u952e\uff0c\u662fControl + L.","title":"1.6.1 clear: clear the terminal"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#162-tab-complete","text":"\u6309\u4e00\u6b21tab\u81ea\u52a8\u8865\u5168\u53ef\u80fd\u7684directory\uff0c\u6309\u4e24\u6b21tab\u663e\u793a\u53ef\u9009\u9009\u9879. \u6bd4\u5982\u8fd9\u4e2aC++PROJECTS\u4e2d\u6709\u4e24\u4e2a\u5b50\u6587\u4ef6\u5939eecs183\u548ceecs280\uff0c\u8f93\u5165 cd e \u4e4b\u540e\u6309\u4e00\u6b21tab\u4f1a\u5e2e\u4f60\u8865\u5168\u6210 cd eecs , \u518d\u6309\u4e00\u6b21\u4f1a\u663e\u793a\u4f60\u6709eecs183\u548ceecs280\u4e24\u4e2a\u9009\u9879.","title":"1.6.2 Tab complete"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#163","text":"\u6309 \u2191 \u4f1a\u9884\u8f93\u5165\u4f60\u4e0a\u4e00\u4e2acommand\uff0c\u4e5f\u5c31\u662f\u8bf4\u95ee\u4f60\u8981\u4e0d\u8981\u91cd\u590d\u4e0a\u4e2a\u6b65\u9aa4. \u6309\u51e0\u6b21 \u2191 \u5c31\u662f\u4e0a\u51e0\u4e2a\uff0c\u540c\u6837\u5728\u8fc7\u7a0b\u4e2d\u6309 \u2193 \u5c31\u662f\u8fd9\u4e2a\u7684\u4e0b\u4e00\u4e2acommand. \u597d\u5904\u662f\u5982\u679c\u8fde\u7eed\u8f93\u5165\u591a\u4e2a\u7c7b\u4f3ccommand\uff0c\u53ef\u4ee5\u7528\u4e0a\u4e0b\u952e\u6765\u51cf\u5c11\u6253\u5b57\u91cf. \u5982\u679c\u662f\u957f\u547d\u4ee4\u5c31\u66f4\u52a0\u9002\u5408.","title":"1.6.3 \u2191\u548c\u2193"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#164-customize-prompt-prompt","text":"At this point, you should know whether you are using Bash or Z Shell , and you should have a working .bash_profile or .zshrc file. (1) \u5982\u679c\u662fmac\u7684zshell: \u9996\u5148\u8f93\u5165zsh\u6253\u5f00zshell, \u7136\u540e\u5982\u679c\u6ca1\u521b\u5efa\u8fc7 .zshrc \u6587\u4ef6\u7684\u8bdd\uff0c\u5c31\u8f93\u5165 touch ~/.zshrc \u5728home directory\u521b\u5efa\u4e00\u4e2a\u53eb .zshrc \u7684\u6587\u4ef6\uff0czshell\u4f1a\u81ea\u52a8\u8bc6\u522b\u5b83. \u800c\u540e\u8f93\u5165\u8fd9\u4e00\u884c\u547d\u4ee4 PROMPT='%F{green}[%n] %F{blue}%~%f %B%F{blue}$%f%b ' \u5c31\u4f1a\u66f4\u6539\u4e00\u4e9b\u5173\u952e\u8bcd\u7684\u989c\u8272\u66f4\u52a0\u5bb9\u6613\u8bc6\u522b. \u4e5f\u53ef\u4ee5\u4e86\u89e3\u4e00\u4e0b\u589e\u52a0\u66f4\u591a\u7684\u81ea\u5b9a\u4e49. (2) \u5982\u679c\u662fwsl\u7684bash shell: \u9996\u5148\u6253\u5f00ubantu, \u7136\u540e\u5982\u679c\u6ca1\u521b\u5efa\u8fc7 .bash_profile \u6587\u4ef6\u7684\u8bdd\u8f93\u5165 touch ~/.bash_profile \u5728home directory\u521b\u5efa\u4e00\u4e2a\uff0cbash shell \u4f1a\u81ea\u52a8\u8bc6\u522b\u5b83. \u800c\u540e\u8f93\u5165\u8fd9\u4e00\u884c\u547d\u4ee4 export PS1='\\[\\e[0;32m\\][\\u] \\[\\e[0;34m\\]\\w/ \\[\\e[01;34m\\]$ \\[\\e[0m\\]' \u548cmac\u5dee\u4e0d\u591a\uff0c\u5c31\u662f\u6539\u4e86\u4e00\u4e9b\u5173\u952e\u8bcd.","title":"1.6.4 Customize prompt: prompt\u6539\u989c\u8272"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#17-shell-scripting","text":"In this tutorial, you\u2019ll learn to automate command line tasks using a shell script. Each line of code in a shell script is a command that could be entered at the command line. \u4e0b\u9762\u6211\u4eec\u7528\u4e00\u4e2a\u4f8b\u5b50\u6765\u4ecb\u7ecd. wc \u662f\u4e00\u4e2a\u7528\u6765\u8ba1\u6570\u7684command, -l \u8868\u793aline\uff0c\u884c\u6570. wc -l file1 \u5c06\u8fd4\u56de'file1'\u4e2d\u7684\u884c\u6570. \u73b0\u5728\u6211\u4eec\u6765\u5199\u4e00\u4e9bcommand\u7528\u4ee5\u7edf\u8ba1the number of files and directories in the present working directory. ls # bin hello hello_css html insta485 insta485generator pyproject.toml tests echo \"Count of files and folders:\" # Count of files and folders: ls | wc -l # 8","title":"1.7 Shell Scripting(\u811a\u672c)"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#171-creating-a-shell-script","text":"\u73b0\u5728\u6211\u4eec\u4e0d\u4e00\u884c\u4e00\u884c\u6253\u4e86. \u6211\u4eec\u521b\u5efa\u4e00\u4e2atext file called lscount and add the following contents. Notice that shell scripts may omit a file extension. shell scripts\u7684\u540e\u7f00\u540d\u540d\u4f1a\u88ab\u5ffd\u7565\uff0c\u5e76\u4e0d\u91cd\u8981. #!/bin/bash # # lscount # # List files and folders, followed by a count # Stop on errors, print commands # See https://vaneyckt.io/posts/safer_bash_scripts_with_set_euxo_pipefail/ set -Eeuo pipefail set -x # List ls # Count echo \"Count of files and folders:\" ls | wc -l","title":"1.7.1 Creating a shell script"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#172-adding-an-executable-bit","text":"We can\u2019t yet execute the script because the executable bit is not yet set. The rw means \u201cRead Write\u201d. ** \u90a3\u4e48\u600e\u4e48\u8bbe\u7f6e\u53ef\u6267\u884c\u7684\u6743\u9650\u5462\uff1f\u6211\u4eec\u5728\u8fd0\u884cscript\u4e4b\u524d\u5199\u4e0a chmod +x \u52a0\u4e0ascript\u7684\u540d\u5b57\u5c31\u53ef\u4ee5. \u8fd9\u6837\u5c31\u628a rw \u53ea\u8bfb\u6539\u6210 rwx : \u201cRead Write Execute\u201d. chmod +x lscount \u90a3\u4e48\u600e\u4e48\u68c0\u6d4b\u6709\u6ca1\u6709\u8bbe\u7f6e\u6210\u529f\u5462\uff1f\u6211\u4eec\u4f7f\u7528 ls -l \u6307\u4ee4. ls -l lscount output\u662f\u8fd9\u4e2a -rw \u8bf4\u660e\u6743\u9650\u8fd8\u662f\u53ea\u8bfb. # -rw-rw-r-- 1 awdeorio staff 273 Aug 27 10:15 lscount \u662f\u4e0b\u9762\u8fd9\u4e2a -rwx \u8bf4\u660e\u6743\u9650\u6539\u597d\u4e86. # -rwxrwxr-x 1 awdeorio staff 273 Aug 27 10:15 lscount \u6700\u540e\u5728\u5f53\u524dworking directory\u8fd0\u884cscript. ./lscount \u4e0b\u9762\u662f\u7b14\u8005\u7684\u4e00\u4e2a\u793a\u4f8b.","title":"1.7.2 Adding an executable bit"},{"location":"01-Command-Line%20Interface-%28CLI%29.html#173","text":"Shebang Scripts need a special first line, called a shebang . Make sure you didn\u2019t forget it. head -n1 bin/lscount !/bin/bash Stop on errors \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cshell \u811a\u672cerror\u65f6\u4e0d\u4f1astop\u3002\u6bcf\u4e2abash shell \u811a\u672c\u7684\u7b2c\u4e00\u884c\u4ee3\u7801\u90fd\u5e94\u8be5\u5199\u4e0a\u4e0b\u9762\u8fd9\u4e2a\u4e1c\u897f . Here\u2019s why . set -Eeuo pipefail Lines Endings Scripts need to have UNIX line endings to work properly. Windows CRLF line terminators are a problem. ./bin/lscount # -bash: ./bin/lscount: /bin/bash^M: bad interpreter: No such file or directory file ./bin/lscount # bin/lscount: Bourne-Again shell script text executable, ASCII text, with CRLF line terminators Change Windows line endings to UNIX line endings. \u4ee5\u4e0b\u4e09\u4e2a\u65b9\u6cd5\u90fd\u53ef\u4ee5. You might have to install the dos2unix package. dos2unix bin/lscount fromdos bin/lscount sed -ri 's/\\r$//' bin/lscount This is what a correct script file type looks like: file bin/lscount # bin/lscount: Bourne-Again shell script text executable, ASCII text","title":"1.7.3 \u6ce8\u610f\u4e8b\u9879"},{"location":"02-IDEs.html","text":"2 IDEs 2 IDEs 2.1 VScode for Mac & WSL/Linux 2.1.1 Installation and Project Basis 2.1.1.1 Downloading VSCode for Mac 2.1.1.2 Create a project and open it with VSCode 2.1.1.3 Create new files \u521b\u9020\u65b0\u6587\u4ef6 2.1.1.4 Downloading from Internet and adding existing files \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0\u73b0\u6709\u6587\u4ef6 2.1.1.5 Rename Files \u6587\u4ef6\u91cd\u547d\u540d 2.1.2 Compile and Run: \u914d\u7f6e launch.json \u6587\u4ef6 2.1.2.1 Create .exe file 2.1.2.2 Create and edit launch.json 2.1.2.3 Run Project 2.1.2.4 Configure input redirection \u8f93\u5165\u91cd\u5b9a\u5411\u6587\u4ef6\u7684\u6743\u9650 2.1.2.5 Arguments and options 2.2 XCode on Mac 2.2.1 Installation and Project Basis 2.2.1.1 \u521b\u5efa\u5e76\u6253\u5f00project 2.2.1.2 \u79fb\u52a8\u81ea\u52a8\u751f\u6210\u7684 main.cpp 2.2.1.3 Add new files 2.2.1.4 \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0existing files 2.2.2 Compile and Run 2.2.2.1 Include Files in a Build 2.2.2.2 Edit Scheme \u65b9\u6848 2.2.2.3 Input Redirection \u8f93\u5165\u91cd\u5b9a\u5411 2.2.2.4 Arguments and options 2.3 Visual Studio on Windows 2.3.1.1 \u521b\u5efa\u5e76\u6253\u5f00project 2.3.1.2 Rename main.cpp file 2.3.1.3 Add new files \u6dfb\u52a0\u65b0\u6587\u4ef6 2.3.1.4 Downing and Adding Existing Files 2.3.1.5 Rename Files \u91cd\u547d\u540d 2.3.2 Compile and Run 2.3.2.1 Exclude files from build 2.3.2.2 Run project 2.3.2.3 Input redirection \u8f93\u51fa\u91cd\u5b9a\u5411 2.3.2.4 Arguments and options 2.4 Troubleshooting 2.4.1 VSCode 2.4.1.1 Reset 2.4.1.2 Compile and run 2.4.1.3 Intllisense C++ Standard 2.4.1.4 C/C++ extension alternatives 2.4.2 Xcode 2.4.3 Visual Studio 2.1 VScode for Mac & WSL/Linux 2.1.1 Installation and Project Basis 2.1.1.1 Downloading VSCode for Mac VSCode is a lightweight, easy-to-use, source code editor with debugging support. It runs on macOS, Windows, and Linux (including CAEN Linux). (1) Download on Mac \u9996\u5148\u786e\u4fdd\u4f60\u4e0b\u8f7d\u4e86compiler and a debugger. MacOS\u9ed8\u8ba4\u7684compiler\u662f Apple clang , \u4f46\u662f\u5b83\u7528\u7684\u662f g++ \u7684\u540d\u5b57(\u602a). debugger\u7528\u7684\u662f lldb . \u81f3\u4e8e\u5177\u4f53\u600e\u4e48\u88c5\u6211\u4eec\u5b9e\u9645\u4e0a\u5df2\u7ecf\u5728install CLI tools\u7684\u65f6\u5019\u88c5\u8fc7\u4e86. \u6211\u4eec\u901a\u8fc7 $ xcode-select --install \u5b89\u88c5\u4e86\u5939\u5e26\u5728xcode\u4e2d\u7684 Apple LLVM which pretends to be g++, \u4ee5\u53calldb debugger. shell xcode-select --install \u68c0\u67e5\u7248\u672c. shell g++ --version # Apple clang version 13.1.6 (clang-1316.0.21.2.5) lldb --version # Apple Swift version 5.6.1 (swiftlang-5.6.0.323.66 clang-1316.0.20.12) \u8fd8\u6709\u4e00\u4ef6\u4e8b\uff0c\u5c31\u662f\u786e\u4fdd\u4f60\u7684Mac\u7248\u672c\u572811.1\u4ee5\u4e0a. shell sw_vers # ProductName: macOS # ProductVersion: 14.2 \u5b89\u88c5VSCode shell brew install --cask visual-studio-code \u5b89\u88c5extension packages: C/C++ extension , CodeLLDB extension . shell code --install-extension ms-vscode.cpptools code --install-extension vadimcn.vscode-lldb list extension\u4ee5\u786e\u8ba4. shell code --list-extensions (2) Download on WSL/Linux \u540c\u6837\uff0c\u4e0b\u8f7dcompiler\u548cdebugger. Windows/WSL\u4e2dcompiler\u7528 g++ , debugger\u7528 gdb . \u6211\u4eec\u5728\u5b89\u88c5CLI\u5de5\u5177\u7684\u65f6\u5019\u4e5f\u5e72\u8fc7\u4e86. \u539f\u751flinux\u4e5f\u4e00\u6837. shell sudo apt install g++ gdb \u68c0\u67e5\u7248\u672c. shell g++ --version # g++ (GCC) 8.5.0 20210514 gdb --version # GNU gdb (GDB) \u5b89\u88c5VSCode \u76f4\u63a5\u901a\u8fc7 https://code.visualstudio.com/ \u5b89\u88c5. \u5b89\u88c5WSL Extension\uff0c\u4f7f\u5f97VS Code backend\u80fd\u591f\u5728WSL\u4e0a\u8fd0\u884c(\u539f\u751flinux\u4e0d\u7528), which is where our installed g++ compiler lives. VS Code\u8fde\u63a5\u5230WSL Ubantu. \u9996\u5148\u70b9\u51fb\u5de6\u4e0b\u84dd\u8272\u56fe\u6807\uff0c\u7136\u540e\u5728\u8df3\u51fa\u7684 Command Palette(Ctrl+Shift+P) \u9009\u62e9\"Connect to WSL\". \u9009\u62e9\u5b8c\u4e4b\u540e\u84dd\u8272\u7684\u56fe\u6807\u4f1a\u663e\u793a\u4f60\u5728WSL Ubantu Mode\u4e0b\u8fd0\u884c. (\u539f\u751flinux\u4e0d\u7528) \u4e00\u5b9a\u8981\u786e\u4fdd\u5728WSL\u4e0b\u8fd0\u884c\uff01\uff01 \u5982\u679caccientally opened the folder in Windows Mode, \u90a3\u4e48\u5c31\u70b9\u51fbCtrl+shift+P\u6253\u5f00Command Palette\u5e76\u9009\u62e9\"WSL: Reopen Folder in WSL\". \u540c\u6837\uff0c\u8fc7\u7a0b\u4e2d\u5982\u679c\u8df3\u51fa \"Unable to start debugging\" \u7a97\u53e3\u4e5f\u8981 Reopen Folder in WSL. \u5728Sidebar\u4e2d\u4e0b\u8f7d\u540d\u5b57\u4e3a \"C/C++\" \u7684extension. 2.1.1.2 Create a project and open it with VSCode \u6bd4\u5982 mkdir ~/eecs280 cd ~/eecs280 mkdir p1-stats cd p1-stats Pitfall: Avoid paths that contain spaces. Spaces causes problems with some command line tools. Bad Example Good Example EECS 280/ eecs280/ Project 1 Stats/ p1-stats/ a quick way to open VS Code to a specific project folder from the command line. \u4f46\u662f\u9996\u5148\u8981\u7528 ls \u786e\u8ba4\u4f60\u73b0\u5728\u5728\u9879\u76ee\u6587\u4ef6\u5939\u4e2d. ls # main.cpp ... code . \u6ce8\u610f\uff1a\u5982\u679c\u4f60\u5728\u4f7f\u7528WSL\uff0c\u90a3\u4e48\u4f60\u7684\u9879\u76ee\u5e94\u5f53\u521b\u5efa\u5728Ubantu\u4e0b\u7684directory\u4e2d\u800c\u4e0d\u662fWindows\u4e0b\u7684. \u5426\u5219\u4f1aslowdown running speed. pwd # /home/awdeorio ... # Good, Linux home # /c/mnt/Users/awdeorio ... # Bad, Windows home 2.1.1.3 Create new files \u521b\u9020\u65b0\u6587\u4ef6 \u5148navigate to working directory\uff0c\u7136\u540e\u5982\u4e0b\uff08\u4f8b\u5982\uff0c\u521b\u5efa\u4e00\u4e2a main.cpp \u7684\u6587\u4ef6 touch main.cpp 2.1.1.4 Downloading from Internet and adding existing files \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0\u73b0\u6709\u6587\u4ef6 \u5148navigate to working directory\uff0c\u7136\u540e\u8fd9\u91cc\u662f\u4ece\u7f51\u4e0a\u4e0b\u8f7d\u6587\u4ef6\u538b\u7f29\u5305\uff0c\u89e3\u538b\u5e76\u79fb\u52a8\u5230working directory\u4e00\u6761\u9f99. wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz ## \u4ece\u8be5\u7f51\u9875\u4e0b\u8f7d tar -xvzf starter-files.tar.gz ## \u89e3\u538b mv starter-files/* . ## \u628astater-files\u4e0b\u6240\u6709\u6587\u4ef6\u79fb\u52a8\u5230working directory rm -rf starter-files starter-files.tar.gz ## \u5220\u9664\u4e0b\u8f7d\u6587\u4ef6 2.1.1.5 Rename Files \u6587\u4ef6\u91cd\u547d\u540d mv \u6307\u4ee4\u5982\u679c\u662fmove\u6587\u4ef6\u5230\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5230\u6587\u4ef6\u5939\uff0c\u610f\u601d\u5c31\u662f\u91cd\u547d\u540d\u6587\u4ef6. mv stats_tests.cpp.starter stats_tests.cpp 2.1.2 Compile and Run: \u914d\u7f6e launch.json \u6587\u4ef6 2.1.2.1 Create .exe file VSCode\u9700\u8981\u4e00\u4e2aexecutable\u6587\u4ef6\u6765compile and run. \u4e5f\u5c31\u662f .exe \u6587\u4ef6. \u6211\u4eec\u901a\u8fc7command line\u521b\u5efa\u4e00\u4e2a. touch stats.cpp # Needed for EECS 280 p1 make main.exe # make\u662fMakefile\u7684clt\u6307\u4ee4. \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u8fd8\u6ca1\u5b66makefile, \u4f46\u662f\u8001\u5e08\u80af\u5b9a\u4f1a\u5728Project tar\u91cc\u7ed9\u4f60\u4e00\u4e2aMakefile\u6587\u4ef6 ./main.exe # \u8dd1\u4e00\u4e0b. \u9700\u8981\u4ee3\u7801\u80fd\u6b63\u5e38\u8fd0\u884c\u624d\u80fd\u6b63\u5e38\u8dd1 \u5982\u679c\u4f60\u7684\u8001\u5e08\u771f\u7684\u6ca1\u7ed9\u4f60Makefile\u7684\u8bdd\uff08\u9006\u5929\uff09\uff0c\u90a3\u4e48\u4f60\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a.exe\u5e76compile manually. g++ -g main.cpp -o main.exe \u672c\u8d28\u4e0a\u5c31\u662f\u53ea\u8981compile main.cpp\u5c31\u53ef\u4ee5\u4e86\uff0c\u5176\u4ed6\u7684files\u90fd\u88ablinker\u901a\u8fc7header file\u7ed9 include\u8fdb\u4e86main.cpp. 2.1.2.2 Create and edit launch.json \u5728\u5de6\u4fa7\u7684 SideBar \u4e2d navigate \u5230 \u201cRun and Debug\", \u5728\u5176\u4e2d\u70b9\u51fb Create a launch.json file , \u7136\u540e\u4f1a\u8df3\u51fa Select debugger . \u5982\u679c\u662fmacOS, \u5219\u9009\u62e9 LLDB ; \u5982\u679c\u662fWSL/Linux, \u5219\u9009\u62e9C++ GDB/LLDB \u3002 \u70b9\u51fb\u4e0b\u65b9\u7684 \u201cAdd Configuration\" . \u7136\u540eWSL\u9009\u62e9 \"C/C++: (gdb) Launch\" . \u6ce8\u610f\u4e0d\u662fAttach\u800c\u662fLaunch. MacOS\u9009\u62e9 \"C/C++: (lldb) Launch\" \u66f4\u6539 launch.json \u4e2d\u7684 \"program\" \u4e3a \"{workspaceFolder}/main.exe\" . \u524d\u63d0\u662f\u4f60\u7684exe\u6587\u4ef6\u53eb main.exe ,\u603b\u4e4b\u5c31\u662f\u8fd0\u884c\u4f60\u7684exe\u6587\u4ef6. \u66f4\u6539 \"cwd\" \u4e3a \"{workspaceFolder}\" \u5982\u679c\u5b83\u4e0d\u662f. ```json { \"program\": \"${workspaceFolder}/main.exe\", ... \"cwd\": \"${workspaceFolder}\", } ``` \u5982\u679c\u51fa\u73b0\u672a\u77e5\u7684\u95ee\u9898\uff0cdelete your launch.json \u5e76\u91cd\u65b0\u914d\u7f6e. 2.1.2.3 Run Project \u786e\u8ba4\u4e86: makeFile\u6587\u4ef6\u5df2\u7ecf\u914d\u7f6e\u597d\uff0c \u5df2\u7ecf\u521b\u5efa\u4e86 main.cpp \u5e76\u5199\u5b8c\u4e86main\u51fd\u6570 (\u5305\u62ec\u5176\u4ed6MakeFile\u914d\u7f6e\u4e2d\u4f9d\u8d56\u7684\u6587\u4ef6). \u7136\u540e\u5df2\u7ecf\u7528 make main.exe \u521b\u5efa\u4e86\u53ef\u6267\u884c\u6587\u4ef6. \u5df2\u7ecf\u914d\u7f6e\u597d\u4e86 launch.json \u7136\u540e\u5c31\u53ef\u4ee5\u8fd0\u884c\u6574\u4e2aproject\u4e86. Navigate\u5230Run and Debug, \u70b9\u51fb\u5de6\u4fa7\u4e0a\u65b9\u7684\u8fd0\u884c\u952e\u5c31\u53ef\u4ee5\u8fd0\u884c. \u5207\u8bb0\u4e0d\u662f\u53f3\u4fa7\u4e0a\u65b9\u7684! 2.1.2.4 Configure input redirection \u8f93\u5165\u91cd\u5b9a\u5411\u6587\u4ef6\u7684\u6743\u9650 \u5728\u4e4b\u524d\u7684CLT\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u5b66\u4e60\u4e86\u600e\u4e48\u5236\u4f5c\u4e00\u4e2ainput redirection script\u6765\u4ee3\u66ff\u6211\u4eec\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u811a\u672c\u8f93\u5165\uff0c\u4ee5\u8fdb\u884c\u81ea\u52a8\u5316. \u6bd4\u5982: ./main.exe < main_test.in # What's your name? # Hello Drew! \u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u5728 launch.json \u6587\u4ef6\u4e2d\u5bf9\u5176\u8fdb\u884cconfigure, \u4ee5\u5141\u8bb8\u5176\u6743\u9650. **For MacOS: ** { \"configurations\": [ { ... \"program\": \"${workspaceFolder}/main.exe\", ... \"stdio\": [\"main_test.in\", null, null], // \u8fd9\u4e00\u884c\u5c31\u662f\u5141\u8bb8 main_test_.in \u6587\u4ef6\u4f5c\u4e3ainput redirection ... } ] } For WSL/Linux: { \"configurations\": [ { ... \"program\": \"${workspaceFolder}/main.exe\", ... \"args\": [\"<\", \"main_test.in\"], // \u8fd9\u4e00\u884c\u5c31\u662f\u5141\u8bb8 main_test_.in \u6587\u4ef6\u4f5c\u4e3ainput redirection // \u6ce8\u610fWindows\u8fd8\u9700\u8981\u52a0\u4e0aredirection\u7b26\u53f7\"<\"\u4f5c\u4e3a\u53c2\u6570, \u5141\u8bb8\u4f7f\u7528redirection. ... } ] } (\u6ce8\u610f\uff0c\u5982\u679c\u662fmacOS\uff0c\u9700\u8981\u5728 launch.json \u4e2d\u786e\u8ba4\u4f60\u5728\u4f7f\u7528\u7684\u662f lldb debugger. \"type\": \"lldb\" . \u5982\u679c\u56e0\u4e3a\u5404\u79cd\u5947\u602a\u7684\u539f\u56e0\u6ca1\u6709\u5c31\u52a0\u4e0a.) { \"configurations\": [ { \"type\": \"lldb\", ... 2.1.2.5 Arguments and options Arguments and options \u5c31\u662f\u5199 command line \u65f6 type into \u7684 inputs to a program. \u6bd4\u5982\uff1a ./main.exe train_small.csv test_small.csv --debug main.exe \u662f program\u540d. train_small.csv and test_small.csv \u662f arguments --debug \u662f\u8fd9\u4e00\u64cd\u4f5c\u7684 option. \u610f\u601d\u5c31\u662f\u8981\u5bf9 main.exe \u8fd9\u4e2aprogram\u8fdb\u884c debug \u8fd9\u4e2a\u884c\u4e3a, \u800c\u5176\u4e2d\u7684\u8f93\u5165\u4e3a train_small.csv \u548c test_small.csv . \u90a3\u4e48\u6211\u4eec\u5c31\u8981\u66f4\u6539 launch.json \u8fdb\u884ccongiguration\u6765\u544a\u77e5\u4e0e\u5141\u8bb8\u8fd9\u4e24\u4e2aarguments\u548cdebug\u8fd9\u4e2acommand line option. \u6211\u4eec\u627e\u5230 \"configurations\" , \u7136\u540e\uff1a { \"configurations\": [ { ... \"program\": \"${workspaceFolder}/main.exe\", \"args\": [\"train_small.csv\", \"test_small.csv\", \"--debug\"], ... } ] } \u6bcf\u4e2aoption\u6216\u8005argument\u5e94\u8be5\u7528string\u8868\u793a\uff0ccomma-separated. \u8fd9\u4e00\u6761\u91cc\u7684\u4e1c\u897f MacOS \u548c WSL/Linux \u662f\u4e00\u6837\u7684 . 2.2 XCode on Mac 2.2.1 Installation and Project Basis 2.2.1.1 \u521b\u5efa\u5e76\u6253\u5f00project \u76f4\u63a5\u4f7f\u7528App Store\u5b89\u88c5. \u521b\u5efaProject\u7684\u6b65\u9aa4\u662f Create a new Xcode projects -> Command Line Tool -> \u586b\u5199project name, \u9009\u62e9\u8bed\u8a00\u4e3aC++, \u5728\u201cOrganization Identifier\u201d field \u8f93\u5165\u8eab\u4efd\u6bd4\u5982\u5b66\u6821\u7684\u9879\u76ee\u5199\u4e0a uniqname. \u521b\u5efa\u65f6\u8bb0\u5f97\u52fe\u9009 Create Git repository on my Mac \u4ee5\u4fbf\u4e8e\u7248\u672c\u7ba1\u7406. \u8fd8\u662f\u8bb0\u5f97\u9879\u76ee\u540d\u4e0d\u8981\u6709\u7a7a\u683c. \u5728working directory \u6253\u5f00project\u7684\u5feb\u6377\u65b9\u6cd5. open p1-stats.xcodeproj 2.2.1.2 \u79fb\u52a8\u81ea\u52a8\u751f\u6210\u7684 main.cpp tree . \u251c\u2500\u2500 main.cpp \u2514\u2500\u2500 p1-stats.xcodeproj \u251c\u2500\u2500 ... 2.2.1.3 Add new files \u540e\u9762\u8fd8\u4f1a\u8d34\u5fc3\u5730\u95ee\u4f60\u8981\u4e0d\u8981also create a header file. \u4f46\u662f\u4e4b\u540e\u4e00\u9875\u9009\u62e9target\u65f6\u4e0d\u8981\u9009\u62e9\u4efb\u4f55target. You should see your new file in the sidebar. 2.2.1.4 \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0existing files \u786e\u4fdd\u4f60\u5728\u5305\u542b\u6e90\u4ee3\u7801\u7684directory\u4e2d. ls # main.cpp p1-stats.xcodeproj \u7f51\u7edc\u4e0b\u8f7d\u4e0e\u89e3\u538b\u6587\u4ef6\u5e76\u653e\u5230working directory\u4e0b. wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz tar -xvzf starter-files.tar.gz mv starter-files/* . rm -rf starter-files starter-files.tar.gz \u4f7f\u7528 tree \u547d\u4ee4\u6216\u8005 ls \u547d\u4ee4\u786e\u8ba4\u6587\u4ef6. tree . \u251c\u2500\u2500 Makefile \u251c\u2500\u2500 main.cpp \u251c\u2500\u2500 main_test.in \u251c\u2500\u2500 main_test.out.correct \u251c\u2500\u2500 main_test_data.tsv \u251c\u2500\u2500 p1-stats.xcodeproj \u2502 \u251c\u2500\u2500 ... \u251c\u2500\u2500 p1_library.cpp \u251c\u2500\u2500 p1_library.hpp \u251c\u2500\u2500 stats.hpp \u251c\u2500\u2500 stats_public_test.cpp \u2514\u2500\u2500 stats_tests.cpp.starter \u8fd9\u4e2a\u65f6\u5019\u6587\u4ef6\u90fd\u5728\u9879\u76ee\u6587\u4ef6\u5939\u4e2d\uff0c\u5728\u4fa7\u8fb9\u662f\u770b\u4e0d\u5230\u6587\u4ef6\u7684. \u70b9\u51fb\u6587\u4ef6\u56fe\u6807\u5e76\u9009\u62e9 Add Files to... \u7136\u540e command + a \u9009\u62e9\u6240\u6709\u6587\u4ef6\uff0c\u9009\u62e9 Create folder references , \u4e0d\u8981\u9009\u62e9 Add to targets \uff01 \u7136\u540e\u5c31\u53ef\u4ee5\u5728 Sidebar \u770b\u5230\u6587\u4ef6\u4e86\uff0c\u8bf4\u660e\u6210\u529f\u4e86. \u91cd\u547d\u540d\u6587\u4ef6\u76f4\u63a5\u5728 Sidebar\u5c31\u53ef\u4ee5\u64cd\u4f5c. 2.2.2 Compile and Run 2.2.2.1 Include Files in a Build \u4e00\u4e2a Xcode target compiles \u4e00\u4e2a exe\u6587\u4ef6\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u521a\u624d\u8bf4\u4e0d\u8981\u628a\u6587\u4ef6add \u5230 target \u7684\u539f\u56e0. \u4f60\u9700\u8981\u77e5\u9053 which files to include in a build. Never include header ( .h or .hpp ) files\uff01 Method 1: Include myfile.cpp each time you see #include \"myfile.hpp\" . Method 2: Include .cpp files used by your Makefile . In this example, main.cpp , stats.cpp , and p1_library.cpp . make clean make main.exe # g++ -Wall -Werror -pedantic -g --std=c++17 main.cpp stats.cpp p1_library.cpp -o main.exe 2.2.2.2 Edit Scheme \u65b9\u6848 \u914d\u7f6e Xcode \u4ee5\u5728\u5305\u542binput files\u7684directory\u4e2d\u8fd0\u884cexe\u6587\u4ef6\uff01\uff01 \u5177\u4f53\u65b9\u6cd5\u662f menu: Product -> Scheme -> Edit Scheme -> Run -> Options , then Use custom working directory . \u7136\u540eBrowse to the directory containing your project\u2019s files. \u6700\u540e Click Close . 2.2.2.3 Input Redirection \u8f93\u5165\u91cd\u5b9a\u5411 XCode \u5e76\u4e0d\u652f\u6301 input redirection. \u4f46\u662f\u6211\u4eec\u7528\u4e00\u4e2a work-around \u6765\u628a input file \u4f20\u5165 cin \uff0c\u8fbe\u5230\u540c\u6837\u7684\u6548\u679c. Add these lines to the top of your main function. Your input filename may be different. #include <cassert> #include <cstdio> //... int main() { #ifdef __APPLE__ assert(freopen(\"main_test.in\", \"r\", stdin)); #endif //... \u5982\u679c\u8981\u7ed3\u675finput redirection, \u4f7f\u7528 comment or delete \u628a\u8fd9\u51e0\u884c\u53bb\u6389. 2.2.2.4 Arguments and options \u548c\u5148\u524d\u4e00\u6837\uff0cArguments and options \u5c31\u662f\u5199 command line \u65f6 type into \u7684 inputs to a program. ./main.exe train_small.csv test_small.csv --debug main.exe \u662f program\u540d. train_small.csv and test_small.csv \u662f arguments --debug \u662f\u8fd9\u4e00\u64cd\u4f5c\u7684 option. \u4e0d\u8fc7 XCode \u4e0d\u7528\u901a\u8fc7 \u7f16\u8f91 launch.json \u6587\u4ef6\u6765 configure Arguments and options. \u6211\u4eec\u76f4\u63a5menu: Product -> Scheme -> Edit Scheme -> Run -> Ariguments . \u7136\u540e\u5728\u5176\u4e2d\u52a0\u4e0a\u6bcf\u4e00\u4e2a option or argument separately. 2.3 Visual Studio on Windows 2.3.1 Installation and Project Basis 2.3.1.1 \u521b\u5efa\u5e76\u6253\u5f00project \u5b89\u88c5 Visual Studio Community edition from Microsoft\u2019s website . \u9009\u62e9 Desktop Development with C++ \uff0c\u5e76\u9009\u62e9 Windows 10 SDK \u3001 Windows 11 SDK \u548c C++ AddressSanitizer . \u91cd\u542f\u540e\uff0c Create a new project -> Console App -> Set project name -> Pick a location for storage. \u540c\u6837\uff0cproject name\u4e0d\u80fd\u6709\u7a7a\u683c. \u8fdb\u5165\u9879\u76ee\u540e\uff0c\u53f3\u51fb\u9879\u76ee\u56fe\u6807\u9009\u62e9 Open Folder in File Explorer , \u8fd9\u5c31\u662f\u6211\u4eec\u7684 working directory \u4e86. \u91cc\u9762\u80af\u5b9a\u4f1a\u5305\u542b\u4e00\u4e2a sln \u6587\u4ef6\u548c\u4e00\u4e2a vcxproj \u6587\u4ef6. tree . \u251c\u2500\u2500 p1-stats.cpp \u251c\u2500\u2500 p1-stats.sln \u251c\u2500\u2500 p1-stats.vcxproj \u251c\u2500\u2500 p1-stats.vcxproj.filters \u2514\u2500\u2500 p1-stats.vcxproj.user \u91cd\u65b0\u6253\u5f00\u9879\u76ee\u5c31\u662f\uff1a\u9009\u62e9 File > Open > Project/Solution , navigate to your project directory ( p1-stats in this example). \u4e5f\u5c31\u662f\u6211\u4eec\u521a\u624d\u7684 working directory. 2.3.1.2 Rename main.cpp file \u6211\u4eec\u521b\u5efa\u7684\u9879\u76ee\u540d\u4f1a\u81ea\u52a8\u53d8\u6210\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\uff0c\u4f46\u6211\u4eec\u5e94\u8be5\u628a\u5b83\u6539\u6210 main.cpp . 2.3.1.3 Add new files \u6dfb\u52a0\u65b0\u6587\u4ef6 \u53f3\u51fb Source Files \uff0c\u9009\u62e9 Add -> New Item . \u8f93\u5165\u6587\u4ef6\u540d. You should see the new file under Source Files , \u5e76\u4e14\u5f53\u4f60\u6253\u5f00\u521a\u624d\u8bf4\u7684 working directory, \u4e5f\u80fd\u770b\u5230\u8be5\u6587\u4ef6. 2.3.1.4 Downing and Adding Existing Files \u9996\u5148 cd \u5230 working directory \u5e76\u7528 ls \u786e\u4fdd\u4f60\u5728\u5176\u4e2d. \u548c\u524d\u9762\u7684 VSCode \u4e0e XCode \u4e00\u6837\uff0c\u4eceInternet \u4e0b\u8f7d\u6587\u4ef6\u5e76\u79fb\u5165 working directory, \u590d\u5236\u540e\u79fb\u9664. wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz tar -xvzf starter-files.tar.gz mv starter-files/* . rm -rf starter-files starter-files.tar.gz \u7136\u540e\u4f7f\u7528 tree \u6216\u8005 ls \u68c0\u67e5\uff1a tree . \u251c\u2500\u2500 Makefile \u251c\u2500\u2500 main.cpp \u251c\u2500\u2500 main_test.in \u251c\u2500\u2500 main_test.out.correct \u251c\u2500\u2500 main_test_data.tsv \u251c\u2500\u2500 p1-stats.sln \u251c\u2500\u2500 p1-stats.vcxproj \u251c\u2500\u2500 p1-stats.vcxproj.filters \u251c\u2500\u2500 p1-stats.vcxproj.user \u251c\u2500\u2500 p1_library.cpp \u251c\u2500\u2500 p1_library.hpp \u251c\u2500\u2500 stats.hpp \u251c\u2500\u2500 stats_public_test.cpp \u2514\u2500\u2500 stats_tests.cpp.starter \u53f3\u51fb Source Files , then select Add -> Existing Item . \u7136\u540e navigate to your project directory. \u901a\u8fc7\u6309\u4f4f Control and clicking each one \u6765\u9009\u62e9\u6240\u6709\u4f60\u9700\u8981\u7684 files. Do not select any .sln or .vcxproj files. Click \u201cAdd\u201d. \u73b0\u5728\u4f60\u53ef\u4ee5\u5728 Sidebar \u4e2d\u770b\u89c1\u8fd9\u4e9b\u6587\u4ef6. 2.3.1.5 Rename Files \u91cd\u547d\u540d \u76f4\u63a5\u5728 Sidebar \u4e2d\u91cd\u547d\u540d\uff0c\u8fd9\u4e48\u505a\u7684\u540c\u65f6\u4e5f\u91cd\u547d\u540d\u4e86 working directory \u4e2d\u7684\u6587\u4ef6. 2.3.2 Compile and Run A Visual Studio Build compiles one .exe file. 2.3.2.1 Exclude files from build \u6211\u4eec\u9700\u8981\u5728\u540c\u4e00\u4e2a build \u4e2d avoid multiple main() functions. \u56e0\u800c\u6211\u4eec\u9700\u8981 exclude files not needed to compile the main program. \u610f\u601d\u662f\u6211\u4eec\u9700\u8981 exclude unit tests from the build \u56e0\u4e3a \u6bcf\u4e2a unit test \u90fd\u6709\u4e00\u4e2a main() function. \u5177\u4f53\u505a\u6cd5\u662f\u53f3\u51fb\u4e00\u4e2a sidebar\u4e2d\u7684\u6587\u4ef6\uff0cselect \u201cProperties\u201d. \u7136\u540e Set \u201cExcluded From Build\u201d to \u201cYes\u201d. \u5f53\u6211\u4eec\u8fd9\u6837\u8bbe\u7f6e\u4e86\u4e4b\u540e\uff0cSidebar\u4f1a\u663e\u793a\u51fa\u4e00\u4e2a\u7ea2\u8272\u6807\u8bc6\u8868\u793a\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u5728\u5f53\u524d\u7684 build \u4e2d. 2.3.2.2 Run project Run \u4e4b\u524d\u9996\u5148\u8981 build. \u4e5f\u5c31\u662f compile. \u70b9\u51fb build solution , \u786e\u8ba4 build output was successful. \u7136\u540e\u70b9\u51fb Local Windows Debugger. Console\u5c31\u51fa\u6765\u4e86\uff0c\u8868\u793a run \u597d\u4e86. 2.3.2.3 Input redirection \u8f93\u51fa\u91cd\u5b9a\u5411 \u53f3\u51fb project \u56fe\u6807\uff0c\u9009\u62e9 Properties . \u9009\u62e9 Debugging , \u800c\u540e\u8fdb\u5165 Command Arguments . \u5c06input redirection \u7b26\u53f7 < \u548c\u8f93\u5165\u6587\u4ef6\u540d\u8f93\u8fdb\u53bb. \u6ce8\u610f\uff1a With input redirection configured, Visual Studio \u4f1a\u81ea\u52a8 close the terminal window,\u4f60\u5c31\u770b\u4e0d\u89c1 output \u4e86. \u4f60\u9700\u8981\u5728 main \u51fd\u6570\u7684\u6700\u540e\u4e00\u884c\u8bbe\u7f6e\u4e00\u4e2a breakpoint\u6765keep the output window open. 2.3.2.4 Arguments and options \u548c\u5148\u524d\u4e00\u6837\uff0cArguments and options \u5c31\u662f\u5199 command line \u65f6 type into \u7684 inputs to a program. ./main.exe train_small.csv test_small.csv --debug main.exe \u662f program\u540d. train_small.csv and test_small.csv \u662f arguments --debug \u662f\u8fd9\u4e00\u64cd\u4f5c\u7684 option. VS \u4e5f\u4e0d\u7528\u901a\u8fc7 \u7f16\u8f91 launch.json \u6587\u4ef6\u6765 configure Arguments and options. \u6211\u4eec\u76f4\u63a5\u6253\u5f00\u548c 2.3.2.3 \u4e2d\u540c\u6837\u7684\u7a97\u53e3\uff0c\u5c06arguments\u548coption\u653e\u8fdb\u53bb. \u6bd4\u5982\uff1a 2.4 Troubleshooting 2.4.1 VSCode 2.4.1.1 Reset \u8981\u91cd\u7f6e VS Code \u7684 project settings \u548c starter files\uff0c\u9996\u5148\u8981\u9000\u51fa VS Code\uff0c\u5907\u4efd\u6587\u4ef6\uff0c\u7136\u540e\u5220\u9664 project directory. pwd cp -a p1-stats p1-stats.bak # Backup all files rm -rf p1-stats # Delete the former directory \u7136\u540e\u91cd\u65b0\u56de\u52302.1\u521b\u5efaproject\u7684\u73af\u8282. \u5982\u679c\u4f60\u4e0d\u662f\u60f3\u91cd\u542f\u9879\u76ee\u800c\u662f\u60f3\u91cd\u7f6eVSCode : (VS Code has a lot of settings and extensions. \u4f60\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u91cd\u7f6e\u6574\u4e2a user interface \u5e76\u79fb\u9664\u6240\u6709 extensions. This is optional. \u6ce8\u610f\u8fd9\u4e2a\u4e1c\u897f\u6539\u52a8\u975e\u5e38\u5927\uff0c\u8fd9\u4e48\u505a\u4e4b\u524d\u8981\u60f3\u597d. ) For Mac: rm -rf ~/.vscode rm -rf ~/Library/Application\\ Support/Code For Windows: rm -rf ~/.vscode rm -rf \"/mnt/c/Users/awdeorio/.vscode\" #\u628aawdeorio\u6362\u6210\u81ea\u5df1\u7528\u6237\u540d rm -rf \"/mnt/c/Users/awdeorio/AppData/Roaming/Code\" #\u628aawdeorio\u6362\u6210\u81ea\u5df1\u7528\u6237\u540d 2.4.1.2 Compile and run \u5982\u679ccompile and run\u9047\u5230\u95ee\u9898\uff0c\u7b2c\u4e00\u6b65\u6700\u597d\u662f\u5220\u9664 launch.json \uff0c\u7136\u540e\u91cd\u65b0\u5c1d\u8bd5compile and run. 2.4.1.3 Intllisense C++ Standard Intellisense \u662f\u4e00\u79cd\u7528\u7ea2\u8272\u659c\u7ebf\u663e\u793a compiler errors \u5e76\u5efa\u8bae\u4ee3\u7801\u8865\u5168\u7684\u529f\u80fd. \u4f46\u662f\u5982\u679c C++ \u7248\u672c\u592a\u4f4e\uff0c\u4f60\u4f1a\u5728\u4e0d\u8be5\u770b\u5230\u659c\u7ebf\u7684\u5730\u65b9\u770b\u5230\u659c\u7ebf. \u9996\u5148\uff0c\u786e\u4fdd\u4f60\u5df2\u7ecf\u6309\u71672.1\u4e2d\u8981\u6c42\u7ecf\u5b89\u88c5\u4e86 C/C++ \u6269\u5c55\u3002 \u7136\u540e\uff0c cmd(windows: ctrl) + shift + P \u6253\u5f00 Command Palette\uff0c\u641c\u7d22\u5e76\u9009\u62e9 C/C++: Edit Configurations (JSON) . \u5b83\u4f1a\u6253\u5f00 c_cpp_properties.json \u6587\u4ef6. \u8c03\u6574 cStandard and cppStandard settings in c_cpp_properties.json . \u4e0d\u8981\u66f4\u6539\u5176\u4ed6 se ttings. { \"configurations\": [ { ... \"cStandard\": \"c17\", \"cppStandard\": \"c++17\", ... } ], ... } 2.4.1.4 C/C++ extension alternatives Microsoft C/C++ extension \u63d0\u4f9b\u5168\u5e73\u53f0\u7684 debugging support and intellisense CodeLLDB \u63d0\u4f9b\u4f7f\u7528 LLVM compiler \u7684debugging support. \u9002\u7528\u4e8eMac. clangd \u63d0\u4f9b intellisense \u4f46\u662f\u9700\u8981 clangd language server, which is related to the LLVM compiler. \u4e0d\u8981\u540c\u65f6\u5b89\u88c5\u548c\u542f\u7528 clangd \u4ee5\u53ca Microsoft C/C++ , \u56e0\u4e3a\u591a\u4e2a intellisense \u53ef\u80fd\u4f1a\u4ea7\u751f\u6df7\u4e71\u7684\u7ed3\u679c. 2.4.2 Xcode To reset Xcode project settings and starter files, \u9996\u5148\u9000\u51fa Xcode. \u7136\u540e\u5907\u4efd\u5e76\u5220\u9664\u539f\u5148\u7684directory. pwd # /Users/awdeorio/src/eecs280 cp -a p1-stats p1-stats.bak # Backup rm -rf p1-stats # Delete \u7136\u540e\u56de\u52302.2\u521b\u5efa\u9879\u76ee\u7684\u73af\u8282\u91cd\u5f00. \u5982\u679c\u4f60\u4e0d\u662f\u60f3\u91cd\u542f\u9879\u76ee\u800c\u662f\u60f3\u91cd\u7f6eXcode : \u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u91cd\u7f6e\u6574\u4e2a user interface to the default settings. \u6ca1\u4e8b\u522b\u8fd9\u4e48\u5e72. defaults delete com.apple.dt.Xcode 2.4.3 Visual Studio To reset Visual Studio project settings and starter files, \u9996\u5148\u9000\u51fa Visual Studio. \u7136\u540e\u5907\u4efd\u5e76\u5220\u9664\u539f\u5148\u7684directory. /Users/awdeorio/src/eecs280 $ cp -a p1-stats p1-stats.bak # Backup $ rm -rf p1-stats # Delete \u7136\u540e\u56de\u52302.3\u521b\u5efa\u9879\u76ee\u7684\u73af\u8282\u91cd\u5f00. \u5982\u679c\u4f60\u4e0d\u662f\u60f3\u91cd\u542f\u9879\u76ee\u800c\u662f\u60f3\u91cd\u7f6eVS : \u901a\u8fc7\u4e0b\u9762\u7684\u65b9\u6cd5\uff0c\u4f60\u53ef\u4ee5\u91cd\u7f6e\u6574\u4e2a user interface to the default settings: \u9009\u62e9 \u201cTools\u201d -> \u201cImport and Export Settings\u201d -> \u201cReset all settings\u201d . \u6ca1\u4e8b\u522b\u8fd9\u4e48\u5e72.","title":"Overview"},{"location":"02-IDEs.html#2-ides","text":"2 IDEs 2.1 VScode for Mac & WSL/Linux 2.1.1 Installation and Project Basis 2.1.1.1 Downloading VSCode for Mac 2.1.1.2 Create a project and open it with VSCode 2.1.1.3 Create new files \u521b\u9020\u65b0\u6587\u4ef6 2.1.1.4 Downloading from Internet and adding existing files \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0\u73b0\u6709\u6587\u4ef6 2.1.1.5 Rename Files \u6587\u4ef6\u91cd\u547d\u540d 2.1.2 Compile and Run: \u914d\u7f6e launch.json \u6587\u4ef6 2.1.2.1 Create .exe file 2.1.2.2 Create and edit launch.json 2.1.2.3 Run Project 2.1.2.4 Configure input redirection \u8f93\u5165\u91cd\u5b9a\u5411\u6587\u4ef6\u7684\u6743\u9650 2.1.2.5 Arguments and options 2.2 XCode on Mac 2.2.1 Installation and Project Basis 2.2.1.1 \u521b\u5efa\u5e76\u6253\u5f00project 2.2.1.2 \u79fb\u52a8\u81ea\u52a8\u751f\u6210\u7684 main.cpp 2.2.1.3 Add new files 2.2.1.4 \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0existing files 2.2.2 Compile and Run 2.2.2.1 Include Files in a Build 2.2.2.2 Edit Scheme \u65b9\u6848 2.2.2.3 Input Redirection \u8f93\u5165\u91cd\u5b9a\u5411 2.2.2.4 Arguments and options 2.3 Visual Studio on Windows 2.3.1.1 \u521b\u5efa\u5e76\u6253\u5f00project 2.3.1.2 Rename main.cpp file 2.3.1.3 Add new files \u6dfb\u52a0\u65b0\u6587\u4ef6 2.3.1.4 Downing and Adding Existing Files 2.3.1.5 Rename Files \u91cd\u547d\u540d 2.3.2 Compile and Run 2.3.2.1 Exclude files from build 2.3.2.2 Run project 2.3.2.3 Input redirection \u8f93\u51fa\u91cd\u5b9a\u5411 2.3.2.4 Arguments and options 2.4 Troubleshooting 2.4.1 VSCode 2.4.1.1 Reset 2.4.1.2 Compile and run 2.4.1.3 Intllisense C++ Standard 2.4.1.4 C/C++ extension alternatives 2.4.2 Xcode 2.4.3 Visual Studio","title":"2 IDEs"},{"location":"02-IDEs.html#21-vscode-for-mac-wsllinux","text":"","title":"2.1 VScode for Mac &amp; WSL/Linux"},{"location":"02-IDEs.html#211-installation-and-project-basis","text":"","title":"2.1.1 Installation and Project Basis"},{"location":"02-IDEs.html#2111-downloading-vscode-for-mac","text":"VSCode is a lightweight, easy-to-use, source code editor with debugging support. It runs on macOS, Windows, and Linux (including CAEN Linux). (1) Download on Mac \u9996\u5148\u786e\u4fdd\u4f60\u4e0b\u8f7d\u4e86compiler and a debugger. MacOS\u9ed8\u8ba4\u7684compiler\u662f Apple clang , \u4f46\u662f\u5b83\u7528\u7684\u662f g++ \u7684\u540d\u5b57(\u602a). debugger\u7528\u7684\u662f lldb . \u81f3\u4e8e\u5177\u4f53\u600e\u4e48\u88c5\u6211\u4eec\u5b9e\u9645\u4e0a\u5df2\u7ecf\u5728install CLI tools\u7684\u65f6\u5019\u88c5\u8fc7\u4e86. \u6211\u4eec\u901a\u8fc7 $ xcode-select --install \u5b89\u88c5\u4e86\u5939\u5e26\u5728xcode\u4e2d\u7684 Apple LLVM which pretends to be g++, \u4ee5\u53calldb debugger. shell xcode-select --install \u68c0\u67e5\u7248\u672c. shell g++ --version # Apple clang version 13.1.6 (clang-1316.0.21.2.5) lldb --version # Apple Swift version 5.6.1 (swiftlang-5.6.0.323.66 clang-1316.0.20.12) \u8fd8\u6709\u4e00\u4ef6\u4e8b\uff0c\u5c31\u662f\u786e\u4fdd\u4f60\u7684Mac\u7248\u672c\u572811.1\u4ee5\u4e0a. shell sw_vers # ProductName: macOS # ProductVersion: 14.2 \u5b89\u88c5VSCode shell brew install --cask visual-studio-code \u5b89\u88c5extension packages: C/C++ extension , CodeLLDB extension . shell code --install-extension ms-vscode.cpptools code --install-extension vadimcn.vscode-lldb list extension\u4ee5\u786e\u8ba4. shell code --list-extensions (2) Download on WSL/Linux \u540c\u6837\uff0c\u4e0b\u8f7dcompiler\u548cdebugger. Windows/WSL\u4e2dcompiler\u7528 g++ , debugger\u7528 gdb . \u6211\u4eec\u5728\u5b89\u88c5CLI\u5de5\u5177\u7684\u65f6\u5019\u4e5f\u5e72\u8fc7\u4e86. \u539f\u751flinux\u4e5f\u4e00\u6837. shell sudo apt install g++ gdb \u68c0\u67e5\u7248\u672c. shell g++ --version # g++ (GCC) 8.5.0 20210514 gdb --version # GNU gdb (GDB) \u5b89\u88c5VSCode \u76f4\u63a5\u901a\u8fc7 https://code.visualstudio.com/ \u5b89\u88c5. \u5b89\u88c5WSL Extension\uff0c\u4f7f\u5f97VS Code backend\u80fd\u591f\u5728WSL\u4e0a\u8fd0\u884c(\u539f\u751flinux\u4e0d\u7528), which is where our installed g++ compiler lives. VS Code\u8fde\u63a5\u5230WSL Ubantu. \u9996\u5148\u70b9\u51fb\u5de6\u4e0b\u84dd\u8272\u56fe\u6807\uff0c\u7136\u540e\u5728\u8df3\u51fa\u7684 Command Palette(Ctrl+Shift+P) \u9009\u62e9\"Connect to WSL\". \u9009\u62e9\u5b8c\u4e4b\u540e\u84dd\u8272\u7684\u56fe\u6807\u4f1a\u663e\u793a\u4f60\u5728WSL Ubantu Mode\u4e0b\u8fd0\u884c. (\u539f\u751flinux\u4e0d\u7528) \u4e00\u5b9a\u8981\u786e\u4fdd\u5728WSL\u4e0b\u8fd0\u884c\uff01\uff01 \u5982\u679caccientally opened the folder in Windows Mode, \u90a3\u4e48\u5c31\u70b9\u51fbCtrl+shift+P\u6253\u5f00Command Palette\u5e76\u9009\u62e9\"WSL: Reopen Folder in WSL\". \u540c\u6837\uff0c\u8fc7\u7a0b\u4e2d\u5982\u679c\u8df3\u51fa \"Unable to start debugging\" \u7a97\u53e3\u4e5f\u8981 Reopen Folder in WSL. \u5728Sidebar\u4e2d\u4e0b\u8f7d\u540d\u5b57\u4e3a \"C/C++\" \u7684extension.","title":"2.1.1.1 Downloading VSCode for Mac"},{"location":"02-IDEs.html#2112-create-a-project-and-open-it-with-vscode","text":"\u6bd4\u5982 mkdir ~/eecs280 cd ~/eecs280 mkdir p1-stats cd p1-stats Pitfall: Avoid paths that contain spaces. Spaces causes problems with some command line tools. Bad Example Good Example EECS 280/ eecs280/ Project 1 Stats/ p1-stats/ a quick way to open VS Code to a specific project folder from the command line. \u4f46\u662f\u9996\u5148\u8981\u7528 ls \u786e\u8ba4\u4f60\u73b0\u5728\u5728\u9879\u76ee\u6587\u4ef6\u5939\u4e2d. ls # main.cpp ... code . \u6ce8\u610f\uff1a\u5982\u679c\u4f60\u5728\u4f7f\u7528WSL\uff0c\u90a3\u4e48\u4f60\u7684\u9879\u76ee\u5e94\u5f53\u521b\u5efa\u5728Ubantu\u4e0b\u7684directory\u4e2d\u800c\u4e0d\u662fWindows\u4e0b\u7684. \u5426\u5219\u4f1aslowdown running speed. pwd # /home/awdeorio ... # Good, Linux home # /c/mnt/Users/awdeorio ... # Bad, Windows home","title":"2.1.1.2 Create a project and open it with VSCode"},{"location":"02-IDEs.html#2113-create-new-files","text":"\u5148navigate to working directory\uff0c\u7136\u540e\u5982\u4e0b\uff08\u4f8b\u5982\uff0c\u521b\u5efa\u4e00\u4e2a main.cpp \u7684\u6587\u4ef6 touch main.cpp","title":"2.1.1.3 Create new files \u521b\u9020\u65b0\u6587\u4ef6"},{"location":"02-IDEs.html#2114-downloading-from-internet-and-adding-existing-files","text":"\u5148navigate to working directory\uff0c\u7136\u540e\u8fd9\u91cc\u662f\u4ece\u7f51\u4e0a\u4e0b\u8f7d\u6587\u4ef6\u538b\u7f29\u5305\uff0c\u89e3\u538b\u5e76\u79fb\u52a8\u5230working directory\u4e00\u6761\u9f99. wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz ## \u4ece\u8be5\u7f51\u9875\u4e0b\u8f7d tar -xvzf starter-files.tar.gz ## \u89e3\u538b mv starter-files/* . ## \u628astater-files\u4e0b\u6240\u6709\u6587\u4ef6\u79fb\u52a8\u5230working directory rm -rf starter-files starter-files.tar.gz ## \u5220\u9664\u4e0b\u8f7d\u6587\u4ef6","title":"2.1.1.4 Downloading from Internet and adding existing files \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0\u73b0\u6709\u6587\u4ef6"},{"location":"02-IDEs.html#2115-rename-files","text":"mv \u6307\u4ee4\u5982\u679c\u662fmove\u6587\u4ef6\u5230\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u5230\u6587\u4ef6\u5939\uff0c\u610f\u601d\u5c31\u662f\u91cd\u547d\u540d\u6587\u4ef6. mv stats_tests.cpp.starter stats_tests.cpp","title":"2.1.1.5 Rename Files \u6587\u4ef6\u91cd\u547d\u540d"},{"location":"02-IDEs.html#212-compile-and-run-launchjson","text":"","title":"2.1.2 Compile and Run: \u914d\u7f6e launch.json \u6587\u4ef6"},{"location":"02-IDEs.html#2121-create-exe-file","text":"VSCode\u9700\u8981\u4e00\u4e2aexecutable\u6587\u4ef6\u6765compile and run. \u4e5f\u5c31\u662f .exe \u6587\u4ef6. \u6211\u4eec\u901a\u8fc7command line\u521b\u5efa\u4e00\u4e2a. touch stats.cpp # Needed for EECS 280 p1 make main.exe # make\u662fMakefile\u7684clt\u6307\u4ee4. \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u8fd8\u6ca1\u5b66makefile, \u4f46\u662f\u8001\u5e08\u80af\u5b9a\u4f1a\u5728Project tar\u91cc\u7ed9\u4f60\u4e00\u4e2aMakefile\u6587\u4ef6 ./main.exe # \u8dd1\u4e00\u4e0b. \u9700\u8981\u4ee3\u7801\u80fd\u6b63\u5e38\u8fd0\u884c\u624d\u80fd\u6b63\u5e38\u8dd1 \u5982\u679c\u4f60\u7684\u8001\u5e08\u771f\u7684\u6ca1\u7ed9\u4f60Makefile\u7684\u8bdd\uff08\u9006\u5929\uff09\uff0c\u90a3\u4e48\u4f60\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a.exe\u5e76compile manually. g++ -g main.cpp -o main.exe \u672c\u8d28\u4e0a\u5c31\u662f\u53ea\u8981compile main.cpp\u5c31\u53ef\u4ee5\u4e86\uff0c\u5176\u4ed6\u7684files\u90fd\u88ablinker\u901a\u8fc7header file\u7ed9 include\u8fdb\u4e86main.cpp.","title":"2.1.2.1 Create .exe file"},{"location":"02-IDEs.html#2122-create-and-edit-launchjson","text":"\u5728\u5de6\u4fa7\u7684 SideBar \u4e2d navigate \u5230 \u201cRun and Debug\", \u5728\u5176\u4e2d\u70b9\u51fb Create a launch.json file , \u7136\u540e\u4f1a\u8df3\u51fa Select debugger . \u5982\u679c\u662fmacOS, \u5219\u9009\u62e9 LLDB ; \u5982\u679c\u662fWSL/Linux, \u5219\u9009\u62e9C++ GDB/LLDB \u3002 \u70b9\u51fb\u4e0b\u65b9\u7684 \u201cAdd Configuration\" . \u7136\u540eWSL\u9009\u62e9 \"C/C++: (gdb) Launch\" . \u6ce8\u610f\u4e0d\u662fAttach\u800c\u662fLaunch. MacOS\u9009\u62e9 \"C/C++: (lldb) Launch\" \u66f4\u6539 launch.json \u4e2d\u7684 \"program\" \u4e3a \"{workspaceFolder}/main.exe\" . \u524d\u63d0\u662f\u4f60\u7684exe\u6587\u4ef6\u53eb main.exe ,\u603b\u4e4b\u5c31\u662f\u8fd0\u884c\u4f60\u7684exe\u6587\u4ef6. \u66f4\u6539 \"cwd\" \u4e3a \"{workspaceFolder}\" \u5982\u679c\u5b83\u4e0d\u662f. ```json { \"program\": \"${workspaceFolder}/main.exe\", ... \"cwd\": \"${workspaceFolder}\", } ``` \u5982\u679c\u51fa\u73b0\u672a\u77e5\u7684\u95ee\u9898\uff0cdelete your launch.json \u5e76\u91cd\u65b0\u914d\u7f6e.","title":"2.1.2.2 Create and edit launch.json"},{"location":"02-IDEs.html#2123-run-project","text":"\u786e\u8ba4\u4e86: makeFile\u6587\u4ef6\u5df2\u7ecf\u914d\u7f6e\u597d\uff0c \u5df2\u7ecf\u521b\u5efa\u4e86 main.cpp \u5e76\u5199\u5b8c\u4e86main\u51fd\u6570 (\u5305\u62ec\u5176\u4ed6MakeFile\u914d\u7f6e\u4e2d\u4f9d\u8d56\u7684\u6587\u4ef6). \u7136\u540e\u5df2\u7ecf\u7528 make main.exe \u521b\u5efa\u4e86\u53ef\u6267\u884c\u6587\u4ef6. \u5df2\u7ecf\u914d\u7f6e\u597d\u4e86 launch.json \u7136\u540e\u5c31\u53ef\u4ee5\u8fd0\u884c\u6574\u4e2aproject\u4e86. Navigate\u5230Run and Debug, \u70b9\u51fb\u5de6\u4fa7\u4e0a\u65b9\u7684\u8fd0\u884c\u952e\u5c31\u53ef\u4ee5\u8fd0\u884c. \u5207\u8bb0\u4e0d\u662f\u53f3\u4fa7\u4e0a\u65b9\u7684!","title":"2.1.2.3 Run Project"},{"location":"02-IDEs.html#2124-configure-input-redirection","text":"\u5728\u4e4b\u524d\u7684CLT\u6559\u7a0b\u4e2d\uff0c\u6211\u4eec\u5b66\u4e60\u4e86\u600e\u4e48\u5236\u4f5c\u4e00\u4e2ainput redirection script\u6765\u4ee3\u66ff\u6211\u4eec\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u811a\u672c\u8f93\u5165\uff0c\u4ee5\u8fdb\u884c\u81ea\u52a8\u5316. \u6bd4\u5982: ./main.exe < main_test.in # What's your name? # Hello Drew! \u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u5728 launch.json \u6587\u4ef6\u4e2d\u5bf9\u5176\u8fdb\u884cconfigure, \u4ee5\u5141\u8bb8\u5176\u6743\u9650. **For MacOS: ** { \"configurations\": [ { ... \"program\": \"${workspaceFolder}/main.exe\", ... \"stdio\": [\"main_test.in\", null, null], // \u8fd9\u4e00\u884c\u5c31\u662f\u5141\u8bb8 main_test_.in \u6587\u4ef6\u4f5c\u4e3ainput redirection ... } ] } For WSL/Linux: { \"configurations\": [ { ... \"program\": \"${workspaceFolder}/main.exe\", ... \"args\": [\"<\", \"main_test.in\"], // \u8fd9\u4e00\u884c\u5c31\u662f\u5141\u8bb8 main_test_.in \u6587\u4ef6\u4f5c\u4e3ainput redirection // \u6ce8\u610fWindows\u8fd8\u9700\u8981\u52a0\u4e0aredirection\u7b26\u53f7\"<\"\u4f5c\u4e3a\u53c2\u6570, \u5141\u8bb8\u4f7f\u7528redirection. ... } ] } (\u6ce8\u610f\uff0c\u5982\u679c\u662fmacOS\uff0c\u9700\u8981\u5728 launch.json \u4e2d\u786e\u8ba4\u4f60\u5728\u4f7f\u7528\u7684\u662f lldb debugger. \"type\": \"lldb\" . \u5982\u679c\u56e0\u4e3a\u5404\u79cd\u5947\u602a\u7684\u539f\u56e0\u6ca1\u6709\u5c31\u52a0\u4e0a.) { \"configurations\": [ { \"type\": \"lldb\", ...","title":"2.1.2.4 Configure input redirection \u8f93\u5165\u91cd\u5b9a\u5411\u6587\u4ef6\u7684\u6743\u9650"},{"location":"02-IDEs.html#2125-arguments-and-options","text":"Arguments and options \u5c31\u662f\u5199 command line \u65f6 type into \u7684 inputs to a program. \u6bd4\u5982\uff1a ./main.exe train_small.csv test_small.csv --debug main.exe \u662f program\u540d. train_small.csv and test_small.csv \u662f arguments --debug \u662f\u8fd9\u4e00\u64cd\u4f5c\u7684 option. \u610f\u601d\u5c31\u662f\u8981\u5bf9 main.exe \u8fd9\u4e2aprogram\u8fdb\u884c debug \u8fd9\u4e2a\u884c\u4e3a, \u800c\u5176\u4e2d\u7684\u8f93\u5165\u4e3a train_small.csv \u548c test_small.csv . \u90a3\u4e48\u6211\u4eec\u5c31\u8981\u66f4\u6539 launch.json \u8fdb\u884ccongiguration\u6765\u544a\u77e5\u4e0e\u5141\u8bb8\u8fd9\u4e24\u4e2aarguments\u548cdebug\u8fd9\u4e2acommand line option. \u6211\u4eec\u627e\u5230 \"configurations\" , \u7136\u540e\uff1a { \"configurations\": [ { ... \"program\": \"${workspaceFolder}/main.exe\", \"args\": [\"train_small.csv\", \"test_small.csv\", \"--debug\"], ... } ] } \u6bcf\u4e2aoption\u6216\u8005argument\u5e94\u8be5\u7528string\u8868\u793a\uff0ccomma-separated. \u8fd9\u4e00\u6761\u91cc\u7684\u4e1c\u897f MacOS \u548c WSL/Linux \u662f\u4e00\u6837\u7684 .","title":"2.1.2.5 Arguments and options"},{"location":"02-IDEs.html#22-xcode-on-mac","text":"","title":"2.2 XCode on Mac"},{"location":"02-IDEs.html#221-installation-and-project-basis","text":"","title":"2.2.1 Installation and Project Basis"},{"location":"02-IDEs.html#2211-project","text":"\u76f4\u63a5\u4f7f\u7528App Store\u5b89\u88c5. \u521b\u5efaProject\u7684\u6b65\u9aa4\u662f Create a new Xcode projects -> Command Line Tool -> \u586b\u5199project name, \u9009\u62e9\u8bed\u8a00\u4e3aC++, \u5728\u201cOrganization Identifier\u201d field \u8f93\u5165\u8eab\u4efd\u6bd4\u5982\u5b66\u6821\u7684\u9879\u76ee\u5199\u4e0a uniqname. \u521b\u5efa\u65f6\u8bb0\u5f97\u52fe\u9009 Create Git repository on my Mac \u4ee5\u4fbf\u4e8e\u7248\u672c\u7ba1\u7406. \u8fd8\u662f\u8bb0\u5f97\u9879\u76ee\u540d\u4e0d\u8981\u6709\u7a7a\u683c. \u5728working directory \u6253\u5f00project\u7684\u5feb\u6377\u65b9\u6cd5. open p1-stats.xcodeproj","title":"2.2.1.1 \u521b\u5efa\u5e76\u6253\u5f00project"},{"location":"02-IDEs.html#2212-maincpp","text":"tree . \u251c\u2500\u2500 main.cpp \u2514\u2500\u2500 p1-stats.xcodeproj \u251c\u2500\u2500 ...","title":"2.2.1.2 \u79fb\u52a8\u81ea\u52a8\u751f\u6210\u7684 main.cpp"},{"location":"02-IDEs.html#2213-add-new-files","text":"\u540e\u9762\u8fd8\u4f1a\u8d34\u5fc3\u5730\u95ee\u4f60\u8981\u4e0d\u8981also create a header file. \u4f46\u662f\u4e4b\u540e\u4e00\u9875\u9009\u62e9target\u65f6\u4e0d\u8981\u9009\u62e9\u4efb\u4f55target. You should see your new file in the sidebar.","title":"2.2.1.3 Add new files"},{"location":"02-IDEs.html#2214-existing-files","text":"\u786e\u4fdd\u4f60\u5728\u5305\u542b\u6e90\u4ee3\u7801\u7684directory\u4e2d. ls # main.cpp p1-stats.xcodeproj \u7f51\u7edc\u4e0b\u8f7d\u4e0e\u89e3\u538b\u6587\u4ef6\u5e76\u653e\u5230working directory\u4e0b. wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz tar -xvzf starter-files.tar.gz mv starter-files/* . rm -rf starter-files starter-files.tar.gz \u4f7f\u7528 tree \u547d\u4ee4\u6216\u8005 ls \u547d\u4ee4\u786e\u8ba4\u6587\u4ef6. tree . \u251c\u2500\u2500 Makefile \u251c\u2500\u2500 main.cpp \u251c\u2500\u2500 main_test.in \u251c\u2500\u2500 main_test.out.correct \u251c\u2500\u2500 main_test_data.tsv \u251c\u2500\u2500 p1-stats.xcodeproj \u2502 \u251c\u2500\u2500 ... \u251c\u2500\u2500 p1_library.cpp \u251c\u2500\u2500 p1_library.hpp \u251c\u2500\u2500 stats.hpp \u251c\u2500\u2500 stats_public_test.cpp \u2514\u2500\u2500 stats_tests.cpp.starter \u8fd9\u4e2a\u65f6\u5019\u6587\u4ef6\u90fd\u5728\u9879\u76ee\u6587\u4ef6\u5939\u4e2d\uff0c\u5728\u4fa7\u8fb9\u662f\u770b\u4e0d\u5230\u6587\u4ef6\u7684. \u70b9\u51fb\u6587\u4ef6\u56fe\u6807\u5e76\u9009\u62e9 Add Files to... \u7136\u540e command + a \u9009\u62e9\u6240\u6709\u6587\u4ef6\uff0c\u9009\u62e9 Create folder references , \u4e0d\u8981\u9009\u62e9 Add to targets \uff01 \u7136\u540e\u5c31\u53ef\u4ee5\u5728 Sidebar \u770b\u5230\u6587\u4ef6\u4e86\uff0c\u8bf4\u660e\u6210\u529f\u4e86. \u91cd\u547d\u540d\u6587\u4ef6\u76f4\u63a5\u5728 Sidebar\u5c31\u53ef\u4ee5\u64cd\u4f5c.","title":"2.2.1.4 \u4e0b\u8f7d\u6587\u4ef6\u4e0e\u6dfb\u52a0existing files"},{"location":"02-IDEs.html#222-compile-and-run","text":"","title":"2.2.2 Compile and Run"},{"location":"02-IDEs.html#2221-include-files-in-a-build","text":"\u4e00\u4e2a Xcode target compiles \u4e00\u4e2a exe\u6587\u4ef6\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u521a\u624d\u8bf4\u4e0d\u8981\u628a\u6587\u4ef6add \u5230 target \u7684\u539f\u56e0. \u4f60\u9700\u8981\u77e5\u9053 which files to include in a build. Never include header ( .h or .hpp ) files\uff01 Method 1: Include myfile.cpp each time you see #include \"myfile.hpp\" . Method 2: Include .cpp files used by your Makefile . In this example, main.cpp , stats.cpp , and p1_library.cpp . make clean make main.exe # g++ -Wall -Werror -pedantic -g --std=c++17 main.cpp stats.cpp p1_library.cpp -o main.exe","title":"2.2.2.1 Include Files in a Build"},{"location":"02-IDEs.html#2222-edit-scheme","text":"\u914d\u7f6e Xcode \u4ee5\u5728\u5305\u542binput files\u7684directory\u4e2d\u8fd0\u884cexe\u6587\u4ef6\uff01\uff01 \u5177\u4f53\u65b9\u6cd5\u662f menu: Product -> Scheme -> Edit Scheme -> Run -> Options , then Use custom working directory . \u7136\u540eBrowse to the directory containing your project\u2019s files. \u6700\u540e Click Close .","title":"2.2.2.2 Edit Scheme \u65b9\u6848"},{"location":"02-IDEs.html#2223-input-redirection","text":"XCode \u5e76\u4e0d\u652f\u6301 input redirection. \u4f46\u662f\u6211\u4eec\u7528\u4e00\u4e2a work-around \u6765\u628a input file \u4f20\u5165 cin \uff0c\u8fbe\u5230\u540c\u6837\u7684\u6548\u679c. Add these lines to the top of your main function. Your input filename may be different. #include <cassert> #include <cstdio> //... int main() { #ifdef __APPLE__ assert(freopen(\"main_test.in\", \"r\", stdin)); #endif //... \u5982\u679c\u8981\u7ed3\u675finput redirection, \u4f7f\u7528 comment or delete \u628a\u8fd9\u51e0\u884c\u53bb\u6389.","title":"2.2.2.3 Input Redirection \u8f93\u5165\u91cd\u5b9a\u5411"},{"location":"02-IDEs.html#2224-arguments-and-options","text":"\u548c\u5148\u524d\u4e00\u6837\uff0cArguments and options \u5c31\u662f\u5199 command line \u65f6 type into \u7684 inputs to a program. ./main.exe train_small.csv test_small.csv --debug main.exe \u662f program\u540d. train_small.csv and test_small.csv \u662f arguments --debug \u662f\u8fd9\u4e00\u64cd\u4f5c\u7684 option. \u4e0d\u8fc7 XCode \u4e0d\u7528\u901a\u8fc7 \u7f16\u8f91 launch.json \u6587\u4ef6\u6765 configure Arguments and options. \u6211\u4eec\u76f4\u63a5menu: Product -> Scheme -> Edit Scheme -> Run -> Ariguments . \u7136\u540e\u5728\u5176\u4e2d\u52a0\u4e0a\u6bcf\u4e00\u4e2a option or argument separately.","title":"2.2.2.4 Arguments and options"},{"location":"02-IDEs.html#23-visual-studio-on-windows","text":"2.3.1 Installation and Project Basis","title":"2.3 Visual Studio on Windows"},{"location":"02-IDEs.html#2311-project","text":"\u5b89\u88c5 Visual Studio Community edition from Microsoft\u2019s website . \u9009\u62e9 Desktop Development with C++ \uff0c\u5e76\u9009\u62e9 Windows 10 SDK \u3001 Windows 11 SDK \u548c C++ AddressSanitizer . \u91cd\u542f\u540e\uff0c Create a new project -> Console App -> Set project name -> Pick a location for storage. \u540c\u6837\uff0cproject name\u4e0d\u80fd\u6709\u7a7a\u683c. \u8fdb\u5165\u9879\u76ee\u540e\uff0c\u53f3\u51fb\u9879\u76ee\u56fe\u6807\u9009\u62e9 Open Folder in File Explorer , \u8fd9\u5c31\u662f\u6211\u4eec\u7684 working directory \u4e86. \u91cc\u9762\u80af\u5b9a\u4f1a\u5305\u542b\u4e00\u4e2a sln \u6587\u4ef6\u548c\u4e00\u4e2a vcxproj \u6587\u4ef6. tree . \u251c\u2500\u2500 p1-stats.cpp \u251c\u2500\u2500 p1-stats.sln \u251c\u2500\u2500 p1-stats.vcxproj \u251c\u2500\u2500 p1-stats.vcxproj.filters \u2514\u2500\u2500 p1-stats.vcxproj.user \u91cd\u65b0\u6253\u5f00\u9879\u76ee\u5c31\u662f\uff1a\u9009\u62e9 File > Open > Project/Solution , navigate to your project directory ( p1-stats in this example). \u4e5f\u5c31\u662f\u6211\u4eec\u521a\u624d\u7684 working directory.","title":"2.3.1.1 \u521b\u5efa\u5e76\u6253\u5f00project"},{"location":"02-IDEs.html#2312-rename-maincpp-file","text":"\u6211\u4eec\u521b\u5efa\u7684\u9879\u76ee\u540d\u4f1a\u81ea\u52a8\u53d8\u6210\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\uff0c\u4f46\u6211\u4eec\u5e94\u8be5\u628a\u5b83\u6539\u6210 main.cpp .","title":"2.3.1.2 Rename main.cpp file"},{"location":"02-IDEs.html#2313-add-new-files","text":"\u53f3\u51fb Source Files \uff0c\u9009\u62e9 Add -> New Item . \u8f93\u5165\u6587\u4ef6\u540d. You should see the new file under Source Files , \u5e76\u4e14\u5f53\u4f60\u6253\u5f00\u521a\u624d\u8bf4\u7684 working directory, \u4e5f\u80fd\u770b\u5230\u8be5\u6587\u4ef6.","title":"2.3.1.3 Add new files \u6dfb\u52a0\u65b0\u6587\u4ef6"},{"location":"02-IDEs.html#2314-downing-and-adding-existing-files","text":"\u9996\u5148 cd \u5230 working directory \u5e76\u7528 ls \u786e\u4fdd\u4f60\u5728\u5176\u4e2d. \u548c\u524d\u9762\u7684 VSCode \u4e0e XCode \u4e00\u6837\uff0c\u4eceInternet \u4e0b\u8f7d\u6587\u4ef6\u5e76\u79fb\u5165 working directory, \u590d\u5236\u540e\u79fb\u9664. wget https://eecs280staff.github.io/p1-stats/starter-files.tar.gz tar -xvzf starter-files.tar.gz mv starter-files/* . rm -rf starter-files starter-files.tar.gz \u7136\u540e\u4f7f\u7528 tree \u6216\u8005 ls \u68c0\u67e5\uff1a tree . \u251c\u2500\u2500 Makefile \u251c\u2500\u2500 main.cpp \u251c\u2500\u2500 main_test.in \u251c\u2500\u2500 main_test.out.correct \u251c\u2500\u2500 main_test_data.tsv \u251c\u2500\u2500 p1-stats.sln \u251c\u2500\u2500 p1-stats.vcxproj \u251c\u2500\u2500 p1-stats.vcxproj.filters \u251c\u2500\u2500 p1-stats.vcxproj.user \u251c\u2500\u2500 p1_library.cpp \u251c\u2500\u2500 p1_library.hpp \u251c\u2500\u2500 stats.hpp \u251c\u2500\u2500 stats_public_test.cpp \u2514\u2500\u2500 stats_tests.cpp.starter \u53f3\u51fb Source Files , then select Add -> Existing Item . \u7136\u540e navigate to your project directory. \u901a\u8fc7\u6309\u4f4f Control and clicking each one \u6765\u9009\u62e9\u6240\u6709\u4f60\u9700\u8981\u7684 files. Do not select any .sln or .vcxproj files. Click \u201cAdd\u201d. \u73b0\u5728\u4f60\u53ef\u4ee5\u5728 Sidebar \u4e2d\u770b\u89c1\u8fd9\u4e9b\u6587\u4ef6.","title":"2.3.1.4 Downing and Adding Existing Files"},{"location":"02-IDEs.html#2315-rename-files","text":"\u76f4\u63a5\u5728 Sidebar \u4e2d\u91cd\u547d\u540d\uff0c\u8fd9\u4e48\u505a\u7684\u540c\u65f6\u4e5f\u91cd\u547d\u540d\u4e86 working directory \u4e2d\u7684\u6587\u4ef6.","title":"2.3.1.5 Rename Files \u91cd\u547d\u540d"},{"location":"02-IDEs.html#232-compile-and-run","text":"A Visual Studio Build compiles one .exe file.","title":"2.3.2 Compile and Run"},{"location":"02-IDEs.html#2321-exclude-files-from-build","text":"\u6211\u4eec\u9700\u8981\u5728\u540c\u4e00\u4e2a build \u4e2d avoid multiple main() functions. \u56e0\u800c\u6211\u4eec\u9700\u8981 exclude files not needed to compile the main program. \u610f\u601d\u662f\u6211\u4eec\u9700\u8981 exclude unit tests from the build \u56e0\u4e3a \u6bcf\u4e2a unit test \u90fd\u6709\u4e00\u4e2a main() function. \u5177\u4f53\u505a\u6cd5\u662f\u53f3\u51fb\u4e00\u4e2a sidebar\u4e2d\u7684\u6587\u4ef6\uff0cselect \u201cProperties\u201d. \u7136\u540e Set \u201cExcluded From Build\u201d to \u201cYes\u201d. \u5f53\u6211\u4eec\u8fd9\u6837\u8bbe\u7f6e\u4e86\u4e4b\u540e\uff0cSidebar\u4f1a\u663e\u793a\u51fa\u4e00\u4e2a\u7ea2\u8272\u6807\u8bc6\u8868\u793a\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u5728\u5f53\u524d\u7684 build \u4e2d.","title":"2.3.2.1 Exclude files from build"},{"location":"02-IDEs.html#2322-run-project","text":"Run \u4e4b\u524d\u9996\u5148\u8981 build. \u4e5f\u5c31\u662f compile. \u70b9\u51fb build solution , \u786e\u8ba4 build output was successful. \u7136\u540e\u70b9\u51fb Local Windows Debugger. Console\u5c31\u51fa\u6765\u4e86\uff0c\u8868\u793a run \u597d\u4e86.","title":"2.3.2.2 Run project"},{"location":"02-IDEs.html#2323-input-redirection","text":"\u53f3\u51fb project \u56fe\u6807\uff0c\u9009\u62e9 Properties . \u9009\u62e9 Debugging , \u800c\u540e\u8fdb\u5165 Command Arguments . \u5c06input redirection \u7b26\u53f7 < \u548c\u8f93\u5165\u6587\u4ef6\u540d\u8f93\u8fdb\u53bb. \u6ce8\u610f\uff1a With input redirection configured, Visual Studio \u4f1a\u81ea\u52a8 close the terminal window,\u4f60\u5c31\u770b\u4e0d\u89c1 output \u4e86. \u4f60\u9700\u8981\u5728 main \u51fd\u6570\u7684\u6700\u540e\u4e00\u884c\u8bbe\u7f6e\u4e00\u4e2a breakpoint\u6765keep the output window open.","title":"2.3.2.3 Input redirection \u8f93\u51fa\u91cd\u5b9a\u5411"},{"location":"02-IDEs.html#2324-arguments-and-options","text":"\u548c\u5148\u524d\u4e00\u6837\uff0cArguments and options \u5c31\u662f\u5199 command line \u65f6 type into \u7684 inputs to a program. ./main.exe train_small.csv test_small.csv --debug main.exe \u662f program\u540d. train_small.csv and test_small.csv \u662f arguments --debug \u662f\u8fd9\u4e00\u64cd\u4f5c\u7684 option. VS \u4e5f\u4e0d\u7528\u901a\u8fc7 \u7f16\u8f91 launch.json \u6587\u4ef6\u6765 configure Arguments and options. \u6211\u4eec\u76f4\u63a5\u6253\u5f00\u548c 2.3.2.3 \u4e2d\u540c\u6837\u7684\u7a97\u53e3\uff0c\u5c06arguments\u548coption\u653e\u8fdb\u53bb. \u6bd4\u5982\uff1a","title":"2.3.2.4 Arguments and options"},{"location":"02-IDEs.html#24-troubleshooting","text":"","title":"2.4 Troubleshooting"},{"location":"02-IDEs.html#241-vscode","text":"","title":"2.4.1 VSCode"},{"location":"02-IDEs.html#2411-reset","text":"\u8981\u91cd\u7f6e VS Code \u7684 project settings \u548c starter files\uff0c\u9996\u5148\u8981\u9000\u51fa VS Code\uff0c\u5907\u4efd\u6587\u4ef6\uff0c\u7136\u540e\u5220\u9664 project directory. pwd cp -a p1-stats p1-stats.bak # Backup all files rm -rf p1-stats # Delete the former directory \u7136\u540e\u91cd\u65b0\u56de\u52302.1\u521b\u5efaproject\u7684\u73af\u8282. \u5982\u679c\u4f60\u4e0d\u662f\u60f3\u91cd\u542f\u9879\u76ee\u800c\u662f\u60f3\u91cd\u7f6eVSCode : (VS Code has a lot of settings and extensions. \u4f60\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u91cd\u7f6e\u6574\u4e2a user interface \u5e76\u79fb\u9664\u6240\u6709 extensions. This is optional. \u6ce8\u610f\u8fd9\u4e2a\u4e1c\u897f\u6539\u52a8\u975e\u5e38\u5927\uff0c\u8fd9\u4e48\u505a\u4e4b\u524d\u8981\u60f3\u597d. ) For Mac: rm -rf ~/.vscode rm -rf ~/Library/Application\\ Support/Code For Windows: rm -rf ~/.vscode rm -rf \"/mnt/c/Users/awdeorio/.vscode\" #\u628aawdeorio\u6362\u6210\u81ea\u5df1\u7528\u6237\u540d rm -rf \"/mnt/c/Users/awdeorio/AppData/Roaming/Code\" #\u628aawdeorio\u6362\u6210\u81ea\u5df1\u7528\u6237\u540d","title":"2.4.1.1 Reset"},{"location":"02-IDEs.html#2412-compile-and-run","text":"\u5982\u679ccompile and run\u9047\u5230\u95ee\u9898\uff0c\u7b2c\u4e00\u6b65\u6700\u597d\u662f\u5220\u9664 launch.json \uff0c\u7136\u540e\u91cd\u65b0\u5c1d\u8bd5compile and run.","title":"2.4.1.2 Compile and run"},{"location":"02-IDEs.html#2413-intllisense-c-standard","text":"Intellisense \u662f\u4e00\u79cd\u7528\u7ea2\u8272\u659c\u7ebf\u663e\u793a compiler errors \u5e76\u5efa\u8bae\u4ee3\u7801\u8865\u5168\u7684\u529f\u80fd. \u4f46\u662f\u5982\u679c C++ \u7248\u672c\u592a\u4f4e\uff0c\u4f60\u4f1a\u5728\u4e0d\u8be5\u770b\u5230\u659c\u7ebf\u7684\u5730\u65b9\u770b\u5230\u659c\u7ebf. \u9996\u5148\uff0c\u786e\u4fdd\u4f60\u5df2\u7ecf\u6309\u71672.1\u4e2d\u8981\u6c42\u7ecf\u5b89\u88c5\u4e86 C/C++ \u6269\u5c55\u3002 \u7136\u540e\uff0c cmd(windows: ctrl) + shift + P \u6253\u5f00 Command Palette\uff0c\u641c\u7d22\u5e76\u9009\u62e9 C/C++: Edit Configurations (JSON) . \u5b83\u4f1a\u6253\u5f00 c_cpp_properties.json \u6587\u4ef6. \u8c03\u6574 cStandard and cppStandard settings in c_cpp_properties.json . \u4e0d\u8981\u66f4\u6539\u5176\u4ed6 se ttings. { \"configurations\": [ { ... \"cStandard\": \"c17\", \"cppStandard\": \"c++17\", ... } ], ... }","title":"2.4.1.3 Intllisense C++ Standard"},{"location":"02-IDEs.html#2414-cc-extension-alternatives","text":"Microsoft C/C++ extension \u63d0\u4f9b\u5168\u5e73\u53f0\u7684 debugging support and intellisense CodeLLDB \u63d0\u4f9b\u4f7f\u7528 LLVM compiler \u7684debugging support. \u9002\u7528\u4e8eMac. clangd \u63d0\u4f9b intellisense \u4f46\u662f\u9700\u8981 clangd language server, which is related to the LLVM compiler. \u4e0d\u8981\u540c\u65f6\u5b89\u88c5\u548c\u542f\u7528 clangd \u4ee5\u53ca Microsoft C/C++ , \u56e0\u4e3a\u591a\u4e2a intellisense \u53ef\u80fd\u4f1a\u4ea7\u751f\u6df7\u4e71\u7684\u7ed3\u679c.","title":"2.4.1.4 C/C++ extension alternatives"},{"location":"02-IDEs.html#242-xcode","text":"To reset Xcode project settings and starter files, \u9996\u5148\u9000\u51fa Xcode. \u7136\u540e\u5907\u4efd\u5e76\u5220\u9664\u539f\u5148\u7684directory. pwd # /Users/awdeorio/src/eecs280 cp -a p1-stats p1-stats.bak # Backup rm -rf p1-stats # Delete \u7136\u540e\u56de\u52302.2\u521b\u5efa\u9879\u76ee\u7684\u73af\u8282\u91cd\u5f00. \u5982\u679c\u4f60\u4e0d\u662f\u60f3\u91cd\u542f\u9879\u76ee\u800c\u662f\u60f3\u91cd\u7f6eXcode : \u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u91cd\u7f6e\u6574\u4e2a user interface to the default settings. \u6ca1\u4e8b\u522b\u8fd9\u4e48\u5e72. defaults delete com.apple.dt.Xcode","title":"2.4.2 Xcode"},{"location":"02-IDEs.html#243-visual-studio","text":"To reset Visual Studio project settings and starter files, \u9996\u5148\u9000\u51fa Visual Studio. \u7136\u540e\u5907\u4efd\u5e76\u5220\u9664\u539f\u5148\u7684directory. /Users/awdeorio/src/eecs280 $ cp -a p1-stats p1-stats.bak # Backup $ rm -rf p1-stats # Delete \u7136\u540e\u56de\u52302.3\u521b\u5efa\u9879\u76ee\u7684\u73af\u8282\u91cd\u5f00. \u5982\u679c\u4f60\u4e0d\u662f\u60f3\u91cd\u542f\u9879\u76ee\u800c\u662f\u60f3\u91cd\u7f6eVS : \u901a\u8fc7\u4e0b\u9762\u7684\u65b9\u6cd5\uff0c\u4f60\u53ef\u4ee5\u91cd\u7f6e\u6574\u4e2a user interface to the default settings: \u9009\u62e9 \u201cTools\u201d -> \u201cImport and Export Settings\u201d -> \u201cReset all settings\u201d . \u6ca1\u4e8b\u522b\u8fd9\u4e48\u5e72.","title":"2.4.3 Visual Studio"},{"location":"03-Compilation-%28Makefile%29.html","text":"3 C++ Compilation (Makefiles) \u6211\u4eec\u53ef\u4ee5\u5728 working directory \u4e2d\u8f93\u5165\u6307\u4ee4\u6765\u7528 g++ compiler \u624b\u52a8\u5236\u4f5c .exe \u6587\u4ef6. g++ -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment main.cpp -o main.exe \u4f46\u662f\u5982\u679c\u7a0b\u5e8f\u7684\u6587\u4ef6\u5173\u7cfb\u6bd4\u8f83\u591a\uff0c\u5148\u540e\u7f16\u8bd1\u987a\u5e8f\u624b\u5199\u5c31\u5f88\u9ebb\u70e6. \u56e0\u800c\u6211\u4eec\u628a\u6307\u4ee4\u5199\u8fdb\u4e00\u4e2a Makefile \u6587\u4ef6\u6765 automate \u8fd9\u4e2a\u8fc7\u7a0b. make \u6307\u4ee4\u4f1a\u8bfb\u53d6\u4e3a Makefile \u6587\u4ef6\uff0c\u6839\u636e\u91cc\u9762\u7684\u6307\u4ee4\u6765\u5236\u4f5c .exe \u6587\u4ef6. 280\u5e76\u4e0d\u8981\u6c42\u624b\u6413 Makefile, \u53ea\u9700\u8981\u80fd\u770b\u61c2 Makefile \u5e76\u4fee\u6539\u5176\u4e2d\u7684\u4e00\u4e9b\u547d\u4ee4\u4f9d\u8d56\u5c31\u53ef\u4ee5\u4e86. \u4ee5\u540e\u518d\u5b66\u4e60 Makefile \u6587\u4ef6\u7684\u7f16\u5199\u4ee5\u53ca\u901a\u8fc7 Cmake \u5de5\u5177\u751f\u6210 Makefile \u6587\u4ef6. 3.1 MakeFile \u8bed\u6cd5\u89c4\u5219 \u6211\u4eec\u77e5\u9053\uff0cC/C++ Source Code \u9996\u5148\u4f1a\u751f\u6210 obj \u6587\u4ef6 ( .o ), \u7136\u540e .o \u6587\u4ef6\u4f1a\u88ab\u7f16\u8bd1\u6210 .exe \u6587\u4ef6. target... : prerequisite... recipe1... (command1... command2...) target (\u76ee\u6807\u6587\u4ef6) : \u672c\u6761\u89c4\u5219\u8981\u751f\u6210\u7684\u6587\u4ef6, \u6bd4\u5982 main.exe . \u5982\u679c target \u6587\u4ef6\u7684\u66f4\u65b0\u65f6\u95f4\u665a\u4e8e prerequisite \u7684\u66f4\u65b0\u65f6\u95f4\uff0c\u5219\u8bf4\u660e prerequisite \u6ca1\u6709\u6539\u52a8\uff0ctarget \u4e0d\u9700\u8981\u91cd\u65b0\u7f16\u8bd1; \u5426\u5219\u4f1a\u8fdb\u884c\u91cd\u65b0\u7f16\u8bd1\u5e76\u66f4\u65b0target. prerequisite (\u4f9d\u8d56\u6587\u4ef6) : used as input to create the target, \u6bd4\u5982 main.cpp . \u5373\u76ee\u6807\u6587\u4ef6\u7531\u54ea\u4e9b\u6587\u4ef6\u751f\u6210. recipe (\u914d\u65b9) \uff1a\u7531 prerequisite \u751f\u6210 target \u7684 commands, \u6bd4\u5982 g++ main.cpp -o main.exe . \u6ce8\u610f\u6bcf\u6761\u547d\u4ee4\u8981\u6362\u884c\uff0c\u4e14\u6bcf\u6761\u547d\u4ee4\u4e4b\u524d\u5fc5\u987b\u6709\u4e00\u4e2atab\u4fdd\u6301\u7f29\u8fdb\uff0c\u8fd9\u662f\u8bed\u6cd5\u8981\u6c42 (\u6709\u4e00\u4e9b\u7f16\u8f91\u5de5\u5177\u9ed8\u8ba4tab\u4e3a4\u4e2a\u7a7a\u683c\uff0c\u4f1a\u9020\u6210Makefile\u8bed\u6cd5\u9519\u8bef ). \u5177\u4f53\u4f8b\u5b50\uff1a makefile main.exe: main.cpp g++ main.cpp -o main.exe 3.2 Variable \u53d8\u91cf \u4e00\u4e2a variable \u53ef\u4ee5\u5e2e\u52a9\u51cf\u5c11 code duplication \u4ece\u800c\u8d77\u5230\u7b80\u5316\u4f5c\u7528. \u6bd4\u5982\u8981\u751f\u6210\u591a\u4e2a .exe \u6587\u4ef6\uff0c\u4e8e\u662f\u6211\u4eec\u7ed9\u7f16\u8bd1\u547d\u4ee4 ( g++ \u7f16\u8bd1\u5668\u548c\u5b83\u7684flag) \u7528 variables ( CXX \u548c CXXFLAGS ) \u6765\u6307\u4ee3. CXX ?= g++ CXXFLAGS ?= -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment main.exe: main.cpp $(CXX) $(CXXFLAGS) main.cpp -o main.exe unit_tests.exe: unit_tests.cpp unit.cpp $(CXX) $(CXXFLAGS) unit_tests.cpp unit.cpp -o unit_tests.exe \u8fd9\u4e9b\u53d8\u91cf\u540d\u90fd\u662f\u6807\u51c6\u7684. \u81f3\u4e8e\u683c\u5f0f\u548c\u5176\u4ed6\u4e1c\u897f\u8fd9\u91cc\u5148\u4e0d\u5b66\u4e86\uff0c\u53c2\u89c1 GNU make \u5b98\u65b9\u6587\u6863 https://www.gnu.org/software/make/manual/make.html#Makefile-Names \u4ee5\u53ca\u4e2d\u8bd1 https://file.elecfans.com/web1/M00/7D/E7/o4YBAFwQthSADYCWAAT9Q1w_4U0711.pdf 3.3 Example 3.3.1 Source files (1) main.cpp : #include <iostream> using namespace std; int main() { cout << \"Hello World!\\n\"; } (2) main_test.in : this program doesn't read stdin, so this text doesn't matter (3) main_test.out.correct : Hello World! 3.3.2 command line compilation \u6211\u4eec\u53ef\u4ee5\u5199 command \u624b\u52a8\u7528 g++ \u7f16\u8bd1\u8fd9\u6bb5. g++ -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment main.cpp -o main.exe ./main.exe # Hello World! rm main.exe ./main.exe < main_test.in > main_test.out diff main_test.out main_test.out.correct # no output means the file matches 3.3.3 Makefile compilation \u800c\u6211\u4eec\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a Makefile \u6587\u4ef6\u6765\u7f16\u8bd1. (1) \u4ee3\u7801\u7ed3\u6784: tree . \u251c\u2500\u2500 Makefile \u2514\u2500\u2500 main.cpp (2) Makefile : CXX ?= g++ CXXFLAGS ?= -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment # Run regression test test: main.exe ./main.exe < main_test.in > main_test.out diff main_test.out main_test.out.correct echo PASS # Compile the main executable main.exe: main.cpp $(CXX) $(CXXFLAGS) main.cpp -o main.exe # Remove automatically generated files clean : rm -rvf *.exe *~ *.out *.dSYM *.stackdump (3) command: make main.exe #(1) make exe using makefile ./main.exe #(2) run exe make test #(3) run a test make clean #(4) clean the generated files","title":"Overview"},{"location":"03-Compilation-%28Makefile%29.html#3-c-compilation-makefiles","text":"\u6211\u4eec\u53ef\u4ee5\u5728 working directory \u4e2d\u8f93\u5165\u6307\u4ee4\u6765\u7528 g++ compiler \u624b\u52a8\u5236\u4f5c .exe \u6587\u4ef6. g++ -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment main.cpp -o main.exe \u4f46\u662f\u5982\u679c\u7a0b\u5e8f\u7684\u6587\u4ef6\u5173\u7cfb\u6bd4\u8f83\u591a\uff0c\u5148\u540e\u7f16\u8bd1\u987a\u5e8f\u624b\u5199\u5c31\u5f88\u9ebb\u70e6. \u56e0\u800c\u6211\u4eec\u628a\u6307\u4ee4\u5199\u8fdb\u4e00\u4e2a Makefile \u6587\u4ef6\u6765 automate \u8fd9\u4e2a\u8fc7\u7a0b. make \u6307\u4ee4\u4f1a\u8bfb\u53d6\u4e3a Makefile \u6587\u4ef6\uff0c\u6839\u636e\u91cc\u9762\u7684\u6307\u4ee4\u6765\u5236\u4f5c .exe \u6587\u4ef6. 280\u5e76\u4e0d\u8981\u6c42\u624b\u6413 Makefile, \u53ea\u9700\u8981\u80fd\u770b\u61c2 Makefile \u5e76\u4fee\u6539\u5176\u4e2d\u7684\u4e00\u4e9b\u547d\u4ee4\u4f9d\u8d56\u5c31\u53ef\u4ee5\u4e86. \u4ee5\u540e\u518d\u5b66\u4e60 Makefile \u6587\u4ef6\u7684\u7f16\u5199\u4ee5\u53ca\u901a\u8fc7 Cmake \u5de5\u5177\u751f\u6210 Makefile \u6587\u4ef6.","title":"3 C++ Compilation (Makefiles)"},{"location":"03-Compilation-%28Makefile%29.html#31-makefile","text":"\u6211\u4eec\u77e5\u9053\uff0cC/C++ Source Code \u9996\u5148\u4f1a\u751f\u6210 obj \u6587\u4ef6 ( .o ), \u7136\u540e .o \u6587\u4ef6\u4f1a\u88ab\u7f16\u8bd1\u6210 .exe \u6587\u4ef6. target... : prerequisite... recipe1... (command1... command2...) target (\u76ee\u6807\u6587\u4ef6) : \u672c\u6761\u89c4\u5219\u8981\u751f\u6210\u7684\u6587\u4ef6, \u6bd4\u5982 main.exe . \u5982\u679c target \u6587\u4ef6\u7684\u66f4\u65b0\u65f6\u95f4\u665a\u4e8e prerequisite \u7684\u66f4\u65b0\u65f6\u95f4\uff0c\u5219\u8bf4\u660e prerequisite \u6ca1\u6709\u6539\u52a8\uff0ctarget \u4e0d\u9700\u8981\u91cd\u65b0\u7f16\u8bd1; \u5426\u5219\u4f1a\u8fdb\u884c\u91cd\u65b0\u7f16\u8bd1\u5e76\u66f4\u65b0target. prerequisite (\u4f9d\u8d56\u6587\u4ef6) : used as input to create the target, \u6bd4\u5982 main.cpp . \u5373\u76ee\u6807\u6587\u4ef6\u7531\u54ea\u4e9b\u6587\u4ef6\u751f\u6210. recipe (\u914d\u65b9) \uff1a\u7531 prerequisite \u751f\u6210 target \u7684 commands, \u6bd4\u5982 g++ main.cpp -o main.exe . \u6ce8\u610f\u6bcf\u6761\u547d\u4ee4\u8981\u6362\u884c\uff0c\u4e14\u6bcf\u6761\u547d\u4ee4\u4e4b\u524d\u5fc5\u987b\u6709\u4e00\u4e2atab\u4fdd\u6301\u7f29\u8fdb\uff0c\u8fd9\u662f\u8bed\u6cd5\u8981\u6c42 (\u6709\u4e00\u4e9b\u7f16\u8f91\u5de5\u5177\u9ed8\u8ba4tab\u4e3a4\u4e2a\u7a7a\u683c\uff0c\u4f1a\u9020\u6210Makefile\u8bed\u6cd5\u9519\u8bef ). \u5177\u4f53\u4f8b\u5b50\uff1a makefile main.exe: main.cpp g++ main.cpp -o main.exe","title":"3.1 MakeFile \u8bed\u6cd5\u89c4\u5219"},{"location":"03-Compilation-%28Makefile%29.html#32-variable","text":"\u4e00\u4e2a variable \u53ef\u4ee5\u5e2e\u52a9\u51cf\u5c11 code duplication \u4ece\u800c\u8d77\u5230\u7b80\u5316\u4f5c\u7528. \u6bd4\u5982\u8981\u751f\u6210\u591a\u4e2a .exe \u6587\u4ef6\uff0c\u4e8e\u662f\u6211\u4eec\u7ed9\u7f16\u8bd1\u547d\u4ee4 ( g++ \u7f16\u8bd1\u5668\u548c\u5b83\u7684flag) \u7528 variables ( CXX \u548c CXXFLAGS ) \u6765\u6307\u4ee3. CXX ?= g++ CXXFLAGS ?= -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment main.exe: main.cpp $(CXX) $(CXXFLAGS) main.cpp -o main.exe unit_tests.exe: unit_tests.cpp unit.cpp $(CXX) $(CXXFLAGS) unit_tests.cpp unit.cpp -o unit_tests.exe \u8fd9\u4e9b\u53d8\u91cf\u540d\u90fd\u662f\u6807\u51c6\u7684. \u81f3\u4e8e\u683c\u5f0f\u548c\u5176\u4ed6\u4e1c\u897f\u8fd9\u91cc\u5148\u4e0d\u5b66\u4e86\uff0c\u53c2\u89c1 GNU make \u5b98\u65b9\u6587\u6863 https://www.gnu.org/software/make/manual/make.html#Makefile-Names \u4ee5\u53ca\u4e2d\u8bd1 https://file.elecfans.com/web1/M00/7D/E7/o4YBAFwQthSADYCWAAT9Q1w_4U0711.pdf","title":"3.2 Variable \u53d8\u91cf"},{"location":"03-Compilation-%28Makefile%29.html#33-example","text":"","title":"3.3 Example"},{"location":"03-Compilation-%28Makefile%29.html#331-source-files","text":"(1) main.cpp : #include <iostream> using namespace std; int main() { cout << \"Hello World!\\n\"; } (2) main_test.in : this program doesn't read stdin, so this text doesn't matter (3) main_test.out.correct : Hello World!","title":"3.3.1 Source files"},{"location":"03-Compilation-%28Makefile%29.html#332-command-line-compilation","text":"\u6211\u4eec\u53ef\u4ee5\u5199 command \u624b\u52a8\u7528 g++ \u7f16\u8bd1\u8fd9\u6bb5. g++ -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment main.cpp -o main.exe ./main.exe # Hello World! rm main.exe ./main.exe < main_test.in > main_test.out diff main_test.out main_test.out.correct # no output means the file matches","title":"3.3.2 command line compilation"},{"location":"03-Compilation-%28Makefile%29.html#333-makefile-compilation","text":"\u800c\u6211\u4eec\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a Makefile \u6587\u4ef6\u6765\u7f16\u8bd1. (1) \u4ee3\u7801\u7ed3\u6784: tree . \u251c\u2500\u2500 Makefile \u2514\u2500\u2500 main.cpp (2) Makefile : CXX ?= g++ CXXFLAGS ?= -Wall -Werror -pedantic -g --std=c++17 -Wno-sign-compare -Wno-comment # Run regression test test: main.exe ./main.exe < main_test.in > main_test.out diff main_test.out main_test.out.correct echo PASS # Compile the main executable main.exe: main.cpp $(CXX) $(CXXFLAGS) main.cpp -o main.exe # Remove automatically generated files clean : rm -rvf *.exe *~ *.out *.dSYM *.stackdump (3) command: make main.exe #(1) make exe using makefile ./main.exe #(2) run exe make test #(3) run a test make clean #(4) clean the generated files","title":"3.3.3 Makefile compilation"},{"location":"04-Debuggers.html","text":"4 Debuggers 4.1 Debugging Basis 4.1.1 Breakpoint \u8bbe\u7f6e\u95f4\u65ad\u70b9 4.1.2 Step over \u8fd0\u884c\u4e00\u884c 4.1.3 Inspect \u67e5\u770b\u53d8\u91cf 4.1.4 Step Into/Out \u67e5\u770b\u6e90\u7801 4.1.5 Continue \u5feb\u8fdb\u5230\u4e0b\u4e00\u4e2a\u95f4\u65ad\u70b9 4.2 Debug Console 4.3 Address Sanitizer \u5730\u5740\u68c0\u67e5\u5668 4.3.1 Leak Checking 4.4 Assertions 4.5 Command-Line Debuggers(gbd,lldb) 4.5.1 CL Debugging \u547d\u4ee4 4.5.2 Input Redirection 4.5.3 Arguments and optins 4.6 More Pro Tips for debugging 4.6.1 Debug Logging \u989d\u5916\u8f93\u51fa 4.6.2 Conditional Breakpoint 4 Debuggers \u672c\u6bb5\u6f14\u793a\u6211\u4eec\u4f7f\u7528\u4e0b\u9762\u4e2d\u8fd9\u6bb5\u4ee3\u7801: #include <iostream> #include <vector> using namespace std; double sum (const vector<double> &data) { double total = 0; for (size_t i=0; i<data.size(); ++i) { total += data[i]; } return total; } int main() { vector<double> data; data.push_back(10); data.push_back(20); data.push_back(30); cout << \"sum(data) = \" << sum(data) << endl; } 4.1 Debugging Basis \u5927\u90e8\u5206 debugger \u90fd\u652f\u6301\u4ee5\u4e0b\u7684\u529f\u80fd. 4.1.1 Breakpoint \u8bbe\u7f6e\u95f4\u65ad\u70b9 Set a breakpoint by clicking to the left of a line number. A breakpoint \u8868\u793a debug \u8fd0\u884c\u5230\u8fd9\u91cc\u505c\u6b62. \u8fd9\u662f debug \u7684\u5f00\u7aef\uff0c\u5c31\u662f\u4ece breakpoint \u5f00\u59cb\u53ef\u4ee5\u9010\u884c debug 4.1.2 Step over \u8fd0\u884c\u4e00\u884c step over \u5c31\u662f\u7ee7\u7eed\u8fd0\u884c\u4e00\u884c\u7684\u610f\u601d. \u4ece breakpoint \u5f00\u59cb\uff0c\u6211\u4eec\u6bcf stepover \u4e00\u4e0b\u5c31\u662f\u8fd0\u884c\u4e00\u884c. 4.1.3 Inspect \u67e5\u770b\u53d8\u91cf \u6211\u4eec stepover \u7684\u65f6\u5019\uff0c\u5de6\u8fb9\u7684 local variables \u4f1a\u66f4\u65b0. \u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u70b9\u5f00\u91cc\u9762\u7684\u6570\u636e\u8fdb\u884c inspect\uff0c\u67e5\u770b\u8fd0\u884c\u8fd9\u4e00\u884c\u4e4b\u540e\u7684\u72b6\u6001. \u4e0b\u9762\u8fd8\u80fd\u68c0\u67e5 call stack. \u70b9\u51fb call stack \u4f1a\u8fdb\u5165\u8be5\u51fd\u6570\u7684 stack frame \u91cc\u9762\u67e5\u770b varibles. 4.1.4 Step Into/Out \u67e5\u770b\u6e90\u7801 Step into \u4f1a\u76f4\u63a5\u8fdb\u5165\u8fd9\u4e00\u884c\u4f7f\u7528\u7684\u51fd\u6570\u7684\u6e90\u4ee3\u7801\uff1b\u5982\u679c\u67e5\u770b\u7684\u662f\u5e93\u51fd\u6570\uff0c\u4f1a\u76f4\u63a5\u8fdb\u5165C++\u7684\u5e93\u6e90\u6587\u4ef6\u4e2d\u8fdb\u884c\u67e5\u770b. \u5982\u679c\u662f\u81ea\u5df1\u5199\u7684\u51fd\u6570\uff0c\u4f1a\u5230\u81ea\u5df1\u7684\u51fd\u6570\u8fd9\u91cc. \u7136\u540e\u7528 Step out \u53ef\u4ee5\u56de\u5230\u6211\u4eec\u7684\u6587\u4ef6. 4.1.5 Continue \u5feb\u8fdb\u5230\u4e0b\u4e00\u4e2a\u95f4\u65ad\u70b9 Continue \u53ef\u4ee5\u76f4\u63a5\u5feb\u8fdb\u8fd0\u884c\u5230\u73b0\u5728\u7684\u4f4d\u7f6e\u7684\u4e0b\u4e00\u4e2a breakpoint. 4.2 Debug Console \u5982\u679c\u6211\u4eec\u73b0\u5728\u5728\u8fdb\u884c\u4e00\u4e2a Matrix \u7684 debugging, \u6211\u4eec\u770b\u5230\u4e86 call stack \u4e2d\u7684\u4e00\u4e2a ptr \u53d8\u91cf\u7684\u5730\u5740\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u5b83\u6307\u7684\u662f Matrix \u4e2d\u7684\u7b2c\u51e0\u4e2a entry. \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728 Debug Console \u4e2d\u8f93\u5165 ptr - mat->data \u6765\u8fdb\u884c\u83b7\u53d6. Debug Console \u4e2d\u53ef\u4ee5\u8f93\u5165\u4efb\u4f55 C++ expression\uff0c\u751a\u81f3\u5305\u62ec function call. 4.3 Address Sanitizer \u5730\u5740\u68c0\u67e5\u5668 We recommend enabling the address sanitizer \u5730\u5740\u9519\u8bef\u68c0\u67e5\u5668 and undefined behavior sanitizer \u672a\u5b9a\u4e49\u884c\u4e3a\u68c0\u67e5\u5668 . These will help you find memory errors like going off the end of an array or vector. \u9996\u5148\u7f16\u8f91 Makefile \u6dfb\u52a0\u8fd9\u4e9b CXXFLAGS . WSL or Linux: Add compiler flags (1) -fsanitize=address , (2) -fsanitize=undefined , (3) -D_GLIBCXX_DEBUG . For example: CXXFLAGS = --std=c++17 -Wall -Werror -pedantic -g -fsanitize=address -fsanitize=undefined -D_GLIBCXX_DEBUG macOS: Add compiler flags (1) -fsanitize=address , (2) -fsanitize=undefined . (ma cOS\u4e0d\u6dfb\u52a0 -D_GLIBCXX_DEBUG .) For example: CXXFLAGS = --std=c++17 -Wall -Werror -pedantic -g -fsanitize=address -fsanitize=undefined \u6700\u540e\u6548\u679c\u662f\uff1a CXX ?= g++ CXXFLAGS ?= --std=c++17 -Wall -Werror -pedantic -g # Add sanitizer flags for identifying undefined behavior. The flags are # different on macOS (AKA Darwin) and Windows/WSL/Linux. UNAME := $(shell uname -s) ifeq \"$(UNAME)\" \"Darwin\" CXXFLAGS += -fsanitize=address -fsanitize=undefined else CXXFLAGS += -fsanitize=address -fsanitize=undefined -D_GLIBCXX_DEBUG endif \u5728 launch.json \u4e2d\u8fdb\u884c\u6dfb\u52a0 address sanitizer \u7684 arguments. For MacOS : \u7f16\u8f91 \"env\" property in your launch.json . \u5982\u679c\u548c\u4e0b\u9762\u8fd9\u4e2a\u4e0d\u4e00\u6837\u5c31replace it. \u5982\u679c\u6ca1\u6709\u5c31\u6dfb\u52a0\u4e0b\u9762\u8fd9\u884c\u5230 \"args\" property. \"env\": { \"ASAN_OPTIONS\": \"abort_on_error=1:detect_leaks=0\" }, For WSL/Linux: \u7f16\u8f91 \"environment\" property in your launch.json . \u5982\u679c\u548c\u4e0b\u9762\u8fd9\u4e2a\u4e0d\u4e00\u6837\u5c31 replace it. \u5982\u679c\u6ca1\u6709\u5c31\u6dfb\u52a0\u4e0b\u9762\u8fd9\u884c\u5230 \"args\" property. \"environment\": [ { \"name\": \"ASAN_OPTIONS\", \"value\": \"abort_on_error=1:detect_leaks=0\" } ], \u5f53 address sanitizer \u53d1\u73b0 error \u65f6\u4f1a\u663e\u793a\u4e00\u9875\u673a\u5668\u7801\uff0c\u8fd9\u6ca1\u4ec0\u4e48\u7528\u800c\u4e14\u5f88\u70e6\u4eba. \u5173\u6389\u7684\u65b9\u6cd5\u662f Code > Settings > Settings> set the lldb.showDisassembly option to never . 4.3.1 Leak Checking address sanitzer \u8fd8\u53ef\u4ee5\u7528\u6765\u68c0\u6d4b memory leak. \u4f46\u662f\u4ec5\u9650\u4e8e WSL/Linux. macOS \u8981\u5728 shell \u91cc\u9762\u5728 make \u540e\u52a0\u5165\u4e00\u884c make main.exe MallocStackLogging=1 leaks -quiet -atExit -- ./main.exe \u6ce8\u610f\u8fd9\u4e2a\u68c0\u6d4b\u5668\u548c address sanitizer \u4e0d\u517c\u5bb9 (\u56e0\u800c\u8fd8\u8981\u628a makefile \u91cc\u9762\u7684 address sanitizer \u53bb\u6389). \u8fd9\u6837\u5b50\u5728\u8fd0\u884c exe \u6587\u4ef6\u7684\u65f6\u5019\u5c31\u4f1a\u544a\u8bc9\u4f60 memory leaking \u7684\u95ee\u9898. make main.exe ./main.exe # Hello Leaks! # ================================================================= # ==1905936==ERROR: LeakSanitizer: detected memory leaks # Direct leak of 4 byte(s) in 1 object(s) allocated from: #0 0x7f54a90ae7b0 in operator new(unsigned long) (/lib64/libasan.so.5+0xf17b0) #1 0x400a73 in main /home/awdeorio/leakcheck/main.cpp:6 #2 0x7f54a8303cf2 in __libc_start_main (/lib64/libc.so.6+0x3acf2) # SUMMARY: AddressSanitizer: 4 byte(s) leaked in 1 allocation(s). 4.4 Assertions The <cassert> header defines an assert() macro\uff0c\u6211\u4eec\u4f20\u7ed9\u5b83\u5e03\u5c14\u53c2\u6570\u4f5c\u4e3a condition\uff1a \u5982\u679c condition is true, nothing happens. \u5982\u679c condition is false, the program crashes immediately. #include <cassert> int main() { int x = 2; int y = 5; assert(x + 3 == y); // true, all good :) assert(x > y); // false, crash!! (\u256f\u00b0\u25a1\u00b0)\u256f\ufe35 \u253b\u2501\u253b } terminal \u4f1a\u663e\u793a\u9519\u8bef\uff1a test.exe: test.cpp:7: int main(): Assertion `x > y' failed. Aborted \u8fd9\u53ef\u4ee5\u68c0\u6d4b\u4e00\u4e9b precondition, invariant \u7b49. 4.5 Command-Line Debuggers(gbd,lldb) IDE \u91cc\u9762\u96c6\u6210\u4e86 debugging \u7684\u6d41\u7a0b\uff0c\u4f46\u662f\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728 terminal \u76f4\u63a5\u7528 gdb/llbd \u6765\u8fdb\u884c debug. \u4f46\u662f\u8fd9\u4e4b\u524d\u6211\u4eec\u9996\u5148\u8981\u7528 g++ \u6765 compile \u5b8c exe \u6587\u4ef6. 4.5.1 CL Debugging \u547d\u4ee4 command what it does b main breakpoint on main function b 13 breakpoint on line 13 of current file b main.cpp:13 breakpoint on line 13 of main.cpp r run or rerun l list a few lines of code n step over (next) s step into up step out (up) c continue p myvar print variable myvar refresh refresh TUI view bt backtrace, useful for segfaults q quit 4.5.2 Input Redirection \u81ea\u52a8\u5316\u8f93\u5165 gdb: gdb main.exe ... (gdb) r < main_test.in ... \u800c lldb \u8981\u590d\u6742\u4e00\u70b9\uff1a lldb main.exe ... (lldb) settings set target.input-path main_test.in (lldb) r ... 4.5.3 Arguments and optins \u6211\u4eec\u4e4b\u524d\u5728 VSCode \u91cc\u5728 launch.json \u91cc\u9762\u653e arguments and options\uff0c\u90a3\u4e48\u5f53\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528 command \u5b9e\u73b0. ./main.exe train_small.csv test_small.csv --debug main.exe is the name of the program train_small.csv and test_small.csv are arguments --debug is an option 4.6 More Pro Tips for debugging 4.6.1 Debug Logging \u989d\u5916\u8f93\u51fa \u5728\u4e00\u4e9b\u5faa\u73af\u4e2d\u6211\u4eec\u53d1\u73b0\u5f02\u5e38\uff0c\u53ef\u4ee5\u4e13\u95e8\u5199\u4e00\u4e9b\u989d\u5916\u7684 output \u7528\u4ee5 debug. \u4e13\u95e8\u52a0\u4e00\u4e9b\u8bdd\u7528\u6765 Debug\uff0c\u5e76\u4e14\u52a0\u4e0a\u6807\u8bc6\u6765\u548c\u666e\u901a\u7684\u8f93\u51fa\u533a\u5206\u5f00. 4.6.2 Conditional Breakpoint \u63a5\u4e0a\u4e00\u6761\uff0c\u6211\u4eec\u53ef\u4ee5\u4eba\u4e3a\u5730\u52a0\u4e00\u4e9b if \u8bed\u53e5\u6765 debug\uff0c\u5e76\u4e14\u628a BreakPoint \u653e\u5728 if \u8bed\u53e5\u7684\u5185\u90e8\u65f6\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u67d0\u4e2a\u65f6\u523b\u53d8\u91cf\u7684\u503c\u662f\u4e0d\u662f\u9884\u671f\u7684\u503c. \u8fd9\u6837\u5c31\u53ef\u4ee5\u4e00\u773c\u68c0\u6d4b\u67d0\u4e2a\u65f6\u523b\u67d0\u4e2a variable \u7684\u503c\u662f\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u503c\uff0c\u8fd9\u6837\u4e0d\u4ec5\u53ef\u4ee5 debug \u8fd8\u53ef\u4ee5\u987a\u4fbf testing.","title":"Overview"},{"location":"04-Debuggers.html#4-debuggers","text":"\u672c\u6bb5\u6f14\u793a\u6211\u4eec\u4f7f\u7528\u4e0b\u9762\u4e2d\u8fd9\u6bb5\u4ee3\u7801: #include <iostream> #include <vector> using namespace std; double sum (const vector<double> &data) { double total = 0; for (size_t i=0; i<data.size(); ++i) { total += data[i]; } return total; } int main() { vector<double> data; data.push_back(10); data.push_back(20); data.push_back(30); cout << \"sum(data) = \" << sum(data) << endl; }","title":"4 Debuggers"},{"location":"04-Debuggers.html#41-debugging-basis","text":"\u5927\u90e8\u5206 debugger \u90fd\u652f\u6301\u4ee5\u4e0b\u7684\u529f\u80fd.","title":"4.1 Debugging Basis"},{"location":"04-Debuggers.html#411-breakpoint","text":"Set a breakpoint by clicking to the left of a line number. A breakpoint \u8868\u793a debug \u8fd0\u884c\u5230\u8fd9\u91cc\u505c\u6b62. \u8fd9\u662f debug \u7684\u5f00\u7aef\uff0c\u5c31\u662f\u4ece breakpoint \u5f00\u59cb\u53ef\u4ee5\u9010\u884c debug","title":"4.1.1 Breakpoint \u8bbe\u7f6e\u95f4\u65ad\u70b9"},{"location":"04-Debuggers.html#412-step-over","text":"step over \u5c31\u662f\u7ee7\u7eed\u8fd0\u884c\u4e00\u884c\u7684\u610f\u601d. \u4ece breakpoint \u5f00\u59cb\uff0c\u6211\u4eec\u6bcf stepover \u4e00\u4e0b\u5c31\u662f\u8fd0\u884c\u4e00\u884c.","title":"4.1.2 Step over \u8fd0\u884c\u4e00\u884c"},{"location":"04-Debuggers.html#413-inspect","text":"\u6211\u4eec stepover \u7684\u65f6\u5019\uff0c\u5de6\u8fb9\u7684 local variables \u4f1a\u66f4\u65b0. \u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u70b9\u5f00\u91cc\u9762\u7684\u6570\u636e\u8fdb\u884c inspect\uff0c\u67e5\u770b\u8fd0\u884c\u8fd9\u4e00\u884c\u4e4b\u540e\u7684\u72b6\u6001. \u4e0b\u9762\u8fd8\u80fd\u68c0\u67e5 call stack. \u70b9\u51fb call stack \u4f1a\u8fdb\u5165\u8be5\u51fd\u6570\u7684 stack frame \u91cc\u9762\u67e5\u770b varibles.","title":"4.1.3 Inspect \u67e5\u770b\u53d8\u91cf"},{"location":"04-Debuggers.html#414-step-intoout","text":"Step into \u4f1a\u76f4\u63a5\u8fdb\u5165\u8fd9\u4e00\u884c\u4f7f\u7528\u7684\u51fd\u6570\u7684\u6e90\u4ee3\u7801\uff1b\u5982\u679c\u67e5\u770b\u7684\u662f\u5e93\u51fd\u6570\uff0c\u4f1a\u76f4\u63a5\u8fdb\u5165C++\u7684\u5e93\u6e90\u6587\u4ef6\u4e2d\u8fdb\u884c\u67e5\u770b. \u5982\u679c\u662f\u81ea\u5df1\u5199\u7684\u51fd\u6570\uff0c\u4f1a\u5230\u81ea\u5df1\u7684\u51fd\u6570\u8fd9\u91cc. \u7136\u540e\u7528 Step out \u53ef\u4ee5\u56de\u5230\u6211\u4eec\u7684\u6587\u4ef6.","title":"4.1.4 Step Into/Out \u67e5\u770b\u6e90\u7801"},{"location":"04-Debuggers.html#415-continue","text":"Continue \u53ef\u4ee5\u76f4\u63a5\u5feb\u8fdb\u8fd0\u884c\u5230\u73b0\u5728\u7684\u4f4d\u7f6e\u7684\u4e0b\u4e00\u4e2a breakpoint.","title":"4.1.5 Continue \u5feb\u8fdb\u5230\u4e0b\u4e00\u4e2a\u95f4\u65ad\u70b9"},{"location":"04-Debuggers.html#42-debug-console","text":"\u5982\u679c\u6211\u4eec\u73b0\u5728\u5728\u8fdb\u884c\u4e00\u4e2a Matrix \u7684 debugging, \u6211\u4eec\u770b\u5230\u4e86 call stack \u4e2d\u7684\u4e00\u4e2a ptr \u53d8\u91cf\u7684\u5730\u5740\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u5b83\u6307\u7684\u662f Matrix \u4e2d\u7684\u7b2c\u51e0\u4e2a entry. \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728 Debug Console \u4e2d\u8f93\u5165 ptr - mat->data \u6765\u8fdb\u884c\u83b7\u53d6. Debug Console \u4e2d\u53ef\u4ee5\u8f93\u5165\u4efb\u4f55 C++ expression\uff0c\u751a\u81f3\u5305\u62ec function call.","title":"4.2 Debug Console"},{"location":"04-Debuggers.html#43-address-sanitizer","text":"We recommend enabling the address sanitizer \u5730\u5740\u9519\u8bef\u68c0\u67e5\u5668 and undefined behavior sanitizer \u672a\u5b9a\u4e49\u884c\u4e3a\u68c0\u67e5\u5668 . These will help you find memory errors like going off the end of an array or vector. \u9996\u5148\u7f16\u8f91 Makefile \u6dfb\u52a0\u8fd9\u4e9b CXXFLAGS . WSL or Linux: Add compiler flags (1) -fsanitize=address , (2) -fsanitize=undefined , (3) -D_GLIBCXX_DEBUG . For example: CXXFLAGS = --std=c++17 -Wall -Werror -pedantic -g -fsanitize=address -fsanitize=undefined -D_GLIBCXX_DEBUG macOS: Add compiler flags (1) -fsanitize=address , (2) -fsanitize=undefined . (ma cOS\u4e0d\u6dfb\u52a0 -D_GLIBCXX_DEBUG .) For example: CXXFLAGS = --std=c++17 -Wall -Werror -pedantic -g -fsanitize=address -fsanitize=undefined \u6700\u540e\u6548\u679c\u662f\uff1a CXX ?= g++ CXXFLAGS ?= --std=c++17 -Wall -Werror -pedantic -g # Add sanitizer flags for identifying undefined behavior. The flags are # different on macOS (AKA Darwin) and Windows/WSL/Linux. UNAME := $(shell uname -s) ifeq \"$(UNAME)\" \"Darwin\" CXXFLAGS += -fsanitize=address -fsanitize=undefined else CXXFLAGS += -fsanitize=address -fsanitize=undefined -D_GLIBCXX_DEBUG endif \u5728 launch.json \u4e2d\u8fdb\u884c\u6dfb\u52a0 address sanitizer \u7684 arguments. For MacOS : \u7f16\u8f91 \"env\" property in your launch.json . \u5982\u679c\u548c\u4e0b\u9762\u8fd9\u4e2a\u4e0d\u4e00\u6837\u5c31replace it. \u5982\u679c\u6ca1\u6709\u5c31\u6dfb\u52a0\u4e0b\u9762\u8fd9\u884c\u5230 \"args\" property. \"env\": { \"ASAN_OPTIONS\": \"abort_on_error=1:detect_leaks=0\" }, For WSL/Linux: \u7f16\u8f91 \"environment\" property in your launch.json . \u5982\u679c\u548c\u4e0b\u9762\u8fd9\u4e2a\u4e0d\u4e00\u6837\u5c31 replace it. \u5982\u679c\u6ca1\u6709\u5c31\u6dfb\u52a0\u4e0b\u9762\u8fd9\u884c\u5230 \"args\" property. \"environment\": [ { \"name\": \"ASAN_OPTIONS\", \"value\": \"abort_on_error=1:detect_leaks=0\" } ], \u5f53 address sanitizer \u53d1\u73b0 error \u65f6\u4f1a\u663e\u793a\u4e00\u9875\u673a\u5668\u7801\uff0c\u8fd9\u6ca1\u4ec0\u4e48\u7528\u800c\u4e14\u5f88\u70e6\u4eba. \u5173\u6389\u7684\u65b9\u6cd5\u662f Code > Settings > Settings> set the lldb.showDisassembly option to never .","title":"4.3 Address Sanitizer \u5730\u5740\u68c0\u67e5\u5668"},{"location":"04-Debuggers.html#431-leak-checking","text":"address sanitzer \u8fd8\u53ef\u4ee5\u7528\u6765\u68c0\u6d4b memory leak. \u4f46\u662f\u4ec5\u9650\u4e8e WSL/Linux. macOS \u8981\u5728 shell \u91cc\u9762\u5728 make \u540e\u52a0\u5165\u4e00\u884c make main.exe MallocStackLogging=1 leaks -quiet -atExit -- ./main.exe \u6ce8\u610f\u8fd9\u4e2a\u68c0\u6d4b\u5668\u548c address sanitizer \u4e0d\u517c\u5bb9 (\u56e0\u800c\u8fd8\u8981\u628a makefile \u91cc\u9762\u7684 address sanitizer \u53bb\u6389). \u8fd9\u6837\u5b50\u5728\u8fd0\u884c exe \u6587\u4ef6\u7684\u65f6\u5019\u5c31\u4f1a\u544a\u8bc9\u4f60 memory leaking \u7684\u95ee\u9898. make main.exe ./main.exe # Hello Leaks! # ================================================================= # ==1905936==ERROR: LeakSanitizer: detected memory leaks # Direct leak of 4 byte(s) in 1 object(s) allocated from: #0 0x7f54a90ae7b0 in operator new(unsigned long) (/lib64/libasan.so.5+0xf17b0) #1 0x400a73 in main /home/awdeorio/leakcheck/main.cpp:6 #2 0x7f54a8303cf2 in __libc_start_main (/lib64/libc.so.6+0x3acf2) # SUMMARY: AddressSanitizer: 4 byte(s) leaked in 1 allocation(s).","title":"4.3.1 Leak Checking"},{"location":"04-Debuggers.html#44-assertions","text":"The <cassert> header defines an assert() macro\uff0c\u6211\u4eec\u4f20\u7ed9\u5b83\u5e03\u5c14\u53c2\u6570\u4f5c\u4e3a condition\uff1a \u5982\u679c condition is true, nothing happens. \u5982\u679c condition is false, the program crashes immediately. #include <cassert> int main() { int x = 2; int y = 5; assert(x + 3 == y); // true, all good :) assert(x > y); // false, crash!! (\u256f\u00b0\u25a1\u00b0)\u256f\ufe35 \u253b\u2501\u253b } terminal \u4f1a\u663e\u793a\u9519\u8bef\uff1a test.exe: test.cpp:7: int main(): Assertion `x > y' failed. Aborted \u8fd9\u53ef\u4ee5\u68c0\u6d4b\u4e00\u4e9b precondition, invariant \u7b49.","title":"4.4 Assertions"},{"location":"04-Debuggers.html#45-command-line-debuggersgbdlldb","text":"IDE \u91cc\u9762\u96c6\u6210\u4e86 debugging \u7684\u6d41\u7a0b\uff0c\u4f46\u662f\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728 terminal \u76f4\u63a5\u7528 gdb/llbd \u6765\u8fdb\u884c debug. \u4f46\u662f\u8fd9\u4e4b\u524d\u6211\u4eec\u9996\u5148\u8981\u7528 g++ \u6765 compile \u5b8c exe \u6587\u4ef6.","title":"4.5 Command-Line Debuggers(gbd,lldb)"},{"location":"04-Debuggers.html#451-cl-debugging","text":"command what it does b main breakpoint on main function b 13 breakpoint on line 13 of current file b main.cpp:13 breakpoint on line 13 of main.cpp r run or rerun l list a few lines of code n step over (next) s step into up step out (up) c continue p myvar print variable myvar refresh refresh TUI view bt backtrace, useful for segfaults q quit","title":"4.5.1 CL Debugging \u547d\u4ee4"},{"location":"04-Debuggers.html#452-input-redirection","text":"\u81ea\u52a8\u5316\u8f93\u5165 gdb: gdb main.exe ... (gdb) r < main_test.in ... \u800c lldb \u8981\u590d\u6742\u4e00\u70b9\uff1a lldb main.exe ... (lldb) settings set target.input-path main_test.in (lldb) r ...","title":"4.5.2 Input Redirection"},{"location":"04-Debuggers.html#453-arguments-and-optins","text":"\u6211\u4eec\u4e4b\u524d\u5728 VSCode \u91cc\u5728 launch.json \u91cc\u9762\u653e arguments and options\uff0c\u90a3\u4e48\u5f53\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528 command \u5b9e\u73b0. ./main.exe train_small.csv test_small.csv --debug main.exe is the name of the program train_small.csv and test_small.csv are arguments --debug is an option","title":"4.5.3 Arguments and optins"},{"location":"04-Debuggers.html#46-more-pro-tips-for-debugging","text":"","title":"4.6 More Pro Tips for debugging"},{"location":"04-Debuggers.html#461-debug-logging","text":"\u5728\u4e00\u4e9b\u5faa\u73af\u4e2d\u6211\u4eec\u53d1\u73b0\u5f02\u5e38\uff0c\u53ef\u4ee5\u4e13\u95e8\u5199\u4e00\u4e9b\u989d\u5916\u7684 output \u7528\u4ee5 debug. \u4e13\u95e8\u52a0\u4e00\u4e9b\u8bdd\u7528\u6765 Debug\uff0c\u5e76\u4e14\u52a0\u4e0a\u6807\u8bc6\u6765\u548c\u666e\u901a\u7684\u8f93\u51fa\u533a\u5206\u5f00.","title":"4.6.1 Debug Logging \u989d\u5916\u8f93\u51fa"},{"location":"04-Debuggers.html#462-conditional-breakpoint","text":"\u63a5\u4e0a\u4e00\u6761\uff0c\u6211\u4eec\u53ef\u4ee5\u4eba\u4e3a\u5730\u52a0\u4e00\u4e9b if \u8bed\u53e5\u6765 debug\uff0c\u5e76\u4e14\u628a BreakPoint \u653e\u5728 if \u8bed\u53e5\u7684\u5185\u90e8\u65f6\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u77e5\u9053\u67d0\u4e00\u65f6\u523b\u67d0\u4e2a\u65f6\u523b\u53d8\u91cf\u7684\u503c\u662f\u4e0d\u662f\u9884\u671f\u7684\u503c. \u8fd9\u6837\u5c31\u53ef\u4ee5\u4e00\u773c\u68c0\u6d4b\u67d0\u4e2a\u65f6\u523b\u67d0\u4e2a variable \u7684\u503c\u662f\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u503c\uff0c\u8fd9\u6837\u4e0d\u4ec5\u53ef\u4ee5 debug \u8fd8\u53ef\u4ee5\u987a\u4fbf testing.","title":"4.6.2 Conditional Breakpoint"},{"location":"05-Version-Control-%28git%29.html","text":"5 Version Control 5.1 Github Authentication \u9a8c\u8bc1 5.1.1 SSH Keys 5.1.2 Personal Acces Token 5.2 Create a local repository 5.2.1 \u7ed9 directory \u6dfb\u52a0\u4e00\u4e2a .gitignore \u6587\u4ef6 5.2.2 Initialize repo 5.2.3 \u6dfb\u52a0 existing files to version control 5.3 \u521b\u5efa remote repo \u53ca connect local reop to remote 5.4 Daily work flow with version control 5.5 Version Control For a Team 5.5.1 \u6dfb\u52a0 Collaborator 5.5.2 \u89e3\u51b3 Conflict 5.5.3 rejected pushes 5.6 \u6ce8\u610f\u4e8b\u9879 5.6.1 \u6dfb\u52a0 commit \u65f6\u7684\u6587\u5b57\u5907\u6ce8 5.6.2 README.md \u6587\u4ef6 5.6.3 \u770b commit \u7684\u5185\u5bb9 5.6.4 \u5220\u5e93 5 Version Control \u9996\u5148\u5b89\u88c5 git sudo apt install git git --version \u7136\u540e configure name \u548c email git config --global user.name \"Your NAME here\" git config --global user.email \"Your Email here\" 5.1 Github Authentication \u9a8c\u8bc1 \u6709\u4e24\u4e2a\u65b9\u6cd5 connect to Github: SSH Key: a special file that you can use to connect to remote terminals. Github Personal Tokens Keys: a separate password used just for GitHub. 5.1.1 SSH Keys \u5982\u679c\u6709\u4e0b\u9762\u8fd9\u4e9b files \u4e2d\u7684\u4e00\u4e9b\uff0c\u4f60\u5c31\u5df2\u7ecf\u6709 SSH Keys \u4e86\uff1b\u5982\u679c\u4f60 get an error that ~/.ssh does not exist, \u90a3\u5c31\u8bf4\u660e\u8fd8\u6ca1\u6709\uff0c\u53ef\u4ee5\u521b\u9020\u4e00\u4e2a. \u770b\u770b\u6709\u6ca1\u6709\uff1a ls ~/.ssh ... if error, generate one: ssh-keygen -t ed25519 -C \"your_email@example.com\" Enter. \u521b\u5efa\u7ed3\u675f. \u901a\u8fc7 cat \u6307\u4ee4\u628a pub \u6587\u4ef6\u7684\u5185\u5bb9\u4f20\u7ed9 shell\uff0cshell \u5c31\u4f1a\u663e\u793a\u51fa\u6765. cat ~/.ssh/id_ed25519.pub # ssh-ed25519 KLBJDjlkaksfadhinoueliwekljhfasdlkjhfdss/asdnfkjlnaksjdfdfnkljdafslF awdeorio@umich.edu.com \u628a\u8fd9\u4e2a\u7ed3\u679c\u590d\u5236\u4e0b\u6765\uff0c\u6253\u5f00 https://github.com/settings/keys \uff0c \u800c\u540e\u70b9\u51fb Add SSH key. \u7136\u540e\u5c31\u6709\u4e00\u4e2a\u8fde\u63a5\u5230 Github \u7684 SSH key \u4e86. WARNING: Do not share your private key with anyone! It\u2019s the file that looks like id_ed25519 \uff01 Test your connection: ssh -T git@github.com Hi awdeorio! You've successfully authenticated, but GitHub does not provide shell access. 5.1.2 Personal Acces Token A Personal Access Token is an alternative to SSH Keys. \u76f4\u63a5 Login to GitHub. Navigate to Profile > Settings > Developer Settings > Tokens (classic). \u76f4\u63a5 Generate \u4e00\u4e2a\uff0c\u8bb0\u5f97 check only the repo box. \u7136\u540e Copy \u4e0b\u6765. 5.2 Create a local repository 5.2.1 \u7ed9 directory \u6dfb\u52a0\u4e00\u4e2a .gitignore \u6587\u4ef6 \u8fd9\u91cc\u7684\u8fd9\u4e2a .gitignore \u662f\u4e00\u4e2a pre-configured \u80fd\u591f work with most C++ projects \u7684\uff0c\u56e0\u800c 280/281 \u7684 pro \u90fd\u80fd\u7528. pwd # /Users/awdeorio/Developer/eecs280/p2-cv wget https://eecs280staff.github.io/tutorials/dot_gitignore_sample -O .gitignore ls -A # .gitignore 5.2.2 Initialize repo git init #Initialized empty Git repository in /Users/awdeorio/Developer/eecs280/p2-cv/.git/ git status #On branch main #Untracked files: # .gitignore # ... #nothing added to commit but untracked files present (use \"git add\" to track) 5.2.3 \u6dfb\u52a0 existing files to version control \u9996\u5148 double check \u4f60\u6709\u4e00\u4e2a .gitignore file. shell head .gitignore # This is a sample .gitignore file that's useful for C++ projects. \u7136\u540e\u6dfb\u52a0\u5305\u62ec\u4f60\u7684 .gitignore \u5728\u5185\u7684\u6240\u6709\u6587\u4ef6\u5230 git \u4e2d\uff0c\u7136\u540e\u67e5\u770b status \u5c31\u80fd\u770b\u5230\u5f88\u591a\u5f85 commit \u7684 changded files. shell git add . git status #On branch main # #Changes to be committed: # # new file: .gitignore ... Commit \u8fd9\u4e9b\u6587\u4ef6\u5230 local repo with the commit message \u201cInitial commit\u201d. shell git commit -m \"Initial commit\" #[main (root-commit) cefd222] Initial commit # 1 file changed, 71 insertions(+) # create mode 100644 .gitignore \u53ef\u4ee5 view commit log and see our first commit. ```shell git log #commit cefd2227510fa5e16e357198be19832b952d314e (HEAD -> main) #Author: Andrew DeOrio awdeorio@umich.edu #Date: Tue Aug 30 19:29:52 2022 -0400 # Initial commit ``` \u7136\u540e\u53ef\u4ee5\u770b\u5230the status is clean, \u6ca1\u6709\u4ec0\u4e48\u8981 commit \u7684\u4e86. shell git status # On branch main # nothing to commit, working tree clean \u4f60\u53ef\u80fd\u4e0d\u60f3commit automatically generated or binary files. \u56e0\u4e3a\u8fd9\u4e9b\u4e9b Binaries \u5728\u522b\u4eba\u7684 machine \u4e0a\u4e0d\u4e00\u5b9a\u5de5\u4f5c. shell git ls-files ... # main.exe # main.exe.dSYM/Contents/Info.plist # main.exe.dSYM/Contents/Resources/DWARF/main.exe ... \u6240\u4ee5\u53ef\u4ee5\u628a\u4ed6\u4eec\u4ece git \u4e2d\u79fb\u9664\u6389\uff0c\u4e0d commit. shell git rm -f main.exe git rm -rf main.exe.dSYM git status # On branch main # Changes to be committed: # (use \"git restore --staged <file>...\" to unstage) # deleted: main.exe # deleted: # main.exe.dSYM/Contents/Info.plist # deleted: # main.exe.dSYM/Contents/Resources/DWARF/main.exe git commit -m \"remove binary files\" git status # On branch main # nothing to commit, working tree clean 5.3 \u521b\u5efa remote repo \u53ca connect local reop to remote \u521b\u5efa remote repo \u5c31\u662f\u516c\u516c\u53c8\u5f0f\u5f0f\u7684 github \u9875\u9762\u4e0a\u64cd\u4f5c\u4e00\u4e0b. \u800c\u5982\u4f55 connect local repo \u5230 remote: \u9996\u5148\u786e\u5b9a\u4f60\u5728\u4f60\u6709 git \u7684 directory. shell pwd # github.com/awdeorio/p2-cv \u4f7f\u7528\u8fd9\u4e2a address \u521b\u5efa\u4e00\u4e2a origin \u8fd9\u91cc\u975e\u5e38\u91cd\u8981\u7684\u662f\uff0c\u8fd9\u4e2a origin \u5bf9\u4e8e\u4f7f\u7528 SSH \u548c Personal Token \u7684\u4eba\u662f\u4e0d\u4e00\u6837\u7684\uff01 For SSH: shell git remote add origin git@github.com:awdeorio/p2-cv.git # use your URL For personal Token: shell git remote add origin https://github.com/awdeorio/p2-cv.git # use your URL \u5982\u679c\u5199\u9519\u4e86\u90a3\u5c31\u5220\u9664 origin \u7136\u540e\u91cd\u65b0\u5199\u4e00\u904d. shell git remote rm origin \u786e\u8ba4\u4e00\u4e0b\u5df2\u7ecf connect \u4e0a remote \u4e86 shell git remote -v # origin git@github.com:awdeorio/p2-cv.git (fetch) # origin git@github.com:awdeorio/p2-cv.git (push) Your local git may use master as the name for the initial branch, whereas GitHub expects it to be named main. \u56e0\u800c\u7528 -M \u6307\u4ee4\u6539\u540d shell git branch # master git branch -M main git branch # main \u628a\u5df2\u7ecf committed \u5230 local repo \u7684 commits push \u5230 remote repo. shell git push -u origin main \u786e\u8ba4\u5df2\u7ecf commit, \u5e76 verify commit log. ```shell $ git status # On branch main # Your branch is up to date with 'origin/main'. # nothing to commit, working tree clean git log # commit cefd2227510fa5e16e357198be19832b952d314e (HEAD -> main) # Author: Andrew DeOrio awdeorio@umich.edu # Date: Tue Aug 30 19:29:52 2022 -0400 # Initial commit ``` 5.4 Daily work flow with version control \u67e5\u770b status\uff0c\u68c0\u67e5\u672c\u5730\u7684 branch \u662f\u5426\u5df2\u7ecf\u540c\u6b65\u66f4\u65b0\u4e86 server \u7684 change\uff0c\u4ee5\u53ca\u672c\u5730\u7684 change \u662f\u5426\u5df2\u7ecf commit \u548c push \u5230 server. shell git status Retrieve any changes from the server. shell git fetch git rebase Make changes to files. shell git add SOME_FILE git commit -m \"Short description goes here\" Push changes to GitHub server. shell git push 5.5 Version Control For a Team 5.5.1 \u6dfb\u52a0 Collaborator \u800c\u540e\uff1a GitHub sends a confirmation email to your partner. Your partner clicks accept. Your partner creates an SSH key or a GitHub Personal Access Token. Your partner clone the remote repo on their own local machine using the same remote URL that you do. shell git clone https://github.com/awdeorio/p2-cv.git 5.5.2 \u89e3\u51b3 Conflict The following text is copied from a helpful GitHub article . When you perform a git rebase operation, you\u2019re typically moving commits around. Because of this, you might get into a situation where a merge conflict is introduced. That means that two of your commits modified the same line in the same file, and Git doesn\u2019t know which change to apply. \u7b80\u5355\u6765\u8bf4\u5c31\u662f merge conflict \u53d1\u751f\u4e86. \u56e0\u4e3a\u4f60\u4eec\u90fd commit \u4e86\uff0c\u4f46\u662f\u4f60\u8fd8\u6ca1\u6709 fetch \u5bf9\u65b9\u7684 commit \u5c31 commit \u4e86. \u8fd9\u4e2a\u65f6\u5019\u4f60\u5e94\u8be5\u9009\u62e9 merge \u4e00\u4e2a branch. \u53ef\u4ee5\u76f4\u63a5\u5728 Github Desktop \u8fdb\u884c\u64cd\u4f5c. git merge BRANCH-NAME 5.5.3 rejected pushes \u5982\u679c\u4f60\u4f7f\u7528 git push \u65f6 push \u88ab rejected error \u4e86\uff0c\u90a3\u5c31\u662f\u4f60\u7684 teammate made \u4e86\u4e00\u4e2a commit. \u8fd9\u4e2a\u65f6\u5019\u5f88\u7b80\u5355\uff0c\u5148 fetch \u518d push. 5.6 \u6ce8\u610f\u4e8b\u9879 5.6.1 \u6dfb\u52a0 commit \u65f6\u7684\u6587\u5b57\u5907\u6ce8 \u6bd4\u5982\uff1a git commit -m \"Added README\" git status commit \u4e00\u4e2a change \u65f6\u5e94\u5907\u6ce8\u6765\u8868\u793a\u505a\u4e86\u4ec0\u4e48. 5.6.2 README.md \u6587\u4ef6 \u5e94\u8be5\u5728 repo \u4e2d\u6dfb\u52a0\u4e00\u4e2a README.md \u6587\u4ef6\u6765\u5199\u8fd9\u4e2a repo \u7684 instructions and descriptions. touch README.md git add README.md git commit -m \"Added README\" git status 5.6.3 \u770b commit \u7684\u5185\u5bb9 git diff 1.cpp \u4f60\u53ef\u4ee5\u901a\u8fc7 diff \u547d\u4ee4\u67e5\u770b the last clean committed version of the file. 5.6.4 \u5220\u5e93 \u9996\u5148\u5728 Github \u91cc\u9762\u5220\u9664 repository. \u7136\u540e\u5220\u9664 .git \u8fd9\u4e2a hidden file \u4ee5\u53ca .gitignore . pwd # /Users/awdeorio/Developer/eecs280/p2-cv rm -rf .git/ .gitignore ls -A git status # fatal: Not a git repository (or any of the parent directories): .git","title":"Overview"},{"location":"05-Version-Control-%28git%29.html#5-version-control","text":"\u9996\u5148\u5b89\u88c5 git sudo apt install git git --version \u7136\u540e configure name \u548c email git config --global user.name \"Your NAME here\" git config --global user.email \"Your Email here\"","title":"5 Version Control"},{"location":"05-Version-Control-%28git%29.html#51-github-authentication","text":"\u6709\u4e24\u4e2a\u65b9\u6cd5 connect to Github: SSH Key: a special file that you can use to connect to remote terminals. Github Personal Tokens Keys: a separate password used just for GitHub.","title":"5.1 Github Authentication \u9a8c\u8bc1"},{"location":"05-Version-Control-%28git%29.html#511-ssh-keys","text":"\u5982\u679c\u6709\u4e0b\u9762\u8fd9\u4e9b files \u4e2d\u7684\u4e00\u4e9b\uff0c\u4f60\u5c31\u5df2\u7ecf\u6709 SSH Keys \u4e86\uff1b\u5982\u679c\u4f60 get an error that ~/.ssh does not exist, \u90a3\u5c31\u8bf4\u660e\u8fd8\u6ca1\u6709\uff0c\u53ef\u4ee5\u521b\u9020\u4e00\u4e2a. \u770b\u770b\u6709\u6ca1\u6709\uff1a ls ~/.ssh ... if error, generate one: ssh-keygen -t ed25519 -C \"your_email@example.com\" Enter. \u521b\u5efa\u7ed3\u675f. \u901a\u8fc7 cat \u6307\u4ee4\u628a pub \u6587\u4ef6\u7684\u5185\u5bb9\u4f20\u7ed9 shell\uff0cshell \u5c31\u4f1a\u663e\u793a\u51fa\u6765. cat ~/.ssh/id_ed25519.pub # ssh-ed25519 KLBJDjlkaksfadhinoueliwekljhfasdlkjhfdss/asdnfkjlnaksjdfdfnkljdafslF awdeorio@umich.edu.com \u628a\u8fd9\u4e2a\u7ed3\u679c\u590d\u5236\u4e0b\u6765\uff0c\u6253\u5f00 https://github.com/settings/keys \uff0c \u800c\u540e\u70b9\u51fb Add SSH key. \u7136\u540e\u5c31\u6709\u4e00\u4e2a\u8fde\u63a5\u5230 Github \u7684 SSH key \u4e86. WARNING: Do not share your private key with anyone! It\u2019s the file that looks like id_ed25519 \uff01 Test your connection: ssh -T git@github.com Hi awdeorio! You've successfully authenticated, but GitHub does not provide shell access.","title":"5.1.1 SSH Keys"},{"location":"05-Version-Control-%28git%29.html#512-personal-acces-token","text":"A Personal Access Token is an alternative to SSH Keys. \u76f4\u63a5 Login to GitHub. Navigate to Profile > Settings > Developer Settings > Tokens (classic). \u76f4\u63a5 Generate \u4e00\u4e2a\uff0c\u8bb0\u5f97 check only the repo box. \u7136\u540e Copy \u4e0b\u6765.","title":"5.1.2 Personal Acces Token"},{"location":"05-Version-Control-%28git%29.html#52-create-a-local-repository","text":"","title":"5.2 Create a local repository"},{"location":"05-Version-Control-%28git%29.html#521-directory-gitignore","text":"\u8fd9\u91cc\u7684\u8fd9\u4e2a .gitignore \u662f\u4e00\u4e2a pre-configured \u80fd\u591f work with most C++ projects \u7684\uff0c\u56e0\u800c 280/281 \u7684 pro \u90fd\u80fd\u7528. pwd # /Users/awdeorio/Developer/eecs280/p2-cv wget https://eecs280staff.github.io/tutorials/dot_gitignore_sample -O .gitignore ls -A # .gitignore","title":"5.2.1 \u7ed9 directory \u6dfb\u52a0\u4e00\u4e2a .gitignore \u6587\u4ef6"},{"location":"05-Version-Control-%28git%29.html#522-initialize-repo","text":"git init #Initialized empty Git repository in /Users/awdeorio/Developer/eecs280/p2-cv/.git/ git status #On branch main #Untracked files: # .gitignore # ... #nothing added to commit but untracked files present (use \"git add\" to track)","title":"5.2.2 Initialize repo"},{"location":"05-Version-Control-%28git%29.html#523-existing-files-to-version-control","text":"\u9996\u5148 double check \u4f60\u6709\u4e00\u4e2a .gitignore file. shell head .gitignore # This is a sample .gitignore file that's useful for C++ projects. \u7136\u540e\u6dfb\u52a0\u5305\u62ec\u4f60\u7684 .gitignore \u5728\u5185\u7684\u6240\u6709\u6587\u4ef6\u5230 git \u4e2d\uff0c\u7136\u540e\u67e5\u770b status \u5c31\u80fd\u770b\u5230\u5f88\u591a\u5f85 commit \u7684 changded files. shell git add . git status #On branch main # #Changes to be committed: # # new file: .gitignore ... Commit \u8fd9\u4e9b\u6587\u4ef6\u5230 local repo with the commit message \u201cInitial commit\u201d. shell git commit -m \"Initial commit\" #[main (root-commit) cefd222] Initial commit # 1 file changed, 71 insertions(+) # create mode 100644 .gitignore \u53ef\u4ee5 view commit log and see our first commit. ```shell git log #commit cefd2227510fa5e16e357198be19832b952d314e (HEAD -> main) #Author: Andrew DeOrio awdeorio@umich.edu #Date: Tue Aug 30 19:29:52 2022 -0400 # Initial commit ``` \u7136\u540e\u53ef\u4ee5\u770b\u5230the status is clean, \u6ca1\u6709\u4ec0\u4e48\u8981 commit \u7684\u4e86. shell git status # On branch main # nothing to commit, working tree clean \u4f60\u53ef\u80fd\u4e0d\u60f3commit automatically generated or binary files. \u56e0\u4e3a\u8fd9\u4e9b\u4e9b Binaries \u5728\u522b\u4eba\u7684 machine \u4e0a\u4e0d\u4e00\u5b9a\u5de5\u4f5c. shell git ls-files ... # main.exe # main.exe.dSYM/Contents/Info.plist # main.exe.dSYM/Contents/Resources/DWARF/main.exe ... \u6240\u4ee5\u53ef\u4ee5\u628a\u4ed6\u4eec\u4ece git \u4e2d\u79fb\u9664\u6389\uff0c\u4e0d commit. shell git rm -f main.exe git rm -rf main.exe.dSYM git status # On branch main # Changes to be committed: # (use \"git restore --staged <file>...\" to unstage) # deleted: main.exe # deleted: # main.exe.dSYM/Contents/Info.plist # deleted: # main.exe.dSYM/Contents/Resources/DWARF/main.exe git commit -m \"remove binary files\" git status # On branch main # nothing to commit, working tree clean","title":"5.2.3 \u6dfb\u52a0 existing files to version control"},{"location":"05-Version-Control-%28git%29.html#53-remote-repo-connect-local-reop-to-remote","text":"\u521b\u5efa remote repo \u5c31\u662f\u516c\u516c\u53c8\u5f0f\u5f0f\u7684 github \u9875\u9762\u4e0a\u64cd\u4f5c\u4e00\u4e0b. \u800c\u5982\u4f55 connect local repo \u5230 remote: \u9996\u5148\u786e\u5b9a\u4f60\u5728\u4f60\u6709 git \u7684 directory. shell pwd # github.com/awdeorio/p2-cv \u4f7f\u7528\u8fd9\u4e2a address \u521b\u5efa\u4e00\u4e2a origin \u8fd9\u91cc\u975e\u5e38\u91cd\u8981\u7684\u662f\uff0c\u8fd9\u4e2a origin \u5bf9\u4e8e\u4f7f\u7528 SSH \u548c Personal Token \u7684\u4eba\u662f\u4e0d\u4e00\u6837\u7684\uff01 For SSH: shell git remote add origin git@github.com:awdeorio/p2-cv.git # use your URL For personal Token: shell git remote add origin https://github.com/awdeorio/p2-cv.git # use your URL \u5982\u679c\u5199\u9519\u4e86\u90a3\u5c31\u5220\u9664 origin \u7136\u540e\u91cd\u65b0\u5199\u4e00\u904d. shell git remote rm origin \u786e\u8ba4\u4e00\u4e0b\u5df2\u7ecf connect \u4e0a remote \u4e86 shell git remote -v # origin git@github.com:awdeorio/p2-cv.git (fetch) # origin git@github.com:awdeorio/p2-cv.git (push) Your local git may use master as the name for the initial branch, whereas GitHub expects it to be named main. \u56e0\u800c\u7528 -M \u6307\u4ee4\u6539\u540d shell git branch # master git branch -M main git branch # main \u628a\u5df2\u7ecf committed \u5230 local repo \u7684 commits push \u5230 remote repo. shell git push -u origin main \u786e\u8ba4\u5df2\u7ecf commit, \u5e76 verify commit log. ```shell $ git status # On branch main # Your branch is up to date with 'origin/main'. # nothing to commit, working tree clean git log # commit cefd2227510fa5e16e357198be19832b952d314e (HEAD -> main) # Author: Andrew DeOrio awdeorio@umich.edu # Date: Tue Aug 30 19:29:52 2022 -0400 # Initial commit ```","title":"5.3 \u521b\u5efa remote repo \u53ca connect local reop to remote"},{"location":"05-Version-Control-%28git%29.html#54-daily-work-flow-with-version-control","text":"\u67e5\u770b status\uff0c\u68c0\u67e5\u672c\u5730\u7684 branch \u662f\u5426\u5df2\u7ecf\u540c\u6b65\u66f4\u65b0\u4e86 server \u7684 change\uff0c\u4ee5\u53ca\u672c\u5730\u7684 change \u662f\u5426\u5df2\u7ecf commit \u548c push \u5230 server. shell git status Retrieve any changes from the server. shell git fetch git rebase Make changes to files. shell git add SOME_FILE git commit -m \"Short description goes here\" Push changes to GitHub server. shell git push","title":"5.4 Daily work flow with version control"},{"location":"05-Version-Control-%28git%29.html#55-version-control-for-a-team","text":"","title":"5.5 Version Control For a Team"},{"location":"05-Version-Control-%28git%29.html#551-collaborator","text":"\u800c\u540e\uff1a GitHub sends a confirmation email to your partner. Your partner clicks accept. Your partner creates an SSH key or a GitHub Personal Access Token. Your partner clone the remote repo on their own local machine using the same remote URL that you do. shell git clone https://github.com/awdeorio/p2-cv.git","title":"5.5.1 \u6dfb\u52a0 Collaborator"},{"location":"05-Version-Control-%28git%29.html#552-conflict","text":"The following text is copied from a helpful GitHub article . When you perform a git rebase operation, you\u2019re typically moving commits around. Because of this, you might get into a situation where a merge conflict is introduced. That means that two of your commits modified the same line in the same file, and Git doesn\u2019t know which change to apply. \u7b80\u5355\u6765\u8bf4\u5c31\u662f merge conflict \u53d1\u751f\u4e86. \u56e0\u4e3a\u4f60\u4eec\u90fd commit \u4e86\uff0c\u4f46\u662f\u4f60\u8fd8\u6ca1\u6709 fetch \u5bf9\u65b9\u7684 commit \u5c31 commit \u4e86. \u8fd9\u4e2a\u65f6\u5019\u4f60\u5e94\u8be5\u9009\u62e9 merge \u4e00\u4e2a branch. \u53ef\u4ee5\u76f4\u63a5\u5728 Github Desktop \u8fdb\u884c\u64cd\u4f5c. git merge BRANCH-NAME","title":"5.5.2 \u89e3\u51b3 Conflict"},{"location":"05-Version-Control-%28git%29.html#553-rejected-pushes","text":"\u5982\u679c\u4f60\u4f7f\u7528 git push \u65f6 push \u88ab rejected error \u4e86\uff0c\u90a3\u5c31\u662f\u4f60\u7684 teammate made \u4e86\u4e00\u4e2a commit. \u8fd9\u4e2a\u65f6\u5019\u5f88\u7b80\u5355\uff0c\u5148 fetch \u518d push.","title":"5.5.3 rejected pushes"},{"location":"05-Version-Control-%28git%29.html#56","text":"","title":"5.6 \u6ce8\u610f\u4e8b\u9879"},{"location":"05-Version-Control-%28git%29.html#561-commit","text":"\u6bd4\u5982\uff1a git commit -m \"Added README\" git status commit \u4e00\u4e2a change \u65f6\u5e94\u5907\u6ce8\u6765\u8868\u793a\u505a\u4e86\u4ec0\u4e48.","title":"5.6.1 \u6dfb\u52a0 commit \u65f6\u7684\u6587\u5b57\u5907\u6ce8"},{"location":"05-Version-Control-%28git%29.html#562-readmemd","text":"\u5e94\u8be5\u5728 repo \u4e2d\u6dfb\u52a0\u4e00\u4e2a README.md \u6587\u4ef6\u6765\u5199\u8fd9\u4e2a repo \u7684 instructions and descriptions. touch README.md git add README.md git commit -m \"Added README\" git status","title":"5.6.2 README.md \u6587\u4ef6"},{"location":"05-Version-Control-%28git%29.html#563-commit","text":"git diff 1.cpp \u4f60\u53ef\u4ee5\u901a\u8fc7 diff \u547d\u4ee4\u67e5\u770b the last clean committed version of the file.","title":"5.6.3 \u770b commit \u7684\u5185\u5bb9"},{"location":"05-Version-Control-%28git%29.html#564","text":"\u9996\u5148\u5728 Github \u91cc\u9762\u5220\u9664 repository. \u7136\u540e\u5220\u9664 .git \u8fd9\u4e2a hidden file \u4ee5\u53ca .gitignore . pwd # /Users/awdeorio/Developer/eecs280/p2-cv rm -rf .git/ .gitignore ls -A git status # fatal: Not a git repository (or any of the parent directories): .git","title":"5.6.4 \u5220\u5e93"},{"location":"06-Text-Editors-%28emacs%29.html","text":"8 Text Editors 8.1 Installation and Start & Quit 8.1.1 \u5b89\u88c5 emacs 8.1.2 \u542f\u52a8 emacs 8.1.3 Short-cut \u4fdd\u5b58\u4e0e\u5173\u95ed emacs 8.2 Customize Key binding \u81ea\u5b9a\u4e49\u6309\u952e 8.2.1 Basic: \u7f16\u8f91 init \u6587\u4ef6 8.2.2 \u91cd\u7f6e\u6240\u6709configuration 8.2.3 \u76f4\u63a5\u5728 Emac \u4e2d\u521b\u5efa\u6587\u4ef6 8.3 Pro-tips 8.3.1 Auto-Complete 8.3.2 Company Mode 8.3.3 \u6dfb\u52a0 Emacs Shortcut term 8.3.4 Editing remotely with TRAMP 8.3.5 Text-only mode 8 Text Editors Emacs is an extensible, customizable, free, text editor. \u5b83\u6709\u4e00\u4e2a IDE mode \u80fd\u591f\u4f7f\u7528 gdb and lldb . \u638c\u63e1 Emacs \u53ef\u4ee5\u8ba9\u4f60 edit code very quickly. Reasons to learn Emacs: Endlessly customizable. key bindings \u5feb\u901f\u7f16\u8f91\u4ee3\u7801. \u5177\u6709 IDE \u7279\u6027\u8fd8 with zero project setup. \u53ef\u9009\u62e9 text-only mod, \u9002\u5408 remote servers Emacs keyboard shortcuts work in many places: command line, GDB prompt, LLDB prompt, Xcode (optional), Visual Studio (optional) 8.1 Installation and Start & Quit 8.1.1 \u5b89\u88c5 emacs \u5b89\u88c5 brew install --cask emacs # macOS sudo apt install emacs # Windows/WSL, Linux \u786e\u8ba4 compiler \u7248\u672c g++ --version # macOS Apple clang version 13.1.6 (clang-1316.0.21.2.5) $ lldb --version # macOS Apple Swift version 5.6.1 (swiftlang-5.6.0.323.66 clang-1316.0.20.12) $ g++ --version # WSL/Linux g++ (GCC) 8.5.0 20210514 $ gdb --version # WSL/Linux GNU gdb (GDB) 8.1.2 \u542f\u52a8 emacs \u542f\u52a8 emacs: emacs \u5728\u540e\u53f0\u542f\u52a8 Emacs\uff0c\u4ee5\u4fbf\u7ee7\u7eed\u4f7f\u7528terminal: emacs & 8.1.3 Short-cut \u4fdd\u5b58\u4e0e\u5173\u95ed emacs \u4fdd\u5b58\uff1a C-x C-s C \u8868\u793a control \u952e. \u8fd9\u91cc\u7684\u610f\u601d\u662f\u6309\u4f4f C \uff0c\u800c\u540e\u6309\u4f4f x \u800c\u677e\u5f00\uff0c\u800c\u540e\u6309\u4f4f s \u800c\u677e\u5f00\uff0c\u6700\u540e\u677e\u5f00 C . \u5173\u95ed\uff1a C-x C-c \u6309\u4f4f C \uff0c\u800c\u540e\u6309\u4f4f x \u800c\u677e\u5f00\uff0c\u800c\u540e\u6309\u4f4f c \u800c\u677e\u5f00\uff0c\u6700\u540e\u677e\u5f00 C . 8.2 Customize Key binding \u81ea\u5b9a\u4e49\u6309\u952e 8.2.1 Basic: \u7f16\u8f91 init \u6587\u4ef6 \u901a\u8fc7\u4e0b\u9762\u8fd9\u4e2a\u6307\u4ee4\u53ef\u4ee5\u6253\u5f00 emacs \u7684 init \u6587\u4ef6. emacs ~/.emacs.d/init.el \u7136\u540e\u5f00\u59cb\u7f16\u8f91 init.el \u6587\u4ef6. \u6ce8\u610f\u8fd9\u4e2a\u6587\u672c\u683c\u5f0f\u4e2d ; \u5c31\u662f\u6ce8\u91ca\u7684\u610f\u601d. \u5bf9\u4e8e Mac \u800c\u8a00\uff0c\u5c06 Command \u6620\u5c04\u5230 Meta\uff0c\u5c06 Option \u6620\u5c04\u5230 Super \u66f4\u7b26\u5408\u4eba\u4f53\u5de5\u7a0b\u5b66. ;; macOS modifier keys (setq mac-command-modifier 'meta) ; Command == Meta (setq mac-option-modifier 'super) ; Option == Super basic customization ``` ;; Don't show a startup message (setq inhibit-startup-message t) ;; Show line and column numbers (setq line-number-mode t) (setq column-number-mode t) ;; Show syntax highlighting (global-font-lock-mode t) ;; Highlight marked regions (setq-default transient-mark-mode t) ;; Parentheses (electric-pair-mode 1) ; automatically close parentheses, etc. (show-paren-mode t) ; show matching parentheses ;; Smooth scrolling (one line at a time) (setq scroll-step 1) ;; Tab settings: 2 spaces. See also: language-specific customizations below. (setq-default indent-tabs-mode nil) (setq tab-width 2) ;; Easier buffer switching (global-set-key \"\\C-x\\C-b\" 'electric-buffer-list) ``` package manager automates package installation and configuration. ``` ;; Configure built in package manager (require 'package) (package-initialize) (add-to-list 'package-archives '(\"melpa\" . \"https://melpa.org/packages/\")) (add-to-list 'package-archives '(\"gnu\" . \"https://elpa.gnu.org/packages/\")) ;; Install use-package ;; https://github.com/jwiegley/use-package (when (not (package-installed-p 'use-package)) (package-refresh-contents) (package-install 'use-package)) (eval-when-compile (require 'use-package)) ``` undo/redo ;; More intuitive undo/redo. M-_ undo, C-M-_ redo (use-package undo-tree :config (global-undo-tree-mode) (global-set-key \"\\C-\\M-_\" 'redo) :ensure t :defer t ) C/C++ ``` ;; Intellisense syntax checking ;; http://www.flycheck.org/en/latest/ (use-package flycheck :config ;; enable in all modes (global-flycheck-mode) ;; C++17 (add-hook 'c++-mode-hook (lambda () (setq flycheck-clang-language-standard \"c++17\"))) :ensure t :defer t ) ;; C and C++ programming. Build with C-c m. Rebuild with C-c c. Put ;; this in c-mode-base-map because c-mode-map, c++-mode-map, and so ;; on, inherit from it. (add-hook 'c-initialization-hook (lambda () (define-key c-mode-base-map (kbd \"C-c m\") 'compile))) (add-hook 'c-initialization-hook (lambda () (define-key c-mode-base-map (kbd \"C-c c\") 'recompile))) (setq-default c-basic-offset tab-width) ; indentation (add-to-list 'auto-mode-alist '(\"\\.h$\" . c++-mode)) ; assume C++ for .h files ``` integrated debugging \u5982\u679c\u662f wsl \u5219\u628a\u8fd9\u91cc\u7684 lldb \u6362\u6210 gdb (use-package realgud :ensure t ) (use-package realgud-lldb :ensure t ) (\u4f7f\u7528debug: M-x gud-gdb for WSL/Linux, M-x realgud--lldb for mac) 8.2.2 \u91cd\u7f6e\u6240\u6709configuration \u91cd\u5f00\u547d\u4ee4\uff1a rm -rf ~/.emacs ~/.emacs.d/ 8.2.3 \u76f4\u63a5\u5728 Emac \u4e2d\u521b\u5efa\u6587\u4ef6 emacs 1.cpp 8.3 Pro-tips 8.3.1 Auto-Complete M + / \u53ef\u4ee5\u63d0\u4f9b C++ \u8bed\u53e5\u7684 auto complete. 8.3.2 Company Mode \u6dfb\u52a0\u8fd9\u4e2a\u5230 init.el ;; Autocomplete for code ;; Company docs: https://company-mode.github.io/ ;; Company TNG: https://github.com/company-mode/company-mode/issues/526 (use-package company :config (company-tng-configure-default) ; use default configuration (global-company-mode) :ensure t :defer t ; lazy loading ) 8.3.3 \u6dfb\u52a0 Emacs Shortcut term e () { emacs \"$@\" & } \u6dfb\u52a0\u8fd9\u4e2a\u5230 ~/.bash_profile / ~/.zshrc \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u4e00\u4e2a e \u6765\u6307\u4ee3 emacs e stats.cpp 8.3.4 Editing remotely with TRAMP Emacs TRAMP mode lets you edit a file on a remote server using a local GUI window. Configure Emacs TRAMP mode to use SSH multiplexing. Add this to your ~/.emacs.d/init.el . (use-package tramp :config (setq tramp-default-method \"ssh\") (setq tramp-ssh-controlmaster-options (concat \"-o ControlMaster auto \" \"-o ControlPath ~/.ssh/socket-%%C \" )) (setq tramp-use-ssh-controlmaster-options nil) :defer 1 ; lazy loading ) SSH into your remote server, CAEN Linux in this example. This will set up an SSH multiplexing connection. ssh login.engin.umich.edu ... In Emacs, open the file /ssh:login.engin.umich.edu:main.cpp . Recall C-x C-f is find-file . Tab completion works in the minibuffer. You\u2019re now editing a file main.cpp on a remote server. ssh login.engin.umich.edu hostname # ...caen-vnc-vm05.engin.umich.edu cd p1-stats tmux new -s shared emacs -nw main.cpp Bob connects to the same remote server that Alice did. He connects to Alice\u2019s tmux session named shared . She\u2019s already running Emacs, so he sees her Emacs session. ssh caen-vnc-vm05.engin.umich.edu tmux attach -t shared 8.3.5 Text-only mode If you\u2019re on a remote server without a GUI, you can use Emacs in text-only mode. The -nw option stands for \u201cno window\u201d. emacs -nw","title":"Overview"},{"location":"06-Text-Editors-%28emacs%29.html#8-text-editors","text":"Emacs is an extensible, customizable, free, text editor. \u5b83\u6709\u4e00\u4e2a IDE mode \u80fd\u591f\u4f7f\u7528 gdb and lldb . \u638c\u63e1 Emacs \u53ef\u4ee5\u8ba9\u4f60 edit code very quickly. Reasons to learn Emacs: Endlessly customizable. key bindings \u5feb\u901f\u7f16\u8f91\u4ee3\u7801. \u5177\u6709 IDE \u7279\u6027\u8fd8 with zero project setup. \u53ef\u9009\u62e9 text-only mod, \u9002\u5408 remote servers Emacs keyboard shortcuts work in many places: command line, GDB prompt, LLDB prompt, Xcode (optional), Visual Studio (optional)","title":"8 Text Editors"},{"location":"06-Text-Editors-%28emacs%29.html#81-installation-and-start-quit","text":"","title":"8.1 Installation and Start &amp; Quit"},{"location":"06-Text-Editors-%28emacs%29.html#811-emacs","text":"\u5b89\u88c5 brew install --cask emacs # macOS sudo apt install emacs # Windows/WSL, Linux \u786e\u8ba4 compiler \u7248\u672c g++ --version # macOS Apple clang version 13.1.6 (clang-1316.0.21.2.5) $ lldb --version # macOS Apple Swift version 5.6.1 (swiftlang-5.6.0.323.66 clang-1316.0.20.12) $ g++ --version # WSL/Linux g++ (GCC) 8.5.0 20210514 $ gdb --version # WSL/Linux GNU gdb (GDB)","title":"8.1.1 \u5b89\u88c5 emacs"},{"location":"06-Text-Editors-%28emacs%29.html#812-emacs","text":"\u542f\u52a8 emacs: emacs \u5728\u540e\u53f0\u542f\u52a8 Emacs\uff0c\u4ee5\u4fbf\u7ee7\u7eed\u4f7f\u7528terminal: emacs &","title":"8.1.2 \u542f\u52a8 emacs"},{"location":"06-Text-Editors-%28emacs%29.html#813-short-cut-emacs","text":"\u4fdd\u5b58\uff1a C-x C-s C \u8868\u793a control \u952e. \u8fd9\u91cc\u7684\u610f\u601d\u662f\u6309\u4f4f C \uff0c\u800c\u540e\u6309\u4f4f x \u800c\u677e\u5f00\uff0c\u800c\u540e\u6309\u4f4f s \u800c\u677e\u5f00\uff0c\u6700\u540e\u677e\u5f00 C . \u5173\u95ed\uff1a C-x C-c \u6309\u4f4f C \uff0c\u800c\u540e\u6309\u4f4f x \u800c\u677e\u5f00\uff0c\u800c\u540e\u6309\u4f4f c \u800c\u677e\u5f00\uff0c\u6700\u540e\u677e\u5f00 C .","title":"8.1.3 Short-cut \u4fdd\u5b58\u4e0e\u5173\u95ed emacs"},{"location":"06-Text-Editors-%28emacs%29.html#82-customize-key-binding","text":"","title":"8.2 Customize Key binding \u81ea\u5b9a\u4e49\u6309\u952e"},{"location":"06-Text-Editors-%28emacs%29.html#821-basic-init","text":"\u901a\u8fc7\u4e0b\u9762\u8fd9\u4e2a\u6307\u4ee4\u53ef\u4ee5\u6253\u5f00 emacs \u7684 init \u6587\u4ef6. emacs ~/.emacs.d/init.el \u7136\u540e\u5f00\u59cb\u7f16\u8f91 init.el \u6587\u4ef6. \u6ce8\u610f\u8fd9\u4e2a\u6587\u672c\u683c\u5f0f\u4e2d ; \u5c31\u662f\u6ce8\u91ca\u7684\u610f\u601d. \u5bf9\u4e8e Mac \u800c\u8a00\uff0c\u5c06 Command \u6620\u5c04\u5230 Meta\uff0c\u5c06 Option \u6620\u5c04\u5230 Super \u66f4\u7b26\u5408\u4eba\u4f53\u5de5\u7a0b\u5b66. ;; macOS modifier keys (setq mac-command-modifier 'meta) ; Command == Meta (setq mac-option-modifier 'super) ; Option == Super basic customization ``` ;; Don't show a startup message (setq inhibit-startup-message t) ;; Show line and column numbers (setq line-number-mode t) (setq column-number-mode t) ;; Show syntax highlighting (global-font-lock-mode t) ;; Highlight marked regions (setq-default transient-mark-mode t) ;; Parentheses (electric-pair-mode 1) ; automatically close parentheses, etc. (show-paren-mode t) ; show matching parentheses ;; Smooth scrolling (one line at a time) (setq scroll-step 1) ;; Tab settings: 2 spaces. See also: language-specific customizations below. (setq-default indent-tabs-mode nil) (setq tab-width 2) ;; Easier buffer switching (global-set-key \"\\C-x\\C-b\" 'electric-buffer-list) ``` package manager automates package installation and configuration. ``` ;; Configure built in package manager (require 'package) (package-initialize) (add-to-list 'package-archives '(\"melpa\" . \"https://melpa.org/packages/\")) (add-to-list 'package-archives '(\"gnu\" . \"https://elpa.gnu.org/packages/\")) ;; Install use-package ;; https://github.com/jwiegley/use-package (when (not (package-installed-p 'use-package)) (package-refresh-contents) (package-install 'use-package)) (eval-when-compile (require 'use-package)) ``` undo/redo ;; More intuitive undo/redo. M-_ undo, C-M-_ redo (use-package undo-tree :config (global-undo-tree-mode) (global-set-key \"\\C-\\M-_\" 'redo) :ensure t :defer t ) C/C++ ``` ;; Intellisense syntax checking ;; http://www.flycheck.org/en/latest/ (use-package flycheck :config ;; enable in all modes (global-flycheck-mode) ;; C++17 (add-hook 'c++-mode-hook (lambda () (setq flycheck-clang-language-standard \"c++17\"))) :ensure t :defer t ) ;; C and C++ programming. Build with C-c m. Rebuild with C-c c. Put ;; this in c-mode-base-map because c-mode-map, c++-mode-map, and so ;; on, inherit from it. (add-hook 'c-initialization-hook (lambda () (define-key c-mode-base-map (kbd \"C-c m\") 'compile))) (add-hook 'c-initialization-hook (lambda () (define-key c-mode-base-map (kbd \"C-c c\") 'recompile))) (setq-default c-basic-offset tab-width) ; indentation (add-to-list 'auto-mode-alist '(\"\\.h$\" . c++-mode)) ; assume C++ for .h files ``` integrated debugging \u5982\u679c\u662f wsl \u5219\u628a\u8fd9\u91cc\u7684 lldb \u6362\u6210 gdb (use-package realgud :ensure t ) (use-package realgud-lldb :ensure t ) (\u4f7f\u7528debug: M-x gud-gdb for WSL/Linux, M-x realgud--lldb for mac)","title":"8.2.1 Basic: \u7f16\u8f91 init \u6587\u4ef6"},{"location":"06-Text-Editors-%28emacs%29.html#822-configuration","text":"\u91cd\u5f00\u547d\u4ee4\uff1a rm -rf ~/.emacs ~/.emacs.d/","title":"8.2.2 \u91cd\u7f6e\u6240\u6709configuration"},{"location":"06-Text-Editors-%28emacs%29.html#823-emac","text":"emacs 1.cpp","title":"8.2.3 \u76f4\u63a5\u5728 Emac \u4e2d\u521b\u5efa\u6587\u4ef6"},{"location":"06-Text-Editors-%28emacs%29.html#83-pro-tips","text":"","title":"8.3 Pro-tips"},{"location":"06-Text-Editors-%28emacs%29.html#831-auto-complete","text":"M + / \u53ef\u4ee5\u63d0\u4f9b C++ \u8bed\u53e5\u7684 auto complete.","title":"8.3.1 Auto-Complete"},{"location":"06-Text-Editors-%28emacs%29.html#832-company-mode","text":"\u6dfb\u52a0\u8fd9\u4e2a\u5230 init.el ;; Autocomplete for code ;; Company docs: https://company-mode.github.io/ ;; Company TNG: https://github.com/company-mode/company-mode/issues/526 (use-package company :config (company-tng-configure-default) ; use default configuration (global-company-mode) :ensure t :defer t ; lazy loading )","title":"8.3.2 Company Mode"},{"location":"06-Text-Editors-%28emacs%29.html#833-emacs-shortcut-term","text":"e () { emacs \"$@\" & } \u6dfb\u52a0\u8fd9\u4e2a\u5230 ~/.bash_profile / ~/.zshrc \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u4e00\u4e2a e \u6765\u6307\u4ee3 emacs e stats.cpp","title":"8.3.3 \u6dfb\u52a0 Emacs Shortcut term"},{"location":"06-Text-Editors-%28emacs%29.html#834-editing-remotely-with-tramp","text":"Emacs TRAMP mode lets you edit a file on a remote server using a local GUI window. Configure Emacs TRAMP mode to use SSH multiplexing. Add this to your ~/.emacs.d/init.el . (use-package tramp :config (setq tramp-default-method \"ssh\") (setq tramp-ssh-controlmaster-options (concat \"-o ControlMaster auto \" \"-o ControlPath ~/.ssh/socket-%%C \" )) (setq tramp-use-ssh-controlmaster-options nil) :defer 1 ; lazy loading ) SSH into your remote server, CAEN Linux in this example. This will set up an SSH multiplexing connection. ssh login.engin.umich.edu ... In Emacs, open the file /ssh:login.engin.umich.edu:main.cpp . Recall C-x C-f is find-file . Tab completion works in the minibuffer. You\u2019re now editing a file main.cpp on a remote server. ssh login.engin.umich.edu hostname # ...caen-vnc-vm05.engin.umich.edu cd p1-stats tmux new -s shared emacs -nw main.cpp Bob connects to the same remote server that Alice did. He connects to Alice\u2019s tmux session named shared . She\u2019s already running Emacs, so he sees her Emacs session. ssh caen-vnc-vm05.engin.umich.edu tmux attach -t shared","title":"8.3.4 Editing remotely with TRAMP"},{"location":"06-Text-Editors-%28emacs%29.html#835-text-only-mode","text":"If you\u2019re on a remote server without a GUI, you can use Emacs in text-only mode. The -nw option stands for \u201cno window\u201d. emacs -nw","title":"8.3.5 Text-only mode"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html","text":"7 Foundations 7.1 Machine Model \u673a\u5668\u6a21\u578b 7.1.1 Storage Duration 7.1.2 Reference sematics and Value sematics \u5f15\u7528\u8bed\u4e49\u4e0e\u503c\u8bed\u4e49 7.1.3 Compile time \u548c Runtime 7.2 Function Calls and the Call Stack 7.2.1 Activation Record and stack \u6fc0\u6d3b\u8bb0\u5f55\u4e0e\u6808 7.2.2 Function Call \u7684\u8fc7\u7a0b 7.2.3 Activation Record (Stack Frame) \u7684\u8fd0\u884c\u4f8b 7.2.4 pass-by-reference function \u7684 stack frame \u8fd0\u884c\u4f8b 7.3 Procedural Abstraction \u8fc7\u7a0b\u62bd\u8c61\u5316 7.3.1 Interfaces \u548c implementations 7.4 Unit Testing 7.4.1 Testing \u7684\u7c7b\u578b 7.4.2 Test Cases \u7684\u7c7b\u578b 7.4.3 Unit-Test Framework \u6559\u7a0b 7.4.4 Framework macro\u63d0\u4f9b\u7684\u7279\u6b8a Assert \u51fd\u6570 7 Foundations \u8fd9\u4e00\u8bb2\u662f recap \u4ee5\u524d\u5b66\u8fc7\u7684\u5185\u5bb9\u5e76\u4ecb\u7ecd\u4e00\u4e9b\u66f4\u52a0 rigorous \u7684\u6982\u5ff5. 7.1 Machine Model \u673a\u5668\u6a21\u578b \u4e00\u4e2a name(\u540d\u79f0) \u6307 some entity such as a variable, function, or type. \u4e00\u4e2a varibale(\u53d8\u91cf) \u662f\u4e00\u4e2a\u6307\u4ee3 memory \u4e2d\u7684\u4e00\u4e2a object \u7684 name. (variable \u5c31\u662f\u4e00\u79cd name\uff01) \u4e00\u4e2a name \u5177\u6709\u5b83\u7684 scope(\u4f5c\u7528\u57df) \uff0cscope \u51b3\u5b9a\u4e86\u4ec0\u4e48\u533a\u57df\u7684 code \u80fd\u591f\u4f7f\u7528\u8be5 name \u6765\u6307\u4ee3\u5b83\u8868\u793a\u7684 entity. \u4e00\u4e2a declaration(\u58f0\u660e) \u5c31\u662f\u5f15\u5165\u4e00\u4e2a name \u7684\u884c\u4e3a\uff0c\u5e76\u4e14 declaration \u5904\u662f\u8be5 name \u7684 scope \u7684\u8d77\u70b9. \u4e00\u4e2a object(\u5bf9\u8c61) \u5c31\u662f memory \u4e2d\u7684 a piece of data. object is locateda at some address(\u5730\u5740) in the memory. object \u7684 lifetime(\u751f\u547d\u5468\u671f) \u5c31\u662f legal to use this object \u7684\u65f6\u671f. \u4e00\u4e2a object \u5728\u67d0\u4e2a\u65f6\u523b\u88ab create\uff0c\u5728\u67d0\u4e2a\u65f6\u523b\u88ab destroy\uff0c\u4ece\u88ab create \u5230\u88ab destroy \u7684\u8fd9\u6bb5\u65f6\u95f4\u5c31\u662f\u6211\u4eec\u80fd\u591f legallu use it \u7684\u65f6\u95f4. \u5b83\u53d6\u51b3\u4e8e\u8be5 object \u7684 storage duration . \u4e3a\u4e86\u5b66\u4e60 memory \u4e2d objects \u548c\u7528\u6765\u6307\u4ee3\u5b83\u4eec\u7684 variables \u7684\u53d8\u5316\uff0c\u6211\u4eec\u5f15\u5165 machine model . Machine Model \u5c31\u662f\u5bf9\u4e8e codes \u5982\u4f55 relate to program execution \u7684\u4e00\u4e2a\u63cf\u8ff0. \u6700\u57fa\u7840\u7684 machine model \u5c31\u662f\u628a memory \u770b\u505a\u4e00\u4e2a\u50cf array \u7684\u4e1c\u897f\u7684\u56fe. \u5982\u4e0b. \u4e4b\u540e\u4f1a\u6709\u66f4\u590d\u6742\u7684 machine model \u73b0\u5728\u6211\u4eec\u5f00\u59cb\u8bb2 object \u7684\u50a8\u5b58\u5468\u671f. 7.1.1 Storage Duration \u6709\u4e09\u79cd Storage Duration. static (\u4e5f\u53eb Global \u5168\u5c40\u5bf9\u8c61) : \u8fd9\u79cd object \u7684 lifetime \u662f the whole program. automatic (\u4e5f\u53eb Local \u5c40\u90e8\u5bf9\u8c61) : \u8fd9\u79cd object \u7684 lifetime \u662f\u88ab\u7ed1\u5b9a\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684 scope\uff0c\u6bd4\u5982\u67d0\u4e00\u6bb5\u4ee3\u7801\u5757. dynamic (\u52a8\u6001) : static \u548c automatic durations \u90fd\u662f\u7531 compiler \u63a7\u5236\u7684\uff0c\u800c dynamic duration \u5374\u662f\u7531 programmer explicitly create and control \u7684. \u672c\u8bfe\u7a0b\u5c06\u53ea\u8bb2 static \u548c automatic \u7684 object. Variable \u548c memory object \u5e76\u4e0d\u7b49\u540c. Variable \u662f\u548c source code \u76f8\u6302\u94a9\u7684\u6982\u5ff5\uff0c\u800c memory object \u5219\u662f\u548c runtime \u76f8\u6302\u94a9\u7684\u6982\u5ff5. \u540c\u4e00\u4e2a variable \u53ef\u4ee5\u5728\u4e0d\u540c\u65f6\u95f4\u6307\u4ee3\u4e0d\u540c\u7684 object. \u6bd4\u5982 a local variable in a functon that is called more than once. Dynamic storage duration \u7684 objects \u4e0d\u4f1a\u548c \u4e00\u4e2a variable \u5173\u8054 . 7.1.2 Reference sematics and Value sematics \u5f15\u7528\u8bed\u4e49\u4e0e\u503c\u8bed\u4e49 \u6211\u4eec\u90fd\u5df2\u7ecf\u5b66\u8fc7\u4e86 pass by reference \u548c pass by value \u7684\u533a\u522b. \u800c\u6211\u4eec\u77e5\u9053\uff0cC++ \u4e2d x = y \u4ec5\u8868\u793a modify the value of object x \u800c\u4e0d\u662f change which object x is referring to\uff0c \u5982\u679c\u4e00\u4e2a\u884c\u4e3a\u4e2d x = y \u8868\u793a\u524d\u8005\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5730\u65b9\u5c31\u53eb\u505a value semantics(\u503c\u8bed\u4e49) \uff1b\u800c\u5982\u679c\u8868\u793a\u540e\u8005\uff0c\u90a3\u4e48\u5c31\u53eb\u505a reference semantics(\u5f15\u7528\u8bed\u4e49) . \u56e0\u800c C++ \u8fd9\u4e2a\u8bed\u8a00\u7684\u9ed8\u8ba4\u662f value sematics. \u800c C++ \u4ec5\u5728 intializating new variable \u7684\u65f6\u5019\u652f\u6301 reference semantics . int x = 42; // initial x to refer to an object, and sets the initial value to 42. int y = 99; y = x; // assign the value of x:42 to y. x = 55; // y is not becoming 55, because they are still pointing at different objects. \u4f46\u662f\u5982\u679c\u5728 new variable name \u7684\u5de6\u4fa7\u52a0\u4e0a\u4e00\u4e2a ampersand (&) , \u90a3\u4e48\u5c31\u80fd\u591f\u628a\u8be5 name \u5173\u8054\u5230\u4e00\u4e2a\u73b0\u6709\u7684 object. \u6211\u4eec\u90fd\u77e5\u9053\uff0c\u8fd9\u4e2a\u7b26\u53f7\u53eb\u505a reference operator\uff08\u53d6\u5730\u5740\u8fd0\u7b97\u7b26\uff09\uff0c\u653e\u5728\u4e00\u4e2a\u4ee3\u8868\u67d0\u4e2a object \u7684 variable name \u5de6\u4fa7\uff0c\u53ef\u4ee5\u63d0\u53d6\u5b83\u6240\u4ee3\u8868\u7684 object \u7684 memory address \u6765\u5b58\u653e\u5728\u6307\u9488\u53d8\u91cf\u91cc\uff1b\u4f46\u662f\u5728 initialization \u7684\u65f6\u5019\u5982\u679c\u5728\u65b0 varible name \u7684\u5de6\u4fa7\u52a0\u4e0a &\uff0c\u5219\u5e76\u4e0d\u662f\u8868\u793a\u63d0\u53d6 address \u7684\u8fd0\u7b97\uff0c\u800c\u662f \u201c\u5c06\u6211\u4eec\u5de6\u8fb9\u8fd9\u4e2a\u65b0\u7684 varibale name\u5173\u8054\u5230\u73b0\u6709\u7684\u53f3\u8fb9\u8fd9\u4e2a variable name \u4ee3\u8868\u7684 object \u4e0a\u201d\uff0c\u901a\u4fd7\u800c\u8a00\u5c31\u662f\u7ed9\u5bf9\u8c61\u53d6\u4e2a\u65b0\u540d\u5b57 . \u8fd9\u5c31\u662f reference operator \u7684\u53e6\u4e00\u4e2a\u7528\u6cd5. \u8fd9\u4e2a\u7528\u6cd5\u548c\u5199\u51fd\u6570\u65f6 pass by reference \u7684\u7528\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u5373\u76f4\u63a5\u6307\u5411\u8fd9\u5757 address \u4e0a\u7684 object \u5bf9\u5176\u8fdb\u884c\u8d4b\u540d/\u8fd0\u7b97. int x = 42; int &y = x; //y\u548cx\u662f\u540c\u4e00\u4e2aobject, \u503c\u90fd\u662f42, y\u662f\u7ed9\u5b83\u8d77\u7684\u65b0\u540d\u5b57 x = 24; cout << y; //24, \u503c\u88ab\u6539\u53d8\u4e86 z = 3; y = z; //pass by value cout << x; //3, \u503c\u88ab\u6539\u53d8\u4e86 \u8fd9\u91cc\uff0cy \u548c x \u662f\u4e24\u4e2a variable\uff0c\u4f46\u662f\u4ed6\u4eec\u90fd\u548c\u540c\u4e00\u4e2a object associate\u4e86. \u56e0\u800c\u6539\u53d8\u5176\u4e2d\u4efb\u4f55\u4e00\u4e2a\u7684\u503c\uff0c\u53e6\u4e00\u4e2a\u4e5f\u4f1a\u6539\u53d8\uff0c\u4e0d\u5982\u8bf4 y \u548c x \u662f\u79f0\u547c\u8be5 object \u7684\u4e24\u4e2a\u540d\u5b57. \u5e76\u4e14 \u7531\u4e8eC++\u53ea\u652f\u6301\u5728 initialization \u65f6\u7684 reference semantics, a variable \u548c a memory object \u4e4b\u95f4\u7684 association can never be broken! (except when variable goes out of scope). \u4e5f\u5c31\u662f\u8bf4\u4f60\u4e00\u65e6 declare \u4e86\u4e00\u4e2a variable\uff0c\u90a3\u4e48\u5b83\u5c31\u548c\u4f60 declare \u65f6\u8ba9\u5b83 refer \u7684 object \u7ed1\u5b9a\u4e86\uff0c \u4f60\u65e0\u6cd5\u91cd\u65b0\u7ed9\u8fd9\u4e2a variable \u7ed1\u5b9a\u65b0\u7684 object\uff01 \u4f60\u4fee\u6539\u5b83\u5c31\u662f\u4fee\u6539\u8fd9\u4e2a object. \u800c\u5bf9\u4e8e\u5f53\u51fa\u4e86 scope \u4e4b\u540e\uff0c\u8fd9\u4e2a name \u5c31\u65e0\u6548\u4e86\uff0c\u6211\u4eec\u7684 object \u5c31\u5c11\u4e86\u4e00\u4e2a\u540d\u5b57. \u6bd4\u5982\u4e00\u4e2a\u51fd\u6570\u7684 pass by reference \u7684\u53c2\u6570\uff0c\u5c31\u662f\u5bf9\u4e00\u4e2a\u53d8\u91cf\u53d6\u7684\u4e00\u4e2a\u65b0\u540d\u5b57\uff0c\u800c\u5728 main() \u51fd\u6570\u8fd0\u884c\u8fc7\u4e86\u8fd9\u4e2a\u51fd\u6570\u4e4b\u540e\uff0c\u8fd9\u4e2a\u540d\u5b57\u5c31\u5931\u53bb\u4e86. \u56e0\u800c pass-by-reference parameters \u4e5f\u53eb\u505a\u539f object \u7684\u4e00\u4e2a alias (\u522b\u540d)\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u6211\u4eec\u5728 Windows \u684c\u9762\u521b\u5efa\u7684\u5feb\u6377\u65b9\u5f0f. 7.1.3 Compile time \u548c Runtime \u4e00\u4e2a\u7a0b\u5e8f\u9996\u5148\u8981 compile\uff0c\u5176\u6b21\u518d execute (run). Compile \u4e00\u4e2a\u7a0b\u5e8f\u662f\u9700\u8981\u65f6\u95f4\u7684. \u8fd9\u6bb5\u65f6\u95f4\u91cc compiler \u4f1a\u505a\u4e00\u4e0b\u7684\u4e8b\u60c5: observe variable declarations: \u89c2\u5bdf\u4ee3\u7801\u91cc variables \u7684 name, type, scope \u548c value. \u786e\u5b9a\u9700\u8981\u7ed9\u6bcf\u4e2a type \u7684 variables \u7684 size. \u6bd4\u5982\uff1a int \u9700\u8981 4 bytes double \u9700\u8981 8 bytes \u66f4\u590d\u6742\u7684 ADT: n bytes ( \u6ce8\u610f\uff1a\u4e00\u4e2a byte \u5c31\u662f 8 \u4e2a bits\uff0c\u4e00\u4e2a bit \u5b9e\u9645\u4e0a\u5c31\u662f binary digits\uff0c\u5c31\u662f\u4e00\u4e2a 0/1 \u7684\u4e8c\u8fdb\u5236\u6570 ) Compile time \u5c31\u662f Compiler compile \u4f60\u7684 codes \u7684\u8fd9\u6bb5\u65f6\u95f4. \u65e9\u5728 compile time\uff0ccompiler \u5c31\u4f1a\u51b3\u5b9a\u597d\u8fd9\u6bb5\u4ee3\u7801 \u9700\u8981\u591a\u5927\u7684 memory. \u800c runtime \u5c31\u662f\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u95f4. \u8fd9\u6bb5\u65f6\u95f4 compiled code \u88ab\u6267\u884c\uff0cvariables \u4f1a\u4ee5 objects \u7684\u5f62\u5f0f\u88ab\u50a8\u5b58\u5728 memory (RAM) \u91cc\uff0c\u5176\u5927\u5c0f\u5c31\u662f\u8fd9\u4e2a variable type \u7684\u5927\u5c0f. \uff08\u5f53\u7136 variable \u81ea\u8eab\u4e5f\u4f1a\u5360\u636e\u4e00\u5b9a\u5927\u5c0f\uff0c\u5c31\u6bd4\u5982\u4e24\u4e2a int variable \u90fd\u662f\u540c\u4e00\u4e2a object \u7684\u540d\u5b57\uff0c\u90a3\u4e48\u8fd9\u4e2a object \u5c31\u53ea\u6709 4 bytes\uff0c\u4f46\u662f\u5176\u5b9e\u8fd9\u4e24\u4e2a\u540d\u5b57\u4e5f\u5360\u636e\u4e86\u4e00\u70b9 memory \u4f7f\u5f97\u5b83\u4eec\u80fd\u88ab\u8bc6\u522b\u3002\u4f46\u8fd9\u79cd\u4e1c\u897f\u6211\u4eec\u5c31\u4e0d\u7ba1\u4e86\u3002\uff09 \u6240\u4ee5\u6211\u4eec\u8981\u6ce8\u610f\u7684\u6982\u5ff5\u662f\uff1a object \u53ea\u5728 runtime \u4ea7\u751f\uff0cvariable \u662f compile time \u5c31\u88ab\u8bc6\u522b\u4e86 \u3002 7.2 Function Calls and the Call Stack 7.2.1 Activation Record and stack \u6fc0\u6d3b\u8bb0\u5f55\u4e0e\u6808 \u521a\u624d\u6211\u4eec\u4ecb\u7ecd\u4e86\u6700\u57fa\u672c\u7684\u628a memory \u4e2d\u7684 object \u770b\u4f5c\u7c7b\u4f3c array \u5143\u7d20\u7684 machine model\uff0c\u800c\u73b0\u5728\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e2a\u66f4\u52a0 structured \u7684 machine model\uff0c\u5373\u88ab\u591a\u79cd\u9ad8\u7ea7\u8bed\u8a00\u7684 implementations \u4f7f\u7528\u7684\uff1a Stack-based memory management \uff08\u57fa\u4e8e\u6808\u7684\u5185\u5b58\u7ba1\u7406\uff09. \u5728\u5927\u591a\u6570\u9ad8\u7ea7\u8bed\u8a00\u7684 implementations \u4e2d\uff0c\u51fd\u6570\u8c03\u7528\u7684\u6570\u636e\u90fd\u96c6\u4e2d\u5b58\u50a8\u5728\u4e00\u4e2a activation record\uff08\u6fc0\u6d3b\u8bb0\u5f55\uff09 \u4e2d\uff0c activation record \u5c31\u662f\u7ed9\u51fd\u6570\u5206\u914d\u7684 memory\uff0c\u5206\u914d\u7ed9\u4e00\u4e2a\u51fd\u6570\u7684 memory \u5c31\u53eb\u505a \u5b83\u7684activation record \u5176\u4e2d\u5305\u542b\u51fd\u6570\u7684\u6240\u6709 parameters \u548c local variables\uff0ctemporary objects \u5373 return address\u7b49\uff0c\u800c\u672c\u8bfe\u7a0b\u4e2d\u6211\u4eec\u53ea\u8003\u8651 activation record \u4e2d\u7684 parameters \u548c local variables\uff0c\u5ffd\u7565\u5176\u4ed6\u6570\u636e. \u5728 stack-based memory management \u4e2d\uff0cactivation record \u88ab\u50a8\u5b58\u5728\u4e00\u4e2a\u53eb\u505a stack\uff08\u6808\uff09 \u7684 data structure \u4e2d. \u5f53\u521b\u5efa\u4e00\u6761 activation record \u540e\uff0c\u5b83\u5c31\u4f1a\u88ab\u653e\u5728 stack \u7684\u9876\u90e8 \uff0c\u800c \u7b2c\u4e00\u4e2a\u88ab\u9500\u6bc1\u7684 activation record \u5c31\u662f\u8fd9\u6761\u6700\u65b0\u88ab\u521b\u5efa\u51fa\u6765\u7684 activation record . \u8fd9\u5c31\u662f\u8457\u540d\u7684 last-in, first-out Behavior (LIFO\uff0c\u540e\u8fdb\u5148\u51fa\u884c\u4e3a) . \u7531\u4e8e activation record (more commonly)\u4e5f\u53eb\u505a stack frame\uff08\u6808\u5e27\uff09 . \u6240\u4ee5\u77e5\u9053\u4e86 activation record \u7684\u6982\u5ff5\u540e\uff0c\u6211\u4eec\u5c31\u5927\u6982\u77e5\u9053\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f\u7684\u4e00\u4e9b\u7c97\u7565\u7684\u6570\u636e\u5b58\u50a8\u65b9\u5f0f\u4e86. \u6bd4\u5982\u6211\u4eec\u7684 C++ \u7a0b\u5e8f\u603b\u662f\u4ece main() \u51fd\u6570\u5f00\u59cb\u7684\uff0c\u800c\u6240\u6709\u5728 main() \u51fd\u6570\u4e2d\u7684 local objects \u90fd\u5b58\u5728 main() \u7684 activation record \u4e2d\uff0c\u800c main() \u53c8\u8c03\u7528\u5176\u4ed6\u51fd\u6570\uff0c\u8fd0\u884c\u65f6\u5728\u6808\u9876\u4e3a\u8fd9\u4e9b\u51fd\u6570\u521b\u9020 activation record\uff0c\u800c\u521b\u9020\u7684 \u8fd9\u4e2a activation record \u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u5b83\u53ef\u80fd\u5b58\u50a8\u7684\u5c40\u90e8\u53d8\u91cf\u6570\u91cf. \u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a activation \u7684\u5927\u5c0f\u5e76\u4e0d\u662f\u81ea\u7531\u6539\u53d8\u7684\uff0c\u800c\u662f\u4ece\u5b83\u88ab\u521b\u5efa\u65f6\u5c31\u56fa\u5b9a\u597d\u7684\uff0c\u6839\u636e\u91cc\u9762\u7684 local variable \u6570\u91cf\u51b3\u5b9a\uff08\u6211\u4eec\u53ef\u80fd\u4f1a\u89c9\u5f97\u662f object \u6570\u91cf\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\uff0c\u800c\u662f local variable \u7684\u6570\u91cf\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u7406\u89e3\u57fa\u4e8e\u7b80\u5316\u6a21\u578b\uff0c\u5b9e\u9645\u4e0a\u4f5c\u4e3a reference \u7684 variable \u4e5f\u5360 memory\uff0c\u4f46\u662f\u662f user \u4e0d\u80fd\u63a5\u89e6\u7684.\uff09 7.2.2 Function Call \u7684\u8fc7\u7a0b \u6211\u4eec\u77e5\u9053\uff0cC++ \u7684\u7a0b\u5e8f\u5c31\u662f\u8fd0\u884c\u51fd\u6570. \u6700\u5f00\u59cb\u7684\u51fd\u6570\u5c31\u662f main() \uff1b main() \u4f1a call \u5176\u4ed6\u51fd\u6570\uff0c\u800c\u5176\u4ed6\u51fd\u6570\u53c8\u4f1a call \u5176\u4ed6\u51fd\u6570\uff1b\u8fd0\u884c\u5b8c main() \uff0c\u7a0b\u5e8f\u5c31\u7ed3\u675f\u4e86. \u6bcf\u4e00\u4e2a function call \u7684\u6d41\u7a0b\u6309\u7167\u4e0b\u9762\u8fd9\u4e2a\u8fc7\u7a0b\uff1a \u5f53 function \u8fd0\u884c\u5230\u5d4c\u5957\u5728\u91cc\u9762\u7684\u5176\u4ed6 function \u65f6\uff0cevaluate actual arguments to the function. Make a new and unique invocation of the called function. (1) Push a stack frame (2) Pass parameters \u6682\u505c original function \u7684\u8fd0\u884c \u8fd0\u884c called function\uff0c\u53ef\u80fd\u4f1a\u8fd4\u56de\u4e00\u4e9b\u503c (optional) \u8fd0\u884c called function \u7ed3\u675f\u540e\uff0c\u91cd\u65b0\u5728 original function left off \u7684\u5730\u65b9 resume. destroy called function \u7684 stack frame. \u6ce8\u610f\uff0c\u8fd9\u91cc\u4ece 3 \u5230 4 \u7684\u8fc7\u6e21\u88ab\u79f0\u4e3a\u4e00\u79cd active flow \uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8fc7\u7a0b\u662f code explictly \u544a\u8bc9 computer \u53bb\u8fd0\u884c\u54ea\u4e2a function\uff0c\u800c\u4ece\u7b2c 4 \u6b65\u5230\u7b2c 5 \u6b65\u7684\u8fc7\u6e21\u88ab\u79f0\u4e3a\u4e00\u79cd passive flow \uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8fc7\u7a0b\u7684 transfer of control \u5e76\u4e0d\u662f code \u544a\u8bc9 computer, \u800c\u662f computer \u5728\u8fd0\u884c stack frame \u7684\u8fc7\u7a0b\u4e2d\u81ea\u4e3b\u7684. 7.2.3 Activation Record (Stack Frame) \u7684\u8fd0\u884c\u4f8b \u4e3a\u4e86\u7406\u89e3\u7a0b\u5e8f\u8fd0\u884c\u7684\u6d41\u7a0b\uff0c\u6211\u4eec\u8003\u8651\u8fd9\u4e00\u4e2a\u5b8c\u6574\u7684\u7a0b\u5e8f\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u4f8b\u5b50\uff1a void bar(){ } void foo(){ bar(); } int main(){ foo(); } \u8fd9\u4e00\u7a0b\u5e8f\u90fd\u770b\u5f97\u51fa\u6765\uff0c\u662f main() \u51fd\u6570\u8c03\u7528 foo() \u8fd9\u4e2a\u51fd\u6570\uff0c\u800c foo() \u8fd9\u4e2a\u51fd\u6570\u5185\u90e8\u518d\u8c03\u7528 bar() \u8fd9\u4e2a\u51fd\u6570. \u8fd9\u4e2a\u8fc7\u7a0b\u5728 stack \u4e2d\u7684\u6837\u5b50\u662f\u8fd9\u6837\u7684\uff1a\uff08\u4e0d\u8bba\u54ea\u4e2a\u65b9\u5411\u90fd\u4e00\u6837\u7684\uff09 program \u4e00\u5f00\u59cb\u5c31\u4f1a\u8c03\u7528 main() \u51fd\u6570\uff0c\u56e0\u800c\u521b\u5efa\u4e00\u6761 main() \u51fd\u6570\u7684 activation record \u5e76\u653e\u5165\u6808\u9876\uff1b \u800c\u540e main() \u51fd\u6570\u8c03\u7528 foo() \u51fd\u6570\uff0c\u56e0\u800c\u521b\u9020\u4e00\u6761 foo() \u51fd\u6570\u7684 activation record \u5e76\u5165\u6808\uff0c\u653e\u5728\u6808\u9876\uff0c main() \u51fd\u6570\u7684\u4e0a\u9762\uff1b \u800c\u540e foo() \u51fd\u6570\u8c03\u7528 bar() \u51fd\u6570\uff0c\u540c\u6837\u521b\u9020 activation record \u5e76\u5165\u6808\u9876. \u6700\u91cc\u5c42\u7684 bar() \u51fd\u6570\u8fd0\u884c\u7ed3\u675f\uff0c\u4ece\u6808\u9876\u5148\u79fb\u9664\u5b83\u7684 activation record\uff1b \u800c\u540e foo() \u51fd\u6570\u8fd0\u884c\u5b8c\u6210\uff0c\u4ece\u6808\u9876\u79fb\u9664 activation record\uff1b main() \u51fd\u6570\u8fd0\u884c\u7ed3\u675f\uff0c\u6808\u88ab\u6e05\u7a7a. \u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u8fc7\u7a0b\uff0c\u73b0\u5728\u6211\u4eec\u52a0\u5165 variables \u6765\u8fdb\u4e00\u6b65\u7406\u89e3\uff0c\u770b\u7b2c\u4e8c\u4e2a\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\u7684\u4f8b\u5b50. int plus_one(int x){ return x + 1; } int plus_two(int x){ return plus_one(x + 1); } int main(){ int result = 0; result = plus_one(0); result = plus_two(result); cout << result; } program \u9996\u5148\u8c03\u7528 main() \u51fd\u6570\uff0c\u5e76\u5148\u58f0\u660e\u4e00\u4e2a local variable result \uff08\u5bf9\u5e94\u7684 object \u540c\u65f6\u88ab\u521b\u9020\uff0c\u5c31\u662f\u6211\u4eec\u521a\u624d\u8bf4\u7684\u4ec5\u5728 variable \u7684 initialization \u65f6\u7684 reference semantics\uff09\uff1b\u800c\u540e main() \u51fd\u6570\u8c03\u7528 plus_one() \u51fd\u6570\uff0c plus_one() \u751f\u6210\u5176 scope \u4e0b\u7684 local variable x \uff0c\u5c06\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684 main() \u51fd\u6570\u4e2d\u7684 local variable result \u7684\u503c pass \u7ed9\u81ea\u5df1\u7684 local variable x \uff1b\u800c\u540e plus_one() \u8fd0\u884c\u7ed3\u675f\u8fd4\u56de x \u7684\u503c\u52a0\u4e0a 1 \u5e76 assign \u7ed9 result \uff0c result \u7684\u503c\u66f4\u65b0\uff1b\u800c\u540e main() \u51fd\u6570\u53c8\u8fd0\u884c\u4e0b\u4e00\u4e2a\u51fd\u6570 plus_two() . \u800c\u8fd9\u4e00\u8fc7\u7a0b\u5728 stack \u4e2d\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u6d41\u7a0b\uff1a main() \u51fd\u6570\u88ab\u8c03\u7528\uff0c main() \u7684 activation record \u88ab\u521b\u5efa. main() \u51fd\u6570\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d local variable result \u88ab\u58f0\u660e\uff0c\u7559\u51fa memory \u4e2d\u7684\u4f4d\u7f6e\u5b58\u653e\u5bf9\u5e94\u7684 object\uff0c\u5177\u4f53\u6570\u636e\u4e3a int \u578b\u7684 1. plus_one() \u51fd\u6570\u88ab main() \u51fd\u6570\u8c03\u7528\uff0c\u521b\u5efa plus_one() \u7684 activation record. \u5728\u88ab\u8c03\u7528\u7684\u540c\u65f6\uff0c plus_one() \u51fd\u6570\u751f\u6210\u5728\u5b83\u7684 scope \u4e2d\u7684 local variable x \uff0c\u5e76\u901a\u8fc7\u51fd\u6570\u7684 pass by value\uff0c\u83b7\u53d6\u8c03\u7528\u5b83\u7684 main() \u51fd\u6570\u91cc\u7684 local variable result \u7684\u503c\uff0c\u5e76 pass \u7ed9\u81ea\u5df1\u7684 local variable x . plus_one() \u5bf9\u81ea\u5df1\u7684 local variable x \u8fdb\u884c\u52a0\u4e00\u7684\u64cd\u4f5c\uff0c\u8fd0\u884c\u7ed3\u675f\u65f6\u628a\u5b83\u7684\u503c\u4f5c\u4e3a\u51fd\u6570\u7684 return value\uff0creturn \u7ed9\u8c03\u7528\u81ea\u5df1\u7684 main() \u51fd\u6570. main() \u51fd\u6570\u83b7\u53d6 plus_one() \u7684 return \u503c\u7684\u540c\u65f6\uff0c\u628a\u5b83 assign \u7ed9 main() \u7684 local variable result . \u5728\u5b8c\u6210 return \u7684\u8fc7\u7a0b\u540e\uff0c plus_one() \u8fd0\u884c\u7ed3\u675f\u5e76\u6e05\u9664\u81ea\u5df1\u7684 activation record\uff0c\u5373\u51fa stack. \u73b0\u5728 stack \u4e2d\u53ea\u5269\u4e0b\u5728\u6808\u5e95\u7684 main() \u51fd\u6570\u7684 activation record. \u8fd9\u5c31\u662f\u4ece program \u5f00\u59cb\u8fd0\u884c\u4e00\u76f4\u5230 result = plus_one(0); \u8fd9\u4e00\u884c\u8fd0\u884c\u7ed3\u675f\u7684\u5168\u8fc7\u7a0b. \u73b0\u5728\u6765\u5230\u4e0b\u4e00\u884c result = plus_two(result); . \u4ece\u521a\u624d\u7684\u72b6\u6001\u5f00\u59cb. main() \u8c03\u7528 plus_two() \u51fd\u6570\uff0c plus_two() \u7684 activation record \u88ab\u521b\u5efa. \u6ce8\u610f\u5230\uff0c plus_two() \u7684 activation record \u5728 memory \u4e2d\u7684\u4f4d\u7f6e\u4f1a\u88ab\u5b89\u6392\u5230\u521a\u624d\u88ab\u6e05\u9664\u7684 plus_one() \u7684 activation record \u7684\u4f4d\u7f6e\u4e0a\uff01 plus_two() \u5728\u521b\u5efa activation record \u7684\u540c\u65f6\u4e5f\u4e00\u6837\u4ece main() \u4e2d\u83b7\u53d6 result \u7684\u503c\u5e76\u8d4b\u7ed9\u81ea\u5df1\u521d\u59cb\u7684 local variable x . plus_two() \u8c03\u7528 plus_one() \u51fd\u6570\uff0c\u521b\u5efa activation record\uff0c\u4f20\u53c2\uff0c\u628a\u81ea\u5df1\u7684local variable x \u4f20\u7ed9 plus_one \u7684 local variable x . \u8fd9\u91cc\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0 \u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u53d8\u91cf\u540d\u90fd\u53eb\u505a x \uff0c\u4f46\u662f\u8fd9\u5e76\u4e0d\u4f1a\u51b2\u7a81\uff0c\u56e0\u4e3a\u5b83\u4eec\u50a8\u5b58\u5728\u4e0d\u540c\u7684 activation record \u4e2d. \u5728 plus_one \u7684 scope \u4e2d x \u6307\u4ee3 plus_one \u4e2d\u7684 object\uff0c\u800c\u5728 plus_two \u7684 scope \u4e2d\u6307\u4ee3 plus_two \u4e2d\u7684 object. \u6240\u4ee5\u7a0b\u5e8f\u8bc6\u522b local variable name \u5176\u5b9e\u662f\u4ee5\u4e00\u4e2a activaion record \u4e3a\u5355\u4f4d\u7684\uff0c\u56e0\u7531 scope \u51b3\u5b9a\uff01\u591a\u4e2a activation record \u540c\u65f6\u5b58\u5728\u65f6\uff0c\u91cc\u9762\u53ef\u4ee5\u6709\u76f8\u540c\u7684\u5c40\u90e8\u53d8\u91cf\u540d\uff0c\u8fd9\u4e5f\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u8bf4\u7684\u4e00\u4e2a variable name \u7ed1\u5b9a\u4e86\u4e00\u4e2a object \u5c31\u4e0d\u80fd\u7ed1\u5b9a\u5176\u4ed6 object\u4e86\uff0c\u9664\u975e\u51fa scope. \u5f53\u7136\u6211\u4eec\u81ea\u7136\u800c\u7136\u5730\u60f3\u5230 global variable \u80af\u5b9a\u4e0d\u80fd\u8fd9\u6837. \u4e4b\u540e\u5404\u51fd\u6570\u4f9d\u6b21\u8fd0\u884c\u7ed3\u675f\u5e76\u6e05\u9664 activation record \u51fa\u6808. 7.2.4 pass-by-reference function \u7684 stack frame \u8fd0\u884c\u4f8b \u4e0a\u9762\u90fd\u662f\u53ea\u6709 pass by value \u7684 parameter \u7684\u51fd\u6570\uff0c\u73b0\u5728\u770b\u7b2c\u4e09\u4e2a\u4f8b\u5b50\uff1a\u4e00\u4e2a\u6709 pass by reference \u7684 parameter \u7684\u51fd\u6570. Pass-by-reference \u5c31\u662f\u5728\u521b\u5efa\u521d\u59cb variable \u65f6\u7528\u4e86 reference semantics. \u5b9e\u9645\u4e0a\uff0c**\u51fd\u6570\u4e2d\u4f20\u53c2\u5c31\u662f\u7528\u7b49\u53f7\u8d4b\u503c\uff01\u53ea\u4e0d\u8fc7\u8fd9\u4e00\u6b65\u53ef\u4ee5\u8de8\u57df activation record \u5230\u8c03\u7528\u672c\u51fd\u6570\u7684\u53e6\u4e00\u4e2a\u51fd\u6570\u7684 activation record \u4e2d\u53bb. \u6bd4\u5982 void swap(int &x, int &y); \u800c\u6211\u4eec\u5728 main() \u51fd\u6570\u91cc call \u5b83\uff0c swap(x,y); . \u8fd9\u5c31\u662f\u7b49\u4e8e int &x = x; , int &y = y , \u7531\u4e8e\u662f\u8de8 scope \u7684\u6240\u4ee5\u8fd9\u91cc\u540c\u4e00\u4e2a variable x \u53ef\u4ee5\u6307\u4ee3\u4e24\u4e2a\u4e0d\u540c\u7684 object\uff0c\u5b8c\u6210\u8fd9\u4e2a\u8d4b\u503c\u884c\u4e3a. ** \u6309\u7167\u6211\u4eec\u4e4b\u524d\u5b66\u4e60\u7684\uff0c int &a = b \u5c31\u662f\u7ed9 b \u6307\u4ee3\u7684 object \u53d6\u53e6\u4e00\u4e2a\u540d\u5b57\u53eb\u505a a \uff0c\u56e0\u800c pass-by-reference \u7684 local variable \u5c31\u662f\u7ed9\u8c03\u7528\u81ea\u5df1\u7684\u51fd\u6570\u4f20\u8fc7\u6765\u7684\u5b83\u7684\u4f5c\u4e3a\u53c2\u6570\u7684 local variable \u6240\u6307\u4ee3\u7684 object \u53d6\u7684\u4e00\u4e2a\u65b0\u540d\u5b57. \u8fd9\u4e00\u4e2a\u4f20\u53c2\u8fc7\u7a0b\u662f\u8de8 activation record \u7684. \u6211\u4eec\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50. void swap(int &x, int &y){ int tmp = x; x = y; y = tmp; } int main(){ int a = 3; int b = 7; cout << a << \",\" << b << endl; //3,7 swap(a, b); cout << a << \",\" << b << endl; //7,3 } \u6211\u4eec\u6765\u7efc\u5408\u521a\u624d\u5bf9 & \u7684\u5b66\u4e60\u4ee5\u53ca\u5bf9 call stack \u7684\u5b66\u4e60\u6765\u770b\u8fd9\u4e00\u6d41\u7a0b\uff1a \u7a0b\u5e8f\u521b\u5efa main() \u51fd\u6570\u7684 activation record\uff0c\u5927\u5c0f\u5305\u542b\u4e24\u4e2a local variable\u7684 space. main() \u51fd\u6570\u8fd0\u884c. \u8fd0\u884c\u5230 swap() \u65f6\u4e3a\u5176\u521b\u5efa activation record\uff0c\u5927\u5c0f\u5305\u542b\u4e09\u4e2a local variable\uff0c\u5176\u4e2d\u4e24\u4e2a\u662f main() \u7684 local variable a \u548c b \u7684 reference\uff0c\u53e6\u5916\u4e00\u4e2a tmp refer to \u81ea\u5df1\u7684\u4e00\u4e2a temporary object. swap() \u8fdb\u884c\u6211\u4eec\u719f\u6089\u7684\u53d8\u91cf\u4ea4\u6362\u64cd\u4f5c. \u8fd9\u91cc x \u548c y \u90fd\u662f\u5f15\u7528\u53c2\u6570\uff0c\u4f46\u6211\u4eec\u8981\u8bb0\u5f97\u6211\u4eec\u8bf4\u7684\uff1areference semantics \u4ec5\u5728 initialization \u65f6\uff0c\u800c\u8fd9\u91cc\u662f value semantics. \u8fd9\u91cc\u7684 x = y \u628a y ( b ) \u6240\u6307\u4ee3\u7684 object \u7684\u503c\u8d4b\u7ed9 x ( a ) \u6240\u6307\u4ee3\u7684 object. \u81ea\u7136\u5730\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u5728\u4e24\u4e2a activation record \u4e2d\u662f\u540c\u6b65\u8fdb\u884c\u7684\uff0c\u56e0\u4e3a\u52a8\u7684\u662f\u540c\u4e24\u4e2a object. \u7ed3\u675f\u6e05\u9664 activation record \u800c\u51fa\u6808. 7.3 Procedural Abstraction \u8fc7\u7a0b\u62bd\u8c61\u5316 procedural adstraction \u628a what code does \u548c how it works \u7ed9\u5206\u5f00\u4e86. Functions \u5c31\u662f C++ \u4e2d\u8fc7\u7a0b\u62bd\u8c61\u5316\u7684\u4e3b\u8981\u5de5\u5177. 7.3.1 Interfaces \u548c implementations CS terminology \u4e2d\uff0c interface \u6307\u7528\u6765 specify what something does \u7684\u4e1c\u897f\uff0c\u800c implementation specifes how it works. #include <iostream> #include <vector> using namespace std; double mean(vector<double> v) //interface { // implementations } int main() { vector<double> v; double m = mean(v); // only care about the interface here cout << m; } 7.4 Unit Testing 7.4.1 Testing \u7684\u7c7b\u578b Testing \u6709\u4ee5\u4e0b\u51e0\u4e2a\u7c7b\u578b Unit testing: One piece at a time (e.g., a function) \u5b83\u7684\u597d\u5904\u662f (1) Find and fix bugs early (2) Test smaller, less complex, easier to understand units. System Testing: Test Entire project (code base) \u6211\u4eec\u5728 unit testing \u4e4b\u540e\u5e94\u8be5\u8fdb\u884c system testing \u6765\u786e\u4fdd\u4ee3\u7801\u7684\u8854\u63a5\u6b63\u786e Regression testing: \u5728\u66f4\u6539\u4ee3\u7801\u4e4b\u540e\uff0cAutomatically run all unit and system tests. \u8fd9\u4e00\u8282\u8bfe\u63d0\u4f9b\u4e86 unit_test_framework.hpp , \u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a macro(\u5b8f) \u6765\u65b9\u4fbf\u5199 Unit Tests. \u56e0\u800c\u5199 project \u53ea\u9700\u8981\u628a\u8fd9\u4e2a\u6587\u4ef6 include \u8fdb testing \u7684 cpp \u6587\u4ef6\u5c31\u53ef\u4ee5\u4e86 #include \"unit_test_framework.hpp\" 7.4.2 Test Cases \u7684\u7c7b\u578b Type prehibited: \u7c7b\u578b\u4e0d\u4e00\u81f4\u53ef\u80fd\u4f1a\u5bfc\u81f4 compiler error \u7684 Testing\uff0c \u4e0d\u9700\u8981\u5199. Requires prohibited: \u8fdd\u53cd requirements \u7684 tests. \u4e0d\u9700\u8981\u5199. Simple: \u4e00\u822c\u7684 test cases. Edge (Special): \u4e00\u4e9b\u8fb9\u7f18\u95ee\u9898\uff0c\u6bd4\u5982\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\u7684 array \u548c vector\uff0c\u6d4b\u8bd5\u4f17\u6570\u7684\u65f6\u5019\u8bbe\u7f6e\u591a\u4e2a\u4f17\u6570(\u5e94\u5f53\u53d6\u6700\u5c0f\u7684)\u7b49. Stress: \u5927\u578b\u7684\u6570\u636e\uff0c\u5982\u51e0\u4e07\u4e2a\u5143\u7d20\u7684vector. \u8fd9\u8282\u8bfe\u4e0d\u9700\u8981\u5199. 7.4.3 Unit-Test Framework \u6559\u7a0b \u6bd4\u5982\u6d4b\u8bd5\u4e00\u4e2a\u53eb\u505a arrays.cpp \u7684\u6587\u4ef6\uff0c\u6211\u4eec\u5e94\u8be5\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u53eb arrays_tests.cpp . \u5728\u5176\u4e2d\u5f15\u7528 framework. \u5982\u679c\u5176\u4e2d\u5305\u62ec\u4e24\u4e2a\u53eb\u505a slideRight() \u7684\u51fd\u6570\u548c flip() \u7684\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u5728 arrays_tests.cpp \u4e2d\u5199\u4e00\u4e9b\u53eb\u505a TEST(test_slide_right_123) \u548c `TEST(test_flip_123) \u8fd9\u6837\u7684\u51fd\u6570. #include \"arrays.hpp\" #include \"unit_test_framework.hpp\" // A helper function for comparing arrays. Returns true if the // arrays are the same size and contain the same values. bool compare_arrays(int arr1[], int size1, int arr2[], int size2) { if (size1 != size2) { return false; } for (int i = 0; i < size1; ++i) { if (arr1[i] != arr2[i]) { return false; } } return true; } // We define a test case with the TEST(<test_name>) macro. // <test_name> can be any valid C++ function name. TEST(test_slide_right_1) { int testing[] = { 4, 0, 1, 3, 3 }; int correct[] = { 3, 4, 0, 1, 3 }; slideRight(testing, 5); ASSERT_TRUE(compare_arrays(testing, 5, correct, 5)); } TEST(test_flip_1) { int testing[] = { 4, 0, 1, 3, 3 }; int correct[] = { 3, 3, 1, 0, 4 }; flip(testing, 5); ASSERT_TRUE(compare_arrays(testing, 5, correct, 5)); } TEST_MAIN() // No semicolon! \u8fd9\u5c31\u662f\u5b8f\u4e2d\u5b9a\u4e49\u7684\u8bed\u6cd5 \u5728\u5199\u5b8c\u4e4b\u540e\uff0c\u7528\u7f16\u8bd1\u5668\u5236\u4f5c\u51fa .exe \u6587\u4ef6 g++ -Wall -Werror -pedantic -g -std=c++11 arrays.cpp arrays_tests.cpp -o arrays_tests.exe ./arrays_tests.exe # Running test: numbers_are_equal # PASS # Running test: true_is_true # PASS # *** Results *** # ** Test case 'numbers_are_equal': PASS # ** Test case 'true_is_true': PASS # *** Summary *** # Out of 2 tests run: # 0 failure(s), 0 error(s) \u8fd9\u4e2a framework macro \u6700\u5927\u7684\u7279\u70b9\u662f\uff1a\u8fd8\u53ef\u4ee5\u7528\u5236\u4f5c\u51fa\u6765\u7684 .exe \u53ea\u8dd1\u5176\u4e2d\u7684\u4e00\u4e2a\u51fd\u6570. ./arrays_tests.exe numbers_are_equal # Running test: numbers_are_equal # PASS # *** Results *** # ** Test case 'numbers_are_equal': PASS # *** Summary *** # Out of 1 tests run: # 0 failure(s), 0 error(s) 7.4.4 Framework macro\u63d0\u4f9b\u7684\u7279\u6b8a Assert \u51fd\u6570 Assertion Description ASSERT_EQUAL(first, second) \u76f8\u7b49 ASSERT_NOT_EQUAL(first, second) \u4e0d\u7b49 ASSERT_TRUE(bool value) true ASSERT_FALSE(bool value) false ASSERT_ALMOST_EQUAL(double first, double second, double precision) $ ASSERT_SEQUENCE_EQUAL(first, second) arrays, vectors, lists \u76f8\u7b49","title":"Overview"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#7-foundations","text":"\u8fd9\u4e00\u8bb2\u662f recap \u4ee5\u524d\u5b66\u8fc7\u7684\u5185\u5bb9\u5e76\u4ecb\u7ecd\u4e00\u4e9b\u66f4\u52a0 rigorous \u7684\u6982\u5ff5.","title":"7 Foundations"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#71-machine-model","text":"\u4e00\u4e2a name(\u540d\u79f0) \u6307 some entity such as a variable, function, or type. \u4e00\u4e2a varibale(\u53d8\u91cf) \u662f\u4e00\u4e2a\u6307\u4ee3 memory \u4e2d\u7684\u4e00\u4e2a object \u7684 name. (variable \u5c31\u662f\u4e00\u79cd name\uff01) \u4e00\u4e2a name \u5177\u6709\u5b83\u7684 scope(\u4f5c\u7528\u57df) \uff0cscope \u51b3\u5b9a\u4e86\u4ec0\u4e48\u533a\u57df\u7684 code \u80fd\u591f\u4f7f\u7528\u8be5 name \u6765\u6307\u4ee3\u5b83\u8868\u793a\u7684 entity. \u4e00\u4e2a declaration(\u58f0\u660e) \u5c31\u662f\u5f15\u5165\u4e00\u4e2a name \u7684\u884c\u4e3a\uff0c\u5e76\u4e14 declaration \u5904\u662f\u8be5 name \u7684 scope \u7684\u8d77\u70b9. \u4e00\u4e2a object(\u5bf9\u8c61) \u5c31\u662f memory \u4e2d\u7684 a piece of data. object is locateda at some address(\u5730\u5740) in the memory. object \u7684 lifetime(\u751f\u547d\u5468\u671f) \u5c31\u662f legal to use this object \u7684\u65f6\u671f. \u4e00\u4e2a object \u5728\u67d0\u4e2a\u65f6\u523b\u88ab create\uff0c\u5728\u67d0\u4e2a\u65f6\u523b\u88ab destroy\uff0c\u4ece\u88ab create \u5230\u88ab destroy \u7684\u8fd9\u6bb5\u65f6\u95f4\u5c31\u662f\u6211\u4eec\u80fd\u591f legallu use it \u7684\u65f6\u95f4. \u5b83\u53d6\u51b3\u4e8e\u8be5 object \u7684 storage duration . \u4e3a\u4e86\u5b66\u4e60 memory \u4e2d objects \u548c\u7528\u6765\u6307\u4ee3\u5b83\u4eec\u7684 variables \u7684\u53d8\u5316\uff0c\u6211\u4eec\u5f15\u5165 machine model . Machine Model \u5c31\u662f\u5bf9\u4e8e codes \u5982\u4f55 relate to program execution \u7684\u4e00\u4e2a\u63cf\u8ff0. \u6700\u57fa\u7840\u7684 machine model \u5c31\u662f\u628a memory \u770b\u505a\u4e00\u4e2a\u50cf array \u7684\u4e1c\u897f\u7684\u56fe. \u5982\u4e0b. \u4e4b\u540e\u4f1a\u6709\u66f4\u590d\u6742\u7684 machine model \u73b0\u5728\u6211\u4eec\u5f00\u59cb\u8bb2 object \u7684\u50a8\u5b58\u5468\u671f.","title":"7.1 Machine Model \u673a\u5668\u6a21\u578b"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#711-storage-duration","text":"\u6709\u4e09\u79cd Storage Duration. static (\u4e5f\u53eb Global \u5168\u5c40\u5bf9\u8c61) : \u8fd9\u79cd object \u7684 lifetime \u662f the whole program. automatic (\u4e5f\u53eb Local \u5c40\u90e8\u5bf9\u8c61) : \u8fd9\u79cd object \u7684 lifetime \u662f\u88ab\u7ed1\u5b9a\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684 scope\uff0c\u6bd4\u5982\u67d0\u4e00\u6bb5\u4ee3\u7801\u5757. dynamic (\u52a8\u6001) : static \u548c automatic durations \u90fd\u662f\u7531 compiler \u63a7\u5236\u7684\uff0c\u800c dynamic duration \u5374\u662f\u7531 programmer explicitly create and control \u7684. \u672c\u8bfe\u7a0b\u5c06\u53ea\u8bb2 static \u548c automatic \u7684 object. Variable \u548c memory object \u5e76\u4e0d\u7b49\u540c. Variable \u662f\u548c source code \u76f8\u6302\u94a9\u7684\u6982\u5ff5\uff0c\u800c memory object \u5219\u662f\u548c runtime \u76f8\u6302\u94a9\u7684\u6982\u5ff5. \u540c\u4e00\u4e2a variable \u53ef\u4ee5\u5728\u4e0d\u540c\u65f6\u95f4\u6307\u4ee3\u4e0d\u540c\u7684 object. \u6bd4\u5982 a local variable in a functon that is called more than once. Dynamic storage duration \u7684 objects \u4e0d\u4f1a\u548c \u4e00\u4e2a variable \u5173\u8054 .","title":"7.1.1 Storage Duration"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#712-reference-sematics-and-value-sematics","text":"\u6211\u4eec\u90fd\u5df2\u7ecf\u5b66\u8fc7\u4e86 pass by reference \u548c pass by value \u7684\u533a\u522b. \u800c\u6211\u4eec\u77e5\u9053\uff0cC++ \u4e2d x = y \u4ec5\u8868\u793a modify the value of object x \u800c\u4e0d\u662f change which object x is referring to\uff0c \u5982\u679c\u4e00\u4e2a\u884c\u4e3a\u4e2d x = y \u8868\u793a\u524d\u8005\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5730\u65b9\u5c31\u53eb\u505a value semantics(\u503c\u8bed\u4e49) \uff1b\u800c\u5982\u679c\u8868\u793a\u540e\u8005\uff0c\u90a3\u4e48\u5c31\u53eb\u505a reference semantics(\u5f15\u7528\u8bed\u4e49) . \u56e0\u800c C++ \u8fd9\u4e2a\u8bed\u8a00\u7684\u9ed8\u8ba4\u662f value sematics. \u800c C++ \u4ec5\u5728 intializating new variable \u7684\u65f6\u5019\u652f\u6301 reference semantics . int x = 42; // initial x to refer to an object, and sets the initial value to 42. int y = 99; y = x; // assign the value of x:42 to y. x = 55; // y is not becoming 55, because they are still pointing at different objects. \u4f46\u662f\u5982\u679c\u5728 new variable name \u7684\u5de6\u4fa7\u52a0\u4e0a\u4e00\u4e2a ampersand (&) , \u90a3\u4e48\u5c31\u80fd\u591f\u628a\u8be5 name \u5173\u8054\u5230\u4e00\u4e2a\u73b0\u6709\u7684 object. \u6211\u4eec\u90fd\u77e5\u9053\uff0c\u8fd9\u4e2a\u7b26\u53f7\u53eb\u505a reference operator\uff08\u53d6\u5730\u5740\u8fd0\u7b97\u7b26\uff09\uff0c\u653e\u5728\u4e00\u4e2a\u4ee3\u8868\u67d0\u4e2a object \u7684 variable name \u5de6\u4fa7\uff0c\u53ef\u4ee5\u63d0\u53d6\u5b83\u6240\u4ee3\u8868\u7684 object \u7684 memory address \u6765\u5b58\u653e\u5728\u6307\u9488\u53d8\u91cf\u91cc\uff1b\u4f46\u662f\u5728 initialization \u7684\u65f6\u5019\u5982\u679c\u5728\u65b0 varible name \u7684\u5de6\u4fa7\u52a0\u4e0a &\uff0c\u5219\u5e76\u4e0d\u662f\u8868\u793a\u63d0\u53d6 address \u7684\u8fd0\u7b97\uff0c\u800c\u662f \u201c\u5c06\u6211\u4eec\u5de6\u8fb9\u8fd9\u4e2a\u65b0\u7684 varibale name\u5173\u8054\u5230\u73b0\u6709\u7684\u53f3\u8fb9\u8fd9\u4e2a variable name \u4ee3\u8868\u7684 object \u4e0a\u201d\uff0c\u901a\u4fd7\u800c\u8a00\u5c31\u662f\u7ed9\u5bf9\u8c61\u53d6\u4e2a\u65b0\u540d\u5b57 . \u8fd9\u5c31\u662f reference operator \u7684\u53e6\u4e00\u4e2a\u7528\u6cd5. \u8fd9\u4e2a\u7528\u6cd5\u548c\u5199\u51fd\u6570\u65f6 pass by reference \u7684\u7528\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u5373\u76f4\u63a5\u6307\u5411\u8fd9\u5757 address \u4e0a\u7684 object \u5bf9\u5176\u8fdb\u884c\u8d4b\u540d/\u8fd0\u7b97. int x = 42; int &y = x; //y\u548cx\u662f\u540c\u4e00\u4e2aobject, \u503c\u90fd\u662f42, y\u662f\u7ed9\u5b83\u8d77\u7684\u65b0\u540d\u5b57 x = 24; cout << y; //24, \u503c\u88ab\u6539\u53d8\u4e86 z = 3; y = z; //pass by value cout << x; //3, \u503c\u88ab\u6539\u53d8\u4e86 \u8fd9\u91cc\uff0cy \u548c x \u662f\u4e24\u4e2a variable\uff0c\u4f46\u662f\u4ed6\u4eec\u90fd\u548c\u540c\u4e00\u4e2a object associate\u4e86. \u56e0\u800c\u6539\u53d8\u5176\u4e2d\u4efb\u4f55\u4e00\u4e2a\u7684\u503c\uff0c\u53e6\u4e00\u4e2a\u4e5f\u4f1a\u6539\u53d8\uff0c\u4e0d\u5982\u8bf4 y \u548c x \u662f\u79f0\u547c\u8be5 object \u7684\u4e24\u4e2a\u540d\u5b57. \u5e76\u4e14 \u7531\u4e8eC++\u53ea\u652f\u6301\u5728 initialization \u65f6\u7684 reference semantics, a variable \u548c a memory object \u4e4b\u95f4\u7684 association can never be broken! (except when variable goes out of scope). \u4e5f\u5c31\u662f\u8bf4\u4f60\u4e00\u65e6 declare \u4e86\u4e00\u4e2a variable\uff0c\u90a3\u4e48\u5b83\u5c31\u548c\u4f60 declare \u65f6\u8ba9\u5b83 refer \u7684 object \u7ed1\u5b9a\u4e86\uff0c \u4f60\u65e0\u6cd5\u91cd\u65b0\u7ed9\u8fd9\u4e2a variable \u7ed1\u5b9a\u65b0\u7684 object\uff01 \u4f60\u4fee\u6539\u5b83\u5c31\u662f\u4fee\u6539\u8fd9\u4e2a object. \u800c\u5bf9\u4e8e\u5f53\u51fa\u4e86 scope \u4e4b\u540e\uff0c\u8fd9\u4e2a name \u5c31\u65e0\u6548\u4e86\uff0c\u6211\u4eec\u7684 object \u5c31\u5c11\u4e86\u4e00\u4e2a\u540d\u5b57. \u6bd4\u5982\u4e00\u4e2a\u51fd\u6570\u7684 pass by reference \u7684\u53c2\u6570\uff0c\u5c31\u662f\u5bf9\u4e00\u4e2a\u53d8\u91cf\u53d6\u7684\u4e00\u4e2a\u65b0\u540d\u5b57\uff0c\u800c\u5728 main() \u51fd\u6570\u8fd0\u884c\u8fc7\u4e86\u8fd9\u4e2a\u51fd\u6570\u4e4b\u540e\uff0c\u8fd9\u4e2a\u540d\u5b57\u5c31\u5931\u53bb\u4e86. \u56e0\u800c pass-by-reference parameters \u4e5f\u53eb\u505a\u539f object \u7684\u4e00\u4e2a alias (\u522b\u540d)\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u6211\u4eec\u5728 Windows \u684c\u9762\u521b\u5efa\u7684\u5feb\u6377\u65b9\u5f0f.","title":"7.1.2 Reference sematics and Value sematics \u5f15\u7528\u8bed\u4e49\u4e0e\u503c\u8bed\u4e49"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#713-compile-time-runtime","text":"\u4e00\u4e2a\u7a0b\u5e8f\u9996\u5148\u8981 compile\uff0c\u5176\u6b21\u518d execute (run). Compile \u4e00\u4e2a\u7a0b\u5e8f\u662f\u9700\u8981\u65f6\u95f4\u7684. \u8fd9\u6bb5\u65f6\u95f4\u91cc compiler \u4f1a\u505a\u4e00\u4e0b\u7684\u4e8b\u60c5: observe variable declarations: \u89c2\u5bdf\u4ee3\u7801\u91cc variables \u7684 name, type, scope \u548c value. \u786e\u5b9a\u9700\u8981\u7ed9\u6bcf\u4e2a type \u7684 variables \u7684 size. \u6bd4\u5982\uff1a int \u9700\u8981 4 bytes double \u9700\u8981 8 bytes \u66f4\u590d\u6742\u7684 ADT: n bytes ( \u6ce8\u610f\uff1a\u4e00\u4e2a byte \u5c31\u662f 8 \u4e2a bits\uff0c\u4e00\u4e2a bit \u5b9e\u9645\u4e0a\u5c31\u662f binary digits\uff0c\u5c31\u662f\u4e00\u4e2a 0/1 \u7684\u4e8c\u8fdb\u5236\u6570 ) Compile time \u5c31\u662f Compiler compile \u4f60\u7684 codes \u7684\u8fd9\u6bb5\u65f6\u95f4. \u65e9\u5728 compile time\uff0ccompiler \u5c31\u4f1a\u51b3\u5b9a\u597d\u8fd9\u6bb5\u4ee3\u7801 \u9700\u8981\u591a\u5927\u7684 memory. \u800c runtime \u5c31\u662f\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u95f4. \u8fd9\u6bb5\u65f6\u95f4 compiled code \u88ab\u6267\u884c\uff0cvariables \u4f1a\u4ee5 objects \u7684\u5f62\u5f0f\u88ab\u50a8\u5b58\u5728 memory (RAM) \u91cc\uff0c\u5176\u5927\u5c0f\u5c31\u662f\u8fd9\u4e2a variable type \u7684\u5927\u5c0f. \uff08\u5f53\u7136 variable \u81ea\u8eab\u4e5f\u4f1a\u5360\u636e\u4e00\u5b9a\u5927\u5c0f\uff0c\u5c31\u6bd4\u5982\u4e24\u4e2a int variable \u90fd\u662f\u540c\u4e00\u4e2a object \u7684\u540d\u5b57\uff0c\u90a3\u4e48\u8fd9\u4e2a object \u5c31\u53ea\u6709 4 bytes\uff0c\u4f46\u662f\u5176\u5b9e\u8fd9\u4e24\u4e2a\u540d\u5b57\u4e5f\u5360\u636e\u4e86\u4e00\u70b9 memory \u4f7f\u5f97\u5b83\u4eec\u80fd\u88ab\u8bc6\u522b\u3002\u4f46\u8fd9\u79cd\u4e1c\u897f\u6211\u4eec\u5c31\u4e0d\u7ba1\u4e86\u3002\uff09 \u6240\u4ee5\u6211\u4eec\u8981\u6ce8\u610f\u7684\u6982\u5ff5\u662f\uff1a object \u53ea\u5728 runtime \u4ea7\u751f\uff0cvariable \u662f compile time \u5c31\u88ab\u8bc6\u522b\u4e86 \u3002","title":"7.1.3 Compile time \u548c Runtime"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#72-function-calls-and-the-call-stack","text":"","title":"7.2 Function Calls and the Call Stack"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#721-activation-record-and-stack","text":"\u521a\u624d\u6211\u4eec\u4ecb\u7ecd\u4e86\u6700\u57fa\u672c\u7684\u628a memory \u4e2d\u7684 object \u770b\u4f5c\u7c7b\u4f3c array \u5143\u7d20\u7684 machine model\uff0c\u800c\u73b0\u5728\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e2a\u66f4\u52a0 structured \u7684 machine model\uff0c\u5373\u88ab\u591a\u79cd\u9ad8\u7ea7\u8bed\u8a00\u7684 implementations \u4f7f\u7528\u7684\uff1a Stack-based memory management \uff08\u57fa\u4e8e\u6808\u7684\u5185\u5b58\u7ba1\u7406\uff09. \u5728\u5927\u591a\u6570\u9ad8\u7ea7\u8bed\u8a00\u7684 implementations \u4e2d\uff0c\u51fd\u6570\u8c03\u7528\u7684\u6570\u636e\u90fd\u96c6\u4e2d\u5b58\u50a8\u5728\u4e00\u4e2a activation record\uff08\u6fc0\u6d3b\u8bb0\u5f55\uff09 \u4e2d\uff0c activation record \u5c31\u662f\u7ed9\u51fd\u6570\u5206\u914d\u7684 memory\uff0c\u5206\u914d\u7ed9\u4e00\u4e2a\u51fd\u6570\u7684 memory \u5c31\u53eb\u505a \u5b83\u7684activation record \u5176\u4e2d\u5305\u542b\u51fd\u6570\u7684\u6240\u6709 parameters \u548c local variables\uff0ctemporary objects \u5373 return address\u7b49\uff0c\u800c\u672c\u8bfe\u7a0b\u4e2d\u6211\u4eec\u53ea\u8003\u8651 activation record \u4e2d\u7684 parameters \u548c local variables\uff0c\u5ffd\u7565\u5176\u4ed6\u6570\u636e. \u5728 stack-based memory management \u4e2d\uff0cactivation record \u88ab\u50a8\u5b58\u5728\u4e00\u4e2a\u53eb\u505a stack\uff08\u6808\uff09 \u7684 data structure \u4e2d. \u5f53\u521b\u5efa\u4e00\u6761 activation record \u540e\uff0c\u5b83\u5c31\u4f1a\u88ab\u653e\u5728 stack \u7684\u9876\u90e8 \uff0c\u800c \u7b2c\u4e00\u4e2a\u88ab\u9500\u6bc1\u7684 activation record \u5c31\u662f\u8fd9\u6761\u6700\u65b0\u88ab\u521b\u5efa\u51fa\u6765\u7684 activation record . \u8fd9\u5c31\u662f\u8457\u540d\u7684 last-in, first-out Behavior (LIFO\uff0c\u540e\u8fdb\u5148\u51fa\u884c\u4e3a) . \u7531\u4e8e activation record (more commonly)\u4e5f\u53eb\u505a stack frame\uff08\u6808\u5e27\uff09 . \u6240\u4ee5\u77e5\u9053\u4e86 activation record \u7684\u6982\u5ff5\u540e\uff0c\u6211\u4eec\u5c31\u5927\u6982\u77e5\u9053\u9ad8\u7ea7\u8bed\u8a00\u7a0b\u5e8f\u7684\u4e00\u4e9b\u7c97\u7565\u7684\u6570\u636e\u5b58\u50a8\u65b9\u5f0f\u4e86. \u6bd4\u5982\u6211\u4eec\u7684 C++ \u7a0b\u5e8f\u603b\u662f\u4ece main() \u51fd\u6570\u5f00\u59cb\u7684\uff0c\u800c\u6240\u6709\u5728 main() \u51fd\u6570\u4e2d\u7684 local objects \u90fd\u5b58\u5728 main() \u7684 activation record \u4e2d\uff0c\u800c main() \u53c8\u8c03\u7528\u5176\u4ed6\u51fd\u6570\uff0c\u8fd0\u884c\u65f6\u5728\u6808\u9876\u4e3a\u8fd9\u4e9b\u51fd\u6570\u521b\u9020 activation record\uff0c\u800c\u521b\u9020\u7684 \u8fd9\u4e2a activation record \u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u5b83\u53ef\u80fd\u5b58\u50a8\u7684\u5c40\u90e8\u53d8\u91cf\u6570\u91cf. \u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a activation \u7684\u5927\u5c0f\u5e76\u4e0d\u662f\u81ea\u7531\u6539\u53d8\u7684\uff0c\u800c\u662f\u4ece\u5b83\u88ab\u521b\u5efa\u65f6\u5c31\u56fa\u5b9a\u597d\u7684\uff0c\u6839\u636e\u91cc\u9762\u7684 local variable \u6570\u91cf\u51b3\u5b9a\uff08\u6211\u4eec\u53ef\u80fd\u4f1a\u89c9\u5f97\u662f object \u6570\u91cf\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\uff0c\u800c\u662f local variable \u7684\u6570\u91cf\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u7406\u89e3\u57fa\u4e8e\u7b80\u5316\u6a21\u578b\uff0c\u5b9e\u9645\u4e0a\u4f5c\u4e3a reference \u7684 variable \u4e5f\u5360 memory\uff0c\u4f46\u662f\u662f user \u4e0d\u80fd\u63a5\u89e6\u7684.\uff09","title":"7.2.1 Activation Record and stack \u6fc0\u6d3b\u8bb0\u5f55\u4e0e\u6808"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#722-function-call","text":"\u6211\u4eec\u77e5\u9053\uff0cC++ \u7684\u7a0b\u5e8f\u5c31\u662f\u8fd0\u884c\u51fd\u6570. \u6700\u5f00\u59cb\u7684\u51fd\u6570\u5c31\u662f main() \uff1b main() \u4f1a call \u5176\u4ed6\u51fd\u6570\uff0c\u800c\u5176\u4ed6\u51fd\u6570\u53c8\u4f1a call \u5176\u4ed6\u51fd\u6570\uff1b\u8fd0\u884c\u5b8c main() \uff0c\u7a0b\u5e8f\u5c31\u7ed3\u675f\u4e86. \u6bcf\u4e00\u4e2a function call \u7684\u6d41\u7a0b\u6309\u7167\u4e0b\u9762\u8fd9\u4e2a\u8fc7\u7a0b\uff1a \u5f53 function \u8fd0\u884c\u5230\u5d4c\u5957\u5728\u91cc\u9762\u7684\u5176\u4ed6 function \u65f6\uff0cevaluate actual arguments to the function. Make a new and unique invocation of the called function. (1) Push a stack frame (2) Pass parameters \u6682\u505c original function \u7684\u8fd0\u884c \u8fd0\u884c called function\uff0c\u53ef\u80fd\u4f1a\u8fd4\u56de\u4e00\u4e9b\u503c (optional) \u8fd0\u884c called function \u7ed3\u675f\u540e\uff0c\u91cd\u65b0\u5728 original function left off \u7684\u5730\u65b9 resume. destroy called function \u7684 stack frame. \u6ce8\u610f\uff0c\u8fd9\u91cc\u4ece 3 \u5230 4 \u7684\u8fc7\u6e21\u88ab\u79f0\u4e3a\u4e00\u79cd active flow \uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8fc7\u7a0b\u662f code explictly \u544a\u8bc9 computer \u53bb\u8fd0\u884c\u54ea\u4e2a function\uff0c\u800c\u4ece\u7b2c 4 \u6b65\u5230\u7b2c 5 \u6b65\u7684\u8fc7\u6e21\u88ab\u79f0\u4e3a\u4e00\u79cd passive flow \uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8fc7\u7a0b\u7684 transfer of control \u5e76\u4e0d\u662f code \u544a\u8bc9 computer, \u800c\u662f computer \u5728\u8fd0\u884c stack frame \u7684\u8fc7\u7a0b\u4e2d\u81ea\u4e3b\u7684.","title":"7.2.2 Function Call \u7684\u8fc7\u7a0b"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#723-activation-record-stack-frame","text":"\u4e3a\u4e86\u7406\u89e3\u7a0b\u5e8f\u8fd0\u884c\u7684\u6d41\u7a0b\uff0c\u6211\u4eec\u8003\u8651\u8fd9\u4e00\u4e2a\u5b8c\u6574\u7684\u7a0b\u5e8f\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u4f8b\u5b50\uff1a void bar(){ } void foo(){ bar(); } int main(){ foo(); } \u8fd9\u4e00\u7a0b\u5e8f\u90fd\u770b\u5f97\u51fa\u6765\uff0c\u662f main() \u51fd\u6570\u8c03\u7528 foo() \u8fd9\u4e2a\u51fd\u6570\uff0c\u800c foo() \u8fd9\u4e2a\u51fd\u6570\u5185\u90e8\u518d\u8c03\u7528 bar() \u8fd9\u4e2a\u51fd\u6570. \u8fd9\u4e2a\u8fc7\u7a0b\u5728 stack \u4e2d\u7684\u6837\u5b50\u662f\u8fd9\u6837\u7684\uff1a\uff08\u4e0d\u8bba\u54ea\u4e2a\u65b9\u5411\u90fd\u4e00\u6837\u7684\uff09 program \u4e00\u5f00\u59cb\u5c31\u4f1a\u8c03\u7528 main() \u51fd\u6570\uff0c\u56e0\u800c\u521b\u5efa\u4e00\u6761 main() \u51fd\u6570\u7684 activation record \u5e76\u653e\u5165\u6808\u9876\uff1b \u800c\u540e main() \u51fd\u6570\u8c03\u7528 foo() \u51fd\u6570\uff0c\u56e0\u800c\u521b\u9020\u4e00\u6761 foo() \u51fd\u6570\u7684 activation record \u5e76\u5165\u6808\uff0c\u653e\u5728\u6808\u9876\uff0c main() \u51fd\u6570\u7684\u4e0a\u9762\uff1b \u800c\u540e foo() \u51fd\u6570\u8c03\u7528 bar() \u51fd\u6570\uff0c\u540c\u6837\u521b\u9020 activation record \u5e76\u5165\u6808\u9876. \u6700\u91cc\u5c42\u7684 bar() \u51fd\u6570\u8fd0\u884c\u7ed3\u675f\uff0c\u4ece\u6808\u9876\u5148\u79fb\u9664\u5b83\u7684 activation record\uff1b \u800c\u540e foo() \u51fd\u6570\u8fd0\u884c\u5b8c\u6210\uff0c\u4ece\u6808\u9876\u79fb\u9664 activation record\uff1b main() \u51fd\u6570\u8fd0\u884c\u7ed3\u675f\uff0c\u6808\u88ab\u6e05\u7a7a. \u8fd9\u662f\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u8fc7\u7a0b\uff0c\u73b0\u5728\u6211\u4eec\u52a0\u5165 variables \u6765\u8fdb\u4e00\u6b65\u7406\u89e3\uff0c\u770b\u7b2c\u4e8c\u4e2a\u7a0d\u5fae\u590d\u6742\u4e00\u4e9b\u7684\u4f8b\u5b50. int plus_one(int x){ return x + 1; } int plus_two(int x){ return plus_one(x + 1); } int main(){ int result = 0; result = plus_one(0); result = plus_two(result); cout << result; } program \u9996\u5148\u8c03\u7528 main() \u51fd\u6570\uff0c\u5e76\u5148\u58f0\u660e\u4e00\u4e2a local variable result \uff08\u5bf9\u5e94\u7684 object \u540c\u65f6\u88ab\u521b\u9020\uff0c\u5c31\u662f\u6211\u4eec\u521a\u624d\u8bf4\u7684\u4ec5\u5728 variable \u7684 initialization \u65f6\u7684 reference semantics\uff09\uff1b\u800c\u540e main() \u51fd\u6570\u8c03\u7528 plus_one() \u51fd\u6570\uff0c plus_one() \u751f\u6210\u5176 scope \u4e0b\u7684 local variable x \uff0c\u5c06\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684 main() \u51fd\u6570\u4e2d\u7684 local variable result \u7684\u503c pass \u7ed9\u81ea\u5df1\u7684 local variable x \uff1b\u800c\u540e plus_one() \u8fd0\u884c\u7ed3\u675f\u8fd4\u56de x \u7684\u503c\u52a0\u4e0a 1 \u5e76 assign \u7ed9 result \uff0c result \u7684\u503c\u66f4\u65b0\uff1b\u800c\u540e main() \u51fd\u6570\u53c8\u8fd0\u884c\u4e0b\u4e00\u4e2a\u51fd\u6570 plus_two() . \u800c\u8fd9\u4e00\u8fc7\u7a0b\u5728 stack \u4e2d\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u6d41\u7a0b\uff1a main() \u51fd\u6570\u88ab\u8c03\u7528\uff0c main() \u7684 activation record \u88ab\u521b\u5efa. main() \u51fd\u6570\u7684\u6267\u884c\u8fc7\u7a0b\u4e2d local variable result \u88ab\u58f0\u660e\uff0c\u7559\u51fa memory \u4e2d\u7684\u4f4d\u7f6e\u5b58\u653e\u5bf9\u5e94\u7684 object\uff0c\u5177\u4f53\u6570\u636e\u4e3a int \u578b\u7684 1. plus_one() \u51fd\u6570\u88ab main() \u51fd\u6570\u8c03\u7528\uff0c\u521b\u5efa plus_one() \u7684 activation record. \u5728\u88ab\u8c03\u7528\u7684\u540c\u65f6\uff0c plus_one() \u51fd\u6570\u751f\u6210\u5728\u5b83\u7684 scope \u4e2d\u7684 local variable x \uff0c\u5e76\u901a\u8fc7\u51fd\u6570\u7684 pass by value\uff0c\u83b7\u53d6\u8c03\u7528\u5b83\u7684 main() \u51fd\u6570\u91cc\u7684 local variable result \u7684\u503c\uff0c\u5e76 pass \u7ed9\u81ea\u5df1\u7684 local variable x . plus_one() \u5bf9\u81ea\u5df1\u7684 local variable x \u8fdb\u884c\u52a0\u4e00\u7684\u64cd\u4f5c\uff0c\u8fd0\u884c\u7ed3\u675f\u65f6\u628a\u5b83\u7684\u503c\u4f5c\u4e3a\u51fd\u6570\u7684 return value\uff0creturn \u7ed9\u8c03\u7528\u81ea\u5df1\u7684 main() \u51fd\u6570. main() \u51fd\u6570\u83b7\u53d6 plus_one() \u7684 return \u503c\u7684\u540c\u65f6\uff0c\u628a\u5b83 assign \u7ed9 main() \u7684 local variable result . \u5728\u5b8c\u6210 return \u7684\u8fc7\u7a0b\u540e\uff0c plus_one() \u8fd0\u884c\u7ed3\u675f\u5e76\u6e05\u9664\u81ea\u5df1\u7684 activation record\uff0c\u5373\u51fa stack. \u73b0\u5728 stack \u4e2d\u53ea\u5269\u4e0b\u5728\u6808\u5e95\u7684 main() \u51fd\u6570\u7684 activation record. \u8fd9\u5c31\u662f\u4ece program \u5f00\u59cb\u8fd0\u884c\u4e00\u76f4\u5230 result = plus_one(0); \u8fd9\u4e00\u884c\u8fd0\u884c\u7ed3\u675f\u7684\u5168\u8fc7\u7a0b. \u73b0\u5728\u6765\u5230\u4e0b\u4e00\u884c result = plus_two(result); . \u4ece\u521a\u624d\u7684\u72b6\u6001\u5f00\u59cb. main() \u8c03\u7528 plus_two() \u51fd\u6570\uff0c plus_two() \u7684 activation record \u88ab\u521b\u5efa. \u6ce8\u610f\u5230\uff0c plus_two() \u7684 activation record \u5728 memory \u4e2d\u7684\u4f4d\u7f6e\u4f1a\u88ab\u5b89\u6392\u5230\u521a\u624d\u88ab\u6e05\u9664\u7684 plus_one() \u7684 activation record \u7684\u4f4d\u7f6e\u4e0a\uff01 plus_two() \u5728\u521b\u5efa activation record \u7684\u540c\u65f6\u4e5f\u4e00\u6837\u4ece main() \u4e2d\u83b7\u53d6 result \u7684\u503c\u5e76\u8d4b\u7ed9\u81ea\u5df1\u521d\u59cb\u7684 local variable x . plus_two() \u8c03\u7528 plus_one() \u51fd\u6570\uff0c\u521b\u5efa activation record\uff0c\u4f20\u53c2\uff0c\u628a\u81ea\u5df1\u7684local variable x \u4f20\u7ed9 plus_one \u7684 local variable x . \u8fd9\u91cc\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0 \u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u53d8\u91cf\u540d\u90fd\u53eb\u505a x \uff0c\u4f46\u662f\u8fd9\u5e76\u4e0d\u4f1a\u51b2\u7a81\uff0c\u56e0\u4e3a\u5b83\u4eec\u50a8\u5b58\u5728\u4e0d\u540c\u7684 activation record \u4e2d. \u5728 plus_one \u7684 scope \u4e2d x \u6307\u4ee3 plus_one \u4e2d\u7684 object\uff0c\u800c\u5728 plus_two \u7684 scope \u4e2d\u6307\u4ee3 plus_two \u4e2d\u7684 object. \u6240\u4ee5\u7a0b\u5e8f\u8bc6\u522b local variable name \u5176\u5b9e\u662f\u4ee5\u4e00\u4e2a activaion record \u4e3a\u5355\u4f4d\u7684\uff0c\u56e0\u7531 scope \u51b3\u5b9a\uff01\u591a\u4e2a activation record \u540c\u65f6\u5b58\u5728\u65f6\uff0c\u91cc\u9762\u53ef\u4ee5\u6709\u76f8\u540c\u7684\u5c40\u90e8\u53d8\u91cf\u540d\uff0c\u8fd9\u4e5f\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u8bf4\u7684\u4e00\u4e2a variable name \u7ed1\u5b9a\u4e86\u4e00\u4e2a object \u5c31\u4e0d\u80fd\u7ed1\u5b9a\u5176\u4ed6 object\u4e86\uff0c\u9664\u975e\u51fa scope. \u5f53\u7136\u6211\u4eec\u81ea\u7136\u800c\u7136\u5730\u60f3\u5230 global variable \u80af\u5b9a\u4e0d\u80fd\u8fd9\u6837. \u4e4b\u540e\u5404\u51fd\u6570\u4f9d\u6b21\u8fd0\u884c\u7ed3\u675f\u5e76\u6e05\u9664 activation record \u51fa\u6808.","title":"7.2.3 Activation Record (Stack Frame) \u7684\u8fd0\u884c\u4f8b"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#724-pass-by-reference-function-stack-frame","text":"\u4e0a\u9762\u90fd\u662f\u53ea\u6709 pass by value \u7684 parameter \u7684\u51fd\u6570\uff0c\u73b0\u5728\u770b\u7b2c\u4e09\u4e2a\u4f8b\u5b50\uff1a\u4e00\u4e2a\u6709 pass by reference \u7684 parameter \u7684\u51fd\u6570. Pass-by-reference \u5c31\u662f\u5728\u521b\u5efa\u521d\u59cb variable \u65f6\u7528\u4e86 reference semantics. \u5b9e\u9645\u4e0a\uff0c**\u51fd\u6570\u4e2d\u4f20\u53c2\u5c31\u662f\u7528\u7b49\u53f7\u8d4b\u503c\uff01\u53ea\u4e0d\u8fc7\u8fd9\u4e00\u6b65\u53ef\u4ee5\u8de8\u57df activation record \u5230\u8c03\u7528\u672c\u51fd\u6570\u7684\u53e6\u4e00\u4e2a\u51fd\u6570\u7684 activation record \u4e2d\u53bb. \u6bd4\u5982 void swap(int &x, int &y); \u800c\u6211\u4eec\u5728 main() \u51fd\u6570\u91cc call \u5b83\uff0c swap(x,y); . \u8fd9\u5c31\u662f\u7b49\u4e8e int &x = x; , int &y = y , \u7531\u4e8e\u662f\u8de8 scope \u7684\u6240\u4ee5\u8fd9\u91cc\u540c\u4e00\u4e2a variable x \u53ef\u4ee5\u6307\u4ee3\u4e24\u4e2a\u4e0d\u540c\u7684 object\uff0c\u5b8c\u6210\u8fd9\u4e2a\u8d4b\u503c\u884c\u4e3a. ** \u6309\u7167\u6211\u4eec\u4e4b\u524d\u5b66\u4e60\u7684\uff0c int &a = b \u5c31\u662f\u7ed9 b \u6307\u4ee3\u7684 object \u53d6\u53e6\u4e00\u4e2a\u540d\u5b57\u53eb\u505a a \uff0c\u56e0\u800c pass-by-reference \u7684 local variable \u5c31\u662f\u7ed9\u8c03\u7528\u81ea\u5df1\u7684\u51fd\u6570\u4f20\u8fc7\u6765\u7684\u5b83\u7684\u4f5c\u4e3a\u53c2\u6570\u7684 local variable \u6240\u6307\u4ee3\u7684 object \u53d6\u7684\u4e00\u4e2a\u65b0\u540d\u5b57. \u8fd9\u4e00\u4e2a\u4f20\u53c2\u8fc7\u7a0b\u662f\u8de8 activation record \u7684. \u6211\u4eec\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50. void swap(int &x, int &y){ int tmp = x; x = y; y = tmp; } int main(){ int a = 3; int b = 7; cout << a << \",\" << b << endl; //3,7 swap(a, b); cout << a << \",\" << b << endl; //7,3 } \u6211\u4eec\u6765\u7efc\u5408\u521a\u624d\u5bf9 & \u7684\u5b66\u4e60\u4ee5\u53ca\u5bf9 call stack \u7684\u5b66\u4e60\u6765\u770b\u8fd9\u4e00\u6d41\u7a0b\uff1a \u7a0b\u5e8f\u521b\u5efa main() \u51fd\u6570\u7684 activation record\uff0c\u5927\u5c0f\u5305\u542b\u4e24\u4e2a local variable\u7684 space. main() \u51fd\u6570\u8fd0\u884c. \u8fd0\u884c\u5230 swap() \u65f6\u4e3a\u5176\u521b\u5efa activation record\uff0c\u5927\u5c0f\u5305\u542b\u4e09\u4e2a local variable\uff0c\u5176\u4e2d\u4e24\u4e2a\u662f main() \u7684 local variable a \u548c b \u7684 reference\uff0c\u53e6\u5916\u4e00\u4e2a tmp refer to \u81ea\u5df1\u7684\u4e00\u4e2a temporary object. swap() \u8fdb\u884c\u6211\u4eec\u719f\u6089\u7684\u53d8\u91cf\u4ea4\u6362\u64cd\u4f5c. \u8fd9\u91cc x \u548c y \u90fd\u662f\u5f15\u7528\u53c2\u6570\uff0c\u4f46\u6211\u4eec\u8981\u8bb0\u5f97\u6211\u4eec\u8bf4\u7684\uff1areference semantics \u4ec5\u5728 initialization \u65f6\uff0c\u800c\u8fd9\u91cc\u662f value semantics. \u8fd9\u91cc\u7684 x = y \u628a y ( b ) \u6240\u6307\u4ee3\u7684 object \u7684\u503c\u8d4b\u7ed9 x ( a ) \u6240\u6307\u4ee3\u7684 object. \u81ea\u7136\u5730\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u5728\u4e24\u4e2a activation record \u4e2d\u662f\u540c\u6b65\u8fdb\u884c\u7684\uff0c\u56e0\u4e3a\u52a8\u7684\u662f\u540c\u4e24\u4e2a object. \u7ed3\u675f\u6e05\u9664 activation record \u800c\u51fa\u6808.","title":"7.2.4 pass-by-reference function \u7684 stack frame \u8fd0\u884c\u4f8b"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#73-procedural-abstraction","text":"procedural adstraction \u628a what code does \u548c how it works \u7ed9\u5206\u5f00\u4e86. Functions \u5c31\u662f C++ \u4e2d\u8fc7\u7a0b\u62bd\u8c61\u5316\u7684\u4e3b\u8981\u5de5\u5177.","title":"7.3 Procedural Abstraction \u8fc7\u7a0b\u62bd\u8c61\u5316"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#731-interfaces-implementations","text":"CS terminology \u4e2d\uff0c interface \u6307\u7528\u6765 specify what something does \u7684\u4e1c\u897f\uff0c\u800c implementation specifes how it works. #include <iostream> #include <vector> using namespace std; double mean(vector<double> v) //interface { // implementations } int main() { vector<double> v; double m = mean(v); // only care about the interface here cout << m; }","title":"7.3.1 Interfaces \u548c implementations"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#74-unit-testing","text":"","title":"7.4 Unit Testing"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#741-testing","text":"Testing \u6709\u4ee5\u4e0b\u51e0\u4e2a\u7c7b\u578b Unit testing: One piece at a time (e.g., a function) \u5b83\u7684\u597d\u5904\u662f (1) Find and fix bugs early (2) Test smaller, less complex, easier to understand units. System Testing: Test Entire project (code base) \u6211\u4eec\u5728 unit testing \u4e4b\u540e\u5e94\u8be5\u8fdb\u884c system testing \u6765\u786e\u4fdd\u4ee3\u7801\u7684\u8854\u63a5\u6b63\u786e Regression testing: \u5728\u66f4\u6539\u4ee3\u7801\u4e4b\u540e\uff0cAutomatically run all unit and system tests. \u8fd9\u4e00\u8282\u8bfe\u63d0\u4f9b\u4e86 unit_test_framework.hpp , \u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a macro(\u5b8f) \u6765\u65b9\u4fbf\u5199 Unit Tests. \u56e0\u800c\u5199 project \u53ea\u9700\u8981\u628a\u8fd9\u4e2a\u6587\u4ef6 include \u8fdb testing \u7684 cpp \u6587\u4ef6\u5c31\u53ef\u4ee5\u4e86 #include \"unit_test_framework.hpp\"","title":"7.4.1 Testing \u7684\u7c7b\u578b"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#742-test-cases","text":"Type prehibited: \u7c7b\u578b\u4e0d\u4e00\u81f4\u53ef\u80fd\u4f1a\u5bfc\u81f4 compiler error \u7684 Testing\uff0c \u4e0d\u9700\u8981\u5199. Requires prohibited: \u8fdd\u53cd requirements \u7684 tests. \u4e0d\u9700\u8981\u5199. Simple: \u4e00\u822c\u7684 test cases. Edge (Special): \u4e00\u4e9b\u8fb9\u7f18\u95ee\u9898\uff0c\u6bd4\u5982\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\u7684 array \u548c vector\uff0c\u6d4b\u8bd5\u4f17\u6570\u7684\u65f6\u5019\u8bbe\u7f6e\u591a\u4e2a\u4f17\u6570(\u5e94\u5f53\u53d6\u6700\u5c0f\u7684)\u7b49. Stress: \u5927\u578b\u7684\u6570\u636e\uff0c\u5982\u51e0\u4e07\u4e2a\u5143\u7d20\u7684vector. \u8fd9\u8282\u8bfe\u4e0d\u9700\u8981\u5199.","title":"7.4.2 Test Cases \u7684\u7c7b\u578b"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#743-unit-test-framework","text":"\u6bd4\u5982\u6d4b\u8bd5\u4e00\u4e2a\u53eb\u505a arrays.cpp \u7684\u6587\u4ef6\uff0c\u6211\u4eec\u5e94\u8be5\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u53eb arrays_tests.cpp . \u5728\u5176\u4e2d\u5f15\u7528 framework. \u5982\u679c\u5176\u4e2d\u5305\u62ec\u4e24\u4e2a\u53eb\u505a slideRight() \u7684\u51fd\u6570\u548c flip() \u7684\u51fd\u6570\uff0c\u90a3\u4e48\u5c31\u5728 arrays_tests.cpp \u4e2d\u5199\u4e00\u4e9b\u53eb\u505a TEST(test_slide_right_123) \u548c `TEST(test_flip_123) \u8fd9\u6837\u7684\u51fd\u6570. #include \"arrays.hpp\" #include \"unit_test_framework.hpp\" // A helper function for comparing arrays. Returns true if the // arrays are the same size and contain the same values. bool compare_arrays(int arr1[], int size1, int arr2[], int size2) { if (size1 != size2) { return false; } for (int i = 0; i < size1; ++i) { if (arr1[i] != arr2[i]) { return false; } } return true; } // We define a test case with the TEST(<test_name>) macro. // <test_name> can be any valid C++ function name. TEST(test_slide_right_1) { int testing[] = { 4, 0, 1, 3, 3 }; int correct[] = { 3, 4, 0, 1, 3 }; slideRight(testing, 5); ASSERT_TRUE(compare_arrays(testing, 5, correct, 5)); } TEST(test_flip_1) { int testing[] = { 4, 0, 1, 3, 3 }; int correct[] = { 3, 3, 1, 0, 4 }; flip(testing, 5); ASSERT_TRUE(compare_arrays(testing, 5, correct, 5)); } TEST_MAIN() // No semicolon! \u8fd9\u5c31\u662f\u5b8f\u4e2d\u5b9a\u4e49\u7684\u8bed\u6cd5 \u5728\u5199\u5b8c\u4e4b\u540e\uff0c\u7528\u7f16\u8bd1\u5668\u5236\u4f5c\u51fa .exe \u6587\u4ef6 g++ -Wall -Werror -pedantic -g -std=c++11 arrays.cpp arrays_tests.cpp -o arrays_tests.exe ./arrays_tests.exe # Running test: numbers_are_equal # PASS # Running test: true_is_true # PASS # *** Results *** # ** Test case 'numbers_are_equal': PASS # ** Test case 'true_is_true': PASS # *** Summary *** # Out of 2 tests run: # 0 failure(s), 0 error(s) \u8fd9\u4e2a framework macro \u6700\u5927\u7684\u7279\u70b9\u662f\uff1a\u8fd8\u53ef\u4ee5\u7528\u5236\u4f5c\u51fa\u6765\u7684 .exe \u53ea\u8dd1\u5176\u4e2d\u7684\u4e00\u4e2a\u51fd\u6570. ./arrays_tests.exe numbers_are_equal # Running test: numbers_are_equal # PASS # *** Results *** # ** Test case 'numbers_are_equal': PASS # *** Summary *** # Out of 1 tests run: # 0 failure(s), 0 error(s)","title":"7.4.3 Unit-Test Framework \u6559\u7a0b"},{"location":"07-Call-Stack-Procedural-Abstraction-and-Unit-Tests.html#744-framework-macro-assert","text":"Assertion Description ASSERT_EQUAL(first, second) \u76f8\u7b49 ASSERT_NOT_EQUAL(first, second) \u4e0d\u7b49 ASSERT_TRUE(bool value) true ASSERT_FALSE(bool value) false ASSERT_ALMOST_EQUAL(double first, double second, double precision) $ ASSERT_SEQUENCE_EQUAL(first, second) arrays, vectors, lists \u76f8\u7b49","title":"7.4.4 Framework macro\u63d0\u4f9b\u7684\u7279\u6b8a Assert \u51fd\u6570"},{"location":"08-Pointers-and-Arrays.html","text":"\u9898\u5916\u8bdd1\uff1ausing namespace \u9898\u5916\u8bdd2: address \u7684 number system 8 Pointer and Array 8.1 Pointer \u6307\u9488 8.1.1 Pointer Type \u6307\u9488\u53d8\u91cf\u7c7b\u578b 8.1.2 Dereference Operator(*) \u89e3\u5f15\u7528\u7b26\u53f7 8.1.3 Pointer Type \u7684\u7528\u5904 8.1.4 nullptr (\u7a7a\u6307\u9488) 8.1.5 Pointer \u578b\u51fd\u6570 8.1.6 Pass-by-Pointer \u7684\u51fd\u6570 8.2 Array 8.2.1 Kinds of objects in C++ 8.2.2 Array Decay into pointer 8.2.3 Array Decay \u7684\u672c\u8d28: [] \u662f\u4e00\u4e2a\u590d\u5408\u8fd0\u7b97\u7b26, == *() 8.2.4 Array \u578b object \u7684\u672c\u8d28 8.2.5 = \u8d4b\u503c\u8fd0\u7b97\u7b26\u7684\u8fd4\u56de\u503c: \u4e3a\u4ec0\u4e48 array \u578b object \u4e0d\u5141\u8bb8 8.2.5.1 \u7136\u800c class \u578b object \u5373 class \u548c struct \u662f\u5141\u8bb8\u8fd9\u4e48\u505a\u7684 8.2.5.2 Array Decay \u5728 function parameter \u4e2d 8.2.5.3 [] \u7684\u5b9a\u4e49: \u5176\u5b9e\u4e0d\u5c40\u9650\u4e8e array \u4e2d 8.3 Pointer Arithmetic 8.3.1 sizeof() operator 8.3.2 Pointer Offset: ptr + x 8.3.3 arr[i] (== i[arr]) \u7684\u5b9a\u4e49 8.3.4 Pointer Difference: ptr1 - ptr2 8.3.5 Pointer Comparison 8.3.6 Traversal by Pointer \u9898\u5916\u8bdd1\uff1a using namespace \u4e00\u4e2a namespace \u5c31\u662f\u4e00\u79cd way to organize code. \u610f\u601d\u5c31\u662f\u6807\u8bb0\u7ed9\u7f16\u8bd1\u5668\uff1a\u5982\u679c\u4e0d\u77e5\u9053\u67d0\u4e2a\u4e1c\u897f\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u90a3\u4e48\u5c31\u53bb\u8fd9\u4e2a namespace \u91cc\u53bb\u627e. \u6bd4\u5982 using namespace std; \u5c31\u662f\u544a\u8bc9 compiler: \u5f53\u4f60\u770b\u5230 cout \u7684\u65f6\u5019\uff0c\u4f60\u4e0d\u77e5\u9053\u8fd9\u4e2a function \u5728\u54ea\u91cc\uff0c\u4f60\u53ef\u4ee5\u52a0\u4e0a std \u770b\u770b. \u8fd9\u4e2a\u53eb standard namespace. \u9898\u5916\u8bdd2: address \u7684 number system \u6211\u4eec\u53d1\u73b0\u6211\u4eec model \u91cc\u9762\u7684 addresses \u603b\u662f 0x6E3F \u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u5176\u5b9e\u8fd9\u91cc\u7684\u610f\u601d\u662f $6E3F_{16}$ , \u524d\u7f00 0x \u8868\u793a\u7684\u662f\u8fd9\u662f\u4e00\u4e2a 16 \u8fdb\u5236 (Hexadecimal) \u7684\u6570. \u4e3a\u4ec0\u4e48\u8981 16 \u8fdb\u5236\uff1a\u56e0\u4e3a 16 \u8fdb\u5236\u4e2d\u4e2a\u4f4d\u6570\u6700\u5927\u7684\u662f $F$ \u5373 \u4ece 0 \u5f00\u59cb\u7684 15\uff0c\u5b83\u7684 binary \u5bf9\u5e94\u6b63\u597d\u662f $1111$. \u6240\u4ee5\u4e00\u4e2a 4 \u4f4d hexadecimal \u7684\u6570\u53ef\u4ee5\u8868\u793a\u4e00\u4e2a\u7531 16 \u4e2a bits \u7ec4\u6210\u7684\u6570. \u8fd9\u5c31\u662f\u4e00\u4e2a 16-bit \u7684\u5730\u5740. \u800c\u73b0\u5b9e\u4e2d\u6211\u4eec\u5e38\u7528\u7684\u662f 32-bit \u548c 64-bit \u7684\u5730\u5740. \u56fe\u91cc\u8fd9\u5c31\u662f\u4e00\u4e9b 32-bit \u7684\u5730\u5740\u3002 $2^{32}$ bits \u7ea6\u7b49\u4e8e 4 GB. \u6211\u4eec\u6240\u8bf4\u7684 32-bit \u548c 64-bit \u7684\u8ba1\u7b97\u673a\uff0c\u5c31\u662f\u8ba1\u7b97\u673a CPU \u7684 memory register\uff08\u5bc4\u5b58\u5668\uff09 \u7684\u5927\u5c0f\uff0c\u4e5f\u4ee3\u8868\u4e86\u5b83\u4e00\u6b21\u6027\u5904\u7406\u7684\u6700\u5927\u6570\u636e\u5bbd\u5ea6\u3002 8 Pointer and Array \u56de\u987e\uff1aC++ \u4e2d\uff0cobject \u662f memory \u4e2d\u7684 a piece of data\uff0c\u5b83\u4f4d\u4e8e memory \u4e2d\u7684\u67d0\u4e2a address. \u5728\u521b\u5efa object \u65f6\uff0ccompiler \u4f1a\u51b3\u5b9a\u5bf9\u8c61\u7684\u4f4d\u7f6e. \u9664\u4e86\u51b3\u5b9a\u4e00\u4e2a object \u662f\u5728 global segment, stack \u8fd8\u662f\u5728 heap segment\uff08\u5806\u6bb5, \u7528\u4e8e dynamic memory \u7684 segment\uff09\u5916\uff0c\u6211\u4eec\u65e0\u6cd5\u63a7\u5236\u5176\u4f4d\u7f6e. \u5728\u76f8\u540c\u7684\u7a0b\u5e8f\u548c\u8f93\u5165\u4e0b\uff0c \u540c\u4e00\u7cfb\u7edf\u4e0a\u8fd0\u884c\u4e24\u6b21\u76f8\u540c\u7684\u7a0b\u5e8f\u90fd\u4f1a\u5c06\u76f8\u540c\u7684\u5bf9\u8c61\u653e\u7f6e\u5728\u4e0d\u540c\u7684 memory address \uff0c\u4e0d\u540c\u7684 system \u66f4\u52a0\u4e0d\u540c. \u867d\u7136\u4f5c\u4e3a programmer \u65e0\u6cd5\u63a7\u5236 object\uff0c\u4f46\u662f\u6211\u4eec\u80fd\u591f\u5bf9\u5176\u8fdb\u884c\u67e5\u8be2. 8.1 Pointer \u6307\u9488 8.1.1 Pointer Type \u6307\u9488\u53d8\u91cf\u7c7b\u578b \u5c31\u50cf declare variable \u7684\u65f6\u5019\u653e\u5728\u53d8\u91cf\u5de6\u4fa7\u7684 &x \u548c\u5e73\u65f6\u4f5c\u4e3a operator \u7684 & \u4e0d\u540c\uff0c pointer \u7c7b\u578b\u7684 declaration \u4e2d *ptr \u548c\u5e73\u65f6\u4f5c\u4e3a operator \u7684 * \u4e0d\u540c. int *ptr \u5e76\u4e0d\u662f declare \u4e00\u4e2a\u53eb\u505a *ptr \u7684 int \u7c7b\u578b variable\uff0c\u800c\u662f declare \u4e00\u4e2a\u53eb\u505a ptr \u7684 int * \u7c7b\u578b\u7684 variable\uff01 \u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u662f\u4e00\u4e2a \u65b0\u7684\u53d8\u91cf\u7c7b\u578b \uff0c\u5b83\u5e76\u4e0d\u662f\u4e00\u4e2a int\uff0c\u800c\u662f\u4e00\u4e2a int pointer. \u50cf\u8fd9\u6837\u7684\u53d8\u91cf\u7c7b\u578b\u5c31\u53eb\u505a pointer type \uff0c\u8fd9\u4e2a type \u7684\u540d\u5b57\u5305\u542b\uff1a The type of the objects whose addresses the pointer can hold as a value (\u8fd9\u4e2a\u53d8\u91cf\u6240\u80fd\u5b58\u50a8\u7684\u5730\u5740\u5bf9\u5e94\u7684\u5bf9\u8c61\u7c7b\u578b)\uff0c\u6bd4\u5982 int * \u53ea\u80fd\u5b58\u50a8 int \u53d8\u91cf\u7c7b\u578b\u7684\u5bf9\u8c61. * \u7b26\u53f7\uff0c\u4ee5\u8868\u793a\u8fd9\u662f\u4e00\u4e2a pointer \u7c7b\u578b. \u5b9e\u9645\u4e0a\u6240\u6709\u6307\u9488\u7684\u503c\u90fd\u662f\u540c\u4e00\u79cd\u7c7b\u578b\uff0c\u5c31\u662f\u5730\u5740\uff0c\u6bd4\u5982 int * \u548c char * \u7684\u503c\u90fd\u4e00\u6837\u662f\u5730\u5740\uff0c\u4f46\u662f\u4e3a\u4e86\u80fd\u591f\u8fdb\u884c\u8fd0\u7b97\uff0c\u6307\u9488\u8fd8\u5b9a\u4e49\u4e86\u5b83\u80fd\u5b58\u653e\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u8fd9\u6837\u5b50 int * \u548c char * \u5c31\u53d8\u6210\u4e86\u4e24\u79cd\u7c7b\u578b\uff0c\u8868\u793a\u8fd9\u4e2a\u5730\u5740\u6307\u5411\u7684 object \u662f\u4e0d\u540c\u7c7b\u578b\u7684. C++ \u4e2d\u7684\u6bcf\u4e2a data type \u90fd\u6709 corresponding pointer type\uff0c\u5305\u62ec pointer type \u81ea\u8eab\uff01\u6bd4\u5982 double * \u5c31\u662f\u5b58\u50a8 double \u7c7b\u578b\u7684 pointer type\uff0c\u800c double ** \u5c31\u662f\u5b58\u50a8 double * \u7c7b\u578b\u7684\u5730\u5740\u7684 pointer type. \u6211\u4eec\u77e5\u9053\uff0cpointer type \u5b58\u50a8\u7684\u662f\u5730\u5740. \u6240\u4ee5\u5728 declare \u7684\u65f6\u5019\uff0c\u6211\u4eec\u7ed9\u5b83\u8d4b\u7684\u503c\u662f variable \u6240\u6307\u4ee3\u7684 object \u7684 memory address. \u4e8e\u662f\u6211\u4eec\u5c31\u8981\u5bf9\u53d8\u91cf\u4f7f\u7528 reference operator ( & ) \u7136\u540e\u628a\u83b7\u53d6\u5230\u7684\u503c assign \u7ed9\u6211\u4eec\u7684\u6307\u9488\u53d8\u91cf. int x = 3; int *ptr = &x; cout << ptr << endl; //0x7ffee0659a2c \u6211\u4eec\u8f93\u51fa\u8fd9\u4e2a\u53eb ptr \u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u987a\u5229\u50a8\u5b58\u4e86 x \u7684\u5730\u5740. \u4f46\u662f\u5b58\u5b83\u7684\u5730\u5740\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u2014\u2014 8.1.2 Dereference Operator( * ) \u89e3\u5f15\u7528\u7b26\u53f7 * \u53eb\u505a dereference operator\uff08\u89e3\u5f15\u7528\u7b26\u53f7\uff09\uff0c\u662f\u4e13\u95e8\u7528\u4e8e pointer \u7c7b\u578b\u7684 variable \u7684 operator\uff0c\u7528\u4e8e\u83b7\u53d6\u5176\u4f5c\u7528\u4e8e\u7684 pointer variable \u6240\u5b58\u50a8\u7684\u5730\u5740\u4f4d\u7f6e\u4e0a\u7684 variable. \u6ce8\u610f\u5230\u8fd9\u91cc\u7684 * \u548c\u6211\u4eec\u5728 declare \u6307\u9488\u53d8\u91cf\u7684 type * \u4e2d\u7684 * \u662f\u4e0d\u4e00\u6837\u7684\u4e1c\u897f. \u90a3\u4e2a\u53ea\u662f\u53d8\u91cf\u7c7b\u578b\u7684 name \u7684\u4e00\u90e8\u5206\uff1b\u8fd9\u91cc\u5219\u662f\u4e00\u4e2a operator\uff0c\u5bf9\u53d8\u91cf\u8fdb\u884c\u8fd0\u7b97. int x = 3; cout << &x << endl; //0x7ffee0659a2c int *ptr = &x; cout << ptr << endl; //0x7ffee0659a2c cout << *ptr << endl; //3 \u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u89e3\u5f15\u7528\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u88ab\u5b58\u50a8 object\uff0c\u6ce8\u610f\u5e76\u4e0d\u662f\u83b7\u5f97\u5b83\u7684\u503c\uff0c\u800c\u662f\u76f4\u63a5\u8f6c\u5230\u4e86\u539f object \u4e0a\uff0c\u5c31\u662f\u8bf4 \u6211\u4eec\u5bf9 *ptr \u7684\u4efb\u4f55\u64cd\u4f5c\u90fd\u4f1a\u76f4\u63a5\u6539\u53d8\u5b83\u6307\u5411\u7684 object . \u8fd9\u5c31\u662f\u6307\u9488 \u201dpointer\u201c \u8fd9\u4e2a\u540d\u5b57\u7684\u542b\u4e49\uff0c\u5373\u5b83\u4e0d\u6b62\u662f\u5b58\u50a8\u5730\u5740\uff0c\u800c\u4e14\u53ef\u4ee5\u901a\u8fc7\u89e3\u5f15\u7528\u76f4\u63a5\u6307\u5411\u8fd9\u4e00\u5730\u5740\u7684 object. int x = 3; int *ptr = &x; *ptr++; cout << x; //4, \u66f4\u6539\u4e86 \u6211\u4eec\u8fd8\u53ef\u4ee5\u66f4\u6539 ptr \u50a8\u5b58\u7684\u5730\u5740\u6765\u8ba9\u5b83\u6307\u5411\u53e6\u4e00\u4e2a object\uff01\u521a\u624d\u6211\u4eec\u8bf4\u4e86\uff0cC++\u53ea\u5728initialization\u65f6\u652f\u6301 reference semantic \u5bfc\u81f4\u6211\u4eec\u4e00\u65e6\u628a\u4e00\u4e2a variable name \u548c\u4e00\u4e2a object \u7ed1\u5b9a\uff0c\u90a3\u4e48\u5c31\u518d\u4e5f\u65e0\u6cd5\u8ba9\u8fd9\u4e2a variable name \u7ed1\u5b9a\u5176\u4ed6 object \u4e86. \u8fd9\u5c31\u662f\u6211\u4eec\u9700\u8981 pointer type \u7684\u539f\u56e0\uff0c\u56e0\u4e3a pointer type \u53ef\u4ee5\u968f\u4fbf\u66f4\u6539\u50a8\u5b58\u54ea\u4e2a object \u7684\u5730\u5740\uff0c\u800c\u4e14\u901a\u8fc7\u89e3\u5f15\u7528\u8fd0\u7b97\u53ef\u4ee5\u76f4\u63a5\u5bf9\u8fd9\u4e2a object \u8fdb\u884c\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u53ef\u4ee5\u7075\u6d3b\u5207\u6362\u81ea\u5df1\u8868\u793a\u54ea\u4e2a object. \u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u80fd\u591f simulate reference semantics. \u6211\u4eec\u4e00\u65e6\u628a\u4e00\u4e2a variable name \u548c\u4e00\u4e2a object \u7ed1\u5b9a\uff0c\u90a3\u4e48\u5c31\u518d\u4e5f\u65e0\u6cd5\u8ba9\u8fd9\u4e2a variable name \u7ed1\u5b9a\u5176\u4ed6 object\uff0c\u8fd9\u4e2a\u89c4\u5b9a\u6ca1\u6709\u7279\u4f8b\uff0c\u5f53\u7136\u5305\u62ec pointer type\uff1a\u6211\u4eec\u77e5\u9053\u4e00\u4e2a pointer \u53d8\u91cf\u81ea\u5df1\u7ed1\u5b9a\u7684 object\uff0c\u5373\u5b83\u5728 memory \u4e2d\u7684\u4f4d\u7f6e\u5f53\u7136\u662f\u56fa\u5b9a\u7684. \u7136\u800c\u5b83\u901a\u8fc7\u50a8\u5b58\u522b\u7684 object \u7684\u5730\u5740\u7136\u540e\u901a\u8fc7\u89e3\u5f15\u7528\u968f\u610f\u5207\u6362\u81ea\u5df1\u64cd\u4f5c\u7684 object. int x = 3; int *ptr = &x; cout << *ptr << endl; //3 int y = 4; ptr = &y; cout << *ptr; //4\uff0c\u73b0\u5728\u6307\u5411y x = 1; y = 5; cout << *ptr; //5\uff0c\u548cy\u7ed1\u5b9a \u201c\u6307\u5411\u4e00\u4e2a object\u201d\uff0c\u8fd9\u5c31\u662f\u6307\u9488\u7684\u540d\u5b57\u7684\u610f\u601d. \u4e0b\u9762\u662f\u4e00\u4e2a\u5e26 activation record \u7684\u4f8b\u5b50. int main(){ int foo = 1; int *bar = &foo; foo += 1; *bar += 1; cout << foo << endl;//3 cout << bar << endl; //some address cout << *bar << endl; //3 } 8.1.3 Pointer Type \u7684\u7528\u5904 \u6211\u4eec\u521a\u624d\u8bf4\u4e86\uff0cpointer type \u53ef\u4ee5 \u201c\u6a21\u62df\u201d reference semantics\uff0c\u8fd9\u5728\u4ec5\u652f\u6301 initialization \u65f6\u7684 reference semantics \u7684 C++ \u8bed\u8a00\u91cc\u662f\u5f88\u91cd\u8981\u5f88\u6709\u7528\u7684\u4e00\u4e2a\u7279\u6027. \u5b83\u53ef\u4ee5 use objects across different scopes . Enables Subtype Polymorphism(\u5b50\u7c7b\u578b\u591a\u6001) . Keep track of objects in dynamic memory . Implement linked data structures. \u7531\u4e8e arrarys \u4e2d\u7684 objects \u5177\u6709 sequential address\uff0c\u6211\u4eec\u80fd\u591f \u901a\u8fc7 pointer arithmetic \u6765\u8ba1\u7b97\u6211\u4eec\u60f3\u8981\u7684 element \u7684 address. \u540e\u56db\u6761\u76ee\u524d\u8fd8\u4e0d\u77e5\u9053\uff0c\u4f46\u662f\u8fd9\u8282\u8bfe\u90fd\u4f1a\u8bb2. 8.1.4 nullptr (\u7a7a\u6307\u9488) Pointer type \u662f\u4e00\u79cd atomic \u7684\u6570\u636e\u7c7b\u578b \uff0c\u610f\u601d\u662f\u4ed6\u4e0d\u80fd\u518d\u88ab\u5212\u5206\u4e3a\u66f4\u5c0f\u7684 object. \u5bf9\u4e8e\u4e00\u4e2a atomic \u7684\u6570\u636e\u7c7b\u578b\u800c\u8a00\uff0c\u5982\u679c\u6ca1\u6709\u88abexplicitly initialized to some value\uff0c\u90a3\u4e48\u5b83\u4f1a\u88ab\u9ed8\u8ba4\u5730 initialized \u4e3a\u4e00\u4e2a undefined value: int x = 3; int *ptr; //\u6ca1\u6709\u663e\u5f0f\u521d\u59cb\u5316, \u9ed8\u8ba4\u503c\u4e3a undefined value ptr = &x; //\u73b0\u5728\u5b83\u5c31\u662f\u4e00\u4e2awell-define value, \u503c\u5c31\u662fx\u7684\u5730\u5740 \u800c deference \u4e00\u4e2a undifined value \u7684\u6307\u9488\u53d8\u91cf\u662f\u4e00\u4e2a undefined behavior. \u8fd9\u610f\u5473\u7740\u5b83\u4e0d\u4e00\u5b9a\u62a5\u9519\uff0c\u4f46\u662f\u503c\u4e00\u5b9a\u4e0d\u5bf9. \u8fd9\u79cd undefined \u884c\u4e3a\u662f\u975e\u5e38\u96be\u4ee5 debug \u7684. \u53ef\u4ee5\u7528 address sanitizer \u6765\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a. \u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u5c31\u662f\u8bd5\u56fe\u7ed9\u4e00\u4e2a undefined to some object \u7684\u6307\u9488\u53d8\u91cf\u8d4b\u503c\uff0c\u8fd9\u662f\u4e00\u4e2a undefined behavior. x \u7684\u503c\u4e00\u5f00\u59cb\u662f undefined value\uff0c\u4f46\u662f\u540e\u9762\u88ab\u5206\u914d\u5230\u4e86 a \u7684\u5730\u5740\uff0c\u800c y \u7684\u503c\u5219\u4ecd\u7136 undefined\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u662f\u4e00\u4e9b junk address. \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5 dereference x \u4f46\u662f dereference y \u5c31\u4f1a\u5bfc\u81f4\u6211\u4eec\u6307\u5230\u4e00\u4e9b\u83ab\u540d\u5176\u5999\u7684 object \u4e0a. int main(){ int *x; int *y; int a = -1; x = &a; cout << *x << endl; // prints -1 *x = 42; cout << a << endl; // prints 42 *y = 13; // UNDEFINED BEHAVIOR } A null pointer (\u7a7a\u6307\u9488) \u662f\u4e00\u4e2a\u503c\u4e3a 0x0 \u7684\u6307\u9488\uff0c\u5199\u4f5c nullptr \uff0c\u6ca1\u6709 object \u80fd\u591f\u88ab\u653e\u5728\u8fd9\u4e2a\u5730\u5740\u4f4d\u7f6e\uff0c\u56e0\u800c null pointer \u4e0d\u6307\u5411\u4efb\u4f55 object. nullptr \u6709\u4e24\u4e2a\u597d\u5904. \u5b83\u53ef\u4ee5\u7528\u4e8e\u4efb\u4f55 pointer type\uff0c\u6bd4\u5982 int *ptr = nullptr , char *ptr = nullptr , \u901a\u7528\u7684. \u5f53\u7136\u6307\u5411\u4e0d\u540c\u7c7b\u578b\u7684 nullptr \u8fd8\u662f\u4e0d\u80fd\u8fdb\u884c\u8fd0\u7b97\u7684. c++ int main() { int *ptr1 = nullptr; double *ptr2 = nullptr; cout << (ptr1 == ptr2); // error, \u5730\u5740\u503c\u90fd\u662f\u4e00\u6837\u7684, \u4f46\u8bed\u6cd5\u5b9a\u4e49\u4e0d\u80fd\u8fd9\u6837 cout << (ptr1 == nullptr); // 1 } dereference \u4e00\u4e2a nullptr \u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u76f4\u63a5 crash\uff0c\u8fd9\u5c31\u975e\u5e38\u5bb9\u6613 debug. \u867d\u7136\u8fd9\u4e5f\u662f\u4e00\u4e2a undefined behavior\uff0c\u4f46\u662f\u6bd4\u4e71\u4e03\u516b\u7cdf\u7684 undefined behavior \u8981\u597d\u5f88\u591a\uff0c\u56e0\u4e3a\u4e00\u4e0b\u5c31\u770b\u51fa\u6765\u4e86. \u56e0\u800c\u5f53\u6211\u4eec declare \u4e00\u4e2a pointer type \u4f46\u662f\u4e0d\u60f3 initialize \u5b83\u7684\u503c\u65f6\u6700\u597d\u7684\u529e\u6cd5\u5c31\u662f\u7ed9\u5b83 assign \u4e00\u4e2a nullptr . 8.1.5 Pointer \u578b\u51fd\u6570 int * get_address(int x) { return &x; } void print(int val) { cout << val << endl; } int main() { int a = 3; int *ptr = get_address(a); print(42); cout << *ptr << endl; // UNDEFINED BEHAVIOR } // \u8f93\u51fa\u7ed3\u679c: 42 // 42 \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u91cc\u7684 pointer \u578b\u51fd\u6570\u5fc5\u987b\u8981\u6709 pass-by-reference \u7684\u53d8\u91cf\u624d\u53ef\u4ee5. \u56e0\u4e3a\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u5730\u5740\uff0c\u800c\u4f17\u6240\u5468\u77e5\u51fd\u6570\u7684 stack frame \u5728\u8fd0\u884c\u7ed3\u675f\u540e\u5c31\u4f1a\u88ab\u6467\u6bc1\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u4e0d\u7ed9\u8fd9\u91cc\u7684 x \u52a0\u4e0a\u5f15\u7528\uff0c\u6700\u540e\u8fd4\u56de\u7684\u51fd\u6570\u503c\u5c31\u662f\u4e00\u4e2a\u5df2\u7ecf\u88ab\u6467\u6bc1\u7684\u53d8\u91cf\u7684\u5730\u5740. \u5e76\u4e14\u6211\u4eec\u77e5\u9053\uff0c\u5728\u8fd9\u4e2a\u51fd\u6570\u4e4b\u540e\u8fd0\u884c\u7684\u51fd\u6570\u7684 stack frame \u7684\u4f4d\u7f6e\u5c31\u662f\u4e4b\u524d\u521a\u521a\u88ab\u6467\u6bc1\u7684\u51fd\u6570\u7684 stack frame \u7684\u4f4d\u7f6e. \u56e0\u800c\u6211\u4eec\u4f1a\u628a\u8fd9\u4e2a\u65b0\u7684 print() \u51fd\u6570\u91cc\u9762\u7684\u53d8\u91cf\u7684\u503c\u901a\u8fc7 ptr \u7684\u89e3\u5f15\u7528\u7ed9\u8bfb\u51fa\u6765. \u6240\u4ee5\u4fee\u6539\u8fd9\u4e2a\u51fd\u6570\uff0c\u53ea\u9700\u8981\u628a x \u6539\u6210 &x \u5b83\u5c31\u6b63\u786e\u4e86. int * get_address(int &x) { return &x; } void print(int val) { cout << val << endl; } int main() { int a = 3; int *ptr = get_address(a); print(42); cout << *ptr << endl; // UNDEFINED BEHAVIOR } // \u8f93\u51fa\u7ed3\u679c: 42 // 3 8.1.6 Pass-by-Pointer \u7684\u51fd\u6570 void swap_pointed(int *x, int *y) { int tmp = *x; *x = *y; *y = tmp; } int main() { int a = 3; int b = 5; swap_pointed(&a, &b); cout << a << endl; // prints 5 cout << b << endl; // prints 3 } \u6211\u4eec\u53d1\u73b0\u8fd9\u91cc\u7684 * \u6709\u70b9\u591a\uff0c\u4f46\u662f\u5176\u5b9e\u5f88\u597d\u60f3\uff1a pass-by-pointer \u51fd\u6570\u7684 parameter \u662f pointer type\uff0c\u90a3\u4e48\u4f20\u7ed9\u5b83\u7684\u503c\u5c31\u662f\u53d8\u91cf\u7684\u5730\u5740. \u6211\u4eec pass-by-reference \u7684\u76ee\u7684\u662f\u5728\u4e3b\u51fd\u6570\u7684 stack frame \u5916\u64cd\u4f5c\u4e3b\u51fd\u6570\u4e2d\u7684 objects. \u8fd9\u4e2a\u51fd\u6570\u91cc\u9762\u7684 *x , *y \u662f\u76f4\u63a5\u5bf9 pointer type \u53d8\u91cf x , y \u8fdb\u884c\u89e3\u5f15\u7528\uff0c\u83b7\u53d6\u5230\u5b83\u7684 object\uff0c\u4e5f\u5c31\u662f\u8bf4 *x \u4e00\u5f00\u59cb\u5c31\u662f main \u4e2d\u7684 a (object)\uff0c\u800c *y \u4e00\u5f00\u59cb\u5c31\u662f main \u4e2d\u7684 b (object). \u6211\u4eec\u9996\u5148\u628a a \u7684\u503c\u4ed8\u7ed9\u4e86 tmp \u8fd9\u4e2a local variable. (\u8fd9\u662f\u4e00\u4e2a\u4e3b\u52a8\u7684 value semantics\uff0c\u56e0\u4e3a tmp \u5e76\u4e0d\u662f\u5f15\u7528\u53d8\u91cf\uff0c\u5426\u5219\u662f int &tmp = *x ) \u7136\u800c\u628a b \u7684\u503c\u8d4b\u7ed9 a (\u8fd9\u91cc\u4e5f\u662f\u4e00\u4e2a value semantics\uff0c\u53f3\u8fb9\u7684 *y \u4f20\u9012\u7ed9 *x \u4e5f\u5c31\u662f a object \u4ee5 b object \u7684\u503c) \u7136\u540e\u5728\u628a tmp \u7684\u503c\u4e5f\u5c31\u662f\u539f\u672c a \u7684\u503c\u8d4b\u7ed9 b . 8.2 Array 8.2.1 Kinds of objects in C++ C++ \u4e2d\u6709\u8fd9\u6837\u4e09\u79cd object \u7c7b\u578b: Atomic (primitive)\uff1a\u539f\u5b50\u7c7b\u578b\uff0c\u4e0d\u80fd\u518d\u5206. \u6bd4\u5982 int, double, char \u548c\u6240\u6709pointer type. arrays\uff1ahomogeneous\uff0c\u662f\u4e00\u4e2a continuous sequence of objects of the same type. class-type\uff1aheterogeneous\uff0c\u4e00\u4e2a compound object\uff0c\u7531 member subobjects \u7ec4\u6210. \u5176 members \u548c\u5b83\u4eec\u7684 types \u7531\u4e00\u4e2a struct \u6216 class \u6765\u5b9a\u4e49. \u6240\u4ee5 Arrays \u5176\u5b9e\u662f\u4e00\u79cd\u5f88\u5e7f\u6cdb\u7684\u6570\u636e\u7c7b\u578b. \u5b83\u7684\u7279\u70b9\u662f\uff1a fixed size\uff0c elements of same type\uff0c ordered elements\uff0c \u5360\u636e contiguous chunk of memory\uff0c \u5e76 support constant time random access(\u5373 indexing) 8.2.2 Array Decay into pointer \u6211\u4eec\u90fd\u77e5\u9053\u6253\u5370 array \u8981\u7528\u5faa\u73af\uff0c\u4e0d\u80fd\u76f4\u63a5\u6253\u5370\uff0c\u56e0\u4e3a cout << arr << endl; # 0x000840c0 \u5f53\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6 arr \u7684\u503c\u65f6\uff0c\u6211\u4eec\u83b7\u53d6\u5230\u7684\u662f arr \u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u5730\u5740. \u6211\u4eec\u79f0\u8fd9\u4e2a\u8fc7\u7a0b\u4e3a arr \"decays\" into a pointer to its first element. \u56e0\u800c int arr1[4] = {1, 2, 3, 4}; int arr2[4] = {5, 6, 7, 8}; arr2 = arr1; \u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a array \u7684\u503c\u8d4b\u7ed9\u53e6\u4e00\u4e2a array\uff0c\u6211\u4eec\u77e5\u9053\u4e5f\u9700\u8981\u5faa\u73af\uff0c\u8fd9\u662f\u56e0\u4e3a \u5bf9\u4e8e\u5de6\u4fa7\u7684 arr2\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u5c1d\u8bd5 get the value\uff0c\u5b83\u4ecd\u7136\u662f\u4e00\u4e2a array\uff1b\u800c\u5bf9\u4e8e\u53f3\u4fa7\u7684 arr1\uff0c\u6211\u4eec\u5c1d\u8bd5 get its value\uff0c\u5b83\u5c31 decay \u4e3a\u4e86\u4e00\u4e2a pointer. \u8fd9\u5bfc\u81f4\u4e86\u8d4b\u503c\u7c7b\u578b\u4e0d\u4e00\u81f4. 8.2.3 Array Decay \u7684\u672c\u8d28: [] \u662f\u4e00\u4e2a\u590d\u5408\u8fd0\u7b97\u7b26, == *() \u6211\u4eec\u4f1a\u89c9\u5f97 array decay \u8fd9\u4ef6\u4e8b\u542c\u8d77\u6765\u5f88\u7384\u5e7b\uff0c\u50cf\u662f\u4ec0\u4e48\u653e\u5c04\u6027\u7269\u8d28\u8870\u53d8\u4e00\u6837\uff0c\u7b14\u8005\u5f88\u4e0d\u559c\u6b22\u8fd9\u79cd\u8bf4\u6cd5\uff0c\u6211\u89c9\u5f97\u83ab\u540d\u5176\u5999\u7684\u3002 \u5176\u5b9e\u5f88\u7b80\u5355\uff0c [] \u8fd9\u4e2a operator \u5c31\u662f\u4e00\u4e2a composite operator \u3002 a[n] \u5b9e\u9645\u4e0a\u5c31\u662f\u5bf9 *(a + n) \u7684\u7b80\u5199 \uff0c\u8fd9\u91cc type \u6307\u7684\u662f array \u4e2d\u5143\u7d20\u7684 type. \u672c\u8d28\u4e0a\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u5c31\u662f\u8ba9\u8fd9\u4e2a\u8fd0\u7b97\u66f4\u52a0\u76f4\u89c2\u4ee5\u53ca\u5199\u8d77\u6765\u66f4\u52a0\u7b80\u5355\u800c\u5df2\u3002 \u800c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\uff0c\u4f5c\u4e3a\u8fd0\u7b97\u7b26\u7684\u7b26\u53f7\u5728 initialize \u7684\u65f6\u5019\u603b\u662f\u6709\u5176\u4ed6\u610f\u601d\u7684\u3002 \u6bd4\u5982 * \u5728\u8fd0\u7b97\u7684\u65f6\u5019\u662f\u89e3\u5f15\u7528\u7b26\u53f7\uff0c\u4f46\u662f\u5728 initialize \u7684\u65f6\u5019\u5b83\u662f\u7c7b\u578b\u540d\u7684\u4e00\u90e8\u5206\uff0c type * \u8868\u793a\u8fd9\u662f\u4e2a\u6307\u9488\u7c7b\u578b\u3002 \u518d\u6bd4\u5982 & \u5728\u8fd0\u7b97\u7684\u65f6\u5019\u8868\u793a\u53d6\u5730\u5740\u7b26\u53f7\uff0c\u4f46\u662f\u5728 initialize \u7684\u65f6\u5019\u5b83\u867d\u7136\u4e0d\u662f\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c\u4f46\u4e5f\u8868\u793a\u4e86\u8fd9\u4e2a initialization \u7684\u610f\u601d\u662f\u53d6\u540d\uff0c\u6bd4\u5982 int &a = b \u8868\u793a\u7ed9 b \u7684 object \u53d6\u4e00\u4e2a\u65b0\u540d\u5b57 a . \u90a3\u4e48 [] \u5728 initialization \u7684\u65f6\u5019\u4e5f\u662f\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c type a[] \u8868\u793a\u8fd9\u4e2a a \u53d8\u91cf\u662f\u4e00\u4e2a array \u578b\u7684\u590d\u5408\u53d8\u91cf\uff0c\u5176\u5143\u7d20\u4e3a type \u578b. \u8fd9\u4e2a\u8bdd\u5176\u5b9e\u662f\u628a array \u8fd9\u4e2a\u7c7b\u578b\u7ed9\u62bd\u8c61\u6210\u4e00\u4e2a\u5f62\u8c61\u7684\u4e1c\u897f\u8868\u8fbe\u51fa\u6765\u4e86\uff0c\u5b9e\u9645\u4e0a array \u7c7b\u5e76\u4e0d\u662f\u4e00\u4e2a\u5f88\u5927\u7684\u4e00\u4e2a\u5305\u542b\u5f88\u591a\u5143\u7d20\u7684\u6846\u6846\uff0c\u800c\u662f \u4e00\u4e2a\u975e\u5e38\u7c7b\u4f3c\u4e8e\u6307\u9488\u7684\u6570\u636e\u7c7b\u578b\u3002 8.2.4 Array \u578b object \u7684\u672c\u8d28 \u4e00\u4e2a array \u7c7b\u578b\u7684 object\uff0c\u5b83\u7684\u503c\uff08\u6211\u4eec\u4f7f\u7528\u7684\u90e8\u5206\uff09\u5c31\u662f\u4e00\u4e2a\u5730\u5740\uff0c\u8fd9\u4e2a\u5730\u5740\u5c31\u662f\u6211\u4eec\u8bf4\u7684 array \u9996\u5143\u7d20\u7684\u5730\u5740\u3002 \u90a3\u4e48\u5b83\u548c\u6307\u9488\u6709\u4ec0\u4e48\u4e0d\u540c\u5462\uff1f \u5b83\u7684\u503c\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u7c7b\u4f3c\u4e8e\u662f const \u7684\u3002\u4e5f\u5c31\u662f\u50a8\u5b58\u7684\u8fd9\u4e2a\u5730\u5740\u662f\u4e0d\u80fd\u6539\u53d8\u7684\u3002\uff08\u4e0d\u50cf\u6307\u9488\u578b\u53d8\u91cf\uff0c\u503c\u53ef\u4ee5\u6539\u53d8\uff09 \u867d\u7136\u6211\u4eec\u4f7f\u7528\u5b83\u65f6\uff0c\u5b83\u7ed9\u6211\u4eec\u7684\u503c\u5c31\u662f\u9996\u5143\u7d20\u5730\u5740\uff0c\u4f46\u662f\u8fd9\u4e2a object \u672c\u8eab\u7684\u5360\u5185\u5b58\u5927\u5c0f\u5305\u542b\u4e86\u5b83\u6240\u6709\u5143\u7d20\u7684\u5927\u5c0f\u3002 \u5b83\u9664\u4e86\u5b58\u50a8\u9996\u5143\u7d20\u5730\u5740\u4e4b\u5916\u8fd8\u505a\u4e86\u522b\u7684\u4e8b\u60c5\uff0c\u6bd4\u5982\u6846\u5b9a\u4e86\u4e00\u4e2a\u6307\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u5757\u3002 8.2.5 = \u8d4b\u503c\u8fd0\u7b97\u7b26\u7684\u8fd4\u56de\u503c: \u4e3a\u4ec0\u4e48 array \u578b object \u4e0d\u5141\u8bb8 \u6240\u4ee5\u4e3a\u4ec0\u4e48\u5f53\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6\u628a\u4e00\u4e2a array \u8d4b\u503c\u7ed9\u53e6\u4e00\u4e2a array \u65f6\u4e0d\u884c\u3002\u56e0\u4e3a C++ \u8fd9\u4e2a\u8bed\u8a00\u4e0d\u5141\u8bb8 array \u7c7b\u578b\u6570\u636e\u7684\u8d4b\u503c\u64cd\u4f5c\u3002 \u8fd9\u4e2a\u539f\u56e0\u662f\u663e\u7136\u7684\uff0c\u5176\u4e2d\u4e00\u4e2a\u539f\u56e0\u662f\u56e0\u4e3a array \u662f\u4e00\u4e2a immutable \u7684 object\uff0c\u5b83\u7684\u957f\u5ea6\u5c31\u662f\u4e0d\u53ef\u53d8\u7684\u3002array \u662f\u4e00\u4e2a\u540c\u7c7b\u578b\u7684\u8fde\u7eed\u591a\u4e2a object \u7ec4\u6210\u7684\u590d\u5408\u578b object\uff0c\u4e00\u542c\u5c31\u77e5\u9053\u8fd9\u4e2a\u4e1c\u897f\u7684\u9650\u5236\u5f88\u591a\u3002 \u5f53\u6211\u4eec: arr1 = arr2 \u6211\u4eec\u662f\u60f3\u8981\u628a\u4e00\u4e2a array \u8d4b\u7ed9\u53e6\u4e00\u4e2a array\u3002 \u4f46\u662f array \u8fd4\u56de\u7ed9 = \u8fd9\u4e2a\u8d4b\u503c\u8fd0\u7b97\u7b26\u7684\u4e0d\u662f\u5b83\u81ea\u5df1\uff0c\u800c\u662f\u53ea\u662f\u8fd4\u56de\u5b83\u9996\u5143\u7d20\u7684\u5730\u5740\u3002 \u6211\u4eec\u7406\u89e3\u4e00\u4e0b\uff1a\u6211\u4eec\u521a\u624d\u8bf4\u5230\uff0carray \u5c31\u662f\u4e00\u4e2a\u5f88\u7c7b\u4f3c\u4e8e\u6307\u9488\u7684 object \u7c7b\u578b\uff0c\u4f46\u662f\u5b83\u5e76\u4e0d\u662f\uff0c\u5b83\u7684 copy constructor \u7684\u505a\u6cd5\u4ee5\u53ca assignment operator = \u7684 return value \u867d\u7136\u662f\u9996\u5143\u7d20\u5730\u5740\uff0c\u4f46\u662f\u5b83\u81ea\u5df1\u662f\u4e00\u4e2a\u590d\u6742\u7684\u590d\u5408\u578b\u53d8\u91cf\uff08 class \uff09\u3002 \u6240\u4ee5\u8fd9\u5c31\u662f type error \u7684\u539f\u56e0\u3002compiler \u770b\u5230\u7684\u662f\u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a\u5355\u7eaf\u7684 32 bit \u5730\u5740\u8d4b\u7ed9\u4e00\u4e2a\u590d\u6742\u7684\u590d\u5408\u578b\u53d8\u91cf\u3002\u5e76\u6ca1\u6709\u8fd9\u6837\u4e00\u4e2a operator= \u7684 overload\uff0c\u5176\u5de6\u8fb9\u53c2\u6570\u662f int * object, \u53f3\u8fb9\u662f array \u8fd9\u4e2a compound object. \uff08\u5176\u5b9e\u4e0d\u4ec5\u6ca1\u6709\uff0c\u6211\u4eec\u81ea\u5df1\u4e5f\u6ca1\u529e\u6cd5\u91cd\u5199\u4e00\u4e2a = \u6765 overload operator= \uff0c\u56e0\u4e3ac++ std \u628a array \u7c7b\u5b58\u50a8\u7684\u5730\u5740\u8bbe\u7f6e\u6210 const \u7684\uff0c\u8fd9\u5c31\u4ece\u6839\u6e90\u4e0a\u62d2\u7edd\u4e86\u6211\u4eec\u8fd9\u4e48\u505a\uff0c\u5426\u5219\u6211\u4eec\u4e5f\u53ef\u4ee5\u91cd\u5199\u4e00\u4e2a\uff09 8.2.5.1 \u7136\u800c class \u578b object \u5373 class \u548c struct \u662f\u5141\u8bb8\u8fd9\u4e48\u505a\u7684 \u7701\u6d41\uff1a\u4e24\u4e2a\u76f8\u540c\u7c7b\u578b\u7684 class \u6216\u8005 struct \u578b object \u53ef\u4ee5\u7528 = \u8d4b\u503c\u3002 \u5b9e\u9645\u4e0a\u8fd9\u5c31\u662f copy constrctor (\u548c default constructor \u4e00\u6837\u81ea\u52a8\u751f\u6210) \u6240\u505a\u7684\u4e8b\u60c5\u3002 8.2.5.2 Array Decay \u5728 function parameter \u4e2d \u6211\u4eec\u542c\u8fc7\u4e00\u4e2a\u8bf4\u6cd5\u53eb\u505a function \u5bf9\u4e8e array \u7684\u53c2\u6570\u662f\u81ea\u52a8 pass by reference \u7684\uff0c\u4f46\u662f\u8fd9\u79cd\u8bf4\u6cd5\u662f\u9519\u8bef\u7684\u3002\u5b9e\u9645\u4e0a\u8fd8\u662f pass by value \u7684\u3002\u7ecf\u8fc7\u521a\u624d\u7684\u8bba\u8ff0\u6211\u4eec\u5927\u6982\u5df2\u7ecf\u77e5\u9053\u4e86\u3002 \u9996\u5148\u8fd9\u4e2a\u884c\u4e3a\u5408\u6cd5\u662f\u56e0\u4e3a function \u7684 parameter passing \u5e76\u4e0d\u662f\u4e00\u4e2a\u521b\u5efa\u4e00\u4e2a copy \u5e76\u91ce\u86ee\u4f7f\u7528 = \u8d4b\u503c\u7684\u8fc7\u7a0b\u3002 \u5b83\u5176\u5b9e\u662f\u901a\u8fc7\u8c03\u7528\u590d\u5236\u6784\u9020\u51fd\u6570 \uff08copy Constructor\uff09 \u6765\u521b\u5efa\u7684\u3002 \u800c C++ \u8fd9\u4e2a\u8bed\u8a00\u7684\u8bbe\u8ba1\u5c31\u662f\uff1a\u5f53\u6211\u4eec\u4f20\u9012\u4e00\u4e2a\u6307\u9488\u4f5c\u4e3a\u53c2\u6570\u65f6\uff0c\u6211\u4eec\u751f\u6210\u7684 local variable \u4e0d\u662f\u4e00\u4e2a\u6570\u7ec4\u800c\u662f\u4e00\u4e2a\u5355\u7eaf\u7684\u6307\u9488\uff0c\u540d\u5b57\u548c\u4f20\u8fdb\u53bb\u7684 array \u540d\u76f8\u540c\uff0c\u4f46\u662f\u5b83\u662f\u4e00\u4e2a\u5355\u7eaf\u7684 pointer \u7c7b\u3002 \u6bd4\u5982\u6211\u4eec\u4f20\u8fdb\u53bb int a[] \uff0c\u751f\u6210\u7684\u5c40\u90e8\u53d8\u91cf\u5c31\u662f int *a . \u6240\u4ee5\u6211\u4eec\u4f20\u8fdb\u53bb\u7684 array \u5c31\u662f\u4f20\u8fdb\u53bb\u5b83\u9996\u5143\u7d20\u7684\u5730\u5740\uff0c\u662f\u4e00\u4e2a\u5355\u7eaf\u7684\u5730\u5740\u503c\uff0c\u8fd9\u662f\u56e0\u4e3a copy constructor \u4f1a\u5728\u51fd\u6570\u7684 stack frame \u4e2d\u65b0\u5efa\u4e00\u4e2a array object\uff0c\u7136\u540e \u590d\u5236\u539f array \u7684\u6240\u6709 members \u3002\u56e0\u800c\u6ca1\u6709 type error\u3002\u4e0d\u50cf\u6211\u4eec\u76f4\u63a5 arr1 = arr2 \u5c31\u6709 type error\u3002 \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u73b0\u5728 int a[] \u8fd9\u4e2a\u4e1c\u897f\u5355\u7eaf\u53ea\u662f\u4e00\u4e2a\u5730\u5740\u800c\u4e0d\u662f array \u4e86\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u8fd8\u80fd\u4f7f\u7528 a[2] \u8fdb\u884c\u68c0\u7d22\u5462\uff1f 8.2.5.3 [] \u7684\u5b9a\u4e49: \u5176\u5b9e\u4e0d\u5c40\u9650\u4e8e array \u4e2d \u5f53\u4f60\u6709\u4e00\u4e2a\u6307\u5411\u7c7b\u578b T \u7684\u6307\u9488 p \uff0c p[i] \u5b9e\u9645\u4e0a\u662f\u89e3\u5f15\u7528\u4e86 p \u50a8\u5b58\u7684\u5730\u5740\u4e4b\u540e i * sizeof(T)) \u4e2a byte \u7684\u5730\u5740\u3002 pointer arithmetic \u7b80\u5316\u4e86\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u91cd\u5199\u4e86 + \uff0c\u8ba9\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u6307\u9488\u578b p \u548c\u4e00\u4e2a int \u578b i \uff0c\u5b9a\u4e49\u4e86 *(p + i) \u8868\u793a\u89e3\u5f15\u7528 p \u6240\u5b58\u50a8\u7684\u5730\u5740\u540e\uff0c i \u500d\u7684 p \u6240\u5b58\u50a8\u5730\u5740\u4e0a\u7684 object \u5360 bytes \u5927\u5c0f\u7684\u5730\u5740\u4e0a\u7684 object. \u6240\u4ee5\u8bf4 p[i] = *(p + i) \u7684\u610f\u601d\u5c31\u662f\uff0c\u89e3\u5f15\u7528 \uff08 p \u52a0\u4e0a i \u4e2a T \u5927\u5c0f\u7684 bytes \u7684\u5730\u5740\uff09 \u4e0a\u7684\u503c. \u5f53\u7136\uff0c\u5728\u975e array \u533a\u57df\u4f7f\u7528\u8fd9\u4e2a\u7b26\u53f7\u867d\u7136\u5408\u6cd5\u4f46\u662f\u80af\u5b9a\u4f1a\u4ea7\u751f\u51fa\u83ab\u540d\u5176\u5999\u7684\u503c. \u4e0b\u9762\u4e3a\u4e00\u4e2a\u66f4\u52a0\u8be6\u7ec6\u7684\u89e3\u91ca. 8.3 Pointer Arithmetic 8.3.1 sizeof() operator int a[3] = {1, 2, 3}; cout << sizeof(a) << endl; //12 cout << sizeof(int) << endl; //4 sizeof() \u6709\u4e24\u4e2a\u91cd\u5199\uff0c\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a type\uff0c\u662f\u8fd4\u56de\u67d0\u4e2a type \u7684\u5185\u5b58\u5927\u5c0f\uff1b \u53e6\u5916\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a variable\uff0c\u662f\u8fd4\u56de\u8be5 variable \u7684 object \u6240\u5c5e\u7684 type \u7684\u5185\u5b58\u5927\u5c0f. \u6211\u4eec\u9700\u8981\u6ce8\u610f\uff0c\u6240\u6709\u7684\u6307\u9488 type \u7684\u5927\u5c0f\u90fd\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u7ba1\u6307\u5411\u7684\u5bf9\u8c61\u591a\u5927\uff01 \u8fd9\u4e2a\u5927\u5c0f\u548c\u64cd\u4f5c\u7cfb\u7edf\u7684 bit \u6570\u6709\u5173\u3002 \u572832\u4f4d\uff0832-bit\uff09\u7cfb\u7edf\u4e2d\uff0c\u6307\u9488\u901a\u5e38\u662f4\u5b57\u8282\uff0832\u4f4d/8 = 4\u5b57\u8282\uff09\u3002 \u572864\u4f4d\uff0864-bit\uff09\u7cfb\u7edf\u4e2d\uff0c\u6307\u9488\u901a\u5e38\u662f8\u5b57\u8282\uff0864\u4f4d/8 = 8\u5b57\u8282\uff09\u3002 \u8fd9\u662f\u56e0\u4e3a\u6307\u9488\u9700\u8981\u80fd\u591f\u5b58\u50a8\u5185\u5b58\u4e2d\u4efb\u610f\u4f4d\u7f6e\u7684\u5730\u5740\uff0c\u800c\u5730\u5740\u7684\u5927\u5c0f\u5fc5\u987b\u8db3\u4ee5\u8986\u76d6\u6574\u4e2a\u7cfb\u7edf\u7684\u5730\u5740\u7a7a\u95f4\u3002\u572832\u4f4d\u7cfb\u7edf\u4e2d\uff0c\u6709232232\u4e2a\u53ef\u80fd\u7684\u5730\u5740\uff0c\u56e0\u6b64\u9700\u89814\u5b57\u8282\u6765\u8868\u793a\u8fd9\u4e9b\u5730\u5740\u3002\u540c\u6837\uff0c64\u4f4d\u7cfb\u7edf\u6709264264\u4e2a\u53ef\u80fd\u7684\u5730\u5740\uff0c\u9700\u89818\u5b57\u8282\u6765\u8868\u793a\u3002 2\u5b57\u8282\u6307\u9488\uff08\u537316\u4f4d\u62162\u5b57\u8282\u957f\uff09\u901a\u5e38\u89c1\u4e8e\u8001\u65e7\u768416\u4f4d\u7cfb\u7edf\uff0c\u8fd9\u7c7b\u7cfb\u7edf\u73b0\u5728\u76f8\u5bf9\u8f83\u5c11\u89c1\u3002 8.3.2 Pointer Offset: ptr + x Def1\uff1a ptr + x \u89e3\u5f15\u7528\u7684\u662f memory \u4e2d\u524d\u65b9\u7b2c x \u4e2a *ptr \u578b\u53d8\u91cf\uff0c\u4e5f\u5c31\u662f \u524d\u65b9 i * sizeof(*ptr) \u4e2a\u5730\u5740\u7684\u4e1c\u897f. \u8fd9\u91cc\u7684 ptr \u662f\u4e00\u4e2a pointer type\uff0c\u5b58\u653e\u7684\u662f\u5730\u5740\uff0c\u800c x \u5219\u662f\u4e00\u4e2a int \u578b. \u901a\u5e38\u800c\u8a00\u4e24\u4e2a\u4e0d\u540c\u7c7b\u7684\u53d8\u91cf\u7684\u503c\u662f\u4e0d\u80fd\u76f8\u52a0\u7684\uff0c\u4f46\u662f\u8fd9\u91cc\u662f\u4e00\u4e2a\u65b0\u7684\u8bed\u6cd5\u5b9a\u4e49\uff1a\u5b9a\u4e49 poiter \u578b\u53d8\u91cf\u52a0\u4e0a int \u578b\u53d8\u91cf x \u7684\u610f\u601d\u662f\u5730\u5740\u540e\u63a8 x \u4e2a int \u7684\u5927\u5c0f. **\u4e00\u4e2a int \u5360 memory \u5927\u5c0f\u4e3a 4 bytes\uff0c\u4e00\u4e2a char\u5360 memory \u5927\u5c0f\u4e3a 1 byte. ** \u4e00\u4e2a short \u4fee\u9970\u7684 object \u603b\u662f\u81f3\u5c11\u548c\u4e00\u4e2a char \u4e00\u6837\u5927\uff08$\\geq 1)$\uff0c\u4e00\u4e2a long \u4fee\u9970\u7684 object \u603b\u662f\u81f3\u5c11\u548c\u4e00\u4e2a int \u4e00\u6837\u5927. \uff08$\\geq 4$\uff09 \u8fd9\u4e2a\u8bed\u6cd5\u4e5f\u9002\u7528\u4e8e\u5176\u4ed6\u7c7b\u578b\u53d8\u91cf\u7684 array\uff0c\u4f46\u662f\u4e5f\u4ec5\u9650\u4e8e array\uff01 \u66f4\u52a0 general \u5730\u8bf4\uff1a Def: \u5f53\u4f60\u5bf9\u6307\u9488\u8fdb\u884c\u52a0\u6cd5\u64cd\u4f5c\u65f6\uff0c\u52a0\u4e0a\u7684\u6570\u5b9e\u9645\u4e0a\u88ab\u4e58\u4ee5\u6307\u9488\u6240\u6307\u5411\u7c7b\u578b\u7684\u5360 bytes \u5927\u5c0f. \u56e0\u800c\u6307\u9488\u53d8\u91cf\u7684\u76f8\u51cf\u7ed3\u679c\u5e76\u4e0d\u662f\u6307\u9488\u53d8\u91cf\uff0c\u800c\u662f\u4e00\u4e2a int\uff0c\u503c\u4e3a\u5730\u5740\u5dee\u7684\u6240\u6307\u53d8\u91cf\u7c7b\u578b\u5927\u5c0f\u7684\u4e2a\u6570. \u56e0\u800c\u5b9e\u9645\u4e0a\u6211\u4eec\u5e76\u4e0d\u7528\u62c5\u5fc3\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u5927\u5c0f\u662f\u591a\u5c11\uff0c\u56e0\u4e3a pointer arithmetic \u7528\u7684\u662f\u6570\u636e\u7684\u4e2a\u6570. int arr[4] = {1, 2, 3, 4}; cout << arr[3] << endl; // \u7ed3\u679c\u4e3a4 cout << *(arr + 3) << endl; // \u7ed3\u679c\u4e5f\u4e3a4 \u8fd9\u91cc arr \u662f\u4e00\u4e2a int array. \u800c\u5f53\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6\u5b83\u7684\u503c\u65f6\uff0c\u5b83 decay \u4e3a\u4e86\u9996\u4e2a\u5143\u7d20\u7684 address. \u57fa\u4e8e\u8bed\u6cd5\uff0c arr + 3 \u7684\u503c\u662f arr \u9996\u4e2a\u5143\u7d20\u7684\u5730\u5740 ( &arr[0] ) \u52a0\u4e0a ($3 \\times $ \u5b83\u7684\u53d8\u91cf\u7c7b\u578b\u5360bytes\u6570\u91cf). \u56e0\u4e3a int \u5360 4 bytes\uff0c\u6700\u540e\u503c\u5c31\u662f ( &arr[0] + 12). \u56e0\u800c\u8fd9\u4e5f\u5c31\u7b49\u4e8e arr[3] . \u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f\u6570\u7ec4\uff0c *(arr + n) \u5c31\u7b49\u4e8e arr[n] . 8.3.3 arr[i] ( == i[arr] ) \u7684\u5b9a\u4e49 **\u5e76\u4e14\u8fd9\u4e2a arr[n] \u5176\u5b9e\u5e76\u4e0d\u662f\u4e00\u5b9a\u8981 arr \u7684\u7b2c n+1 \u4e2a\u5143\u7d20\uff0c\u8fd9\u53ea\u662f\u6211\u4eec\u7684\u4e60\u60ef\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a n[arr] \u4e5f\u53ef\u4ee5. ** \u56e0\u4e3a\u8fd9\u4e2a [] \u8fd0\u7b97\u7b26\u7684\u5b9a\u4e49\u5c31\u662f\u524d\u540e\u7684\u5143\u7d20\u7684\u6307\u9488 arithmetic \u7684\u89e3\u5f15\u7528\uff01 Def3: *(ptr + i) = *(i + ptr) == ptr[i] == i[ptr]; example: int arr[4] = {1, 2, 3, 4}; cout << arr[3] << endl; // 4 cout << *(arr + 3) << endl; // 4 cout << *(arr + 3) << endl; // 4 cout << *(3 + arr) << endl; // 4 cout << 3[arr] << endl; // 4 8.3.4 Pointer Difference: ptr1 - ptr2 Def: ptr2 - ptr1 computes the number of spaces between the two addresses in memory. \uff08\u4e24\u4e2a\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u4e4b\u95f4\u6709\u591a\u5c11\u4e2a\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\uff09 #include <iostream> using namespace std; int main() { int arr[5] = {6, 3, 2, 4, 5}; int *a = arr; int *d = &arr[1]; cout << (a - d) << endl; // 0 } 8.3.5 Pointer Comparison Pointer Comparison \u6bd4\u8f83\u7684\u662f\u5730\u5740\u7684\u5927\u5c0f. \u5730\u5740\u5728\u540e\u9762\u7684\u5c31\u662f\u66f4\u5927\u7684\u5730\u5740. \u56e0\u800c\u6bd4\u5982\uff1a int main() { int arr[5] = { 5, 4, 3, 2, 1 }; int *ptr1 = arr + 2; int *ptr2 = arr + 3; cout << (ptr1 == ptr2) << endl; //false cout << (ptr1 < ptr2) << endl; //true cout << (ptr1 == ptr2 - 1) << endl; //true cout << (ptr1 < arr + 5) << endl; //true } \u6700\u540e\u4e00\u6761\u503c\u5f97\u6ce8\u610f: arr + 5 \u662f\u4e00\u4e2a\u6ca1\u6709\u5b9a\u4e49\u7684\u5730\u5740. \u5b83\u8d85\u8fc7\u4e86 array \u7684\u8303\u56f4\uff0c\u4e0a\u9762\u5e76\u6ca1\u6709 compile \u65f6\u7684\u53d8\u91cf\uff0c\u56e0\u800c\u8fd9\u4e2a\u5730\u65b9 runtime \u65f6\u7684 object \u662f\u4e00\u4e2a\u4e71\u4e03\u516b\u7cdf\u7684 object. \u4f46\u662f\u8fd9\u5e76\u4e0d\u5f71\u54cd\u5b83\u7684\u5730\u5740\u6bd4\uff08\u8be5\u5730\u5740-5\u4e2a int \u5927\u5c0f\u7684\u5730\u5740\uff09\u8981\u5927. 8.3.6 Traversal by Pointer \u6253\u5370 array \u7684\u4e00\u4e2a\u65b9\u6cd5\uff1a #include <iostream> using namespace std; int maxValue(int arr[], int len) { // compiler changes to int *arr int max = *arr; for (int *p = arr; p < (arr + len); p++){ if (*p > max){ max = *p; } } return max; } int main() { int arr1[4] = {2, 3, 6, 1}; int m1 = maxValue(arr1, 4); cout << \"max value in arr1 = \" << m1 << endl; assert(m1 == 6); int arr2[3] = {-4, -2, -8}; int m2 = maxValue(arr2, 3); cout << \"max value in arr2 = \" << m2 << endl; assert(m2 == -2); } \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u6211\u4eec\u5bf9 *arr , *p \u8fdb\u884c\u6539\u53d8\uff0c\u90fd\u4f1a\u5bf9\u539f array \u8fd9\u4e2a object \u5f71\u54cd. \u4f46\u662f int max = *arr \u548c max = *p \u53ea\u662f\u628a arr \u548c p \u6307\u5411\u7684 object \u7684\u503c assign \u7ed9\u4e86\u8fd9\u4e2a int \u578b\u53d8\u91cf. \u8fd9\u5e76\u4e0d\u662f\u4e00\u4e2a reference semantics \u800c\u662f\u4e00\u4e2a value semantics. \u56e0\u800c\u8fd9\u4e2a\u51fd\u6570\u624d\u5408\u6cd5. \u6211\u4eec\u9700\u8981\u8bb0\u5f97\u628a\u5730\u5740\u89e3\u5f15\u7528\u8d4b\u7ed9\u4e00\u4e2a\u53d8\u91cf\u5e76\u4e0d\u662f reference semantics\uff01\uff01 \u53ea\u6709 int &x = y \u624d\u662f reference semantics.","title":"Overview"},{"location":"08-Pointers-and-Arrays.html#1using-namespace","text":"\u4e00\u4e2a namespace \u5c31\u662f\u4e00\u79cd way to organize code. \u610f\u601d\u5c31\u662f\u6807\u8bb0\u7ed9\u7f16\u8bd1\u5668\uff1a\u5982\u679c\u4e0d\u77e5\u9053\u67d0\u4e2a\u4e1c\u897f\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u90a3\u4e48\u5c31\u53bb\u8fd9\u4e2a namespace \u91cc\u53bb\u627e. \u6bd4\u5982 using namespace std; \u5c31\u662f\u544a\u8bc9 compiler: \u5f53\u4f60\u770b\u5230 cout \u7684\u65f6\u5019\uff0c\u4f60\u4e0d\u77e5\u9053\u8fd9\u4e2a function \u5728\u54ea\u91cc\uff0c\u4f60\u53ef\u4ee5\u52a0\u4e0a std \u770b\u770b. \u8fd9\u4e2a\u53eb standard namespace.","title":"\u9898\u5916\u8bdd1\uff1ausing namespace"},{"location":"08-Pointers-and-Arrays.html#2-address-number-system","text":"\u6211\u4eec\u53d1\u73b0\u6211\u4eec model \u91cc\u9762\u7684 addresses \u603b\u662f 0x6E3F \u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u5176\u5b9e\u8fd9\u91cc\u7684\u610f\u601d\u662f $6E3F_{16}$ , \u524d\u7f00 0x \u8868\u793a\u7684\u662f\u8fd9\u662f\u4e00\u4e2a 16 \u8fdb\u5236 (Hexadecimal) \u7684\u6570. \u4e3a\u4ec0\u4e48\u8981 16 \u8fdb\u5236\uff1a\u56e0\u4e3a 16 \u8fdb\u5236\u4e2d\u4e2a\u4f4d\u6570\u6700\u5927\u7684\u662f $F$ \u5373 \u4ece 0 \u5f00\u59cb\u7684 15\uff0c\u5b83\u7684 binary \u5bf9\u5e94\u6b63\u597d\u662f $1111$. \u6240\u4ee5\u4e00\u4e2a 4 \u4f4d hexadecimal \u7684\u6570\u53ef\u4ee5\u8868\u793a\u4e00\u4e2a\u7531 16 \u4e2a bits \u7ec4\u6210\u7684\u6570. \u8fd9\u5c31\u662f\u4e00\u4e2a 16-bit \u7684\u5730\u5740. \u800c\u73b0\u5b9e\u4e2d\u6211\u4eec\u5e38\u7528\u7684\u662f 32-bit \u548c 64-bit \u7684\u5730\u5740. \u56fe\u91cc\u8fd9\u5c31\u662f\u4e00\u4e9b 32-bit \u7684\u5730\u5740\u3002 $2^{32}$ bits \u7ea6\u7b49\u4e8e 4 GB. \u6211\u4eec\u6240\u8bf4\u7684 32-bit \u548c 64-bit \u7684\u8ba1\u7b97\u673a\uff0c\u5c31\u662f\u8ba1\u7b97\u673a CPU \u7684 memory register\uff08\u5bc4\u5b58\u5668\uff09 \u7684\u5927\u5c0f\uff0c\u4e5f\u4ee3\u8868\u4e86\u5b83\u4e00\u6b21\u6027\u5904\u7406\u7684\u6700\u5927\u6570\u636e\u5bbd\u5ea6\u3002","title":"\u9898\u5916\u8bdd2: address \u7684 number system"},{"location":"08-Pointers-and-Arrays.html#8-pointer-and-array","text":"\u56de\u987e\uff1aC++ \u4e2d\uff0cobject \u662f memory \u4e2d\u7684 a piece of data\uff0c\u5b83\u4f4d\u4e8e memory \u4e2d\u7684\u67d0\u4e2a address. \u5728\u521b\u5efa object \u65f6\uff0ccompiler \u4f1a\u51b3\u5b9a\u5bf9\u8c61\u7684\u4f4d\u7f6e. \u9664\u4e86\u51b3\u5b9a\u4e00\u4e2a object \u662f\u5728 global segment, stack \u8fd8\u662f\u5728 heap segment\uff08\u5806\u6bb5, \u7528\u4e8e dynamic memory \u7684 segment\uff09\u5916\uff0c\u6211\u4eec\u65e0\u6cd5\u63a7\u5236\u5176\u4f4d\u7f6e. \u5728\u76f8\u540c\u7684\u7a0b\u5e8f\u548c\u8f93\u5165\u4e0b\uff0c \u540c\u4e00\u7cfb\u7edf\u4e0a\u8fd0\u884c\u4e24\u6b21\u76f8\u540c\u7684\u7a0b\u5e8f\u90fd\u4f1a\u5c06\u76f8\u540c\u7684\u5bf9\u8c61\u653e\u7f6e\u5728\u4e0d\u540c\u7684 memory address \uff0c\u4e0d\u540c\u7684 system \u66f4\u52a0\u4e0d\u540c. \u867d\u7136\u4f5c\u4e3a programmer \u65e0\u6cd5\u63a7\u5236 object\uff0c\u4f46\u662f\u6211\u4eec\u80fd\u591f\u5bf9\u5176\u8fdb\u884c\u67e5\u8be2.","title":"8 Pointer and Array"},{"location":"08-Pointers-and-Arrays.html#81-pointer","text":"","title":"8.1 Pointer \u6307\u9488"},{"location":"08-Pointers-and-Arrays.html#811-pointer-type","text":"\u5c31\u50cf declare variable \u7684\u65f6\u5019\u653e\u5728\u53d8\u91cf\u5de6\u4fa7\u7684 &x \u548c\u5e73\u65f6\u4f5c\u4e3a operator \u7684 & \u4e0d\u540c\uff0c pointer \u7c7b\u578b\u7684 declaration \u4e2d *ptr \u548c\u5e73\u65f6\u4f5c\u4e3a operator \u7684 * \u4e0d\u540c. int *ptr \u5e76\u4e0d\u662f declare \u4e00\u4e2a\u53eb\u505a *ptr \u7684 int \u7c7b\u578b variable\uff0c\u800c\u662f declare \u4e00\u4e2a\u53eb\u505a ptr \u7684 int * \u7c7b\u578b\u7684 variable\uff01 \u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u662f\u4e00\u4e2a \u65b0\u7684\u53d8\u91cf\u7c7b\u578b \uff0c\u5b83\u5e76\u4e0d\u662f\u4e00\u4e2a int\uff0c\u800c\u662f\u4e00\u4e2a int pointer. \u50cf\u8fd9\u6837\u7684\u53d8\u91cf\u7c7b\u578b\u5c31\u53eb\u505a pointer type \uff0c\u8fd9\u4e2a type \u7684\u540d\u5b57\u5305\u542b\uff1a The type of the objects whose addresses the pointer can hold as a value (\u8fd9\u4e2a\u53d8\u91cf\u6240\u80fd\u5b58\u50a8\u7684\u5730\u5740\u5bf9\u5e94\u7684\u5bf9\u8c61\u7c7b\u578b)\uff0c\u6bd4\u5982 int * \u53ea\u80fd\u5b58\u50a8 int \u53d8\u91cf\u7c7b\u578b\u7684\u5bf9\u8c61. * \u7b26\u53f7\uff0c\u4ee5\u8868\u793a\u8fd9\u662f\u4e00\u4e2a pointer \u7c7b\u578b. \u5b9e\u9645\u4e0a\u6240\u6709\u6307\u9488\u7684\u503c\u90fd\u662f\u540c\u4e00\u79cd\u7c7b\u578b\uff0c\u5c31\u662f\u5730\u5740\uff0c\u6bd4\u5982 int * \u548c char * \u7684\u503c\u90fd\u4e00\u6837\u662f\u5730\u5740\uff0c\u4f46\u662f\u4e3a\u4e86\u80fd\u591f\u8fdb\u884c\u8fd0\u7b97\uff0c\u6307\u9488\u8fd8\u5b9a\u4e49\u4e86\u5b83\u80fd\u5b58\u653e\u7684\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u8fd9\u6837\u5b50 int * \u548c char * \u5c31\u53d8\u6210\u4e86\u4e24\u79cd\u7c7b\u578b\uff0c\u8868\u793a\u8fd9\u4e2a\u5730\u5740\u6307\u5411\u7684 object \u662f\u4e0d\u540c\u7c7b\u578b\u7684. C++ \u4e2d\u7684\u6bcf\u4e2a data type \u90fd\u6709 corresponding pointer type\uff0c\u5305\u62ec pointer type \u81ea\u8eab\uff01\u6bd4\u5982 double * \u5c31\u662f\u5b58\u50a8 double \u7c7b\u578b\u7684 pointer type\uff0c\u800c double ** \u5c31\u662f\u5b58\u50a8 double * \u7c7b\u578b\u7684\u5730\u5740\u7684 pointer type. \u6211\u4eec\u77e5\u9053\uff0cpointer type \u5b58\u50a8\u7684\u662f\u5730\u5740. \u6240\u4ee5\u5728 declare \u7684\u65f6\u5019\uff0c\u6211\u4eec\u7ed9\u5b83\u8d4b\u7684\u503c\u662f variable \u6240\u6307\u4ee3\u7684 object \u7684 memory address. \u4e8e\u662f\u6211\u4eec\u5c31\u8981\u5bf9\u53d8\u91cf\u4f7f\u7528 reference operator ( & ) \u7136\u540e\u628a\u83b7\u53d6\u5230\u7684\u503c assign \u7ed9\u6211\u4eec\u7684\u6307\u9488\u53d8\u91cf. int x = 3; int *ptr = &x; cout << ptr << endl; //0x7ffee0659a2c \u6211\u4eec\u8f93\u51fa\u8fd9\u4e2a\u53eb ptr \u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u987a\u5229\u50a8\u5b58\u4e86 x \u7684\u5730\u5740. \u4f46\u662f\u5b58\u5b83\u7684\u5730\u5740\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u2014\u2014","title":"8.1.1 Pointer Type \u6307\u9488\u53d8\u91cf\u7c7b\u578b"},{"location":"08-Pointers-and-Arrays.html#812-dereference-operator","text":"* \u53eb\u505a dereference operator\uff08\u89e3\u5f15\u7528\u7b26\u53f7\uff09\uff0c\u662f\u4e13\u95e8\u7528\u4e8e pointer \u7c7b\u578b\u7684 variable \u7684 operator\uff0c\u7528\u4e8e\u83b7\u53d6\u5176\u4f5c\u7528\u4e8e\u7684 pointer variable \u6240\u5b58\u50a8\u7684\u5730\u5740\u4f4d\u7f6e\u4e0a\u7684 variable. \u6ce8\u610f\u5230\u8fd9\u91cc\u7684 * \u548c\u6211\u4eec\u5728 declare \u6307\u9488\u53d8\u91cf\u7684 type * \u4e2d\u7684 * \u662f\u4e0d\u4e00\u6837\u7684\u4e1c\u897f. \u90a3\u4e2a\u53ea\u662f\u53d8\u91cf\u7c7b\u578b\u7684 name \u7684\u4e00\u90e8\u5206\uff1b\u8fd9\u91cc\u5219\u662f\u4e00\u4e2a operator\uff0c\u5bf9\u53d8\u91cf\u8fdb\u884c\u8fd0\u7b97. int x = 3; cout << &x << endl; //0x7ffee0659a2c int *ptr = &x; cout << ptr << endl; //0x7ffee0659a2c cout << *ptr << endl; //3 \u6211\u4eec\u53d1\u73b0\u901a\u8fc7\u89e3\u5f15\u7528\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u88ab\u5b58\u50a8 object\uff0c\u6ce8\u610f\u5e76\u4e0d\u662f\u83b7\u5f97\u5b83\u7684\u503c\uff0c\u800c\u662f\u76f4\u63a5\u8f6c\u5230\u4e86\u539f object \u4e0a\uff0c\u5c31\u662f\u8bf4 \u6211\u4eec\u5bf9 *ptr \u7684\u4efb\u4f55\u64cd\u4f5c\u90fd\u4f1a\u76f4\u63a5\u6539\u53d8\u5b83\u6307\u5411\u7684 object . \u8fd9\u5c31\u662f\u6307\u9488 \u201dpointer\u201c \u8fd9\u4e2a\u540d\u5b57\u7684\u542b\u4e49\uff0c\u5373\u5b83\u4e0d\u6b62\u662f\u5b58\u50a8\u5730\u5740\uff0c\u800c\u4e14\u53ef\u4ee5\u901a\u8fc7\u89e3\u5f15\u7528\u76f4\u63a5\u6307\u5411\u8fd9\u4e00\u5730\u5740\u7684 object. int x = 3; int *ptr = &x; *ptr++; cout << x; //4, \u66f4\u6539\u4e86 \u6211\u4eec\u8fd8\u53ef\u4ee5\u66f4\u6539 ptr \u50a8\u5b58\u7684\u5730\u5740\u6765\u8ba9\u5b83\u6307\u5411\u53e6\u4e00\u4e2a object\uff01\u521a\u624d\u6211\u4eec\u8bf4\u4e86\uff0cC++\u53ea\u5728initialization\u65f6\u652f\u6301 reference semantic \u5bfc\u81f4\u6211\u4eec\u4e00\u65e6\u628a\u4e00\u4e2a variable name \u548c\u4e00\u4e2a object \u7ed1\u5b9a\uff0c\u90a3\u4e48\u5c31\u518d\u4e5f\u65e0\u6cd5\u8ba9\u8fd9\u4e2a variable name \u7ed1\u5b9a\u5176\u4ed6 object \u4e86. \u8fd9\u5c31\u662f\u6211\u4eec\u9700\u8981 pointer type \u7684\u539f\u56e0\uff0c\u56e0\u4e3a pointer type \u53ef\u4ee5\u968f\u4fbf\u66f4\u6539\u50a8\u5b58\u54ea\u4e2a object \u7684\u5730\u5740\uff0c\u800c\u4e14\u901a\u8fc7\u89e3\u5f15\u7528\u8fd0\u7b97\u53ef\u4ee5\u76f4\u63a5\u5bf9\u8fd9\u4e2a object \u8fdb\u884c\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u53ef\u4ee5\u7075\u6d3b\u5207\u6362\u81ea\u5df1\u8868\u793a\u54ea\u4e2a object. \u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u80fd\u591f simulate reference semantics. \u6211\u4eec\u4e00\u65e6\u628a\u4e00\u4e2a variable name \u548c\u4e00\u4e2a object \u7ed1\u5b9a\uff0c\u90a3\u4e48\u5c31\u518d\u4e5f\u65e0\u6cd5\u8ba9\u8fd9\u4e2a variable name \u7ed1\u5b9a\u5176\u4ed6 object\uff0c\u8fd9\u4e2a\u89c4\u5b9a\u6ca1\u6709\u7279\u4f8b\uff0c\u5f53\u7136\u5305\u62ec pointer type\uff1a\u6211\u4eec\u77e5\u9053\u4e00\u4e2a pointer \u53d8\u91cf\u81ea\u5df1\u7ed1\u5b9a\u7684 object\uff0c\u5373\u5b83\u5728 memory \u4e2d\u7684\u4f4d\u7f6e\u5f53\u7136\u662f\u56fa\u5b9a\u7684. \u7136\u800c\u5b83\u901a\u8fc7\u50a8\u5b58\u522b\u7684 object \u7684\u5730\u5740\u7136\u540e\u901a\u8fc7\u89e3\u5f15\u7528\u968f\u610f\u5207\u6362\u81ea\u5df1\u64cd\u4f5c\u7684 object. int x = 3; int *ptr = &x; cout << *ptr << endl; //3 int y = 4; ptr = &y; cout << *ptr; //4\uff0c\u73b0\u5728\u6307\u5411y x = 1; y = 5; cout << *ptr; //5\uff0c\u548cy\u7ed1\u5b9a \u201c\u6307\u5411\u4e00\u4e2a object\u201d\uff0c\u8fd9\u5c31\u662f\u6307\u9488\u7684\u540d\u5b57\u7684\u610f\u601d. \u4e0b\u9762\u662f\u4e00\u4e2a\u5e26 activation record \u7684\u4f8b\u5b50. int main(){ int foo = 1; int *bar = &foo; foo += 1; *bar += 1; cout << foo << endl;//3 cout << bar << endl; //some address cout << *bar << endl; //3 }","title":"8.1.2 Dereference Operator(*) \u89e3\u5f15\u7528\u7b26\u53f7"},{"location":"08-Pointers-and-Arrays.html#813-pointer-type","text":"\u6211\u4eec\u521a\u624d\u8bf4\u4e86\uff0cpointer type \u53ef\u4ee5 \u201c\u6a21\u62df\u201d reference semantics\uff0c\u8fd9\u5728\u4ec5\u652f\u6301 initialization \u65f6\u7684 reference semantics \u7684 C++ \u8bed\u8a00\u91cc\u662f\u5f88\u91cd\u8981\u5f88\u6709\u7528\u7684\u4e00\u4e2a\u7279\u6027. \u5b83\u53ef\u4ee5 use objects across different scopes . Enables Subtype Polymorphism(\u5b50\u7c7b\u578b\u591a\u6001) . Keep track of objects in dynamic memory . Implement linked data structures. \u7531\u4e8e arrarys \u4e2d\u7684 objects \u5177\u6709 sequential address\uff0c\u6211\u4eec\u80fd\u591f \u901a\u8fc7 pointer arithmetic \u6765\u8ba1\u7b97\u6211\u4eec\u60f3\u8981\u7684 element \u7684 address. \u540e\u56db\u6761\u76ee\u524d\u8fd8\u4e0d\u77e5\u9053\uff0c\u4f46\u662f\u8fd9\u8282\u8bfe\u90fd\u4f1a\u8bb2.","title":"8.1.3 Pointer Type \u7684\u7528\u5904"},{"location":"08-Pointers-and-Arrays.html#814-nullptr","text":"Pointer type \u662f\u4e00\u79cd atomic \u7684\u6570\u636e\u7c7b\u578b \uff0c\u610f\u601d\u662f\u4ed6\u4e0d\u80fd\u518d\u88ab\u5212\u5206\u4e3a\u66f4\u5c0f\u7684 object. \u5bf9\u4e8e\u4e00\u4e2a atomic \u7684\u6570\u636e\u7c7b\u578b\u800c\u8a00\uff0c\u5982\u679c\u6ca1\u6709\u88abexplicitly initialized to some value\uff0c\u90a3\u4e48\u5b83\u4f1a\u88ab\u9ed8\u8ba4\u5730 initialized \u4e3a\u4e00\u4e2a undefined value: int x = 3; int *ptr; //\u6ca1\u6709\u663e\u5f0f\u521d\u59cb\u5316, \u9ed8\u8ba4\u503c\u4e3a undefined value ptr = &x; //\u73b0\u5728\u5b83\u5c31\u662f\u4e00\u4e2awell-define value, \u503c\u5c31\u662fx\u7684\u5730\u5740 \u800c deference \u4e00\u4e2a undifined value \u7684\u6307\u9488\u53d8\u91cf\u662f\u4e00\u4e2a undefined behavior. \u8fd9\u610f\u5473\u7740\u5b83\u4e0d\u4e00\u5b9a\u62a5\u9519\uff0c\u4f46\u662f\u503c\u4e00\u5b9a\u4e0d\u5bf9. \u8fd9\u79cd undefined \u884c\u4e3a\u662f\u975e\u5e38\u96be\u4ee5 debug \u7684. \u53ef\u4ee5\u7528 address sanitizer \u6765\u68c0\u6d4b\u8fd9\u79cd\u884c\u4e3a. \u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u5c31\u662f\u8bd5\u56fe\u7ed9\u4e00\u4e2a undefined to some object \u7684\u6307\u9488\u53d8\u91cf\u8d4b\u503c\uff0c\u8fd9\u662f\u4e00\u4e2a undefined behavior. x \u7684\u503c\u4e00\u5f00\u59cb\u662f undefined value\uff0c\u4f46\u662f\u540e\u9762\u88ab\u5206\u914d\u5230\u4e86 a \u7684\u5730\u5740\uff0c\u800c y \u7684\u503c\u5219\u4ecd\u7136 undefined\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u662f\u4e00\u4e9b junk address. \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ef\u4ee5 dereference x \u4f46\u662f dereference y \u5c31\u4f1a\u5bfc\u81f4\u6211\u4eec\u6307\u5230\u4e00\u4e9b\u83ab\u540d\u5176\u5999\u7684 object \u4e0a. int main(){ int *x; int *y; int a = -1; x = &a; cout << *x << endl; // prints -1 *x = 42; cout << a << endl; // prints 42 *y = 13; // UNDEFINED BEHAVIOR } A null pointer (\u7a7a\u6307\u9488) \u662f\u4e00\u4e2a\u503c\u4e3a 0x0 \u7684\u6307\u9488\uff0c\u5199\u4f5c nullptr \uff0c\u6ca1\u6709 object \u80fd\u591f\u88ab\u653e\u5728\u8fd9\u4e2a\u5730\u5740\u4f4d\u7f6e\uff0c\u56e0\u800c null pointer \u4e0d\u6307\u5411\u4efb\u4f55 object. nullptr \u6709\u4e24\u4e2a\u597d\u5904. \u5b83\u53ef\u4ee5\u7528\u4e8e\u4efb\u4f55 pointer type\uff0c\u6bd4\u5982 int *ptr = nullptr , char *ptr = nullptr , \u901a\u7528\u7684. \u5f53\u7136\u6307\u5411\u4e0d\u540c\u7c7b\u578b\u7684 nullptr \u8fd8\u662f\u4e0d\u80fd\u8fdb\u884c\u8fd0\u7b97\u7684. c++ int main() { int *ptr1 = nullptr; double *ptr2 = nullptr; cout << (ptr1 == ptr2); // error, \u5730\u5740\u503c\u90fd\u662f\u4e00\u6837\u7684, \u4f46\u8bed\u6cd5\u5b9a\u4e49\u4e0d\u80fd\u8fd9\u6837 cout << (ptr1 == nullptr); // 1 } dereference \u4e00\u4e2a nullptr \u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u76f4\u63a5 crash\uff0c\u8fd9\u5c31\u975e\u5e38\u5bb9\u6613 debug. \u867d\u7136\u8fd9\u4e5f\u662f\u4e00\u4e2a undefined behavior\uff0c\u4f46\u662f\u6bd4\u4e71\u4e03\u516b\u7cdf\u7684 undefined behavior \u8981\u597d\u5f88\u591a\uff0c\u56e0\u4e3a\u4e00\u4e0b\u5c31\u770b\u51fa\u6765\u4e86. \u56e0\u800c\u5f53\u6211\u4eec declare \u4e00\u4e2a pointer type \u4f46\u662f\u4e0d\u60f3 initialize \u5b83\u7684\u503c\u65f6\u6700\u597d\u7684\u529e\u6cd5\u5c31\u662f\u7ed9\u5b83 assign \u4e00\u4e2a nullptr .","title":"8.1.4 nullptr (\u7a7a\u6307\u9488)"},{"location":"08-Pointers-and-Arrays.html#815-pointer","text":"int * get_address(int x) { return &x; } void print(int val) { cout << val << endl; } int main() { int a = 3; int *ptr = get_address(a); print(42); cout << *ptr << endl; // UNDEFINED BEHAVIOR } // \u8f93\u51fa\u7ed3\u679c: 42 // 42 \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u91cc\u7684 pointer \u578b\u51fd\u6570\u5fc5\u987b\u8981\u6709 pass-by-reference \u7684\u53d8\u91cf\u624d\u53ef\u4ee5. \u56e0\u4e3a\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u5730\u5740\uff0c\u800c\u4f17\u6240\u5468\u77e5\u51fd\u6570\u7684 stack frame \u5728\u8fd0\u884c\u7ed3\u675f\u540e\u5c31\u4f1a\u88ab\u6467\u6bc1\uff0c\u6240\u4ee5\u5982\u679c\u6211\u4eec\u4e0d\u7ed9\u8fd9\u91cc\u7684 x \u52a0\u4e0a\u5f15\u7528\uff0c\u6700\u540e\u8fd4\u56de\u7684\u51fd\u6570\u503c\u5c31\u662f\u4e00\u4e2a\u5df2\u7ecf\u88ab\u6467\u6bc1\u7684\u53d8\u91cf\u7684\u5730\u5740. \u5e76\u4e14\u6211\u4eec\u77e5\u9053\uff0c\u5728\u8fd9\u4e2a\u51fd\u6570\u4e4b\u540e\u8fd0\u884c\u7684\u51fd\u6570\u7684 stack frame \u7684\u4f4d\u7f6e\u5c31\u662f\u4e4b\u524d\u521a\u521a\u88ab\u6467\u6bc1\u7684\u51fd\u6570\u7684 stack frame \u7684\u4f4d\u7f6e. \u56e0\u800c\u6211\u4eec\u4f1a\u628a\u8fd9\u4e2a\u65b0\u7684 print() \u51fd\u6570\u91cc\u9762\u7684\u53d8\u91cf\u7684\u503c\u901a\u8fc7 ptr \u7684\u89e3\u5f15\u7528\u7ed9\u8bfb\u51fa\u6765. \u6240\u4ee5\u4fee\u6539\u8fd9\u4e2a\u51fd\u6570\uff0c\u53ea\u9700\u8981\u628a x \u6539\u6210 &x \u5b83\u5c31\u6b63\u786e\u4e86. int * get_address(int &x) { return &x; } void print(int val) { cout << val << endl; } int main() { int a = 3; int *ptr = get_address(a); print(42); cout << *ptr << endl; // UNDEFINED BEHAVIOR } // \u8f93\u51fa\u7ed3\u679c: 42 // 3","title":"8.1.5 Pointer \u578b\u51fd\u6570"},{"location":"08-Pointers-and-Arrays.html#816-pass-by-pointer","text":"void swap_pointed(int *x, int *y) { int tmp = *x; *x = *y; *y = tmp; } int main() { int a = 3; int b = 5; swap_pointed(&a, &b); cout << a << endl; // prints 5 cout << b << endl; // prints 3 } \u6211\u4eec\u53d1\u73b0\u8fd9\u91cc\u7684 * \u6709\u70b9\u591a\uff0c\u4f46\u662f\u5176\u5b9e\u5f88\u597d\u60f3\uff1a pass-by-pointer \u51fd\u6570\u7684 parameter \u662f pointer type\uff0c\u90a3\u4e48\u4f20\u7ed9\u5b83\u7684\u503c\u5c31\u662f\u53d8\u91cf\u7684\u5730\u5740. \u6211\u4eec pass-by-reference \u7684\u76ee\u7684\u662f\u5728\u4e3b\u51fd\u6570\u7684 stack frame \u5916\u64cd\u4f5c\u4e3b\u51fd\u6570\u4e2d\u7684 objects. \u8fd9\u4e2a\u51fd\u6570\u91cc\u9762\u7684 *x , *y \u662f\u76f4\u63a5\u5bf9 pointer type \u53d8\u91cf x , y \u8fdb\u884c\u89e3\u5f15\u7528\uff0c\u83b7\u53d6\u5230\u5b83\u7684 object\uff0c\u4e5f\u5c31\u662f\u8bf4 *x \u4e00\u5f00\u59cb\u5c31\u662f main \u4e2d\u7684 a (object)\uff0c\u800c *y \u4e00\u5f00\u59cb\u5c31\u662f main \u4e2d\u7684 b (object). \u6211\u4eec\u9996\u5148\u628a a \u7684\u503c\u4ed8\u7ed9\u4e86 tmp \u8fd9\u4e2a local variable. (\u8fd9\u662f\u4e00\u4e2a\u4e3b\u52a8\u7684 value semantics\uff0c\u56e0\u4e3a tmp \u5e76\u4e0d\u662f\u5f15\u7528\u53d8\u91cf\uff0c\u5426\u5219\u662f int &tmp = *x ) \u7136\u800c\u628a b \u7684\u503c\u8d4b\u7ed9 a (\u8fd9\u91cc\u4e5f\u662f\u4e00\u4e2a value semantics\uff0c\u53f3\u8fb9\u7684 *y \u4f20\u9012\u7ed9 *x \u4e5f\u5c31\u662f a object \u4ee5 b object \u7684\u503c) \u7136\u540e\u5728\u628a tmp \u7684\u503c\u4e5f\u5c31\u662f\u539f\u672c a \u7684\u503c\u8d4b\u7ed9 b .","title":"8.1.6 Pass-by-Pointer \u7684\u51fd\u6570"},{"location":"08-Pointers-and-Arrays.html#82-array","text":"","title":"8.2 Array"},{"location":"08-Pointers-and-Arrays.html#821-kinds-of-objects-in-c","text":"C++ \u4e2d\u6709\u8fd9\u6837\u4e09\u79cd object \u7c7b\u578b: Atomic (primitive)\uff1a\u539f\u5b50\u7c7b\u578b\uff0c\u4e0d\u80fd\u518d\u5206. \u6bd4\u5982 int, double, char \u548c\u6240\u6709pointer type. arrays\uff1ahomogeneous\uff0c\u662f\u4e00\u4e2a continuous sequence of objects of the same type. class-type\uff1aheterogeneous\uff0c\u4e00\u4e2a compound object\uff0c\u7531 member subobjects \u7ec4\u6210. \u5176 members \u548c\u5b83\u4eec\u7684 types \u7531\u4e00\u4e2a struct \u6216 class \u6765\u5b9a\u4e49. \u6240\u4ee5 Arrays \u5176\u5b9e\u662f\u4e00\u79cd\u5f88\u5e7f\u6cdb\u7684\u6570\u636e\u7c7b\u578b. \u5b83\u7684\u7279\u70b9\u662f\uff1a fixed size\uff0c elements of same type\uff0c ordered elements\uff0c \u5360\u636e contiguous chunk of memory\uff0c \u5e76 support constant time random access(\u5373 indexing)","title":"8.2.1 Kinds of objects in C++"},{"location":"08-Pointers-and-Arrays.html#822-array-decay-into-pointer","text":"\u6211\u4eec\u90fd\u77e5\u9053\u6253\u5370 array \u8981\u7528\u5faa\u73af\uff0c\u4e0d\u80fd\u76f4\u63a5\u6253\u5370\uff0c\u56e0\u4e3a cout << arr << endl; # 0x000840c0 \u5f53\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6 arr \u7684\u503c\u65f6\uff0c\u6211\u4eec\u83b7\u53d6\u5230\u7684\u662f arr \u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u5730\u5740. \u6211\u4eec\u79f0\u8fd9\u4e2a\u8fc7\u7a0b\u4e3a arr \"decays\" into a pointer to its first element. \u56e0\u800c int arr1[4] = {1, 2, 3, 4}; int arr2[4] = {5, 6, 7, 8}; arr2 = arr1; \u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a array \u7684\u503c\u8d4b\u7ed9\u53e6\u4e00\u4e2a array\uff0c\u6211\u4eec\u77e5\u9053\u4e5f\u9700\u8981\u5faa\u73af\uff0c\u8fd9\u662f\u56e0\u4e3a \u5bf9\u4e8e\u5de6\u4fa7\u7684 arr2\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u5c1d\u8bd5 get the value\uff0c\u5b83\u4ecd\u7136\u662f\u4e00\u4e2a array\uff1b\u800c\u5bf9\u4e8e\u53f3\u4fa7\u7684 arr1\uff0c\u6211\u4eec\u5c1d\u8bd5 get its value\uff0c\u5b83\u5c31 decay \u4e3a\u4e86\u4e00\u4e2a pointer. \u8fd9\u5bfc\u81f4\u4e86\u8d4b\u503c\u7c7b\u578b\u4e0d\u4e00\u81f4.","title":"8.2.2 Array Decay into pointer"},{"location":"08-Pointers-and-Arrays.html#823-array-decay","text":"\u6211\u4eec\u4f1a\u89c9\u5f97 array decay \u8fd9\u4ef6\u4e8b\u542c\u8d77\u6765\u5f88\u7384\u5e7b\uff0c\u50cf\u662f\u4ec0\u4e48\u653e\u5c04\u6027\u7269\u8d28\u8870\u53d8\u4e00\u6837\uff0c\u7b14\u8005\u5f88\u4e0d\u559c\u6b22\u8fd9\u79cd\u8bf4\u6cd5\uff0c\u6211\u89c9\u5f97\u83ab\u540d\u5176\u5999\u7684\u3002 \u5176\u5b9e\u5f88\u7b80\u5355\uff0c [] \u8fd9\u4e2a operator \u5c31\u662f\u4e00\u4e2a composite operator \u3002 a[n] \u5b9e\u9645\u4e0a\u5c31\u662f\u5bf9 *(a + n) \u7684\u7b80\u5199 \uff0c\u8fd9\u91cc type \u6307\u7684\u662f array \u4e2d\u5143\u7d20\u7684 type. \u672c\u8d28\u4e0a\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u5c31\u662f\u8ba9\u8fd9\u4e2a\u8fd0\u7b97\u66f4\u52a0\u76f4\u89c2\u4ee5\u53ca\u5199\u8d77\u6765\u66f4\u52a0\u7b80\u5355\u800c\u5df2\u3002 \u800c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\uff0c\u4f5c\u4e3a\u8fd0\u7b97\u7b26\u7684\u7b26\u53f7\u5728 initialize \u7684\u65f6\u5019\u603b\u662f\u6709\u5176\u4ed6\u610f\u601d\u7684\u3002 \u6bd4\u5982 * \u5728\u8fd0\u7b97\u7684\u65f6\u5019\u662f\u89e3\u5f15\u7528\u7b26\u53f7\uff0c\u4f46\u662f\u5728 initialize \u7684\u65f6\u5019\u5b83\u662f\u7c7b\u578b\u540d\u7684\u4e00\u90e8\u5206\uff0c type * \u8868\u793a\u8fd9\u662f\u4e2a\u6307\u9488\u7c7b\u578b\u3002 \u518d\u6bd4\u5982 & \u5728\u8fd0\u7b97\u7684\u65f6\u5019\u8868\u793a\u53d6\u5730\u5740\u7b26\u53f7\uff0c\u4f46\u662f\u5728 initialize \u7684\u65f6\u5019\u5b83\u867d\u7136\u4e0d\u662f\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c\u4f46\u4e5f\u8868\u793a\u4e86\u8fd9\u4e2a initialization \u7684\u610f\u601d\u662f\u53d6\u540d\uff0c\u6bd4\u5982 int &a = b \u8868\u793a\u7ed9 b \u7684 object \u53d6\u4e00\u4e2a\u65b0\u540d\u5b57 a . \u90a3\u4e48 [] \u5728 initialization \u7684\u65f6\u5019\u4e5f\u662f\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff0c type a[] \u8868\u793a\u8fd9\u4e2a a \u53d8\u91cf\u662f\u4e00\u4e2a array \u578b\u7684\u590d\u5408\u53d8\u91cf\uff0c\u5176\u5143\u7d20\u4e3a type \u578b. \u8fd9\u4e2a\u8bdd\u5176\u5b9e\u662f\u628a array \u8fd9\u4e2a\u7c7b\u578b\u7ed9\u62bd\u8c61\u6210\u4e00\u4e2a\u5f62\u8c61\u7684\u4e1c\u897f\u8868\u8fbe\u51fa\u6765\u4e86\uff0c\u5b9e\u9645\u4e0a array \u7c7b\u5e76\u4e0d\u662f\u4e00\u4e2a\u5f88\u5927\u7684\u4e00\u4e2a\u5305\u542b\u5f88\u591a\u5143\u7d20\u7684\u6846\u6846\uff0c\u800c\u662f \u4e00\u4e2a\u975e\u5e38\u7c7b\u4f3c\u4e8e\u6307\u9488\u7684\u6570\u636e\u7c7b\u578b\u3002","title":"8.2.3 Array Decay \u7684\u672c\u8d28: [] \u662f\u4e00\u4e2a\u590d\u5408\u8fd0\u7b97\u7b26, == *()"},{"location":"08-Pointers-and-Arrays.html#824-array-object","text":"\u4e00\u4e2a array \u7c7b\u578b\u7684 object\uff0c\u5b83\u7684\u503c\uff08\u6211\u4eec\u4f7f\u7528\u7684\u90e8\u5206\uff09\u5c31\u662f\u4e00\u4e2a\u5730\u5740\uff0c\u8fd9\u4e2a\u5730\u5740\u5c31\u662f\u6211\u4eec\u8bf4\u7684 array \u9996\u5143\u7d20\u7684\u5730\u5740\u3002 \u90a3\u4e48\u5b83\u548c\u6307\u9488\u6709\u4ec0\u4e48\u4e0d\u540c\u5462\uff1f \u5b83\u7684\u503c\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u7c7b\u4f3c\u4e8e\u662f const \u7684\u3002\u4e5f\u5c31\u662f\u50a8\u5b58\u7684\u8fd9\u4e2a\u5730\u5740\u662f\u4e0d\u80fd\u6539\u53d8\u7684\u3002\uff08\u4e0d\u50cf\u6307\u9488\u578b\u53d8\u91cf\uff0c\u503c\u53ef\u4ee5\u6539\u53d8\uff09 \u867d\u7136\u6211\u4eec\u4f7f\u7528\u5b83\u65f6\uff0c\u5b83\u7ed9\u6211\u4eec\u7684\u503c\u5c31\u662f\u9996\u5143\u7d20\u5730\u5740\uff0c\u4f46\u662f\u8fd9\u4e2a object \u672c\u8eab\u7684\u5360\u5185\u5b58\u5927\u5c0f\u5305\u542b\u4e86\u5b83\u6240\u6709\u5143\u7d20\u7684\u5927\u5c0f\u3002 \u5b83\u9664\u4e86\u5b58\u50a8\u9996\u5143\u7d20\u5730\u5740\u4e4b\u5916\u8fd8\u505a\u4e86\u522b\u7684\u4e8b\u60c5\uff0c\u6bd4\u5982\u6846\u5b9a\u4e86\u4e00\u4e2a\u6307\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\u5757\u3002","title":"8.2.4 Array \u578b object \u7684\u672c\u8d28"},{"location":"08-Pointers-and-Arrays.html#825-array-object","text":"\u6240\u4ee5\u4e3a\u4ec0\u4e48\u5f53\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6\u628a\u4e00\u4e2a array \u8d4b\u503c\u7ed9\u53e6\u4e00\u4e2a array \u65f6\u4e0d\u884c\u3002\u56e0\u4e3a C++ \u8fd9\u4e2a\u8bed\u8a00\u4e0d\u5141\u8bb8 array \u7c7b\u578b\u6570\u636e\u7684\u8d4b\u503c\u64cd\u4f5c\u3002 \u8fd9\u4e2a\u539f\u56e0\u662f\u663e\u7136\u7684\uff0c\u5176\u4e2d\u4e00\u4e2a\u539f\u56e0\u662f\u56e0\u4e3a array \u662f\u4e00\u4e2a immutable \u7684 object\uff0c\u5b83\u7684\u957f\u5ea6\u5c31\u662f\u4e0d\u53ef\u53d8\u7684\u3002array \u662f\u4e00\u4e2a\u540c\u7c7b\u578b\u7684\u8fde\u7eed\u591a\u4e2a object \u7ec4\u6210\u7684\u590d\u5408\u578b object\uff0c\u4e00\u542c\u5c31\u77e5\u9053\u8fd9\u4e2a\u4e1c\u897f\u7684\u9650\u5236\u5f88\u591a\u3002 \u5f53\u6211\u4eec: arr1 = arr2 \u6211\u4eec\u662f\u60f3\u8981\u628a\u4e00\u4e2a array \u8d4b\u7ed9\u53e6\u4e00\u4e2a array\u3002 \u4f46\u662f array \u8fd4\u56de\u7ed9 = \u8fd9\u4e2a\u8d4b\u503c\u8fd0\u7b97\u7b26\u7684\u4e0d\u662f\u5b83\u81ea\u5df1\uff0c\u800c\u662f\u53ea\u662f\u8fd4\u56de\u5b83\u9996\u5143\u7d20\u7684\u5730\u5740\u3002 \u6211\u4eec\u7406\u89e3\u4e00\u4e0b\uff1a\u6211\u4eec\u521a\u624d\u8bf4\u5230\uff0carray \u5c31\u662f\u4e00\u4e2a\u5f88\u7c7b\u4f3c\u4e8e\u6307\u9488\u7684 object \u7c7b\u578b\uff0c\u4f46\u662f\u5b83\u5e76\u4e0d\u662f\uff0c\u5b83\u7684 copy constructor \u7684\u505a\u6cd5\u4ee5\u53ca assignment operator = \u7684 return value \u867d\u7136\u662f\u9996\u5143\u7d20\u5730\u5740\uff0c\u4f46\u662f\u5b83\u81ea\u5df1\u662f\u4e00\u4e2a\u590d\u6742\u7684\u590d\u5408\u578b\u53d8\u91cf\uff08 class \uff09\u3002 \u6240\u4ee5\u8fd9\u5c31\u662f type error \u7684\u539f\u56e0\u3002compiler \u770b\u5230\u7684\u662f\u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a\u5355\u7eaf\u7684 32 bit \u5730\u5740\u8d4b\u7ed9\u4e00\u4e2a\u590d\u6742\u7684\u590d\u5408\u578b\u53d8\u91cf\u3002\u5e76\u6ca1\u6709\u8fd9\u6837\u4e00\u4e2a operator= \u7684 overload\uff0c\u5176\u5de6\u8fb9\u53c2\u6570\u662f int * object, \u53f3\u8fb9\u662f array \u8fd9\u4e2a compound object. \uff08\u5176\u5b9e\u4e0d\u4ec5\u6ca1\u6709\uff0c\u6211\u4eec\u81ea\u5df1\u4e5f\u6ca1\u529e\u6cd5\u91cd\u5199\u4e00\u4e2a = \u6765 overload operator= \uff0c\u56e0\u4e3ac++ std \u628a array \u7c7b\u5b58\u50a8\u7684\u5730\u5740\u8bbe\u7f6e\u6210 const \u7684\uff0c\u8fd9\u5c31\u4ece\u6839\u6e90\u4e0a\u62d2\u7edd\u4e86\u6211\u4eec\u8fd9\u4e48\u505a\uff0c\u5426\u5219\u6211\u4eec\u4e5f\u53ef\u4ee5\u91cd\u5199\u4e00\u4e2a\uff09","title":"8.2.5 = \u8d4b\u503c\u8fd0\u7b97\u7b26\u7684\u8fd4\u56de\u503c: \u4e3a\u4ec0\u4e48 array \u578b object \u4e0d\u5141\u8bb8"},{"location":"08-Pointers-and-Arrays.html#8251-class-object-class-struct","text":"\u7701\u6d41\uff1a\u4e24\u4e2a\u76f8\u540c\u7c7b\u578b\u7684 class \u6216\u8005 struct \u578b object \u53ef\u4ee5\u7528 = \u8d4b\u503c\u3002 \u5b9e\u9645\u4e0a\u8fd9\u5c31\u662f copy constrctor (\u548c default constructor \u4e00\u6837\u81ea\u52a8\u751f\u6210) \u6240\u505a\u7684\u4e8b\u60c5\u3002","title":"8.2.5.1 \u7136\u800c class \u578b object \u5373 class \u548c struct \u662f\u5141\u8bb8\u8fd9\u4e48\u505a\u7684"},{"location":"08-Pointers-and-Arrays.html#8252-array-decay-function-parameter","text":"\u6211\u4eec\u542c\u8fc7\u4e00\u4e2a\u8bf4\u6cd5\u53eb\u505a function \u5bf9\u4e8e array \u7684\u53c2\u6570\u662f\u81ea\u52a8 pass by reference \u7684\uff0c\u4f46\u662f\u8fd9\u79cd\u8bf4\u6cd5\u662f\u9519\u8bef\u7684\u3002\u5b9e\u9645\u4e0a\u8fd8\u662f pass by value \u7684\u3002\u7ecf\u8fc7\u521a\u624d\u7684\u8bba\u8ff0\u6211\u4eec\u5927\u6982\u5df2\u7ecf\u77e5\u9053\u4e86\u3002 \u9996\u5148\u8fd9\u4e2a\u884c\u4e3a\u5408\u6cd5\u662f\u56e0\u4e3a function \u7684 parameter passing \u5e76\u4e0d\u662f\u4e00\u4e2a\u521b\u5efa\u4e00\u4e2a copy \u5e76\u91ce\u86ee\u4f7f\u7528 = \u8d4b\u503c\u7684\u8fc7\u7a0b\u3002 \u5b83\u5176\u5b9e\u662f\u901a\u8fc7\u8c03\u7528\u590d\u5236\u6784\u9020\u51fd\u6570 \uff08copy Constructor\uff09 \u6765\u521b\u5efa\u7684\u3002 \u800c C++ \u8fd9\u4e2a\u8bed\u8a00\u7684\u8bbe\u8ba1\u5c31\u662f\uff1a\u5f53\u6211\u4eec\u4f20\u9012\u4e00\u4e2a\u6307\u9488\u4f5c\u4e3a\u53c2\u6570\u65f6\uff0c\u6211\u4eec\u751f\u6210\u7684 local variable \u4e0d\u662f\u4e00\u4e2a\u6570\u7ec4\u800c\u662f\u4e00\u4e2a\u5355\u7eaf\u7684\u6307\u9488\uff0c\u540d\u5b57\u548c\u4f20\u8fdb\u53bb\u7684 array \u540d\u76f8\u540c\uff0c\u4f46\u662f\u5b83\u662f\u4e00\u4e2a\u5355\u7eaf\u7684 pointer \u7c7b\u3002 \u6bd4\u5982\u6211\u4eec\u4f20\u8fdb\u53bb int a[] \uff0c\u751f\u6210\u7684\u5c40\u90e8\u53d8\u91cf\u5c31\u662f int *a . \u6240\u4ee5\u6211\u4eec\u4f20\u8fdb\u53bb\u7684 array \u5c31\u662f\u4f20\u8fdb\u53bb\u5b83\u9996\u5143\u7d20\u7684\u5730\u5740\uff0c\u662f\u4e00\u4e2a\u5355\u7eaf\u7684\u5730\u5740\u503c\uff0c\u8fd9\u662f\u56e0\u4e3a copy constructor \u4f1a\u5728\u51fd\u6570\u7684 stack frame \u4e2d\u65b0\u5efa\u4e00\u4e2a array object\uff0c\u7136\u540e \u590d\u5236\u539f array \u7684\u6240\u6709 members \u3002\u56e0\u800c\u6ca1\u6709 type error\u3002\u4e0d\u50cf\u6211\u4eec\u76f4\u63a5 arr1 = arr2 \u5c31\u6709 type error\u3002 \u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u73b0\u5728 int a[] \u8fd9\u4e2a\u4e1c\u897f\u5355\u7eaf\u53ea\u662f\u4e00\u4e2a\u5730\u5740\u800c\u4e0d\u662f array \u4e86\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u8fd8\u80fd\u4f7f\u7528 a[2] \u8fdb\u884c\u68c0\u7d22\u5462\uff1f","title":"8.2.5.2 Array Decay \u5728 function parameter \u4e2d"},{"location":"08-Pointers-and-Arrays.html#8253-array","text":"\u5f53\u4f60\u6709\u4e00\u4e2a\u6307\u5411\u7c7b\u578b T \u7684\u6307\u9488 p \uff0c p[i] \u5b9e\u9645\u4e0a\u662f\u89e3\u5f15\u7528\u4e86 p \u50a8\u5b58\u7684\u5730\u5740\u4e4b\u540e i * sizeof(T)) \u4e2a byte \u7684\u5730\u5740\u3002 pointer arithmetic \u7b80\u5316\u4e86\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u91cd\u5199\u4e86 + \uff0c\u8ba9\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u6307\u9488\u578b p \u548c\u4e00\u4e2a int \u578b i \uff0c\u5b9a\u4e49\u4e86 *(p + i) \u8868\u793a\u89e3\u5f15\u7528 p \u6240\u5b58\u50a8\u7684\u5730\u5740\u540e\uff0c i \u500d\u7684 p \u6240\u5b58\u50a8\u5730\u5740\u4e0a\u7684 object \u5360 bytes \u5927\u5c0f\u7684\u5730\u5740\u4e0a\u7684 object. \u6240\u4ee5\u8bf4 p[i] = *(p + i) \u7684\u610f\u601d\u5c31\u662f\uff0c\u89e3\u5f15\u7528 \uff08 p \u52a0\u4e0a i \u4e2a T \u5927\u5c0f\u7684 bytes \u7684\u5730\u5740\uff09 \u4e0a\u7684\u503c. \u5f53\u7136\uff0c\u5728\u975e array \u533a\u57df\u4f7f\u7528\u8fd9\u4e2a\u7b26\u53f7\u867d\u7136\u5408\u6cd5\u4f46\u662f\u80af\u5b9a\u4f1a\u4ea7\u751f\u51fa\u83ab\u540d\u5176\u5999\u7684\u503c. \u4e0b\u9762\u4e3a\u4e00\u4e2a\u66f4\u52a0\u8be6\u7ec6\u7684\u89e3\u91ca.","title":"8.2.5.3 [] \u7684\u5b9a\u4e49: \u5176\u5b9e\u4e0d\u5c40\u9650\u4e8e array \u4e2d"},{"location":"08-Pointers-and-Arrays.html#83-pointer-arithmetic","text":"","title":"8.3 Pointer Arithmetic"},{"location":"08-Pointers-and-Arrays.html#831-sizeof-operator","text":"int a[3] = {1, 2, 3}; cout << sizeof(a) << endl; //12 cout << sizeof(int) << endl; //4 sizeof() \u6709\u4e24\u4e2a\u91cd\u5199\uff0c\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a type\uff0c\u662f\u8fd4\u56de\u67d0\u4e2a type \u7684\u5185\u5b58\u5927\u5c0f\uff1b \u53e6\u5916\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a variable\uff0c\u662f\u8fd4\u56de\u8be5 variable \u7684 object \u6240\u5c5e\u7684 type \u7684\u5185\u5b58\u5927\u5c0f. \u6211\u4eec\u9700\u8981\u6ce8\u610f\uff0c\u6240\u6709\u7684\u6307\u9488 type \u7684\u5927\u5c0f\u90fd\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u7ba1\u6307\u5411\u7684\u5bf9\u8c61\u591a\u5927\uff01 \u8fd9\u4e2a\u5927\u5c0f\u548c\u64cd\u4f5c\u7cfb\u7edf\u7684 bit \u6570\u6709\u5173\u3002 \u572832\u4f4d\uff0832-bit\uff09\u7cfb\u7edf\u4e2d\uff0c\u6307\u9488\u901a\u5e38\u662f4\u5b57\u8282\uff0832\u4f4d/8 = 4\u5b57\u8282\uff09\u3002 \u572864\u4f4d\uff0864-bit\uff09\u7cfb\u7edf\u4e2d\uff0c\u6307\u9488\u901a\u5e38\u662f8\u5b57\u8282\uff0864\u4f4d/8 = 8\u5b57\u8282\uff09\u3002 \u8fd9\u662f\u56e0\u4e3a\u6307\u9488\u9700\u8981\u80fd\u591f\u5b58\u50a8\u5185\u5b58\u4e2d\u4efb\u610f\u4f4d\u7f6e\u7684\u5730\u5740\uff0c\u800c\u5730\u5740\u7684\u5927\u5c0f\u5fc5\u987b\u8db3\u4ee5\u8986\u76d6\u6574\u4e2a\u7cfb\u7edf\u7684\u5730\u5740\u7a7a\u95f4\u3002\u572832\u4f4d\u7cfb\u7edf\u4e2d\uff0c\u6709232232\u4e2a\u53ef\u80fd\u7684\u5730\u5740\uff0c\u56e0\u6b64\u9700\u89814\u5b57\u8282\u6765\u8868\u793a\u8fd9\u4e9b\u5730\u5740\u3002\u540c\u6837\uff0c64\u4f4d\u7cfb\u7edf\u6709264264\u4e2a\u53ef\u80fd\u7684\u5730\u5740\uff0c\u9700\u89818\u5b57\u8282\u6765\u8868\u793a\u3002 2\u5b57\u8282\u6307\u9488\uff08\u537316\u4f4d\u62162\u5b57\u8282\u957f\uff09\u901a\u5e38\u89c1\u4e8e\u8001\u65e7\u768416\u4f4d\u7cfb\u7edf\uff0c\u8fd9\u7c7b\u7cfb\u7edf\u73b0\u5728\u76f8\u5bf9\u8f83\u5c11\u89c1\u3002","title":"8.3.1 sizeof() operator"},{"location":"08-Pointers-and-Arrays.html#832-pointer-offset-ptr-x","text":"Def1\uff1a ptr + x \u89e3\u5f15\u7528\u7684\u662f memory \u4e2d\u524d\u65b9\u7b2c x \u4e2a *ptr \u578b\u53d8\u91cf\uff0c\u4e5f\u5c31\u662f \u524d\u65b9 i * sizeof(*ptr) \u4e2a\u5730\u5740\u7684\u4e1c\u897f. \u8fd9\u91cc\u7684 ptr \u662f\u4e00\u4e2a pointer type\uff0c\u5b58\u653e\u7684\u662f\u5730\u5740\uff0c\u800c x \u5219\u662f\u4e00\u4e2a int \u578b. \u901a\u5e38\u800c\u8a00\u4e24\u4e2a\u4e0d\u540c\u7c7b\u7684\u53d8\u91cf\u7684\u503c\u662f\u4e0d\u80fd\u76f8\u52a0\u7684\uff0c\u4f46\u662f\u8fd9\u91cc\u662f\u4e00\u4e2a\u65b0\u7684\u8bed\u6cd5\u5b9a\u4e49\uff1a\u5b9a\u4e49 poiter \u578b\u53d8\u91cf\u52a0\u4e0a int \u578b\u53d8\u91cf x \u7684\u610f\u601d\u662f\u5730\u5740\u540e\u63a8 x \u4e2a int \u7684\u5927\u5c0f. **\u4e00\u4e2a int \u5360 memory \u5927\u5c0f\u4e3a 4 bytes\uff0c\u4e00\u4e2a char\u5360 memory \u5927\u5c0f\u4e3a 1 byte. ** \u4e00\u4e2a short \u4fee\u9970\u7684 object \u603b\u662f\u81f3\u5c11\u548c\u4e00\u4e2a char \u4e00\u6837\u5927\uff08$\\geq 1)$\uff0c\u4e00\u4e2a long \u4fee\u9970\u7684 object \u603b\u662f\u81f3\u5c11\u548c\u4e00\u4e2a int \u4e00\u6837\u5927. \uff08$\\geq 4$\uff09 \u8fd9\u4e2a\u8bed\u6cd5\u4e5f\u9002\u7528\u4e8e\u5176\u4ed6\u7c7b\u578b\u53d8\u91cf\u7684 array\uff0c\u4f46\u662f\u4e5f\u4ec5\u9650\u4e8e array\uff01 \u66f4\u52a0 general \u5730\u8bf4\uff1a Def: \u5f53\u4f60\u5bf9\u6307\u9488\u8fdb\u884c\u52a0\u6cd5\u64cd\u4f5c\u65f6\uff0c\u52a0\u4e0a\u7684\u6570\u5b9e\u9645\u4e0a\u88ab\u4e58\u4ee5\u6307\u9488\u6240\u6307\u5411\u7c7b\u578b\u7684\u5360 bytes \u5927\u5c0f. \u56e0\u800c\u6307\u9488\u53d8\u91cf\u7684\u76f8\u51cf\u7ed3\u679c\u5e76\u4e0d\u662f\u6307\u9488\u53d8\u91cf\uff0c\u800c\u662f\u4e00\u4e2a int\uff0c\u503c\u4e3a\u5730\u5740\u5dee\u7684\u6240\u6307\u53d8\u91cf\u7c7b\u578b\u5927\u5c0f\u7684\u4e2a\u6570. \u56e0\u800c\u5b9e\u9645\u4e0a\u6211\u4eec\u5e76\u4e0d\u7528\u62c5\u5fc3\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u5927\u5c0f\u662f\u591a\u5c11\uff0c\u56e0\u4e3a pointer arithmetic \u7528\u7684\u662f\u6570\u636e\u7684\u4e2a\u6570. int arr[4] = {1, 2, 3, 4}; cout << arr[3] << endl; // \u7ed3\u679c\u4e3a4 cout << *(arr + 3) << endl; // \u7ed3\u679c\u4e5f\u4e3a4 \u8fd9\u91cc arr \u662f\u4e00\u4e2a int array. \u800c\u5f53\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6\u5b83\u7684\u503c\u65f6\uff0c\u5b83 decay \u4e3a\u4e86\u9996\u4e2a\u5143\u7d20\u7684 address. \u57fa\u4e8e\u8bed\u6cd5\uff0c arr + 3 \u7684\u503c\u662f arr \u9996\u4e2a\u5143\u7d20\u7684\u5730\u5740 ( &arr[0] ) \u52a0\u4e0a ($3 \\times $ \u5b83\u7684\u53d8\u91cf\u7c7b\u578b\u5360bytes\u6570\u91cf). \u56e0\u4e3a int \u5360 4 bytes\uff0c\u6700\u540e\u503c\u5c31\u662f ( &arr[0] + 12). \u56e0\u800c\u8fd9\u4e5f\u5c31\u7b49\u4e8e arr[3] . \u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f\u6570\u7ec4\uff0c *(arr + n) \u5c31\u7b49\u4e8e arr[n] .","title":"8.3.2 Pointer Offset: ptr + x"},{"location":"08-Pointers-and-Arrays.html#833-arri-iarr","text":"**\u5e76\u4e14\u8fd9\u4e2a arr[n] \u5176\u5b9e\u5e76\u4e0d\u662f\u4e00\u5b9a\u8981 arr \u7684\u7b2c n+1 \u4e2a\u5143\u7d20\uff0c\u8fd9\u53ea\u662f\u6211\u4eec\u7684\u4e60\u60ef\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a n[arr] \u4e5f\u53ef\u4ee5. ** \u56e0\u4e3a\u8fd9\u4e2a [] \u8fd0\u7b97\u7b26\u7684\u5b9a\u4e49\u5c31\u662f\u524d\u540e\u7684\u5143\u7d20\u7684\u6307\u9488 arithmetic \u7684\u89e3\u5f15\u7528\uff01 Def3: *(ptr + i) = *(i + ptr) == ptr[i] == i[ptr]; example: int arr[4] = {1, 2, 3, 4}; cout << arr[3] << endl; // 4 cout << *(arr + 3) << endl; // 4 cout << *(arr + 3) << endl; // 4 cout << *(3 + arr) << endl; // 4 cout << 3[arr] << endl; // 4","title":"8.3.3 arr[i] (== i[arr]) \u7684\u5b9a\u4e49"},{"location":"08-Pointers-and-Arrays.html#834-pointer-difference-ptr1-ptr2","text":"Def: ptr2 - ptr1 computes the number of spaces between the two addresses in memory. \uff08\u4e24\u4e2a\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u4e4b\u95f4\u6709\u591a\u5c11\u4e2a\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\uff09 #include <iostream> using namespace std; int main() { int arr[5] = {6, 3, 2, 4, 5}; int *a = arr; int *d = &arr[1]; cout << (a - d) << endl; // 0 }","title":"8.3.4 Pointer Difference: ptr1 - ptr2"},{"location":"08-Pointers-and-Arrays.html#835-pointer-comparison","text":"Pointer Comparison \u6bd4\u8f83\u7684\u662f\u5730\u5740\u7684\u5927\u5c0f. \u5730\u5740\u5728\u540e\u9762\u7684\u5c31\u662f\u66f4\u5927\u7684\u5730\u5740. \u56e0\u800c\u6bd4\u5982\uff1a int main() { int arr[5] = { 5, 4, 3, 2, 1 }; int *ptr1 = arr + 2; int *ptr2 = arr + 3; cout << (ptr1 == ptr2) << endl; //false cout << (ptr1 < ptr2) << endl; //true cout << (ptr1 == ptr2 - 1) << endl; //true cout << (ptr1 < arr + 5) << endl; //true } \u6700\u540e\u4e00\u6761\u503c\u5f97\u6ce8\u610f: arr + 5 \u662f\u4e00\u4e2a\u6ca1\u6709\u5b9a\u4e49\u7684\u5730\u5740. \u5b83\u8d85\u8fc7\u4e86 array \u7684\u8303\u56f4\uff0c\u4e0a\u9762\u5e76\u6ca1\u6709 compile \u65f6\u7684\u53d8\u91cf\uff0c\u56e0\u800c\u8fd9\u4e2a\u5730\u65b9 runtime \u65f6\u7684 object \u662f\u4e00\u4e2a\u4e71\u4e03\u516b\u7cdf\u7684 object. \u4f46\u662f\u8fd9\u5e76\u4e0d\u5f71\u54cd\u5b83\u7684\u5730\u5740\u6bd4\uff08\u8be5\u5730\u5740-5\u4e2a int \u5927\u5c0f\u7684\u5730\u5740\uff09\u8981\u5927.","title":"8.3.5 Pointer Comparison"},{"location":"08-Pointers-and-Arrays.html#836-traversal-by-pointer","text":"\u6253\u5370 array \u7684\u4e00\u4e2a\u65b9\u6cd5\uff1a #include <iostream> using namespace std; int maxValue(int arr[], int len) { // compiler changes to int *arr int max = *arr; for (int *p = arr; p < (arr + len); p++){ if (*p > max){ max = *p; } } return max; } int main() { int arr1[4] = {2, 3, 6, 1}; int m1 = maxValue(arr1, 4); cout << \"max value in arr1 = \" << m1 << endl; assert(m1 == 6); int arr2[3] = {-4, -2, -8}; int m2 = maxValue(arr2, 3); cout << \"max value in arr2 = \" << m2 << endl; assert(m2 == -2); } \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u6211\u4eec\u5bf9 *arr , *p \u8fdb\u884c\u6539\u53d8\uff0c\u90fd\u4f1a\u5bf9\u539f array \u8fd9\u4e2a object \u5f71\u54cd. \u4f46\u662f int max = *arr \u548c max = *p \u53ea\u662f\u628a arr \u548c p \u6307\u5411\u7684 object \u7684\u503c assign \u7ed9\u4e86\u8fd9\u4e2a int \u578b\u53d8\u91cf. \u8fd9\u5e76\u4e0d\u662f\u4e00\u4e2a reference semantics \u800c\u662f\u4e00\u4e2a value semantics. \u56e0\u800c\u8fd9\u4e2a\u51fd\u6570\u624d\u5408\u6cd5. \u6211\u4eec\u9700\u8981\u8bb0\u5f97\u628a\u5730\u5740\u89e3\u5f15\u7528\u8d4b\u7ed9\u4e00\u4e2a\u53d8\u91cf\u5e76\u4e0d\u662f reference semantics\uff01\uff01 \u53ea\u6709 int &x = y \u624d\u662f reference semantics.","title":"8.3.6 Traversal by Pointer"},{"location":"09-const-keyword.html","text":"9 the const keyword and compound objects 9.1 const as type qualifier 9.1.1 const pointer 9.1.2 pointer-to-const 9.1.3 reference to const variables 9.1.4 const conversions 9.1.5 \u4f8b\u5b50 9.1.6 const in function 9.1.6.1 const parameter 9.1.6.2 return const 9.1.6.3 \u628a\u666e\u901a ptr \u4f20\u7ed9\u53c2\u6570\u662f const ptr \u6216 ptr-to-const \u7684\u51fd\u6570 9.1.6.4 \u628a const variable \u4f20\u7ed9\u53c2\u6570\u4e0d\u662f const \u7684\u51fd\u6570\uff1aerror 9 the const keyword and compound objects 9.1 const as type qualifier \u8fd9\u4e00\u8282\u975e\u5e38\u9006\u5929\uff0c\u5f88\u7ed5. void copy(int dst[], const int src[], int n) { for (int i = 0; i < n; ++i) { src[i] = dst[i]; //error\uff0c\u56e0\u4e3a scr[]\u88ab\u6dfb\u52a0\u4e86const } } const \u662f\u4e00\u4e2a type qualifier . const forbids assignment. (\u4ec5\u652f\u6301 Initialization) const int x = 3; // ok x = 5; // won\u2019t compile 9.1.1 const pointer \u5e26 const \u7684\u6307\u9488\u7c7b\u578b\u53d8\u91cf\u548c\u5176\u4ed6\u53d8\u91cf\u4e00\u6837\uff0c\u5c31\u662f\u503c\u5728 initialization \u4e4b\u540e\u5c31\u4e0d\u80fd\u53d8\u4e86. \u4e5f\u5c31\u662f \u5b83\u88c5\u7684 address \u4e0d\u80fd\u53d8. int x = 3; int y = 5; int * const ptr = &x; ptr = &y; // ERROR \u4f46\u662f\u5b83\u88c5\u7684 address \u4e0b\u7684\u53d8\u91cf\u662f\u53ef\u4ee5\u53d8\u7684. int x = 3; int y = 5; int * const ptr = &x; *ptr = 10 // ok, x = 10 9.1.2 pointer-to- const const int * ptr = &x; \u6216 int const * ptr = &x \u7684\u610f\u601d\u662f\uff1a\u6dfb\u52a0\u4e00\u4e2a \u6307\u9488 ptr \u6307\u5411 x \uff0c\u5e76\u4e14\u8fd9\u4e2a\u6307\u5411\u7684\u884c\u4e3a\u662f const \u7684. \u8fd9\u5e76\u4e0d\u4ee3\u8868 x \u53d8\u6210\u4e86 const \u53d8\u91cf\uff0c\u800c\u8fd9\u4e2a ptr \u4e5f\u5e76\u4e0d\u662f const \u6307\u9488. \u8fd9\u91cc\u7684\u610f\u601d\u662f ptr \u4e0d\u80fd\u7528\u6765\u6539\u53d8 x \u7684\u503c. **\u56e0\u800c\u4f60\u8fd8\u662f\u53ef\u4ee5\u6539\u53d8 x \u7684\u503c\uff0c\u4f46\u662f\u4e0d\u80fd\u7528 ptr \u6539\u53d8. ** int x = 3; int const * ptr = &x; //\u6216\u8005int const * ptr = &x; *ptr = 10; // ERROR x = 10; // ok, *ptr\u73b0\u5728\u503c\u4e3a10 \u5e76\u4e14\u4e0d\u4ec5\u5982\u6b64\uff0c\u8fd9\u4e2a pointer to const \u548c const pointer \u8fd8\u6709\u4e00\u4e2a\u533a\u522b\u662f\uff0c pointer to const \u53ef\u4ee5\u6539\u7ed1\u5176\u4ed6 object \u7684 address. int x = 3; int y = 6; const int * ptr = &x; //\u6216\u8005int const * ptr = &x; *ptr = 10; // ERROR x = 10; // ok, *ptr\u73b0\u5728\u503c\u4e3a10 ptr = &y; //ok, ptr\u73b0\u5728\u5b58\u7684\u662fy\u7684\u5730\u5740 *ptr = 10; // ERROR y = 10; // ok, *ptr\u73b0\u5728\u503c\u4e3a10 \u5199\u6cd5\u7684\u533a\u522b\u662f const pointer \u7684 const \u5728 * \u540e\u9762\uff0c\u76f4\u63a5\u5728\u53d8\u91cf\u540d\u524d\u9762. \u8fd8\u6709\u4e00\u70b9\u662f\uff1a\u5982\u679c\u4f60\u8981\u6307\u5411\u4e00\u4e2a const variable\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528 ptr-to-const\uff01 \u603b\u7ed3\uff1a ptr \u548c x \u90fd\u4e0d\u662f const \uff0c\u4f46\u662f ptr \u5bf9 x \u7684\u884c\u4e3a\u662f const \u7684\uff1a\u4f60\u65e2\u53ef\u4ee5\u6539\u53d8 ptr \u7684\u503c\u53c8\u53ef\u4ee5\u6539\u53d8 x \u7684\u503c\uff0c\u4f46\u662f\u4f60\u4e0d\u80fd\u901a\u8fc7\u89e3\u5f15\u7528 ptr \u6765\u6539\u53d8 x \u7684\u503c. 9.1.3 reference to const variables const reference variable \u4e0d\u80fd\u7528\u6765 change object \u7684\u503c\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u7528\u8fd9\u4e2a object \u7684\u975e const variable \u6539\u53d8\u539f\u6765\u7684 object \u7684\u503c. int x = 3; int const &ref = x; // ref\u662fx\u7684alias ref = 10; // error x = 10; // still legal 9.1.4 const conversions int x = 3; int const *cptr = &x; //ptr-to-const const int *dptr = &x; //ptr-to-const, \u4e00\u6837 int * const eptr = &x; //const ptr int *ptr1 = cptr; // error int *ptr2 = dptr; // error int *ptr2 = fptr; // error // \u4e00\u4e2a\u90fd\u4e0d\u884c \u8fd9\u91cc\u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a pointer-to-const \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a\u666e\u901a\u7684 pointer\uff0c\u4e0d\u884c. \u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a const pointer \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a \u666e\u901a\u7684 pointer\uff0c\u4e5f\u4e0d\u884c. \u6ce8\u610f\u5230\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a const int \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a\u666e\u901a int\uff0c\u8fd9\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6307\u9488\u5b8c\u5168\u4e0d\u884c. \u8fd9\u662f\u56e0\u4e3a\u6307\u9488\u7684\u7c7b\u578b\u4e0d\u4ec5\u5305\u542b\u4e86\u5b83\u6240\u6307\u5411\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fd8\u5305\u542b\u4e86\u5bf9\u8fd9\u4e9b\u6570\u636e\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u6743\u9650. 9.1.5 \u4f8b\u5b50 int x = 3; int const y = 3; // const\u53d8\u91cf int const * ptr1 = &x; // ptr-to-const, \u6307\u5411x int * const ptr2 = &x; // const ptr, \u6307\u5411x int const &ref = x; y = 5; //error *ptr1 = 5; //error ptr1 = &y; //ok, ptr-to-const\u53ef\u4ee5\u6539\u7ed1 *ptr2 = 5; //ok, const ptr\u53ef\u4ee5\u8c03\u6574\u6307\u5411\u5bf9\u8c61\u503c ptr2 = &x; //error, const ptr\u4e0d\u53ef\u4ee5\u6539\u7ed1 ref = 5; //error, ref-to-const\u4e0d\u53ef\u4ee5\u8c03\u6574\u503c x = 5; //ok, x\u4e0d\u662fconst 9.1.6 const in function 9.1.6.1 const parameter \u5f53 function \u4e2d\u4e00\u4e2a parameter \u88ab\u58f0\u660e\u4e3a const \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5728\u51fd\u6570\u5185\u90e8\u4e0d\u80fd\u88ab\u4fee\u6539. \u8fd9\u5bf9\u4e8e ref \u548c ptr parameters \u5c24\u5176\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u4ee5\u7528\u6765\u4fee\u6539\u4f20\u9012\u7ed9\u51fd\u6570\u7684\u539f\u59cb\u6570\u636e\u3002\u58f0\u660e\u53c2\u6570\u4e3a const \u53ef\u4ee5\u4fdd\u8bc1\u5b89\u5168\u6027. void function(const int x) { // x \u662f const\uff0c\u6240\u4ee5\u4e0d\u80fd\u88ab\u4fee\u6539 } void function(const int *ptr) { // ptr-to-const, \u4e0d\u80fd\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c } void function(int * const ptr) { //const ptr, \u6307\u5411\u7684\u5730\u5740\u4e0d\u80fd\u6539\u53d8, \u53ef\u4ee5\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c } 9.1.6.2 return const const int getNumber() { return 5; } const int& getNumber(const int& x) { return x; } \u8868\u793a\u8fd4\u56de\u7684\u503c\u6216ref \u4e0d\u80fd\u88ab\u4fee\u6539. 9.1.6.3 \u628a\u666e\u901a ptr \u4f20\u7ed9\u53c2\u6570\u662f const ptr \u6216 ptr-to-const \u7684\u51fd\u6570 \u5c06\u666e\u901a\u6307\u9488\u4f20\u9012\u7ed9\u8981\u6c42 pointer-to-const \u7684\u51fd\u6570 : \u5c06\u4e00\u4e2a\u6307\u5411\u975e const \u6570\u636e\u7684\u6307\u9488\u4f20\u9012\u7ed9\u4e00\u4e2a\u63a5\u53d7\u6307\u5411 const \u6570\u636e\u7684\u6307\u9488\u7684\u53c2\u6570\u65f6\uff0c\u5728\u8fd9\u4e2a\u51fd\u6570\u5185\u90e8\uff0c\u4e0d\u4f1a\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u4fee\u6539\u6570\u636e. \u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5. ```c++ void func(const int ptr) { // \u5728\u8fd9\u91cc\uff0c ptr \u4e0d\u80fd\u88ab\u4fee\u6539 } int main() { int x = 10; int ptr = &x; func(ptr); // \u5408\u6cd5\uff1a\u5c06 int \u8f6c\u6362\u4e3a const int* return 0; } ``` \u5c06\u666e\u901a\u6307\u9488\u4f20\u9012\u7ed9\u8981\u6c42 const pointer \u7684\u51fd\u6570 : \u8fd9\u610f\u5473\u7740\u51fd\u6570\u5185\u90e8\u4e0d\u80fd\u6539\u53d8\u6307\u9488\u7684\u503c\uff0c\u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5. ```c++ void func(int *const ptr) { // ptr \u672c\u8eab\u4e0d\u80fd\u88ab\u6539\u53d8\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 ptr \u4fee\u6539\u6240\u6307\u5411\u7684\u6570\u636e } int main() { int x = 10; int *ptr = &x; func(ptr); // \u5408\u6cd5 return 0; } ``` 9.1.6.4 \u628a const variable \u4f20\u7ed9\u53c2\u6570\u4e0d\u662f const \u7684\u51fd\u6570\uff1aerror \u5982\u679c\u4e00\u4e2a\u53d8\u91cf\u662f const\uff0c\u90a3\u4e48 void teal(const int *a); void red(int *a); void purple(int a); int main() { const int arr1[6] = { ... }; int arr2[6] = { ... }; teal(arr1); // ok, const to const red(arr1); // error, const \u53d8\u91cf\u4f20\u7ed9\u975e const \u51fd\u6570\u53c2\u6570 purple(arr1[0]); //ok. \u56e0\u4e3a\u53ea\u4f20array\u7684\u4e00\u4e2a\u503c\u662f\u503c\u4f20\u9012, \u5982\u679c\u4f20array\u81ea\u8eab\u5c31\u662f\u5f15\u7528\u4f20\u9012\u7b2c\u4e00\u4e2a\u5143\u7d20\u5730\u5740. teal(arr2); // ok red(arr2); //ok purple(arr2[0]); //ok }","title":"Overview"},{"location":"09-const-keyword.html#9-the-const-keyword-and-compound-objects","text":"","title":"9 the const keyword and compound objects"},{"location":"09-const-keyword.html#91-const-as-type-qualifier","text":"\u8fd9\u4e00\u8282\u975e\u5e38\u9006\u5929\uff0c\u5f88\u7ed5. void copy(int dst[], const int src[], int n) { for (int i = 0; i < n; ++i) { src[i] = dst[i]; //error\uff0c\u56e0\u4e3a scr[]\u88ab\u6dfb\u52a0\u4e86const } } const \u662f\u4e00\u4e2a type qualifier . const forbids assignment. (\u4ec5\u652f\u6301 Initialization) const int x = 3; // ok x = 5; // won\u2019t compile","title":"9.1 const as type qualifier"},{"location":"09-const-keyword.html#911-const-pointer","text":"\u5e26 const \u7684\u6307\u9488\u7c7b\u578b\u53d8\u91cf\u548c\u5176\u4ed6\u53d8\u91cf\u4e00\u6837\uff0c\u5c31\u662f\u503c\u5728 initialization \u4e4b\u540e\u5c31\u4e0d\u80fd\u53d8\u4e86. \u4e5f\u5c31\u662f \u5b83\u88c5\u7684 address \u4e0d\u80fd\u53d8. int x = 3; int y = 5; int * const ptr = &x; ptr = &y; // ERROR \u4f46\u662f\u5b83\u88c5\u7684 address \u4e0b\u7684\u53d8\u91cf\u662f\u53ef\u4ee5\u53d8\u7684. int x = 3; int y = 5; int * const ptr = &x; *ptr = 10 // ok, x = 10","title":"9.1.1 const pointer"},{"location":"09-const-keyword.html#912-pointer-to-const","text":"const int * ptr = &x; \u6216 int const * ptr = &x \u7684\u610f\u601d\u662f\uff1a\u6dfb\u52a0\u4e00\u4e2a \u6307\u9488 ptr \u6307\u5411 x \uff0c\u5e76\u4e14\u8fd9\u4e2a\u6307\u5411\u7684\u884c\u4e3a\u662f const \u7684. \u8fd9\u5e76\u4e0d\u4ee3\u8868 x \u53d8\u6210\u4e86 const \u53d8\u91cf\uff0c\u800c\u8fd9\u4e2a ptr \u4e5f\u5e76\u4e0d\u662f const \u6307\u9488. \u8fd9\u91cc\u7684\u610f\u601d\u662f ptr \u4e0d\u80fd\u7528\u6765\u6539\u53d8 x \u7684\u503c. **\u56e0\u800c\u4f60\u8fd8\u662f\u53ef\u4ee5\u6539\u53d8 x \u7684\u503c\uff0c\u4f46\u662f\u4e0d\u80fd\u7528 ptr \u6539\u53d8. ** int x = 3; int const * ptr = &x; //\u6216\u8005int const * ptr = &x; *ptr = 10; // ERROR x = 10; // ok, *ptr\u73b0\u5728\u503c\u4e3a10 \u5e76\u4e14\u4e0d\u4ec5\u5982\u6b64\uff0c\u8fd9\u4e2a pointer to const \u548c const pointer \u8fd8\u6709\u4e00\u4e2a\u533a\u522b\u662f\uff0c pointer to const \u53ef\u4ee5\u6539\u7ed1\u5176\u4ed6 object \u7684 address. int x = 3; int y = 6; const int * ptr = &x; //\u6216\u8005int const * ptr = &x; *ptr = 10; // ERROR x = 10; // ok, *ptr\u73b0\u5728\u503c\u4e3a10 ptr = &y; //ok, ptr\u73b0\u5728\u5b58\u7684\u662fy\u7684\u5730\u5740 *ptr = 10; // ERROR y = 10; // ok, *ptr\u73b0\u5728\u503c\u4e3a10 \u5199\u6cd5\u7684\u533a\u522b\u662f const pointer \u7684 const \u5728 * \u540e\u9762\uff0c\u76f4\u63a5\u5728\u53d8\u91cf\u540d\u524d\u9762. \u8fd8\u6709\u4e00\u70b9\u662f\uff1a\u5982\u679c\u4f60\u8981\u6307\u5411\u4e00\u4e2a const variable\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528 ptr-to-const\uff01 \u603b\u7ed3\uff1a ptr \u548c x \u90fd\u4e0d\u662f const \uff0c\u4f46\u662f ptr \u5bf9 x \u7684\u884c\u4e3a\u662f const \u7684\uff1a\u4f60\u65e2\u53ef\u4ee5\u6539\u53d8 ptr \u7684\u503c\u53c8\u53ef\u4ee5\u6539\u53d8 x \u7684\u503c\uff0c\u4f46\u662f\u4f60\u4e0d\u80fd\u901a\u8fc7\u89e3\u5f15\u7528 ptr \u6765\u6539\u53d8 x \u7684\u503c.","title":"9.1.2 pointer-to-const"},{"location":"09-const-keyword.html#913-reference-to-const-variables","text":"const reference variable \u4e0d\u80fd\u7528\u6765 change object \u7684\u503c\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u7528\u8fd9\u4e2a object \u7684\u975e const variable \u6539\u53d8\u539f\u6765\u7684 object \u7684\u503c. int x = 3; int const &ref = x; // ref\u662fx\u7684alias ref = 10; // error x = 10; // still legal","title":"9.1.3 reference to const variables"},{"location":"09-const-keyword.html#914-const-conversions","text":"int x = 3; int const *cptr = &x; //ptr-to-const const int *dptr = &x; //ptr-to-const, \u4e00\u6837 int * const eptr = &x; //const ptr int *ptr1 = cptr; // error int *ptr2 = dptr; // error int *ptr2 = fptr; // error // \u4e00\u4e2a\u90fd\u4e0d\u884c \u8fd9\u91cc\u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a pointer-to-const \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a\u666e\u901a\u7684 pointer\uff0c\u4e0d\u884c. \u6211\u4eec\u5c1d\u8bd5\u628a\u4e00\u4e2a const pointer \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a \u666e\u901a\u7684 pointer\uff0c\u4e5f\u4e0d\u884c. \u6ce8\u610f\u5230\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a const int \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a\u666e\u901a int\uff0c\u8fd9\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6307\u9488\u5b8c\u5168\u4e0d\u884c. \u8fd9\u662f\u56e0\u4e3a\u6307\u9488\u7684\u7c7b\u578b\u4e0d\u4ec5\u5305\u542b\u4e86\u5b83\u6240\u6307\u5411\u7684\u6570\u636e\u7c7b\u578b\uff0c\u8fd8\u5305\u542b\u4e86\u5bf9\u8fd9\u4e9b\u6570\u636e\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u6743\u9650.","title":"9.1.4 const conversions"},{"location":"09-const-keyword.html#915","text":"int x = 3; int const y = 3; // const\u53d8\u91cf int const * ptr1 = &x; // ptr-to-const, \u6307\u5411x int * const ptr2 = &x; // const ptr, \u6307\u5411x int const &ref = x; y = 5; //error *ptr1 = 5; //error ptr1 = &y; //ok, ptr-to-const\u53ef\u4ee5\u6539\u7ed1 *ptr2 = 5; //ok, const ptr\u53ef\u4ee5\u8c03\u6574\u6307\u5411\u5bf9\u8c61\u503c ptr2 = &x; //error, const ptr\u4e0d\u53ef\u4ee5\u6539\u7ed1 ref = 5; //error, ref-to-const\u4e0d\u53ef\u4ee5\u8c03\u6574\u503c x = 5; //ok, x\u4e0d\u662fconst","title":"9.1.5 \u4f8b\u5b50"},{"location":"09-const-keyword.html#916-const-in-function","text":"","title":"9.1.6 const in function"},{"location":"09-const-keyword.html#9161-const-parameter","text":"\u5f53 function \u4e2d\u4e00\u4e2a parameter \u88ab\u58f0\u660e\u4e3a const \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5728\u51fd\u6570\u5185\u90e8\u4e0d\u80fd\u88ab\u4fee\u6539. \u8fd9\u5bf9\u4e8e ref \u548c ptr parameters \u5c24\u5176\u91cd\u8981\uff0c\u56e0\u4e3a\u5b83\u4eec\u53ef\u4ee5\u7528\u6765\u4fee\u6539\u4f20\u9012\u7ed9\u51fd\u6570\u7684\u539f\u59cb\u6570\u636e\u3002\u58f0\u660e\u53c2\u6570\u4e3a const \u53ef\u4ee5\u4fdd\u8bc1\u5b89\u5168\u6027. void function(const int x) { // x \u662f const\uff0c\u6240\u4ee5\u4e0d\u80fd\u88ab\u4fee\u6539 } void function(const int *ptr) { // ptr-to-const, \u4e0d\u80fd\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c } void function(int * const ptr) { //const ptr, \u6307\u5411\u7684\u5730\u5740\u4e0d\u80fd\u6539\u53d8, \u53ef\u4ee5\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c }","title":"9.1.6.1 const parameter"},{"location":"09-const-keyword.html#9162-return-const","text":"const int getNumber() { return 5; } const int& getNumber(const int& x) { return x; } \u8868\u793a\u8fd4\u56de\u7684\u503c\u6216ref \u4e0d\u80fd\u88ab\u4fee\u6539.","title":"9.1.6.2 return const"},{"location":"09-const-keyword.html#9163-ptr-const-ptr-ptr-to-const","text":"\u5c06\u666e\u901a\u6307\u9488\u4f20\u9012\u7ed9\u8981\u6c42 pointer-to-const \u7684\u51fd\u6570 : \u5c06\u4e00\u4e2a\u6307\u5411\u975e const \u6570\u636e\u7684\u6307\u9488\u4f20\u9012\u7ed9\u4e00\u4e2a\u63a5\u53d7\u6307\u5411 const \u6570\u636e\u7684\u6307\u9488\u7684\u53c2\u6570\u65f6\uff0c\u5728\u8fd9\u4e2a\u51fd\u6570\u5185\u90e8\uff0c\u4e0d\u4f1a\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u4fee\u6539\u6570\u636e. \u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5. ```c++ void func(const int ptr) { // \u5728\u8fd9\u91cc\uff0c ptr \u4e0d\u80fd\u88ab\u4fee\u6539 } int main() { int x = 10; int ptr = &x; func(ptr); // \u5408\u6cd5\uff1a\u5c06 int \u8f6c\u6362\u4e3a const int* return 0; } ``` \u5c06\u666e\u901a\u6307\u9488\u4f20\u9012\u7ed9\u8981\u6c42 const pointer \u7684\u51fd\u6570 : \u8fd9\u610f\u5473\u7740\u51fd\u6570\u5185\u90e8\u4e0d\u80fd\u6539\u53d8\u6307\u9488\u7684\u503c\uff0c\u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5. ```c++ void func(int *const ptr) { // ptr \u672c\u8eab\u4e0d\u80fd\u88ab\u6539\u53d8\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7 ptr \u4fee\u6539\u6240\u6307\u5411\u7684\u6570\u636e } int main() { int x = 10; int *ptr = &x; func(ptr); // \u5408\u6cd5 return 0; } ```","title":"9.1.6.3 \u628a\u666e\u901a ptr \u4f20\u7ed9\u53c2\u6570\u662f const ptr \u6216 ptr-to-const \u7684\u51fd\u6570"},{"location":"09-const-keyword.html#9164-const-variable-const-error","text":"\u5982\u679c\u4e00\u4e2a\u53d8\u91cf\u662f const\uff0c\u90a3\u4e48 void teal(const int *a); void red(int *a); void purple(int a); int main() { const int arr1[6] = { ... }; int arr2[6] = { ... }; teal(arr1); // ok, const to const red(arr1); // error, const \u53d8\u91cf\u4f20\u7ed9\u975e const \u51fd\u6570\u53c2\u6570 purple(arr1[0]); //ok. \u56e0\u4e3a\u53ea\u4f20array\u7684\u4e00\u4e2a\u503c\u662f\u503c\u4f20\u9012, \u5982\u679c\u4f20array\u81ea\u8eab\u5c31\u662f\u5f15\u7528\u4f20\u9012\u7b2c\u4e00\u4e2a\u5143\u7d20\u5730\u5740. teal(arr2); // ok red(arr2); //ok purple(arr2[0]); //ok }","title":"9.1.6.4 \u628a const variable \u4f20\u7ed9\u53c2\u6570\u4e0d\u662f const \u7684\u51fd\u6570\uff1aerror"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html","text":"10.1 Struct 10.1.1 Definition, Creating Instance and initialize 10.1.2 Member Access: . 10.1.3 \u6dfb\u52a0 const \u7684 instance 10.1.4 \u6307\u5411 struct instance \u7684 ptr 10.1.5 \u4f7f\u7528pass-by-pointer \u7684 init \u51fd\u6570 10.1.6 -> \u8fd0\u7b97\u7b26 10.1.7 \u4f7f\u7528 assert() \u6765\u68c0\u67e5\u662f\u5426 respect interface 10.1.8 \u53c2\u6570\u4e3a struct \u7684\u51fd\u6570: parameter passing rules 10.1.9 Composing ADTs: Abstraction Layers 10.2 Dynamic Allocation 10.2.1 Heap (\u5806) 10.3.2 new \u548c delete: \u5206\u914d\u548c\u91ca\u653e dynamic memory 10.1 Struct struct \u5c31\u662f\u6211\u4eec\u8bf4\u7684 C-Style \u7684 ADT. An abstract data type (ADT) separates the interface of a data type from its implementation, and it encompasses both the data itself as well as functionality on the data. 10.1.1 Definition, Creating Instance and initialize struct Person { int age; string name; bool isNinja; }; // \u6ce8\u610f; int main() { int x; Person alex; alex = { 75, \"granny\", false }; Person jon = { 25, \"jon\", true }; } We can define a new compound object type via a struct definition (e.g. Person ). We define objects as instances of that type. The struct definition contains member variable declarations , member variables define \u8fd9\u4e2a compound object \u7684 subobjects. \u53ef\u4ee5\u5148\u521b\u9020 object, \u4f46\u662f\u4e0d initialize variables.(\u5982\u56fe) 10.1.2 Member Access: . Individual members are accessed via the . operator (also called the \" member access operator \"). struct Person { int age; string name; bool isNinja; }; int main() { Person p = { 17, \"Ron\", true }; p.isNinja = true; } 10.1.3 \u6dfb\u52a0 const \u7684 instance If you've got a struct object that is const-qualified , that forbids assignment to the struct as a whole and also forbids assignment to its individual members. \u6240\u6709member\u90fd\u4e0d\u80fd\u66f4\u6539\u503c\uff0c\u6574\u4e2a instance \u4e5f\u4e0d\u884c. struct Person { int age; string name; bool isNinja; }; int main() { const Person p1 = { 17, \"Kim\", true }; Person p2 = { 17, \"Ron\", true }; p1.isNinja = false; // error p1 = p2; // error } \u5e76\u4e14\u5373\u4fbf\u6ca1\u6709 initialize \u4e5f\u4e0d\u80fd\u6539. int main() { const Person p1; p1.isNinja = false; // error } 10.1.4 \u6307\u5411 struct instance \u7684 ptr Access structs via pointers : obj.member ptr->member struct Person { int age; string name; bool isNinja; }; int main() { Person p = { 31, \"Aliyah\", true }; Person * ptr = &p; p.age = 32; // \u8fd9\u4e09\u4e2a\u4e00\u6837 (*ptr).age = 32; // \u8fd9\u4e09\u4e2a\u4e00\u6837 ptr->age = 32; // \u8fd9\u4e09\u4e2a\u4e00\u6837 } \u540c\u6837\uff0c\u6307\u5411 const \u7684 struct instance \u7684 ptr \u4e5f\u5fc5\u987b\u662f ptr-to-const. #include <iostream> #include <string> using namespace std; struct Sandwich { string name; bool is_veg; double price; }; int main() { const Sandwich a = {\"a\", true, 1.11}; Sandwich const *ptr = &a; cout << ptr->name; } 10.1.5 \u4f7f\u7528pass-by-pointer \u7684 init \u51fd\u6570 \u4e00\u4e2a ADT \u7684\u5360\u5185\u5b58\u5927\u5c0f\u662f\u5f88\u5927\u7684\u3002\u6211\u4eec\u6709\u65f6\u5019\u4e0d\u5f97\u4e0d\u7528\u4e00\u4e2a function \u6765 init \u5b83\uff0c\u4f46\u662f\u6211\u4eec\u80af\u5b9a\u4e0d\u60f3\u5728 function \u7684 stackframe \u91cc copy \u5b83\uff0c\u7136\u540e\u518d\u590d\u5236\u56de\u53bb\uff0c\u56e0\u4e3a\u5b83\u592a\u5927\u4e86\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u628a\u4e00\u4e2a\u5f88\u5927\u7684 ADT \u53d8\u6210\u4e86\u4e24\u4e2a\uff0c\u975e\u5e38\u5360\u5185\u5b58\u3002 \u4e4b\u524d\u8bf4\u4e86\uff0c pointer \u7c7b object \u7684\u5927\u5c0f\u662f\u6052\u5b9a\u7684\uff0c\u5e76\u4e14\u5c31\u7b49\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f4d\u6570\uff0c\u6240\u4ee5\u5176\u5b9e\u975e\u5e38\u5c0f\u3002 \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a pass-by-pointer \u7684 init \u51fd\u6570\u6765 initialize \u4e00\u4e2a ADT struct. \u6bd4\u5982\u4e00\u4e2a Triangle\uff1a struct Triangle { double a, b, c; }; void Triangle_init(Triangle *tri, double a_in, double b_in, double c_in) { tri->a = a_in; tri->b = b_in; tri->c = c_in; } int main() { Triangle t1; Triangle_init(&t1, 3, 4, 11); } 10.1.6 -> \u8fd0\u7b97\u7b26 \u8fd9\u91cc\u7684 -> \u8fd0\u7b97\u7b26\u662f\u9488\u5bf9 class \u7c7b object \u7684\u6307\u9488\u7684\u8fd0\u7b97\u7b26\u3002\u5b83\u83b7\u53d6\u7684\u5bf9\u8c61\u662f p \u6307\u5411\u7684 object \u7684\u67d0\u4e2a\u5c5e\u6027. \u6bd4\u5982 tri -> a \u5c31\u662f tri \u8fd9\u4e2a Triangle * \u6240\u6307\u5411\u7684 Triangle object \u7684 a \u8fd9\u4e2a\u5c5e\u6027. \u5f53\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u4e5f\u4f7f\u7528 (*tri).a . \u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\u5c31\u662f *tri.a \u662f\u4e0d\u4f1a compile \u7684\uff0c\u53ea\u6709\u52a0\u4e0a\u62ec\u53f7 (*tri).a \u624d compile. \u8fd9\u662f\u56e0\u4e3a\u4f18\u5148\u7ea7\u7684\u95ee\u9898\u3002 \u6240\u4ee5\u5f88\u4e0d\u65b9\u4fbf\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u4f7f\u7528 -> \u597d\uff08\u800c\u4e14\u76f4\u89c2\uff09\u3002 10.1.7 \u4f7f\u7528 assert() \u6765\u68c0\u67e5\u662f\u5426 respect interface \u4f46\u662f\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a Triangle \u7684\u8fb9\u957f\u6784\u4e0d\u6210\u4e00\u4e2a Triangle. \u5e94\u8be5\u7528 assert \u6765\u9632\u6b62\u8fd9\u4e9b\u60c5\u51b5\u3002 \u8fd9\u5c31\u662f ADT \u8981 respect interface \u7684\u7279\u70b9 void Triangle_init(Triangle *tri, double a_in, double b_in, double c_in) { assert(0 < a_in && 0 < b_in && 0 < c_in); assert(a_in + b_in > c_in && a_in + c_in > b_in && b_in + c_in > a_in); tri->a = a_in; tri->b = b_in; tri->c = c_in; } \u5199\u4e00\u4e9b\u51fd\u6570\u8868\u793a\u8fd9\u4e2a ADT \u7684\u64cd\u4f5c\uff1a struct Triangle { double side1; double side2; double angle; }; // REQUIRES: tri points to a Triangle object // MODIFIES: *tri // EFFECTS: Initializes the triangle with the given side lengths. void Triangle_init(Triangle *tri, double a_in, double b_in, double c_in) { tri->side1 = a_in; tri->side2 = b_in; tri->angle = std::acos((std::pow(a_in, 2) + std::pow(b_in, 2) - std::pow(c_in, 2)) / (2 * a_in * b_in)); } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the first side of the given Triangle. double Triangle_side1(const Triangle *tri) { return tri->side1; } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the second side of the given Triangle. double Triangle_side2(const Triangle *tri) { return tri->side2; } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the third side of the given Triangle. double Triangle_side3(const Triangle *tri) { return std::sqrt(std::pow(tri->side1, 2) + std::pow(tri->side2, 2) - 2 * tri->side1 * tri->side2 * std::acos(tri->angle)); } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the perimeter of the given Triangle. double Triangle_perimeter(const Triangle *tri) { return Triangle_side1(tri) + Triangle_side2(tri) + Triangle_side3(tri); } // REQUIRES: tri points to a valid Triangle; s > 0 // MODIFIES: *tri // EFFECTS: Scales the sides of the Triangle by the factor s. void Triangle_scale(Triangle *tri, double s) { tri->side1 *= s; tri->side2 *= s; } 10.1.8 \u53c2\u6570\u4e3a struct \u7684\u51fd\u6570: parameter passing rules \u5f53\u7136\uff0c\u4e0d\u6b62 init \u51fd\u6570\uff0c\u57fa\u672c\u6240\u6709\u9700\u8981\u4f20\u9012 ADT \u53c2\u6570\u7684\u51fd\u6570\uff0c\u6211\u4eec\u90fd\u6700\u597d\u4e0d\u8981 pass by value\u3002\u56e0\u4e3a\u771f\u7684\u5f88\u5927\u3002 \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5 \u4f7f\u7528 pass-by-reference \u6216\u8005 pass-by-pointer. \u5982\u679c\u6211\u4eec\u4e0d\u60f3\u7528\u8fd9\u4e2a ptr \u6765 modify the outside object\uff0c\u6211\u4eec\u9700\u8981\u52a0\u4e0a const \u5173\u952e\u8bcd\uff0c\u4f7f\u7528 pointer-to-const \u6216\u8005 reference-to-const \u6765\u64cd\u4f5c\u3002 10.1.9 Composing ADTs: Abstraction Layers One ADT might be a member of another. struct Professor { int age; Triangle favTriangle; }; void Professor_init(Professor *prof, int age, int side) { prof->age = age; Triangle_init(&prof->favTriangle, side, side, side); } void Professor_init(Professor *prof, int age, const Triangle &favTriangle) { prof->favTriangle = favTriangle; prof->age = age; } \u6211\u4eec\u9700\u8981 Abstraction Layer \u6765\u5236\u4f5c ADT. 10.2 Dynamic Allocation 10.2.1 Heap (\u5806) \u6211\u4eec\u73b0\u5728\u7684\u51fd\u6570\u90fd\u662f\u5728Stack frame\u91cc\u9762\uff0c\u8fd9\u662f\u9759\u6001\u7684\u6570\u636e\u5b58\u50a8\u65b9\u5f0f. \u4f46\u662f\u7ed9\u8fd9\u4e9b Stack \u5206\u914d\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u6570\u91cf\u662f\u5f88\u5c11\u7684. Matrix \u5f88\u5927\uff0c\u4f1a crash \u6389\u7a0b\u5e8f. \u5728\u5904\u7406\u8fd9\u79cd\u5927\u89c4\u6a21\u7684\u6570\u636e\u65f6\uff0c\u6211\u4eec\u5e94\u8be5\u52a8\u7528 Dynamic Allocation(\u52a8\u6001\u5185\u5b58\u5206\u914d) . \u9759\u6001\u7684 memory \u50a8\u5b58\u7ed3\u6784\u662f Stack(\u6808) \uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5df2\u7ecf\u8ba4\u8bc6\u7684\uff1a Stack\u5185\u5b58 \uff1a \u6808\u5185\u5b58\u662f\u81ea\u52a8\u7ba1\u7406\u7684\uff0c\u4e3b\u8981\u7528\u4e8e\u5b58\u50a8 local variables \u548c\u7ba1\u7406 function \u8c03\u7528\uff08\u5305\u62ec\u53c2\u6570\u4f20\u9012\u3001\u8fd4\u56de\u5730\u5740\u548c\u5c40\u90e8\u53d8\u91cf\u7b49\uff09 Stack \u6709\u56fa\u5b9a\u7684\u5927\u5c0f\uff0c\u5f53\u7a0b\u5e8f\u542f\u52a8\u65f6\u7531\u64cd\u4f5c\u7cfb\u7edf\u5206\u914d. Stack \u7684\u751f\u547d\u5468\u671f\u662f\u81ea\u52a8\u7684\uff0c\u5f53\u51fd\u6570\u8c03\u7528\u7ed3\u675f\u65f6\uff0c\u8be5\u51fd\u6570\u7684 Stack Frame \u5c31\u4f1a\u88ab\u9500\u6bc1. \u800c dynamic \u7684 memory \u7684\u50a8\u5b58\u7ed3\u6784\u662f Heap(\u5806) . \u5806\u5185\u5b58 \uff1a Heap memory \u662f dynamically allocated \u7684\uff0c\u9700\u8981\u7a0b\u5e8f\u5458\u663e\u5f0f\u5206\u914d\u548c\u91ca\u653e. \u5806\u7684\u5927\u5c0f\u901a\u5e38\u9650\u5236\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u5141\u8bb8\u7684\u8fdb\u7a0b\u7684\u6700\u5927\u5185\u5b58\u5927\u5c0f\uff0c\u5b83 \u8fdc\u5927\u4e8e Stack \u7684\u5927\u5c0f. \u5806\u7684\u751f\u547d\u5468\u671f\u662f \u624b\u52a8\u7ba1\u7406 \u7684\uff0c\u4f7f\u7528 new \uff08\u5728 C++ \u4e2d\uff09\u5206\u914d\u7684\u5185\u5b58\u4f1a\u4e00\u76f4\u5b58\u5728\u76f4\u5230\u5b83\u88ab delete \u663e\u5f0f\u91ca\u653e. 10.3.2 new \u548c delete : \u5206\u914d\u548c\u91ca\u653e dynamic memory \u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u7684 local varibales \u9759\u6001\u50a8\u5b58\u5728 stack frame \u91cc\u9762\uff0c\u8fd9\u6837\u5f88\u663e\u7136\u592a\u5927\u4e86\u4f1a\u7206\u6389. void func() { Matrix m; Matrix_init(&m, 300, 200); // Use the Matrix Matrix_fill(&m, 42); } // mat goes out of scope \u5e94\u8be5\u628a Matrix \u4fdd\u6301\u5728 dynamic memory \u4e2d\uff1a \u6211\u4eec\u9700\u8981\u7528 new \u5728 heap \u4e2d\u65b0\u5efa\u4e00\u4e2a Matrix\uff0c\u6ce8\u610f\uff0c new \u8fd4\u56de\u7684\u662f\u5b83\u7684\u5730\u5740\uff01\u56e0\u800c\u6211\u4eec\u9700\u8981\u7528\u4e00\u4e2a\u5bf9\u5e94\u7684\u6307\u9488\u53d8\u91cf\u6765\u50a8\u5b58. \u5728\u6700\u540e\uff0c\u6211\u4eec\u8981\u7528 delete \u6765\u6211\u4eec\u4f7f\u7528\u5b8c\u7684 Matrix \u53d8\u91cf\u4ece\u52a8\u6001\u5185\u5b58\u4e2d\u5220\u9664\u6389\uff0c\u8fd9\u6837\u5c31\u628a\u8fd9\u5757\u5185\u5b58\u7a7a\u51fa\u6765\u4e86. // Fills a 3x5 Matrix with a value and checks that // Matrix_at returns that value for each element. TEST(test_fill_basic) { Matrix *mat = new Matrix; // \u5728Dynamic memory \u4e2d\u521b\u9020 Matrix object, the result is a ptr to eh new object. const int width = 3; const int height = 5; const int value = 42; Matrix_init(mat, width, height); Matrix_fill(mat, value); for (int row = 0; row < height; ++row) { for (int col = 0; col < width; ++col) { ASSERT_EQUAL(*Matrix_at(mat, row, col), value); } } delete mat; //delete the Matrix object when we no longer need it }","title":"Overview"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#101-struct","text":"struct \u5c31\u662f\u6211\u4eec\u8bf4\u7684 C-Style \u7684 ADT. An abstract data type (ADT) separates the interface of a data type from its implementation, and it encompasses both the data itself as well as functionality on the data.","title":"10.1 Struct"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1011-definition-creating-instance-and-initialize","text":"struct Person { int age; string name; bool isNinja; }; // \u6ce8\u610f; int main() { int x; Person alex; alex = { 75, \"granny\", false }; Person jon = { 25, \"jon\", true }; } We can define a new compound object type via a struct definition (e.g. Person ). We define objects as instances of that type. The struct definition contains member variable declarations , member variables define \u8fd9\u4e2a compound object \u7684 subobjects. \u53ef\u4ee5\u5148\u521b\u9020 object, \u4f46\u662f\u4e0d initialize variables.(\u5982\u56fe)","title":"10.1.1 Definition, Creating Instance and initialize"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1012-member-access","text":"Individual members are accessed via the . operator (also called the \" member access operator \"). struct Person { int age; string name; bool isNinja; }; int main() { Person p = { 17, \"Ron\", true }; p.isNinja = true; }","title":"10.1.2 Member Access: ."},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1013-const-instance","text":"If you've got a struct object that is const-qualified , that forbids assignment to the struct as a whole and also forbids assignment to its individual members. \u6240\u6709member\u90fd\u4e0d\u80fd\u66f4\u6539\u503c\uff0c\u6574\u4e2a instance \u4e5f\u4e0d\u884c. struct Person { int age; string name; bool isNinja; }; int main() { const Person p1 = { 17, \"Kim\", true }; Person p2 = { 17, \"Ron\", true }; p1.isNinja = false; // error p1 = p2; // error } \u5e76\u4e14\u5373\u4fbf\u6ca1\u6709 initialize \u4e5f\u4e0d\u80fd\u6539. int main() { const Person p1; p1.isNinja = false; // error }","title":"10.1.3 \u6dfb\u52a0 const \u7684 instance"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1014-struct-instance-ptr","text":"Access structs via pointers : obj.member ptr->member struct Person { int age; string name; bool isNinja; }; int main() { Person p = { 31, \"Aliyah\", true }; Person * ptr = &p; p.age = 32; // \u8fd9\u4e09\u4e2a\u4e00\u6837 (*ptr).age = 32; // \u8fd9\u4e09\u4e2a\u4e00\u6837 ptr->age = 32; // \u8fd9\u4e09\u4e2a\u4e00\u6837 } \u540c\u6837\uff0c\u6307\u5411 const \u7684 struct instance \u7684 ptr \u4e5f\u5fc5\u987b\u662f ptr-to-const. #include <iostream> #include <string> using namespace std; struct Sandwich { string name; bool is_veg; double price; }; int main() { const Sandwich a = {\"a\", true, 1.11}; Sandwich const *ptr = &a; cout << ptr->name; }","title":"10.1.4 \u6307\u5411 struct instance \u7684 ptr"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1015-pass-by-pointer-init","text":"\u4e00\u4e2a ADT \u7684\u5360\u5185\u5b58\u5927\u5c0f\u662f\u5f88\u5927\u7684\u3002\u6211\u4eec\u6709\u65f6\u5019\u4e0d\u5f97\u4e0d\u7528\u4e00\u4e2a function \u6765 init \u5b83\uff0c\u4f46\u662f\u6211\u4eec\u80af\u5b9a\u4e0d\u60f3\u5728 function \u7684 stackframe \u91cc copy \u5b83\uff0c\u7136\u540e\u518d\u590d\u5236\u56de\u53bb\uff0c\u56e0\u4e3a\u5b83\u592a\u5927\u4e86\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u628a\u4e00\u4e2a\u5f88\u5927\u7684 ADT \u53d8\u6210\u4e86\u4e24\u4e2a\uff0c\u975e\u5e38\u5360\u5185\u5b58\u3002 \u4e4b\u524d\u8bf4\u4e86\uff0c pointer \u7c7b object \u7684\u5927\u5c0f\u662f\u6052\u5b9a\u7684\uff0c\u5e76\u4e14\u5c31\u7b49\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f4d\u6570\uff0c\u6240\u4ee5\u5176\u5b9e\u975e\u5e38\u5c0f\u3002 \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a pass-by-pointer \u7684 init \u51fd\u6570\u6765 initialize \u4e00\u4e2a ADT struct. \u6bd4\u5982\u4e00\u4e2a Triangle\uff1a struct Triangle { double a, b, c; }; void Triangle_init(Triangle *tri, double a_in, double b_in, double c_in) { tri->a = a_in; tri->b = b_in; tri->c = c_in; } int main() { Triangle t1; Triangle_init(&t1, 3, 4, 11); }","title":"10.1.5 \u4f7f\u7528pass-by-pointer \u7684 init \u51fd\u6570"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1016-","text":"\u8fd9\u91cc\u7684 -> \u8fd0\u7b97\u7b26\u662f\u9488\u5bf9 class \u7c7b object \u7684\u6307\u9488\u7684\u8fd0\u7b97\u7b26\u3002\u5b83\u83b7\u53d6\u7684\u5bf9\u8c61\u662f p \u6307\u5411\u7684 object \u7684\u67d0\u4e2a\u5c5e\u6027. \u6bd4\u5982 tri -> a \u5c31\u662f tri \u8fd9\u4e2a Triangle * \u6240\u6307\u5411\u7684 Triangle object \u7684 a \u8fd9\u4e2a\u5c5e\u6027. \u5f53\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u4e5f\u4f7f\u7528 (*tri).a . \u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\u5c31\u662f *tri.a \u662f\u4e0d\u4f1a compile \u7684\uff0c\u53ea\u6709\u52a0\u4e0a\u62ec\u53f7 (*tri).a \u624d compile. \u8fd9\u662f\u56e0\u4e3a\u4f18\u5148\u7ea7\u7684\u95ee\u9898\u3002 \u6240\u4ee5\u5f88\u4e0d\u65b9\u4fbf\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u4f7f\u7528 -> \u597d\uff08\u800c\u4e14\u76f4\u89c2\uff09\u3002","title":"10.1.6 -&gt; \u8fd0\u7b97\u7b26"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1017-assert-respect-interface","text":"\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a Triangle \u7684\u8fb9\u957f\u6784\u4e0d\u6210\u4e00\u4e2a Triangle. \u5e94\u8be5\u7528 assert \u6765\u9632\u6b62\u8fd9\u4e9b\u60c5\u51b5\u3002 \u8fd9\u5c31\u662f ADT \u8981 respect interface \u7684\u7279\u70b9 void Triangle_init(Triangle *tri, double a_in, double b_in, double c_in) { assert(0 < a_in && 0 < b_in && 0 < c_in); assert(a_in + b_in > c_in && a_in + c_in > b_in && b_in + c_in > a_in); tri->a = a_in; tri->b = b_in; tri->c = c_in; } \u5199\u4e00\u4e9b\u51fd\u6570\u8868\u793a\u8fd9\u4e2a ADT \u7684\u64cd\u4f5c\uff1a struct Triangle { double side1; double side2; double angle; }; // REQUIRES: tri points to a Triangle object // MODIFIES: *tri // EFFECTS: Initializes the triangle with the given side lengths. void Triangle_init(Triangle *tri, double a_in, double b_in, double c_in) { tri->side1 = a_in; tri->side2 = b_in; tri->angle = std::acos((std::pow(a_in, 2) + std::pow(b_in, 2) - std::pow(c_in, 2)) / (2 * a_in * b_in)); } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the first side of the given Triangle. double Triangle_side1(const Triangle *tri) { return tri->side1; } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the second side of the given Triangle. double Triangle_side2(const Triangle *tri) { return tri->side2; } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the third side of the given Triangle. double Triangle_side3(const Triangle *tri) { return std::sqrt(std::pow(tri->side1, 2) + std::pow(tri->side2, 2) - 2 * tri->side1 * tri->side2 * std::acos(tri->angle)); } // REQUIRES: tri points to a valid Triangle // EFFECTS: Returns the perimeter of the given Triangle. double Triangle_perimeter(const Triangle *tri) { return Triangle_side1(tri) + Triangle_side2(tri) + Triangle_side3(tri); } // REQUIRES: tri points to a valid Triangle; s > 0 // MODIFIES: *tri // EFFECTS: Scales the sides of the Triangle by the factor s. void Triangle_scale(Triangle *tri, double s) { tri->side1 *= s; tri->side2 *= s; }","title":"10.1.7 \u4f7f\u7528 assert() \u6765\u68c0\u67e5\u662f\u5426 respect interface"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1018-struct-parameter-passing-rules","text":"\u5f53\u7136\uff0c\u4e0d\u6b62 init \u51fd\u6570\uff0c\u57fa\u672c\u6240\u6709\u9700\u8981\u4f20\u9012 ADT \u53c2\u6570\u7684\u51fd\u6570\uff0c\u6211\u4eec\u90fd\u6700\u597d\u4e0d\u8981 pass by value\u3002\u56e0\u4e3a\u771f\u7684\u5f88\u5927\u3002 \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5 \u4f7f\u7528 pass-by-reference \u6216\u8005 pass-by-pointer. \u5982\u679c\u6211\u4eec\u4e0d\u60f3\u7528\u8fd9\u4e2a ptr \u6765 modify the outside object\uff0c\u6211\u4eec\u9700\u8981\u52a0\u4e0a const \u5173\u952e\u8bcd\uff0c\u4f7f\u7528 pointer-to-const \u6216\u8005 reference-to-const \u6765\u64cd\u4f5c\u3002","title":"10.1.8 \u53c2\u6570\u4e3a struct \u7684\u51fd\u6570: parameter passing rules"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1019-composing-adts-abstraction-layers","text":"One ADT might be a member of another. struct Professor { int age; Triangle favTriangle; }; void Professor_init(Professor *prof, int age, int side) { prof->age = age; Triangle_init(&prof->favTriangle, side, side, side); } void Professor_init(Professor *prof, int age, const Triangle &favTriangle) { prof->favTriangle = favTriangle; prof->age = age; } \u6211\u4eec\u9700\u8981 Abstraction Layer \u6765\u5236\u4f5c ADT.","title":"10.1.9 Composing ADTs: Abstraction Layers"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#102-dynamic-allocation","text":"","title":"10.2 Dynamic Allocation"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1021-heap","text":"\u6211\u4eec\u73b0\u5728\u7684\u51fd\u6570\u90fd\u662f\u5728Stack frame\u91cc\u9762\uff0c\u8fd9\u662f\u9759\u6001\u7684\u6570\u636e\u5b58\u50a8\u65b9\u5f0f. \u4f46\u662f\u7ed9\u8fd9\u4e9b Stack \u5206\u914d\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u6570\u91cf\u662f\u5f88\u5c11\u7684. Matrix \u5f88\u5927\uff0c\u4f1a crash \u6389\u7a0b\u5e8f. \u5728\u5904\u7406\u8fd9\u79cd\u5927\u89c4\u6a21\u7684\u6570\u636e\u65f6\uff0c\u6211\u4eec\u5e94\u8be5\u52a8\u7528 Dynamic Allocation(\u52a8\u6001\u5185\u5b58\u5206\u914d) . \u9759\u6001\u7684 memory \u50a8\u5b58\u7ed3\u6784\u662f Stack(\u6808) \uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5df2\u7ecf\u8ba4\u8bc6\u7684\uff1a Stack\u5185\u5b58 \uff1a \u6808\u5185\u5b58\u662f\u81ea\u52a8\u7ba1\u7406\u7684\uff0c\u4e3b\u8981\u7528\u4e8e\u5b58\u50a8 local variables \u548c\u7ba1\u7406 function \u8c03\u7528\uff08\u5305\u62ec\u53c2\u6570\u4f20\u9012\u3001\u8fd4\u56de\u5730\u5740\u548c\u5c40\u90e8\u53d8\u91cf\u7b49\uff09 Stack \u6709\u56fa\u5b9a\u7684\u5927\u5c0f\uff0c\u5f53\u7a0b\u5e8f\u542f\u52a8\u65f6\u7531\u64cd\u4f5c\u7cfb\u7edf\u5206\u914d. Stack \u7684\u751f\u547d\u5468\u671f\u662f\u81ea\u52a8\u7684\uff0c\u5f53\u51fd\u6570\u8c03\u7528\u7ed3\u675f\u65f6\uff0c\u8be5\u51fd\u6570\u7684 Stack Frame \u5c31\u4f1a\u88ab\u9500\u6bc1. \u800c dynamic \u7684 memory \u7684\u50a8\u5b58\u7ed3\u6784\u662f Heap(\u5806) . \u5806\u5185\u5b58 \uff1a Heap memory \u662f dynamically allocated \u7684\uff0c\u9700\u8981\u7a0b\u5e8f\u5458\u663e\u5f0f\u5206\u914d\u548c\u91ca\u653e. \u5806\u7684\u5927\u5c0f\u901a\u5e38\u9650\u5236\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u5141\u8bb8\u7684\u8fdb\u7a0b\u7684\u6700\u5927\u5185\u5b58\u5927\u5c0f\uff0c\u5b83 \u8fdc\u5927\u4e8e Stack \u7684\u5927\u5c0f. \u5806\u7684\u751f\u547d\u5468\u671f\u662f \u624b\u52a8\u7ba1\u7406 \u7684\uff0c\u4f7f\u7528 new \uff08\u5728 C++ \u4e2d\uff09\u5206\u914d\u7684\u5185\u5b58\u4f1a\u4e00\u76f4\u5b58\u5728\u76f4\u5230\u5b83\u88ab delete \u663e\u5f0f\u91ca\u653e.","title":"10.2.1 Heap (\u5806)"},{"location":"10-Compound-objects%2C-ADT-and-Dynamic-Allocation.html#1032-new-delete-dynamic-memory","text":"\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u7684 local varibales \u9759\u6001\u50a8\u5b58\u5728 stack frame \u91cc\u9762\uff0c\u8fd9\u6837\u5f88\u663e\u7136\u592a\u5927\u4e86\u4f1a\u7206\u6389. void func() { Matrix m; Matrix_init(&m, 300, 200); // Use the Matrix Matrix_fill(&m, 42); } // mat goes out of scope \u5e94\u8be5\u628a Matrix \u4fdd\u6301\u5728 dynamic memory \u4e2d\uff1a \u6211\u4eec\u9700\u8981\u7528 new \u5728 heap \u4e2d\u65b0\u5efa\u4e00\u4e2a Matrix\uff0c\u6ce8\u610f\uff0c new \u8fd4\u56de\u7684\u662f\u5b83\u7684\u5730\u5740\uff01\u56e0\u800c\u6211\u4eec\u9700\u8981\u7528\u4e00\u4e2a\u5bf9\u5e94\u7684\u6307\u9488\u53d8\u91cf\u6765\u50a8\u5b58. \u5728\u6700\u540e\uff0c\u6211\u4eec\u8981\u7528 delete \u6765\u6211\u4eec\u4f7f\u7528\u5b8c\u7684 Matrix \u53d8\u91cf\u4ece\u52a8\u6001\u5185\u5b58\u4e2d\u5220\u9664\u6389\uff0c\u8fd9\u6837\u5c31\u628a\u8fd9\u5757\u5185\u5b58\u7a7a\u51fa\u6765\u4e86. // Fills a 3x5 Matrix with a value and checks that // Matrix_at returns that value for each element. TEST(test_fill_basic) { Matrix *mat = new Matrix; // \u5728Dynamic memory \u4e2d\u521b\u9020 Matrix object, the result is a ptr to eh new object. const int width = 3; const int height = 5; const int value = 42; Matrix_init(mat, width, height); Matrix_fill(mat, value); for (int row = 0; row < height; ++row) { for (int col = 0; col < width; ++col) { ASSERT_EQUAL(*Matrix_at(mat, row, col), value); } } delete mat; //delete the Matrix object when we no longer need it }","title":"10.3.2 new \u548c delete: \u5206\u914d\u548c\u91ca\u653e dynamic memory"},{"location":"11-C-strings.html","text":"11 C-style strings 11.1 C-style strings: \u5c31\u662f\u672b\u5c3e\u81ea\u52a8\u52a0\u4e0a null \\0 \u7684 char array 11.1.1 \u5982\u4f55 Define \u4e00\u4e2a C-style string 11.1.2 \u7528 pointer \u6765 initial C-style string: \u5fc5\u987b const 11.1.3 char value \u7684\u672c\u8d28 11.2 cout \u7531 char array \u540d\u5b57 decay \u5f62\u6210\u7684 char* \u4f1a cout \u6574\u4e2a char array \u800c\u4e0d\u662f\u9996\u5143\u7d20\u5730\u5740 11.2.1 warning: \u4e0d\u8981\u6253\u5370\u5e76\u975e\u6307\u5411\u4e00\u4e2a C string \u7684 char* \u578b\u53d8\u91cf 11.3 \u9898\u5916\u8bdd: Prefix(++x) vs. Postfix(x++) Increment 11.4 C-style strings \u7684 standard functions 11.4.1 Implementation of strcpy 11.4.2 C++ string \u548c C string \u7684\u76f8\u4e92\u8f6c\u6362 11.4.3 strcmp(A, B) 11.5 Command Line Arguments 11.5.1 int main(int argc, char *argv[]) \u7684\u7ed3\u6784 11.5.1 \u5982\u4f55\u628a command line arguments \u91cc\u9762\u7684\u6570\u5b57 c-string \u8f6c\u4e3a double 12.6.2 Caution when comparing elements of argv 12.6.3 \u7efc\u5408\u4f7f\u7528\u4f8b 11 C-style strings \u5f53\u4e00\u4e2a ptr \u51fa\u4e86 arrary \u7684\u8fb9\u754c\u65f6\uff0c\u6211\u4eec\u5982\u679c dereference \u5c31\u505a\u4e86\u4e00\u4e2a undefined behavior\uff0cread/write random memory. \u56e0\u800c\u6211\u4eec\u9700\u8981 keep pointers in their arrays. \u5982\u4f55\u505a\u5230\uff1a keep track of the length separately put a sentinel value at the end of the array 11.1 C-style strings: \u5c31\u662f\u672b\u5c3e\u81ea\u52a8\u52a0\u4e0a null \\0 \u7684 char array \u5728 C \u4e2d\uff0cstring \u5355\u7eaf\u5c31\u662f\u4e00\u4e2a char array. \u552f\u4e00\u5728\u7ed3\u6784\u4e0a\u7684\u7279\u70b9\u662f\uff0c\u5b83\u7684\u672b\u5c3e\u88ab\u81ea\u52a8\u52a0\u4e0a\u4e86\u4e00\u4e2a null character \\0 . \u8fd9\u4e2a \\0 character \u5e76\u4e0d\u662f\u6570\u5b57 0 \u7684 char\uff01\uff01\u5b83\u5b9e\u9645\u4e0a\u662f null\uff0c\u5b83\u7684 ASCII value \u4e3a 0. null character \u50cf\u4e00\u4e2a sentinel\uff0c\u8868\u793a string \u5728\u67d0\u4e2a\u5730\u65b9\u505c\u6b62. 11.1.1 \u5982\u4f55 Define \u4e00\u4e2a C-style string \u5982\u679c\u6211\u4eec\u4f7f\u7528 C-style string\uff0c\u4ee5\u4e0b\u8fd9\u4e24\u4e2a definition \u662f\u7b49\u4ef7\u7684\uff1a char str1[6] = {'h', 'e', 'l', 'l', 'o', '\\0'}; char str2[6] = \"hello\"; \u6ce8\u610f\uff0c\u5982\u679c\u6211\u4eec\u4ece \"\" \u5f62\u5f0f initialize\uff0c\u90a3\u5c31\u662f\u6b63\u5e38\u7684\uff0c\u4f46\u662f \u5982\u679c\u6211\u4eec\u4ece array \u5f62\u5f0f initialize\uff0c\u6211\u4eec\u5fc5\u987b\u5728\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u540e\u624b\u52a8\u52a0\u4e0a '\\0' \uff01 \u5426\u5219\u6211\u4eec stream out \u5c31\u4f1a\u4e71\u4e03\u516b\u7cdf\u3002 char arr[3] = {'a', 'b', 'c'}; cout << arr << endl; // abc\u00c72?\u2554\u2560 \u56e0\u4e3a\u76f4\u5230\u627e\u5230 '\\0' \u5b83\u624d\u4f1a\u505c\u6b62\u627e\u4e0b\u53bb\u3002 \u8fd8\u6709\u4e00\u4e9b\u516b\u80a1\u6587\uff1a\u5982\u679c\u5f53\u6211\u4eec\u5728\u540c\u4e00\u4e2a stack \u4e2d\u8fde\u7eed\u5b9a\u4e49\u4e24\u4e2a c string\uff0c\u5e76\u4e14\u5728\u4e0a\u5c42\u7684\u4e0d\u52a0 sentinal\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u4f1a stream out \u4e00\u4e2a\u8fde\u7eed\u7684\u5408\u5e76 string\u3002\u3002\u3002 char str[3] = {'h', 'i', '\\0'}; char arr[3] = {'a', 'b', 'c'}; cout << arr << endl; // abchi 11.1.2 \u7528 pointer \u6765 initial C-style string: \u5fc5\u987b const array \u610f\u5473\u7740\uff1aC-style string \u662f immutable \u7684\uff01\u5b83\u7684\u957f\u5ea6\u4e0d\u80fd\u6539\u53d8. \u800c\u6211\u4eec\u719f\u6089\u7684 C++-style string \u5219\u662f\u53ef\u4ee5\u6539\u53d8\u5927\u5c0f\u7684. \u6211\u4eec\u73b0\u5728\u8981\u4ecb\u7ecd\u4e00\u4e2a\u52fe\u65f6\u7684\u521b\u9020\u4e00\u4e2a C string \u7684\u65b9\u5f0f\uff1a const char *ptr = \"yay\"; \u5176\u5b9e\u5c31\u662f char[] ptr = \"yay\"; \u4f46\u662f \u8fd9\u5e76\u4e0d\u662f\u5728 stack frame \u91cc\u9762\u7684\u3002 \u6211\u4eec\u662f\u5728 read only segement \u521b\u5efa\u4e86\u4e00\u4e2a\u6ca1\u6709\u540d\u5b57\u7684 C-string \u5185\u5bb9\u4e3a\"yay\"\u3002\u4f46\u662f\u6211\u4eec\u540c\u65f6\u5b9a\u4e49\u4e86\u4e00\u4e2a pointer to const \u53eb\u505a ptr \uff0c\u5b58\u50a8\u5b83\u7684\u9996\u5143\u7d20\u5730\u5740\uff0c\u90a3\u4e48 ptr \u5c31\u548c\u6570\u7ec4\u540d\u6709\u57fa\u672c\u76f8\u540c\u7684\u4f5c\u7528\uff0c\u76f8\u5f53\u4e8e\u6a21\u62df\u4e86 array \u540d\u3002\u6211\u4eec\u53ef\u4ee5\u7528 ptr[n] \u6765 slice. \u4f46\u662f\u901a\u8fc7\u8fd9\u4e2a\u884c\u4e3a\u6211\u4eec\u8981\u5f3a\u8c03\u53e6\u5916\u4e00\u4e2a\u4e8b\u60c5\uff1a \u5982\u679c\u6211\u4eec\u5199 char *ptr = \"yay\" \u8fd9\u5c31\u4e0d\u5bf9\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u77e5\u9053 \"yay\" \u4f5c\u4e3a\u4e00\u4e2a array \uff0c\u9996\u5143\u7d20\u5730\u5740\u662f const \u7684\uff0c\u800c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u975e pointer to const \u7684 pointer \u6307\u5411\u5b83\u3002 11.1.3 char value \u7684\u672c\u8d28 11.2 cout \u7531 char array \u540d\u5b57 decay \u5f62\u6210\u7684 char* \u4f1a cout \u6574\u4e2a char array \u800c\u4e0d\u662f\u9996\u5143\u7d20\u5730\u5740 \u6211\u4eec\u77e5\u9053\uff0c\u5f53\u6211\u4eec\u8bd5\u56fe\u83b7\u53d6 array\u7684\u540d\u5b57\u7684\u503c\u65f6\uff0c\u5b83\u5c31\u4f1a decay \u6210\u4e00\u4e2a\u5bf9\u5e94\u7c7b\u578b\u7684 pointer.(\u8fd4\u56de\u9996\u5143\u7d20\u5730\u5740) char str1[6] = \"hello\"; char *strPtr = str1; StrPtr \u4e8e\u662f\u5c31\u6307\u5411\u4e86 str1 \u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u4e5f\u5c31\u662f 'h' . ex: char str1[6] = \"hello\"; char *strPtr = str1; char str2[6] = \"hello\"; char str3[6] = \"apple\"; cout << (str1 == str2) // compile \u4f46\u7ed3\u679c\u4e3afalse, \u56e0\u4e3a\u5b83\u4eec\u90fd\u53d8\u6210\u4e86ptr, \u8fd9\u4e24\u4e2a\u503c\u90fd\u662f\u5730\u5740, \u4e0d\u7b49 str1 = str3; // \u4e0d compile, \u56e0\u4e3a\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6 str3 \u7684\u503c\u4f7f\u5176 decay \u4e3a\u4e00\u4e2a ptr, \u800c\u5de6\u4fa7\u662f\u4e00\u4e2a array. Type mismatch. strPtr = str3; // \u4f7f\u5f97 strPtr \u91cd\u65b0\u6307\u5411 str3 \u6240\u4ee5\u8bf4\u6211\u4eec\u77e5\u9053\uff1a int arr[3] = {1, 2, 3}; cout << arr << \"\\n\"; // \u7ed3\u679c\u662f\u9996\u5143\u7d20\u5730\u5740 \u4f46\u662f\uff0cchar array \u5374\u662f\u53ef\u4ee5\u8fd9\u6837\u6253\u5370\u7684. \u8fd9\u5e76\u4e0d\u662f\u4ec0\u4e48\u7279\u4f8b\uff0c\u800c\u662f\u56e0\u4e3a << , >> \u5bf9\u4e8e char array \u7c7b\u578b\u5728 library \u4e2d\u91cd\u5199\u8fc7\uff0c\u4f7f\u5176\u652f\u6301\u8fd9\u79cd\u884c\u4e3a. char array\uff0c\u4e5f\u5c31\u662f C string\uff0c\u6709\u5f88\u591a build-in functions. char str[6] = \"hello\"; cout << str << endl; // \u7ed3\u679c\u662f hello \u8fd9\u91cc str \u4ecd\u7136 decay \u6210 char* \u6307\u9488\u4e86\uff0c\u5e76\u6ca1\u6709\u4ec0\u4e48\u7a81\u53d8\uff0c\u4f46\u662f\u56e0\u4e3a std library \u5bf9\u4e8e << \u7684 overload \uff0c cout \u628a\u6240\u6709 char* \u7c7b\u578b\u90fd treat as C-style strings\uff01\uff01 \u4e25\u8c28\u7684\u610f\u601d\u5c31\u662f\u8bf4\uff1aostream \u578b (\u6bd4\u5982 cout ) \u53ea\u8981\u9047\u5230 << char * \u5c31\u4f1a\u6301\u7eed write \u4ece\u8be5 char * \u6307\u5411\u7684\u5730\u5740\u5f80\u540e\uff0c\u76f4\u5230\u78b0\u5230\u7b2c\u4e00\u4e2a null character \u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f. \u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u6253\u5370\u6574\u4e2a C-style string. 11.2.1 warning: \u4e0d\u8981\u6253\u5370\u5e76\u975e\u6307\u5411\u4e00\u4e2a C string \u7684 char* \u578b\u53d8\u91cf \u7136\u800c\u6709\u4e00\u4e2a\u975e\u5e38\u975e\u5e38\u9006\u5929\u7684\u4e1c\u897f\uff0c\u5c31\u662f\u8fd9\u4e2a overload \u4e0d\u662f\u4ec5\u5bf9\u7531 char[] \u578b decay \u800c\u6210\u7684 char * \u578b\u53d8\u91cf\u751f\u6548\uff0c\u800c\u662f\u5bf9\u4efb\u4f55 char * \u578b\u53d8\u91cf\u751f\u6548. \u4e5f\u5c31\u662f\u8bf4\uff0c \u5982\u679c\u8fd9\u5355\u7eaf\u662f\u4e00\u4e2a char * \u578b\u53d8\u91cf\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a char arrary \u7684\u540d\u5b57\uff0c\u662f\u4e0d\u80fd\u76f4\u63a5\u7528 ostream write \u7684\uff0c\u5426\u5219\u5b83\u5c31\u4f1a\u4e00\u76f4 write \u8be5\u5730\u5740\u540e\u9762\u7684\u6240\u6709\u4e1c\u897f\uff0c\u76f4\u5230\u78b0\u5230 null character \\0 \u4e3a\u6b62. \u90a3\u8fd9\u4ef6\u4e8b\u60c5\u5c31\u5f88\u5371\u9669\u4e86\uff0c\u5b83\u4f1a\u4e00\u76f4 write \u4e0b\u53bb. **\u6240\u4ee5 warning: Don\u2019t try to print a char* not pointing into a C-style string. ** 11.3 \u9898\u5916\u8bdd: Prefix( ++x ) vs. Postfix( x++ ) Increment x += 1 \u548c ++x \u662f\u7b49\u4ef7\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd increment \u4e86 x \uff0c\u5e76\u4e14 expression \u7684\u503c\u90fd\u662f\u4e00\u6837\u7684. \u800c x += 1 \u548c x++ \u5374\u4e0d\u662f\u7b49\u4ef7\u7684\uff0c\u5b83\u4eec\u90fd increment \u4e86 x \uff0c\u4f46\u662f expression \u7684\u503c\u5374\u4e0d\u4e00\u6837. x = 1; y = 1; cout << x++; // 1 cout << ++y; // 2 \u4f8b\u5b50\uff1a int x = 10; // go down to 0 while (x --> 0) { cout << x << endl; } // 9\u52300, \u5305\u542b0, \u56e0\u4e3ax=1\u65f6 x--\u4ecd\u662f1, \u8fc7\u4e86\u5224\u5b9a, \u800c\u8fd9\u884c\u4e4b\u540e\u5c31\u662f0\u4e86, \u4e8e\u662f\u6253\u5370\u51fa\u4e860 11.4 C-style strings \u7684 standard functions C-style strings C++-style strings Library Header <cstring> <string> Declaration char cstr[]; \u6216 char *cstr; string str; \u83b7\u53d6 Length strlen(cstr) str.length() Copy value strcpy(cstr1, cstr2) str1 = str2 Indexing cstr[i] str[i] Concatenate strcat(cstr1, cstr2) str1 += str2 Compare strcmp(cstr1, cstr2) str1 == str2 11.4.1 Implementation of strcpy strcpy \u7684\u4f5c\u7528\u662f \u628a\u7b2c\u4e8c\u4e2a cstr \u7684\u503c\u4f20\u7ed9\u7b2c\u4e00\u4e2a . char str1[6] = \"hello\"; char str2[6] = \"apple\"; strcpy(str1, str2); // str1 \u7684\u503c\u8981\u53d8\u6210 \"apple\" \u6211\u4eec\u8fd9\u6837\u5199\uff1a void strcpy(char *dst, const char *src) { // \u8fd9\u662f\u4e2a ptr-to-const \u800c\u4e0d\u662f const ptr, \u53ef\u4ee5\u66f4\u6539\u6307\u5411\u7684\u5bf9\u8c61, \u4f46\u662f\u4e0d\u80fd\u7528\u5b83\u89e3\u5f15\u7528\u66f4\u6539\u6307\u5411\u5bf9\u8c61\u7684\u503c; char * const src \u5219\u662f const ptr, \u80fd\u7528\u5b83\u89e3\u5f15\u7528\u66f4\u6539\u6307\u5411\u5bf9\u8c61\u7684\u503c, \u4f46\u662f\u4e0d\u80fd\u66f4\u6539\u6307\u5411\u7684\u5bf9\u8c61, while (*src != '\\0') { *dst = *src; ++src; ++dst; } *dst = *src; // \u6700\u540e copy null char } \u8fd8\u6709\u4e00\u4e2a\u6781\u7aef\u7b80\u77ed\u7684\u7248\u672c\uff1a void strcpy(char *dst, const char *src) { while (*dst++ = *src++) {} } 11.4.2 C++ string \u548c C string \u7684\u76f8\u4e92\u8f6c\u6362 \u628a C++ string \u8f6c\u6210 C string: c++ const char *cstr = str.c_str(); \u628a C string \u8f6c\u6210 C++ string: c++ string str = string(cstr); 11.4.3 strcmp(A, B) strcmp(A,B) returns: if A \u6bd4 B \u5c0f(\u5b57\u6bcdascii), \u8fd4\u56de\u4e00\u4e2a\u8d1f\u503c\u8868\u793a\u5c0f\u591a\u5c11(\u4e00\u4e2aint) If A = B, \u8fd4\u56de 0 if A \u6bd4 B \u5927(\u5b57\u6bcdascii), \u8fd4\u56de\u4e00\u4e2a\u6b63\u503c\u8868\u793a\u5927\u591a\u5c11(\u4e00\u4e2aint) \u8fd4\u56de\u7684\u662f\u7b2c\u4e00\u4e2a\u4e0d\u4e00\u6837\u7684\u5b57\u6bcd\u7684 ascii \u7801\u7684\u5927\u5c0f\u5dee\u8ddd. 11.5 Command Line Arguments 11.5.1 int main(int argc, char *argv[]) \u7684\u7ed3\u6784 main() \u51fd\u6570\u662f\u53ef\u4ee5\u4f20 parameters \u7684. \u6211\u4eec\u53ef\u4ee5\u5728 terminal (\u6216\u8005VSCode \u7684 launch.json \u4ee3\u66ff terminal) \u7ed9 program \u6307\u5b9a arguments . ./redact bee bee.txt out.txt 10 \u6bd4\u5982\u8fd9\u4e2a command line. \u5176\u4e2d\u6709 5 \u4e2a arguments: ./redact , bee , bee.txt , out.txt , 10 . \u6ce8\u610f\u7a0b\u5e8f\u540d\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a command line argument. \u4e3a\u4e86\u63a5\u6536 arguments\uff0c\u6211\u4eec\u7684 main() \u7684\u62ec\u53f7\u91cc\u8981\u5199\u4e1c\u897f: int main(int argc, char *argv[]) { ... } \u8fd9\u91cc\u7684 argc \u662f\u4e00\u4e2a\u8868\u793a arguments \u7684\u6570\u91cf\u7684 int \uff0c\u800c argv \u662f\u4e00\u4e2a array\uff0c\u5176\u5143\u7d20\u7684\u7c7b\u578b\u90fd\u662f char * . \u5177\u4f53\u4f20\u53c2\u6570\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a \u6211\u4eec command line arguments \uff0c\u9664\u4e86\u7a0b\u5e8f\u540d\u81ea\u8eab\u662f\u7528\u6765 start program \u7684\uff0c**\u4e4b\u540e\u7684\u51e0\u4e2a arguments (\u4e00\u4e2a arrary) \u4f1a\u88ab\u505a\u6210\u4e00\u4e2a array\uff0c\u5176\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a c-string\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a char array. ** \u8fd9\u4e2a\u5927 array \u91cc\u9762\u6bcf\u4e2a\u5c0f char array \u7684\u5730\u5740\uff0c\u90fd\u4f1a\u4f20\u7ed9 main() \u7684 parameter argv \u3002 argv \u662f\u4e00\u4e2a\u5143\u7d20\u4e3a char * \u7684 array \u578b\u53c2\u6570\uff0c\u6211\u4eec\u77e5\u9053\u51fd\u6570\u4f20\u8fdb\u53bb array \u53c2\u6570\u5e76\u4e0d\u662f\u771f\u7684 array \u800c\u662f\u4f1a\u5f7b\u5e95\u53d8\u6210\u4e00\u4e2a\u6307\u5411\u9996\u5143\u7d20\u7684 pointer \u3002compiler \u4f1a\u628a\u5b83\u81ea\u52a8\u53d8\u6210 char **argv \u3002 **\u4f46\u662f\u8fd9\u5b8c\u5168\u4e0d\u5f71\u54cd\u5b83\u7684\u4f5c\u7528\u3002 argv[] \u7684\u503c\u5c31\u662f\u7b2c 0 \u4e2a argument \u8fd9\u4e2a c string \u7684\u9996\u4e2a char \u7684\u5730\u5740\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 [] \u7b26\u53f7\u6765\u89e3\u5f15\u7528 *(argv + i) \uff0c\u8868\u793a\u7b2c i \u4e2a argument \u8fd9\u4e2a c string \u7684\u9996\u4e2a char \u7684\u5730\u5740\u3002 ** \u800c\u6211\u4eec\u77e5\u9053\uff0c**\u6240\u6709 stream \u5bf9\u4e8e char * \u578b\u53d8\u91cf\uff0c\u4e5f\u5c31\u662f char \u7684\u5730\u5740\uff0c\u4f1a\u76f4\u63a5 in/write \u5b83\u6240\u8868\u793a\u7684 char \u4ee5\u53ca\u4e4b\u540e\u7684 char \u4e00\u76f4\u5230\u78b0\u5230 \\0 \u4e3a\u6b62\u3002\u6240\u4ee5\u5f53\u6211\u4eec cout << argv[1] \u7684\u65f6\u5019\uff0c argv[1] \u662f\u4e00\u4e2a\u5730\u5740\uff0c\u4f46\u662f\u6211\u4eec cout \u7684\u662f\u4e00\u6574\u4e2a argument. ** \u7ed3\u6784\u5982\u4e0b\uff1a fstream \u4e5f\u4e00\u6837\u3002 int main(int argc, char *argv[]) { if (argc != 5) { cout << \"Usage: ./redact WORD INFILE OUTFILE NUM_STARS\" << endl; return 1; } string wordToRemove = argv[1]; ifstream fin(argv[2]); ofstream fout(argv[3]); } \u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u9898\u76ee\u6765\u68c0\u6d4b\u4e00\u4e0b\u7406\u89e3\uff1a // ./program cat dog lobster int main(int argc, char *argv[]) { cout << argc // 4 cout << argv[1] // cat cout << *argv[1] // *(argument1\u7684\u9996\u4e2achar\u7684address) = argument1\u7684\u9996\u4e2achar = c cout << argv[2] + 1 << \" \"; // argument2\u7684\u9996\u4e2a\u5143\u7d20address + 1 = argument2\u7684\u9996\u4e2a\u5143\u7d20address + 1\u4e2achar\u5927\u5c0f\u7684address = argument2\u7684\u6b21\u5143\u7d20address, \u7ecf\u8fc7stream out\u6253\u5370\u51faargument2\u4ece\u6b21\u5143\u7d20\u5f00\u59cb\u7684\u90e8\u5206cstring = og } // 4 cat c og 11.5.1 \u5982\u4f55\u628a command line arguments \u91cc\u9762\u7684\u6570\u5b57 c-string \u8f6c\u4e3a double \u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\uff0c\u6bcf\u4e2a arguments \u662f\u4e00\u4e2a c-string. \u5b9e\u9645\u4e0a\u6211\u4eec\u6709\u4e9b arguments \u7684\u610f\u601d\u662f int, double. \u4f46\u662f\u5728 command line \u91cc\u53ea\u80fd\u6253\u51fa string. \u90a3\u4e48\u6211\u4eec\u600e\u4e48\u628a\u5b83\u4eec\u8f6c\u5316\u6210 int/double \u5462\uff1f \u5982\u679c\u60f3\u8981\u8f6c\u5316\u6210 C++-style string: <string> \u8fd9\u4e2a library \u91cc\u6709\u4e24\u4e2a\u51fd\u6570: stoi() \u548c stod() . (1) stoi() parses an integer encoded in a string. (2) stod() parses a double encoded in a string. \u5982\u679c\u60f3\u8981\u8f6c\u5316\u6210 C-style string: \u9700\u8981 #include <cstdlib> \u5bf9\u5e94\u7684\u662f atoi() , atof() #include <string> // needed for stoi() or stod() using namespace std; int main(int argc, char *argv[]) { // parse string \"10\" to int 10 int numStars = stoi(argv[4]); // e.g. numStars is 3, makes *** string replacement(numStars, '*'); } \u4f7f\u7528\u4f8b\uff1aAdd up command line arguments. ./sum 1 2 3 4 5 int main(int argc, char *argv[]) { int sum = 0; for (int i = 1; i < argc; ++i) { sum += atoi(argv[i]); } cout << \"sum is \" << sum << endl; } 12.6.2 Caution when comparing elements of argv int main(int argc, char *argv[]) { // BAD, compares addresses if (argv[1] == \"--debug\") { ... } // OK, wrap one in a std::string if (std::string(argv[1]) == \"--debug\") { ... } // OK, \"\"s suffix creates a std::string if (argv[1] == \"--debug\"s) { ... } // BAD, compares addresses if (argv[1] == argv[2]) { ... } // OK, wrap one in a std::string if (std::string(argv[1]) == argv[2]) { ... } } 12.6.3 \u7efc\u5408\u4f7f\u7528\u4f8b int main(int argc, char *argv[]) { if (argc != 3) { cout << \"Usage: redact INFILE OUTFILE\" << endl; return 1; } string inName = argv[1]; string outName = argv[2]; cout << \"Copying from \" << inName << \" to \" << outName << endl; string wordToRemove; cout << \"What word would you like to remove? \"; cin >> wordToRemove; ifstream fin(inName); ofstream fout(outName); if ( !fin.is_open() || !fout.is_open() ) { cout << \"Unable to open one of the files!\" << endl; return 1; } string word; while (fin >> word) { if (word != wordToRemove) { fout << word << \" \"; } } fin.close(); fout.close(); }","title":"Overview"},{"location":"11-C-strings.html#11-c-style-strings","text":"\u5f53\u4e00\u4e2a ptr \u51fa\u4e86 arrary \u7684\u8fb9\u754c\u65f6\uff0c\u6211\u4eec\u5982\u679c dereference \u5c31\u505a\u4e86\u4e00\u4e2a undefined behavior\uff0cread/write random memory. \u56e0\u800c\u6211\u4eec\u9700\u8981 keep pointers in their arrays. \u5982\u4f55\u505a\u5230\uff1a keep track of the length separately put a sentinel value at the end of the array","title":"11 C-style strings"},{"location":"11-C-strings.html#111-c-style-strings-null-0-char-array","text":"\u5728 C \u4e2d\uff0cstring \u5355\u7eaf\u5c31\u662f\u4e00\u4e2a char array. \u552f\u4e00\u5728\u7ed3\u6784\u4e0a\u7684\u7279\u70b9\u662f\uff0c\u5b83\u7684\u672b\u5c3e\u88ab\u81ea\u52a8\u52a0\u4e0a\u4e86\u4e00\u4e2a null character \\0 . \u8fd9\u4e2a \\0 character \u5e76\u4e0d\u662f\u6570\u5b57 0 \u7684 char\uff01\uff01\u5b83\u5b9e\u9645\u4e0a\u662f null\uff0c\u5b83\u7684 ASCII value \u4e3a 0. null character \u50cf\u4e00\u4e2a sentinel\uff0c\u8868\u793a string \u5728\u67d0\u4e2a\u5730\u65b9\u505c\u6b62.","title":"11.1 C-style strings: \u5c31\u662f\u672b\u5c3e\u81ea\u52a8\u52a0\u4e0a null \\0 \u7684 char array"},{"location":"11-C-strings.html#1111-define-c-style-string","text":"\u5982\u679c\u6211\u4eec\u4f7f\u7528 C-style string\uff0c\u4ee5\u4e0b\u8fd9\u4e24\u4e2a definition \u662f\u7b49\u4ef7\u7684\uff1a char str1[6] = {'h', 'e', 'l', 'l', 'o', '\\0'}; char str2[6] = \"hello\"; \u6ce8\u610f\uff0c\u5982\u679c\u6211\u4eec\u4ece \"\" \u5f62\u5f0f initialize\uff0c\u90a3\u5c31\u662f\u6b63\u5e38\u7684\uff0c\u4f46\u662f \u5982\u679c\u6211\u4eec\u4ece array \u5f62\u5f0f initialize\uff0c\u6211\u4eec\u5fc5\u987b\u5728\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u540e\u624b\u52a8\u52a0\u4e0a '\\0' \uff01 \u5426\u5219\u6211\u4eec stream out \u5c31\u4f1a\u4e71\u4e03\u516b\u7cdf\u3002 char arr[3] = {'a', 'b', 'c'}; cout << arr << endl; // abc\u00c72?\u2554\u2560 \u56e0\u4e3a\u76f4\u5230\u627e\u5230 '\\0' \u5b83\u624d\u4f1a\u505c\u6b62\u627e\u4e0b\u53bb\u3002 \u8fd8\u6709\u4e00\u4e9b\u516b\u80a1\u6587\uff1a\u5982\u679c\u5f53\u6211\u4eec\u5728\u540c\u4e00\u4e2a stack \u4e2d\u8fde\u7eed\u5b9a\u4e49\u4e24\u4e2a c string\uff0c\u5e76\u4e14\u5728\u4e0a\u5c42\u7684\u4e0d\u52a0 sentinal\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u4f1a stream out \u4e00\u4e2a\u8fde\u7eed\u7684\u5408\u5e76 string\u3002\u3002\u3002 char str[3] = {'h', 'i', '\\0'}; char arr[3] = {'a', 'b', 'c'}; cout << arr << endl; // abchi","title":"11.1.1 \u5982\u4f55 Define \u4e00\u4e2a C-style string"},{"location":"11-C-strings.html#1112-pointer-initial-c-style-string-const","text":"array \u610f\u5473\u7740\uff1aC-style string \u662f immutable \u7684\uff01\u5b83\u7684\u957f\u5ea6\u4e0d\u80fd\u6539\u53d8. \u800c\u6211\u4eec\u719f\u6089\u7684 C++-style string \u5219\u662f\u53ef\u4ee5\u6539\u53d8\u5927\u5c0f\u7684. \u6211\u4eec\u73b0\u5728\u8981\u4ecb\u7ecd\u4e00\u4e2a\u52fe\u65f6\u7684\u521b\u9020\u4e00\u4e2a C string \u7684\u65b9\u5f0f\uff1a const char *ptr = \"yay\"; \u5176\u5b9e\u5c31\u662f char[] ptr = \"yay\"; \u4f46\u662f \u8fd9\u5e76\u4e0d\u662f\u5728 stack frame \u91cc\u9762\u7684\u3002 \u6211\u4eec\u662f\u5728 read only segement \u521b\u5efa\u4e86\u4e00\u4e2a\u6ca1\u6709\u540d\u5b57\u7684 C-string \u5185\u5bb9\u4e3a\"yay\"\u3002\u4f46\u662f\u6211\u4eec\u540c\u65f6\u5b9a\u4e49\u4e86\u4e00\u4e2a pointer to const \u53eb\u505a ptr \uff0c\u5b58\u50a8\u5b83\u7684\u9996\u5143\u7d20\u5730\u5740\uff0c\u90a3\u4e48 ptr \u5c31\u548c\u6570\u7ec4\u540d\u6709\u57fa\u672c\u76f8\u540c\u7684\u4f5c\u7528\uff0c\u76f8\u5f53\u4e8e\u6a21\u62df\u4e86 array \u540d\u3002\u6211\u4eec\u53ef\u4ee5\u7528 ptr[n] \u6765 slice. \u4f46\u662f\u901a\u8fc7\u8fd9\u4e2a\u884c\u4e3a\u6211\u4eec\u8981\u5f3a\u8c03\u53e6\u5916\u4e00\u4e2a\u4e8b\u60c5\uff1a \u5982\u679c\u6211\u4eec\u5199 char *ptr = \"yay\" \u8fd9\u5c31\u4e0d\u5bf9\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u77e5\u9053 \"yay\" \u4f5c\u4e3a\u4e00\u4e2a array \uff0c\u9996\u5143\u7d20\u5730\u5740\u662f const \u7684\uff0c\u800c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u975e pointer to const \u7684 pointer \u6307\u5411\u5b83\u3002","title":"11.1.2 \u7528 pointer \u6765 initial C-style string: \u5fc5\u987b const"},{"location":"11-C-strings.html#1113-char-value","text":"","title":"11.1.3 char value \u7684\u672c\u8d28"},{"location":"11-C-strings.html#112-cout-char-array-decay-char-cout-char-array","text":"\u6211\u4eec\u77e5\u9053\uff0c\u5f53\u6211\u4eec\u8bd5\u56fe\u83b7\u53d6 array\u7684\u540d\u5b57\u7684\u503c\u65f6\uff0c\u5b83\u5c31\u4f1a decay \u6210\u4e00\u4e2a\u5bf9\u5e94\u7c7b\u578b\u7684 pointer.(\u8fd4\u56de\u9996\u5143\u7d20\u5730\u5740) char str1[6] = \"hello\"; char *strPtr = str1; StrPtr \u4e8e\u662f\u5c31\u6307\u5411\u4e86 str1 \u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u4e5f\u5c31\u662f 'h' . ex: char str1[6] = \"hello\"; char *strPtr = str1; char str2[6] = \"hello\"; char str3[6] = \"apple\"; cout << (str1 == str2) // compile \u4f46\u7ed3\u679c\u4e3afalse, \u56e0\u4e3a\u5b83\u4eec\u90fd\u53d8\u6210\u4e86ptr, \u8fd9\u4e24\u4e2a\u503c\u90fd\u662f\u5730\u5740, \u4e0d\u7b49 str1 = str3; // \u4e0d compile, \u56e0\u4e3a\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6 str3 \u7684\u503c\u4f7f\u5176 decay \u4e3a\u4e00\u4e2a ptr, \u800c\u5de6\u4fa7\u662f\u4e00\u4e2a array. Type mismatch. strPtr = str3; // \u4f7f\u5f97 strPtr \u91cd\u65b0\u6307\u5411 str3 \u6240\u4ee5\u8bf4\u6211\u4eec\u77e5\u9053\uff1a int arr[3] = {1, 2, 3}; cout << arr << \"\\n\"; // \u7ed3\u679c\u662f\u9996\u5143\u7d20\u5730\u5740 \u4f46\u662f\uff0cchar array \u5374\u662f\u53ef\u4ee5\u8fd9\u6837\u6253\u5370\u7684. \u8fd9\u5e76\u4e0d\u662f\u4ec0\u4e48\u7279\u4f8b\uff0c\u800c\u662f\u56e0\u4e3a << , >> \u5bf9\u4e8e char array \u7c7b\u578b\u5728 library \u4e2d\u91cd\u5199\u8fc7\uff0c\u4f7f\u5176\u652f\u6301\u8fd9\u79cd\u884c\u4e3a. char array\uff0c\u4e5f\u5c31\u662f C string\uff0c\u6709\u5f88\u591a build-in functions. char str[6] = \"hello\"; cout << str << endl; // \u7ed3\u679c\u662f hello \u8fd9\u91cc str \u4ecd\u7136 decay \u6210 char* \u6307\u9488\u4e86\uff0c\u5e76\u6ca1\u6709\u4ec0\u4e48\u7a81\u53d8\uff0c\u4f46\u662f\u56e0\u4e3a std library \u5bf9\u4e8e << \u7684 overload \uff0c cout \u628a\u6240\u6709 char* \u7c7b\u578b\u90fd treat as C-style strings\uff01\uff01 \u4e25\u8c28\u7684\u610f\u601d\u5c31\u662f\u8bf4\uff1aostream \u578b (\u6bd4\u5982 cout ) \u53ea\u8981\u9047\u5230 << char * \u5c31\u4f1a\u6301\u7eed write \u4ece\u8be5 char * \u6307\u5411\u7684\u5730\u5740\u5f80\u540e\uff0c\u76f4\u5230\u78b0\u5230\u7b2c\u4e00\u4e2a null character \u4e4b\u524d\u7684\u6240\u6709\u4e1c\u897f. \u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u6253\u5370\u6574\u4e2a C-style string.","title":"11.2 cout \u7531 char array \u540d\u5b57 decay \u5f62\u6210\u7684 char* \u4f1a cout \u6574\u4e2a char array \u800c\u4e0d\u662f\u9996\u5143\u7d20\u5730\u5740"},{"location":"11-C-strings.html#1121-warning-c-string-char","text":"\u7136\u800c\u6709\u4e00\u4e2a\u975e\u5e38\u975e\u5e38\u9006\u5929\u7684\u4e1c\u897f\uff0c\u5c31\u662f\u8fd9\u4e2a overload \u4e0d\u662f\u4ec5\u5bf9\u7531 char[] \u578b decay \u800c\u6210\u7684 char * \u578b\u53d8\u91cf\u751f\u6548\uff0c\u800c\u662f\u5bf9\u4efb\u4f55 char * \u578b\u53d8\u91cf\u751f\u6548. \u4e5f\u5c31\u662f\u8bf4\uff0c \u5982\u679c\u8fd9\u5355\u7eaf\u662f\u4e00\u4e2a char * \u578b\u53d8\u91cf\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a char arrary \u7684\u540d\u5b57\uff0c\u662f\u4e0d\u80fd\u76f4\u63a5\u7528 ostream write \u7684\uff0c\u5426\u5219\u5b83\u5c31\u4f1a\u4e00\u76f4 write \u8be5\u5730\u5740\u540e\u9762\u7684\u6240\u6709\u4e1c\u897f\uff0c\u76f4\u5230\u78b0\u5230 null character \\0 \u4e3a\u6b62. \u90a3\u8fd9\u4ef6\u4e8b\u60c5\u5c31\u5f88\u5371\u9669\u4e86\uff0c\u5b83\u4f1a\u4e00\u76f4 write \u4e0b\u53bb. **\u6240\u4ee5 warning: Don\u2019t try to print a char* not pointing into a C-style string. **","title":"11.2.1 warning: \u4e0d\u8981\u6253\u5370\u5e76\u975e\u6307\u5411\u4e00\u4e2a C string \u7684 char* \u578b\u53d8\u91cf"},{"location":"11-C-strings.html#113-prefixx-vs-postfixx-increment","text":"x += 1 \u548c ++x \u662f\u7b49\u4ef7\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd increment \u4e86 x \uff0c\u5e76\u4e14 expression \u7684\u503c\u90fd\u662f\u4e00\u6837\u7684. \u800c x += 1 \u548c x++ \u5374\u4e0d\u662f\u7b49\u4ef7\u7684\uff0c\u5b83\u4eec\u90fd increment \u4e86 x \uff0c\u4f46\u662f expression \u7684\u503c\u5374\u4e0d\u4e00\u6837. x = 1; y = 1; cout << x++; // 1 cout << ++y; // 2 \u4f8b\u5b50\uff1a int x = 10; // go down to 0 while (x --> 0) { cout << x << endl; } // 9\u52300, \u5305\u542b0, \u56e0\u4e3ax=1\u65f6 x--\u4ecd\u662f1, \u8fc7\u4e86\u5224\u5b9a, \u800c\u8fd9\u884c\u4e4b\u540e\u5c31\u662f0\u4e86, \u4e8e\u662f\u6253\u5370\u51fa\u4e860","title":"11.3 \u9898\u5916\u8bdd: Prefix(++x) vs. Postfix(x++) Increment"},{"location":"11-C-strings.html#114-c-style-strings-standard-functions","text":"C-style strings C++-style strings Library Header <cstring> <string> Declaration char cstr[]; \u6216 char *cstr; string str; \u83b7\u53d6 Length strlen(cstr) str.length() Copy value strcpy(cstr1, cstr2) str1 = str2 Indexing cstr[i] str[i] Concatenate strcat(cstr1, cstr2) str1 += str2 Compare strcmp(cstr1, cstr2) str1 == str2","title":"11.4 C-style strings \u7684 standard functions"},{"location":"11-C-strings.html#1141-implementation-of-strcpy","text":"strcpy \u7684\u4f5c\u7528\u662f \u628a\u7b2c\u4e8c\u4e2a cstr \u7684\u503c\u4f20\u7ed9\u7b2c\u4e00\u4e2a . char str1[6] = \"hello\"; char str2[6] = \"apple\"; strcpy(str1, str2); // str1 \u7684\u503c\u8981\u53d8\u6210 \"apple\" \u6211\u4eec\u8fd9\u6837\u5199\uff1a void strcpy(char *dst, const char *src) { // \u8fd9\u662f\u4e2a ptr-to-const \u800c\u4e0d\u662f const ptr, \u53ef\u4ee5\u66f4\u6539\u6307\u5411\u7684\u5bf9\u8c61, \u4f46\u662f\u4e0d\u80fd\u7528\u5b83\u89e3\u5f15\u7528\u66f4\u6539\u6307\u5411\u5bf9\u8c61\u7684\u503c; char * const src \u5219\u662f const ptr, \u80fd\u7528\u5b83\u89e3\u5f15\u7528\u66f4\u6539\u6307\u5411\u5bf9\u8c61\u7684\u503c, \u4f46\u662f\u4e0d\u80fd\u66f4\u6539\u6307\u5411\u7684\u5bf9\u8c61, while (*src != '\\0') { *dst = *src; ++src; ++dst; } *dst = *src; // \u6700\u540e copy null char } \u8fd8\u6709\u4e00\u4e2a\u6781\u7aef\u7b80\u77ed\u7684\u7248\u672c\uff1a void strcpy(char *dst, const char *src) { while (*dst++ = *src++) {} }","title":"11.4.1 Implementation of strcpy"},{"location":"11-C-strings.html#1142-c-string-c-string","text":"\u628a C++ string \u8f6c\u6210 C string: c++ const char *cstr = str.c_str(); \u628a C string \u8f6c\u6210 C++ string: c++ string str = string(cstr);","title":"11.4.2 C++ string \u548c C string \u7684\u76f8\u4e92\u8f6c\u6362"},{"location":"11-C-strings.html#1143-strcmpa-b","text":"strcmp(A,B) returns: if A \u6bd4 B \u5c0f(\u5b57\u6bcdascii), \u8fd4\u56de\u4e00\u4e2a\u8d1f\u503c\u8868\u793a\u5c0f\u591a\u5c11(\u4e00\u4e2aint) If A = B, \u8fd4\u56de 0 if A \u6bd4 B \u5927(\u5b57\u6bcdascii), \u8fd4\u56de\u4e00\u4e2a\u6b63\u503c\u8868\u793a\u5927\u591a\u5c11(\u4e00\u4e2aint) \u8fd4\u56de\u7684\u662f\u7b2c\u4e00\u4e2a\u4e0d\u4e00\u6837\u7684\u5b57\u6bcd\u7684 ascii \u7801\u7684\u5927\u5c0f\u5dee\u8ddd.","title":"11.4.3 strcmp(A, B)"},{"location":"11-C-strings.html#115-command-line-arguments","text":"","title":"11.5 Command Line Arguments"},{"location":"11-C-strings.html#1151-int-mainint-argc-char-argv","text":"main() \u51fd\u6570\u662f\u53ef\u4ee5\u4f20 parameters \u7684. \u6211\u4eec\u53ef\u4ee5\u5728 terminal (\u6216\u8005VSCode \u7684 launch.json \u4ee3\u66ff terminal) \u7ed9 program \u6307\u5b9a arguments . ./redact bee bee.txt out.txt 10 \u6bd4\u5982\u8fd9\u4e2a command line. \u5176\u4e2d\u6709 5 \u4e2a arguments: ./redact , bee , bee.txt , out.txt , 10 . \u6ce8\u610f\u7a0b\u5e8f\u540d\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a command line argument. \u4e3a\u4e86\u63a5\u6536 arguments\uff0c\u6211\u4eec\u7684 main() \u7684\u62ec\u53f7\u91cc\u8981\u5199\u4e1c\u897f: int main(int argc, char *argv[]) { ... } \u8fd9\u91cc\u7684 argc \u662f\u4e00\u4e2a\u8868\u793a arguments \u7684\u6570\u91cf\u7684 int \uff0c\u800c argv \u662f\u4e00\u4e2a array\uff0c\u5176\u5143\u7d20\u7684\u7c7b\u578b\u90fd\u662f char * . \u5177\u4f53\u4f20\u53c2\u6570\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a \u6211\u4eec command line arguments \uff0c\u9664\u4e86\u7a0b\u5e8f\u540d\u81ea\u8eab\u662f\u7528\u6765 start program \u7684\uff0c**\u4e4b\u540e\u7684\u51e0\u4e2a arguments (\u4e00\u4e2a arrary) \u4f1a\u88ab\u505a\u6210\u4e00\u4e2a array\uff0c\u5176\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a c-string\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a char array. ** \u8fd9\u4e2a\u5927 array \u91cc\u9762\u6bcf\u4e2a\u5c0f char array \u7684\u5730\u5740\uff0c\u90fd\u4f1a\u4f20\u7ed9 main() \u7684 parameter argv \u3002 argv \u662f\u4e00\u4e2a\u5143\u7d20\u4e3a char * \u7684 array \u578b\u53c2\u6570\uff0c\u6211\u4eec\u77e5\u9053\u51fd\u6570\u4f20\u8fdb\u53bb array \u53c2\u6570\u5e76\u4e0d\u662f\u771f\u7684 array \u800c\u662f\u4f1a\u5f7b\u5e95\u53d8\u6210\u4e00\u4e2a\u6307\u5411\u9996\u5143\u7d20\u7684 pointer \u3002compiler \u4f1a\u628a\u5b83\u81ea\u52a8\u53d8\u6210 char **argv \u3002 **\u4f46\u662f\u8fd9\u5b8c\u5168\u4e0d\u5f71\u54cd\u5b83\u7684\u4f5c\u7528\u3002 argv[] \u7684\u503c\u5c31\u662f\u7b2c 0 \u4e2a argument \u8fd9\u4e2a c string \u7684\u9996\u4e2a char \u7684\u5730\u5740\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 [] \u7b26\u53f7\u6765\u89e3\u5f15\u7528 *(argv + i) \uff0c\u8868\u793a\u7b2c i \u4e2a argument \u8fd9\u4e2a c string \u7684\u9996\u4e2a char \u7684\u5730\u5740\u3002 ** \u800c\u6211\u4eec\u77e5\u9053\uff0c**\u6240\u6709 stream \u5bf9\u4e8e char * \u578b\u53d8\u91cf\uff0c\u4e5f\u5c31\u662f char \u7684\u5730\u5740\uff0c\u4f1a\u76f4\u63a5 in/write \u5b83\u6240\u8868\u793a\u7684 char \u4ee5\u53ca\u4e4b\u540e\u7684 char \u4e00\u76f4\u5230\u78b0\u5230 \\0 \u4e3a\u6b62\u3002\u6240\u4ee5\u5f53\u6211\u4eec cout << argv[1] \u7684\u65f6\u5019\uff0c argv[1] \u662f\u4e00\u4e2a\u5730\u5740\uff0c\u4f46\u662f\u6211\u4eec cout \u7684\u662f\u4e00\u6574\u4e2a argument. ** \u7ed3\u6784\u5982\u4e0b\uff1a fstream \u4e5f\u4e00\u6837\u3002 int main(int argc, char *argv[]) { if (argc != 5) { cout << \"Usage: ./redact WORD INFILE OUTFILE NUM_STARS\" << endl; return 1; } string wordToRemove = argv[1]; ifstream fin(argv[2]); ofstream fout(argv[3]); } \u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u9898\u76ee\u6765\u68c0\u6d4b\u4e00\u4e0b\u7406\u89e3\uff1a // ./program cat dog lobster int main(int argc, char *argv[]) { cout << argc // 4 cout << argv[1] // cat cout << *argv[1] // *(argument1\u7684\u9996\u4e2achar\u7684address) = argument1\u7684\u9996\u4e2achar = c cout << argv[2] + 1 << \" \"; // argument2\u7684\u9996\u4e2a\u5143\u7d20address + 1 = argument2\u7684\u9996\u4e2a\u5143\u7d20address + 1\u4e2achar\u5927\u5c0f\u7684address = argument2\u7684\u6b21\u5143\u7d20address, \u7ecf\u8fc7stream out\u6253\u5370\u51faargument2\u4ece\u6b21\u5143\u7d20\u5f00\u59cb\u7684\u90e8\u5206cstring = og } // 4 cat c og","title":"11.5.1 int main(int argc, char *argv[]) \u7684\u7ed3\u6784"},{"location":"11-C-strings.html#1151-command-line-arguments-c-string-double","text":"\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\uff0c\u6bcf\u4e2a arguments \u662f\u4e00\u4e2a c-string. \u5b9e\u9645\u4e0a\u6211\u4eec\u6709\u4e9b arguments \u7684\u610f\u601d\u662f int, double. \u4f46\u662f\u5728 command line \u91cc\u53ea\u80fd\u6253\u51fa string. \u90a3\u4e48\u6211\u4eec\u600e\u4e48\u628a\u5b83\u4eec\u8f6c\u5316\u6210 int/double \u5462\uff1f \u5982\u679c\u60f3\u8981\u8f6c\u5316\u6210 C++-style string: <string> \u8fd9\u4e2a library \u91cc\u6709\u4e24\u4e2a\u51fd\u6570: stoi() \u548c stod() . (1) stoi() parses an integer encoded in a string. (2) stod() parses a double encoded in a string. \u5982\u679c\u60f3\u8981\u8f6c\u5316\u6210 C-style string: \u9700\u8981 #include <cstdlib> \u5bf9\u5e94\u7684\u662f atoi() , atof() #include <string> // needed for stoi() or stod() using namespace std; int main(int argc, char *argv[]) { // parse string \"10\" to int 10 int numStars = stoi(argv[4]); // e.g. numStars is 3, makes *** string replacement(numStars, '*'); } \u4f7f\u7528\u4f8b\uff1aAdd up command line arguments. ./sum 1 2 3 4 5 int main(int argc, char *argv[]) { int sum = 0; for (int i = 1; i < argc; ++i) { sum += atoi(argv[i]); } cout << \"sum is \" << sum << endl; }","title":"11.5.1 \u5982\u4f55\u628a command line arguments \u91cc\u9762\u7684\u6570\u5b57 c-string \u8f6c\u4e3a double"},{"location":"11-C-strings.html#1262-caution-when-comparing-elements-of-argv","text":"int main(int argc, char *argv[]) { // BAD, compares addresses if (argv[1] == \"--debug\") { ... } // OK, wrap one in a std::string if (std::string(argv[1]) == \"--debug\") { ... } // OK, \"\"s suffix creates a std::string if (argv[1] == \"--debug\"s) { ... } // BAD, compares addresses if (argv[1] == argv[2]) { ... } // OK, wrap one in a std::string if (std::string(argv[1]) == argv[2]) { ... } }","title":"12.6.2 Caution when comparing elements of argv"},{"location":"11-C-strings.html#1263","text":"int main(int argc, char *argv[]) { if (argc != 3) { cout << \"Usage: redact INFILE OUTFILE\" << endl; return 1; } string inName = argv[1]; string outName = argv[2]; cout << \"Copying from \" << inName << \" to \" << outName << endl; string wordToRemove; cout << \"What word would you like to remove? \"; cin >> wordToRemove; ifstream fin(inName); ofstream fout(outName); if ( !fin.is_open() || !fout.is_open() ) { cout << \"Unable to open one of the files!\" << endl; return 1; } string word; while (fin >> word) { if (word != wordToRemove) { fout << word << \" \"; } } fin.close(); fout.close(); }","title":"12.6.3 \u7efc\u5408\u4f7f\u7528\u4f8b"},{"location":"12-Stream-and-IO.html","text":"12 Streams and I/O 12.1 stdin/stdout 12.1.1 input/Output Redirection \u8f93\u5165/\u51fa\u91cd\u5b9a\u5411 12.1.2 Makefile \u901a\u8fc7 redirection \u5b9e\u73b0 regression test 12.1.3 Pipelines 12.2 Exit Codes in C++ Programs 12.3 file I/O with streams: fstream 12.3.1 \u4f7f\u7528 stream \u578b objects \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6 12.3.1.2 \u5982\u4f55\u8ffd\u52a0\u800c\u975e\u8986\u76d6\u6587\u4ef6\u5185\u5bb9 12.4 Stream Input/Output 12.4.1 \u5982\u679c\u5224\u65ad stream operation \u662f\u5426\u6210\u529f 12.4.2 Mixing << and getline() 12.4.3 function \u4e2d\u7684 stream parameters 12.5 Stringstreams 12 Streams and I/O 12.1 stdin/stdout 12.1.1 input/Output Redirection \u8f93\u5165/\u51fa\u91cd\u5b9a\u5411 Programs \u548c command-line environment \u901a\u8fc7\u8fd9\u4e09\u4e2a predefined streams \u6765\u8fdb\u884c\u4ea4\u4e92: standard input(stdin): cin standard output(stdout): cout standard error output(srderror): cerr cin and cout \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5a92\u4ecb\u662f terminal (i.e. from/to the user). \u6240\u4ee5\u5176\u5b9e\u6211\u4e48\u7684 cin \u548c cout \u90fd\u662f\u548c terminal \u5bf9\u8bdd. \u6211\u4eec\u53ef\u4ee5\u5728 terminal \u4e2d\u7ed9\u4e00\u4e2a file \u6765\u4ee3\u66ff\u6211\u4eec\u952e\u76d8\u7684 stdin/cin ; \u5e76\u4e14\u4e5f\u53ef\u4ee5\u7ed9\u5b9a\u4e00\u4e2a file\uff0c\u628a\u4efb\u4f55\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c ( stdout/cout ) \u8f93\u51fa\u5230 file \u91cc\u9762. ./game.exe < choices.txt \u8fd9\u8868\u793a\u6267\u884c ./game.exe \u6587\u4ef6\uff0c\u5e76\u628a choices.txt \u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u4f5c\u4e3a\u6587\u4ef6\u7684\u8f93\u5165. ls > ls.txt \u8fd9\u8868\u793a\u628a ls \u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u8f93\u51fa\u5230 ls.txt \u6587\u4ef6\u91cc. in.txt > ./game.exe \u8fd9\u8868\u793a\u628a in.txt \u4f5c\u4e3a ./game.exe \u7684\u8f93\u5165. 12.1.2 Makefile \u901a\u8fc7 redirection \u5b9e\u73b0 regression test make test \u5f53\u6211\u4eec\u6253\u51fa\u8fd9\u884c\u6307\u4ee4\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u662f\u6307\u4ee4\u4e86 Makefile \u6587\u4ef6\u5f53\u4e2d\u7684 test \u8fd9\u90e8\u5206. \u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u80af\u5b9a\u6709\u4e00\u4e2a Makefile \u6587\u4ef6\u624d\u80fd\u6267\u884c\u8fd9\u4e2a\u547d\u4ee4. \u8fd9\u4e2a\u547d\u4ee4\u4f1a\u627e\u5230 directory \u91cc\u9762\u7684 Makefile \uff0c\u5e76\u4e14\u5728 Makefile \u6587\u4ef6\u91cc\u9762\u627e\u5230 test \u8fd9\u4e00\u5757. \u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u80af\u5b9a\u5b9a\u4e49\u4e86\u4e00\u4e2a test \u6307\u4ee4\u5757: # Project 1 Makefile # Run a regression test test: main.exe stats_tests.exe stats_public_test.exe ./stats_public_test.exe ./stats_tests.exe ./main.exe < main_test.in > main_test.out diff main_test.out main_test.out.correct \u8fd9\u91cc\u5f53\u6211\u4eec\u6267\u884c make test \u65f6\uff0c\u6211\u4eec\u5c31\u8c03\u7528\u53ef\u8fd9\u4e00\u5757\uff0c\u76f8\u5f53\u4e8e\u4f7f\u7528\u7f16\u8bd1\u5668\u5728 terminal \u91cc\u9762\u6267\u884c\u4e86 test: \u540e\u9762\u7684\u8fd9\u4e9b\u547d\u4ee4. \u4e8e\u662f\u6211\u4eec\u5c31\u751f\u6210\u4e86\u6240\u6709\u8fd9\u4e2a project \u7684 exe \u6587\u4ef6\u5e76\u8fd0\u884c\uff0c\u7136\u540e\u628a\u7ed3\u679c\u8f93\u51fa\u5230\u4e86\u4e00\u4e2a\u6587\u4ef6\u91cc\u4e0e\u6211\u4eec\u4e8b\u5148\u8bbe\u7f6e\u597d\u7684\u6b63\u786e\u7ed3\u679c\u8fdb\u884c\u6bd4\u8f83. \u8fd9\u5c31\u662f\u4e00\u4e2a regression test. 12.1.3 Pipelines Pipeline \u5c31\u662f | \u8fd9\u4e2a operator. \u5b83\u53ef\u4ee5\u628a\u4e00\u4e2a program \u7684 stdout \u4f5c\u4e3a stdin \u8f93\u5165\u5230\u53e6\u4e00\u4e2a program. **\u6ce8\u610f\uff1a\u4e00\u4e2acommand \u4e5f\u662f\u4e00\u4e2a program\uff0c\u6240\u4ee5\u5b83\u5f53\u7136\u4e5f\u53ef\u4ee5\u628a\u4e00\u4e2a command \u7684 stdout \u4f5c\u4e3a stdin \u7ed9\u53e6\u4e00\u4e2a command. ** ./game.exe | grep 'battle' > battles.log \u987a\u5e8f\u5c31\u662f\u628a\u5de6\u8fb9 program \u7684 stdout \u4f5c\u4e3a\u53f3\u8fb9 program \u7684 stdin. command line \u91cc\u9762\u7684\u4e1c\u897f\u90fd\u662f\u4ece\u5de6\u81f3\u53f3\u81ea\u7136\u987a\u5e8f\uff0c\u9664\u975e\u52a0\u4e0a\u62ec\u53f7. \u6240\u4ee5\u5728\u8fd9\u91cc: ./game.exe \u7684 stdout \u8f93\u5165\u7ed9\u4e86 grep 'battle' \u8fd9\u4e2a command \u4f5c\u4e3a\u5176 stdin. \u800c\u540e\u628a grep 'battle' \u8fd9\u4e2a command \u7684 stdout redirect \u81f3 battles.log . \u6ce8\u610f grep \u8fd9\u4e2a command (program) \u7684\u7528\u5904\u662f\u68c0\u5176 stdin \u4e2d\u7684\u6240\u6709\u542b\u6709\u67d0\u4e2a\u5173\u952e\u8bcd\u7684\u884c\uff0c\u5e76\u8f93\u51fa. \u8fd9\u91cc\u5c31\u662f\u68c0\u7d22 ./game.exe \u6587\u4ef6\u4e2d\u6240\u6709\u5305\u542b \"battle\" \u7684\u884c\uff0c\u7136\u540e\u8f93\u51fa (\u88abredirect \u81f3\u4e86 log). 12.2 Exit Codes in C++ Programs \u6211\u4eec\u7684 main() \u51fd\u6570\u662f\u6709\u4e00\u4e2a\u8fd4\u56de\u503c\u7684. \u5b83\u9ed8\u8ba4\u4e3a0. \u5f53\u4e00\u4e2a process (\u8fd0\u884c\u4e2d\u7684 program) \u8fd0\u884c\u7ed3\u675f\u65f6, \u5b83\u4f1a passes back an integer \u201cexit status\u201d or \u201cexit code\u201d. \u8fd9\u4e2a return value \u5c31\u662f program \u7684 exit code . \u8fd9\u4e2a exit code \u4e3a\u4e00\u4e2a 9 \u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\uff0c\u56e0\u800c\u8303\u56f4\u662f 0-255. \u5982\u679c\u4e3a0 \u4ee3\u8868\u6ca1\u95ee\u9898\uff0c\u5982\u679c\u4e0d\u662f 0 \u4ee3\u8868 process \u6709 error \u88ab\u6253\u65ad\u4e86. \u4e00\u822c\u662f 1. 1 \u5230 255 \u8868\u793a\u4e0d\u540c\u7684\u9519\u8bef\u6216\u72b6\u6001\u3002\u4e00\u4e9b\u9000\u51fa\u4ee3\u7801\u5df2\u7ecf\u6709\u4e86\u7ea6\u5b9a\u4fd7\u6210\u7684\u542b\u4e49\uff0c\u4f8b\u5982\uff1a 1 \uff1a\u901a\u5e38\u8868\u793a\u901a\u7528\u7684\u672a\u77e5\u9519\u8bef. 2 \uff1a\u7528\u4e8e\u547d\u4ee4\u884c\u8bed\u6cd5\u9519\u8bef. 126 \uff1a\u8868\u793a\u547d\u4ee4\u4e0d\u53ef\u6267\u884c. 127 \uff1a\u8868\u793a\u627e\u4e0d\u5230\u547d\u4ee4\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u547d\u4ee4\u7684\u8def\u5f84\u95ee\u9898. 128 \uff1a\u65e0\u6548\u7684\u9000\u51fa\u53c2\u6570. 128 + N \uff1a\u8868\u793a\u901a\u8fc7\u4fe1\u53f7 N \u7ec8\u6b62\u7684\u8fdb\u7a0b\uff0c\u4f8b\u5982\uff0c\u9000\u51fa\u4ee3\u7801 137 \uff08128 + 9\uff09\u901a\u5e38\u8868\u793a\u8fdb\u7a0b\u6536\u5230\u4e86 SIGKILL \u4fe1\u53f7. 255 \uff1a\u901a\u5e38\u7528\u4e8e\u8868\u793a\u9000\u51fa\u72b6\u6001\u8d85\u51fa\u8303\u56f4. int main() { ofstream fout(\"output.txt\"); if (!fout.is_open()) { cout << \"open failed\" << endl; return 1; // ERROR } // Compiler automatically adds a // return 0; at the end of main() } \u6211\u4eec\u53ef\u4ee5\u5728 terminal \u4f7f\u7528 echo $? \u6765\u67e5\u770b\u524d\u4e00\u4e2a command \u7684 exit code. cp file.txt other.txt echo $? # 0 # success! ./Image_tests.exe # Segmentation fault echo $? # 139 # error, crash with SIGSEGV (128 + 11) diff -q test.out test.correct # Files test.out and test.correct differ $ echo $? # 1 # error, files are different 12.3 file I/O with streams: fstream C++ \u4e2d\u6709\u4e00\u4e2a library \u4e2d\u7684 stream objects \u53ef\u4ee5\u6a21\u62df stdin/stdout. \u5b83\u4eec\u5728 fstream \u8fd9\u4e2a library \u4e2d.\uff08\u6587\u4ef6\u6d41\uff09 fstream \u4e2d\u7684 ifstream \u8fd9\u7c7b object \u53ef\u4ee5\u6a21\u62df cin \uff0c\u5141\u8bb8\u4f60 read a file just like reading from cin . \u53e6\u4e00\u7c7b object ofstream \u53ef\u4ee5\u6a21\u62df cout \uff0c\u5141\u8bb8\u4f60 write to a file just like printing to cout . \u5f15\u7528\u8fd9\u4e2a library: // ifstream and ofstream live ` // in the fstream library #include <fstream> 12.3.1 \u4f7f\u7528 stream \u578b objects \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6 ifstream fin(\"order.txt\"); ofstream fout(\"output.txt\"); \u8fd9\u91cc\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53eb fin \u7684 ifstream \u7c7b object\uff0c\u4e00\u4e2a\u53eb fout \u7684 ofstream \u7c7b object. #include <fstream> int main() { ofstream fout(\"output.txt\"); if (!fout.is_open()) { cout << \"open failed\" << endl; return 1; } for (int i = 0; i < 1000; ++i) { fout << i << endl; } fout.close(); } .is_open() \u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u67e5\u770b\u6587\u4ef6\u662f\u5426\u88ab stream object \u6b63\u786e\u6253\u5f00. .close() \u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5173\u95ed\u4e00\u4e2a fstream\uff0c\u8fd9\u6837\u5176\u4ed6 program \u5c31\u53ef\u4ee5\u5b89\u5168\u5730\u8bbf\u95ee\u5b83\u521a\u624d open \u7684\u8fd9\u4e2a file. 12.3.1.2 \u5982\u4f55\u8ffd\u52a0\u800c\u975e\u8986\u76d6\u6587\u4ef6\u5185\u5bb9 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c ofstream \u4f1a override \u6587\u4ef6\u7684\u6240\u6709\u5185\u5bb9. \u4f46\u662f\u6211\u4eec\u4e0d\u5e0c\u671b\u8fd9\u6837. \u6211\u4eec\u53ef\u4ee5\u6307\u5b9a fstream \u7684\u591a\u79cd\u6a21\u5f0f\uff1a std::ios::app : \u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u8ffd\u52a0\u5230\u6587\u4ef6\u672b\u5c3e\uff0c\u6587\u4ef6\u4e0d\u4f1a\u88ab\u622a\u65ad\uff08\u5373\u4e0d\u4f1a\u6e05\u7a7a\u73b0\u6709\u5185\u5bb9\uff09\uff0c\u5373\u4f7f\u6587\u4ef6\u5df2\u5b58\u5728. std::ios::ate \uff1a\u6253\u5f00\u6587\u4ef6\u5e76\u76f4\u63a5\u79fb\u52a8\u5230\u6587\u4ef6\u672b\u5c3e\uff0c\u53ef\u4ee5\u7528\u4e8e\u5728\u6587\u4ef6\u672b\u5c3e\u4e4b\u524d\u7684\u4efb\u4f55\u4f4d\u7f6e\u6dfb\u52a0\u5185\u5bb9\uff0c\u800c\u4e0d\u8986\u76d6\u73b0\u6709\u5185\u5bb9\u3002 ofstream file(\"example.txt\", ios::app); 12.4 Stream Input/Output \u6211\u4eec\u77e5\u9053 << \u662f insertion operator \uff0c\u4ee3\u8868 stream output. >> \u662f extraction operator \uff0c\u4ee3\u8868 stream input. The behavior is specific to the type of object. \u8fd9\u4e24\u4e2a operator \u9996\u5148 read/write\uff0c\u7136\u540e turns back into the itself. 12.4.1 \u5982\u679c\u5224\u65ad stream operation \u662f\u5426\u6210\u529f \u9996\u5148\u6211\u4eec\u77e5\u9053 >> , << \u662f operator\uff0c\u800c\u4e00\u4e2a operator \u4e00\u5b9a\u6709\u4e00\u4e2a bool value. \u56e0\u800c\u5b83\u81ea\u8eab\u7684\u503c\u5c31\u4ee3\u8868\u4e86\u5b83\u662f\u5426\u6210\u529f. while (fin >> word) { // Read until end of file if (word == \"bee\") { cout << \"cat\" << endl; } else { cout << word << endl; } } while (getline(fin, line)) { // \u4e5f\u4e00\u6837 ... } \u4e0d\u4ec5\u5982\u6b64\uff0cstream objects \u81ea\u8eab\u8fd8\u53ef\u4ee5\u88ab \"contextually\" \u8f6c\u5316\u4e3a bool value. if (fin) { cout << \"stream is ok!\" << endl; } \u503c\u90fd\u662f\u8868\u793a\u662f\u5426\u6709 read/write operations \u5931\u8d25. 12.4.2 Mixing << and getline() \u6211\u4eec\u5e94\u5f53\u5728\u6df7\u5408\u4f7f\u7528 >> \u548c gitline() \u65f6\u6ce8\u610f. \u4ee5\u524d\u5df2\u7ecf\u5b66\u8fc7\uff1a >> \u4f1a\u7559\u4e0b newline character\uff0c\u4f46\u662f\u4e0b\u4e00\u4e2a cin \u4f1a\u65e0\u89c6\u5e76\u9500\u6bc1\u5b83. getline() \u5e76\u4e0d\u4f1a. getline() \u4f1a\u8bfb\u53d6\u5305\u62ec newline character \u5728\u5185\u7684\u5185\u5bb9\uff0c\u5373\u4fbf\u53ea\u6709\u4e00\u4e2a newline character \u4e5f\u7b97\u662f\u4e00\u884c. ifstream fin(\"hello.txt\"); string word; fin >> word; cout << word << endl; string line; getline(fin, line); cout << line << endl; \u8fd9\u91cc\u7684\u95ee\u9898\u5728\u4e8e\uff1aThe first fin >> word leaves the newline character in the stream\uff0c\u800c getline() reads a blank line. Fix: add fin >> ws before any getline following >> input. 12.4.3 function \u4e2d\u7684 stream parameters // REQUIRES: img points to a valid Image // EFFECTS: Writes the image to the given output stream // in PPM format. // ... // ... void Image_print(const Image* img, ostream& os); \u6211\u4eec\u53ef\u4ee5 Pass streams by reference \u6765\u4f7f\u7528 fucntion \u64cd\u4f5c stream. \u4e0a\u9762\u8fd9\u4e2a function \u53ef\u4ee5 write to \u4efb\u4f55 output stream\uff0c\u6211\u4eec\u77e5\u9053 ofstream , ostringstream , cout , cerr \u90fd\u5c5e\u4e8e ostream . \u5b83\u4eec\u90fd\u652f\u6301 >> operator. 12.5 Stringstreams istringstream \u662f\u4e00\u79cd\u7528\u4e00\u4e2a string \u4f5c\u4e3a source \u7684 input stream. \u5b83\u53ef\u4ee5\u7528\u6765 simulating stream input from a \"hardcoded\" string. TEST(test_image_basic) { // A hardcoded PPM image string input = \"P3\\n2 2\\n255\\n255 0 0 0 255 0 \\n\"; // Use istringstream for simulated input istringstream ss_input(input); Image *img = new Image; Image_init(img, ss_input); ASSERT_EQUAL(Image_width(img), 2); Pixel red = { 255, 0, 0 }; ASSERT_TRUE(Pixel_equal(Image_get_pixel(img, 0, 0), red)); delete img; } \u540c\u6837\u7684\uff0c ostringstream \u662f\u4e00\u79cd\u53ef\u4ee5\u7528 .str() \u8f6c\u6210 string \u7684 stream. \u53ef\u4ee5\u7528\u6765 check for correctness of output. TEST(test_matrix_basic) { Matrix *mat = new Matrix; Matrix_init(mat, 3, 3); Matrix_fill(mat, 0); Matrix_fill_border(mat, 1); // Hardcoded correct output string output_correct = \"3 3\\n1 1 1 \\n1 0 1 \\n1 1 1 \\n\"; // Capture output in ostringstream ostringstream ss_output; Matrix_print(mat, ss_output); ASSERT_EQUAL(ss_output.str(), output_correct); delete mat; }","title":"Overview"},{"location":"12-Stream-and-IO.html#12-streams-and-io","text":"","title":"12 Streams and I/O"},{"location":"12-Stream-and-IO.html#121-stdinstdout","text":"","title":"12.1 stdin/stdout"},{"location":"12-Stream-and-IO.html#1211-inputoutput-redirection","text":"Programs \u548c command-line environment \u901a\u8fc7\u8fd9\u4e09\u4e2a predefined streams \u6765\u8fdb\u884c\u4ea4\u4e92: standard input(stdin): cin standard output(stdout): cout standard error output(srderror): cerr cin and cout \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5a92\u4ecb\u662f terminal (i.e. from/to the user). \u6240\u4ee5\u5176\u5b9e\u6211\u4e48\u7684 cin \u548c cout \u90fd\u662f\u548c terminal \u5bf9\u8bdd. \u6211\u4eec\u53ef\u4ee5\u5728 terminal \u4e2d\u7ed9\u4e00\u4e2a file \u6765\u4ee3\u66ff\u6211\u4eec\u952e\u76d8\u7684 stdin/cin ; \u5e76\u4e14\u4e5f\u53ef\u4ee5\u7ed9\u5b9a\u4e00\u4e2a file\uff0c\u628a\u4efb\u4f55\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c ( stdout/cout ) \u8f93\u51fa\u5230 file \u91cc\u9762. ./game.exe < choices.txt \u8fd9\u8868\u793a\u6267\u884c ./game.exe \u6587\u4ef6\uff0c\u5e76\u628a choices.txt \u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u4f5c\u4e3a\u6587\u4ef6\u7684\u8f93\u5165. ls > ls.txt \u8fd9\u8868\u793a\u628a ls \u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u8f93\u51fa\u5230 ls.txt \u6587\u4ef6\u91cc. in.txt > ./game.exe \u8fd9\u8868\u793a\u628a in.txt \u4f5c\u4e3a ./game.exe \u7684\u8f93\u5165.","title":"12.1.1 input/Output Redirection \u8f93\u5165/\u51fa\u91cd\u5b9a\u5411"},{"location":"12-Stream-and-IO.html#1212-makefile-redirection-regression-test","text":"make test \u5f53\u6211\u4eec\u6253\u51fa\u8fd9\u884c\u6307\u4ee4\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u662f\u6307\u4ee4\u4e86 Makefile \u6587\u4ef6\u5f53\u4e2d\u7684 test \u8fd9\u90e8\u5206. \u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u80af\u5b9a\u6709\u4e00\u4e2a Makefile \u6587\u4ef6\u624d\u80fd\u6267\u884c\u8fd9\u4e2a\u547d\u4ee4. \u8fd9\u4e2a\u547d\u4ee4\u4f1a\u627e\u5230 directory \u91cc\u9762\u7684 Makefile \uff0c\u5e76\u4e14\u5728 Makefile \u6587\u4ef6\u91cc\u9762\u627e\u5230 test \u8fd9\u4e00\u5757. \u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u80af\u5b9a\u5b9a\u4e49\u4e86\u4e00\u4e2a test \u6307\u4ee4\u5757: # Project 1 Makefile # Run a regression test test: main.exe stats_tests.exe stats_public_test.exe ./stats_public_test.exe ./stats_tests.exe ./main.exe < main_test.in > main_test.out diff main_test.out main_test.out.correct \u8fd9\u91cc\u5f53\u6211\u4eec\u6267\u884c make test \u65f6\uff0c\u6211\u4eec\u5c31\u8c03\u7528\u53ef\u8fd9\u4e00\u5757\uff0c\u76f8\u5f53\u4e8e\u4f7f\u7528\u7f16\u8bd1\u5668\u5728 terminal \u91cc\u9762\u6267\u884c\u4e86 test: \u540e\u9762\u7684\u8fd9\u4e9b\u547d\u4ee4. \u4e8e\u662f\u6211\u4eec\u5c31\u751f\u6210\u4e86\u6240\u6709\u8fd9\u4e2a project \u7684 exe \u6587\u4ef6\u5e76\u8fd0\u884c\uff0c\u7136\u540e\u628a\u7ed3\u679c\u8f93\u51fa\u5230\u4e86\u4e00\u4e2a\u6587\u4ef6\u91cc\u4e0e\u6211\u4eec\u4e8b\u5148\u8bbe\u7f6e\u597d\u7684\u6b63\u786e\u7ed3\u679c\u8fdb\u884c\u6bd4\u8f83. \u8fd9\u5c31\u662f\u4e00\u4e2a regression test.","title":"12.1.2 Makefile \u901a\u8fc7 redirection \u5b9e\u73b0 regression test"},{"location":"12-Stream-and-IO.html#1213-pipelines","text":"Pipeline \u5c31\u662f | \u8fd9\u4e2a operator. \u5b83\u53ef\u4ee5\u628a\u4e00\u4e2a program \u7684 stdout \u4f5c\u4e3a stdin \u8f93\u5165\u5230\u53e6\u4e00\u4e2a program. **\u6ce8\u610f\uff1a\u4e00\u4e2acommand \u4e5f\u662f\u4e00\u4e2a program\uff0c\u6240\u4ee5\u5b83\u5f53\u7136\u4e5f\u53ef\u4ee5\u628a\u4e00\u4e2a command \u7684 stdout \u4f5c\u4e3a stdin \u7ed9\u53e6\u4e00\u4e2a command. ** ./game.exe | grep 'battle' > battles.log \u987a\u5e8f\u5c31\u662f\u628a\u5de6\u8fb9 program \u7684 stdout \u4f5c\u4e3a\u53f3\u8fb9 program \u7684 stdin. command line \u91cc\u9762\u7684\u4e1c\u897f\u90fd\u662f\u4ece\u5de6\u81f3\u53f3\u81ea\u7136\u987a\u5e8f\uff0c\u9664\u975e\u52a0\u4e0a\u62ec\u53f7. \u6240\u4ee5\u5728\u8fd9\u91cc: ./game.exe \u7684 stdout \u8f93\u5165\u7ed9\u4e86 grep 'battle' \u8fd9\u4e2a command \u4f5c\u4e3a\u5176 stdin. \u800c\u540e\u628a grep 'battle' \u8fd9\u4e2a command \u7684 stdout redirect \u81f3 battles.log . \u6ce8\u610f grep \u8fd9\u4e2a command (program) \u7684\u7528\u5904\u662f\u68c0\u5176 stdin \u4e2d\u7684\u6240\u6709\u542b\u6709\u67d0\u4e2a\u5173\u952e\u8bcd\u7684\u884c\uff0c\u5e76\u8f93\u51fa. \u8fd9\u91cc\u5c31\u662f\u68c0\u7d22 ./game.exe \u6587\u4ef6\u4e2d\u6240\u6709\u5305\u542b \"battle\" \u7684\u884c\uff0c\u7136\u540e\u8f93\u51fa (\u88abredirect \u81f3\u4e86 log).","title":"12.1.3 Pipelines"},{"location":"12-Stream-and-IO.html#122-exit-codes-in-c-programs","text":"\u6211\u4eec\u7684 main() \u51fd\u6570\u662f\u6709\u4e00\u4e2a\u8fd4\u56de\u503c\u7684. \u5b83\u9ed8\u8ba4\u4e3a0. \u5f53\u4e00\u4e2a process (\u8fd0\u884c\u4e2d\u7684 program) \u8fd0\u884c\u7ed3\u675f\u65f6, \u5b83\u4f1a passes back an integer \u201cexit status\u201d or \u201cexit code\u201d. \u8fd9\u4e2a return value \u5c31\u662f program \u7684 exit code . \u8fd9\u4e2a exit code \u4e3a\u4e00\u4e2a 9 \u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\uff0c\u56e0\u800c\u8303\u56f4\u662f 0-255. \u5982\u679c\u4e3a0 \u4ee3\u8868\u6ca1\u95ee\u9898\uff0c\u5982\u679c\u4e0d\u662f 0 \u4ee3\u8868 process \u6709 error \u88ab\u6253\u65ad\u4e86. \u4e00\u822c\u662f 1. 1 \u5230 255 \u8868\u793a\u4e0d\u540c\u7684\u9519\u8bef\u6216\u72b6\u6001\u3002\u4e00\u4e9b\u9000\u51fa\u4ee3\u7801\u5df2\u7ecf\u6709\u4e86\u7ea6\u5b9a\u4fd7\u6210\u7684\u542b\u4e49\uff0c\u4f8b\u5982\uff1a 1 \uff1a\u901a\u5e38\u8868\u793a\u901a\u7528\u7684\u672a\u77e5\u9519\u8bef. 2 \uff1a\u7528\u4e8e\u547d\u4ee4\u884c\u8bed\u6cd5\u9519\u8bef. 126 \uff1a\u8868\u793a\u547d\u4ee4\u4e0d\u53ef\u6267\u884c. 127 \uff1a\u8868\u793a\u627e\u4e0d\u5230\u547d\u4ee4\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u547d\u4ee4\u7684\u8def\u5f84\u95ee\u9898. 128 \uff1a\u65e0\u6548\u7684\u9000\u51fa\u53c2\u6570. 128 + N \uff1a\u8868\u793a\u901a\u8fc7\u4fe1\u53f7 N \u7ec8\u6b62\u7684\u8fdb\u7a0b\uff0c\u4f8b\u5982\uff0c\u9000\u51fa\u4ee3\u7801 137 \uff08128 + 9\uff09\u901a\u5e38\u8868\u793a\u8fdb\u7a0b\u6536\u5230\u4e86 SIGKILL \u4fe1\u53f7. 255 \uff1a\u901a\u5e38\u7528\u4e8e\u8868\u793a\u9000\u51fa\u72b6\u6001\u8d85\u51fa\u8303\u56f4. int main() { ofstream fout(\"output.txt\"); if (!fout.is_open()) { cout << \"open failed\" << endl; return 1; // ERROR } // Compiler automatically adds a // return 0; at the end of main() } \u6211\u4eec\u53ef\u4ee5\u5728 terminal \u4f7f\u7528 echo $? \u6765\u67e5\u770b\u524d\u4e00\u4e2a command \u7684 exit code. cp file.txt other.txt echo $? # 0 # success! ./Image_tests.exe # Segmentation fault echo $? # 139 # error, crash with SIGSEGV (128 + 11) diff -q test.out test.correct # Files test.out and test.correct differ $ echo $? # 1 # error, files are different","title":"12.2 Exit Codes in C++ Programs"},{"location":"12-Stream-and-IO.html#123-file-io-with-streams-fstream","text":"C++ \u4e2d\u6709\u4e00\u4e2a library \u4e2d\u7684 stream objects \u53ef\u4ee5\u6a21\u62df stdin/stdout. \u5b83\u4eec\u5728 fstream \u8fd9\u4e2a library \u4e2d.\uff08\u6587\u4ef6\u6d41\uff09 fstream \u4e2d\u7684 ifstream \u8fd9\u7c7b object \u53ef\u4ee5\u6a21\u62df cin \uff0c\u5141\u8bb8\u4f60 read a file just like reading from cin . \u53e6\u4e00\u7c7b object ofstream \u53ef\u4ee5\u6a21\u62df cout \uff0c\u5141\u8bb8\u4f60 write to a file just like printing to cout . \u5f15\u7528\u8fd9\u4e2a library: // ifstream and ofstream live ` // in the fstream library #include <fstream>","title":"12.3 file I/O with streams: fstream"},{"location":"12-Stream-and-IO.html#1231-stream-objects","text":"ifstream fin(\"order.txt\"); ofstream fout(\"output.txt\"); \u8fd9\u91cc\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53eb fin \u7684 ifstream \u7c7b object\uff0c\u4e00\u4e2a\u53eb fout \u7684 ofstream \u7c7b object. #include <fstream> int main() { ofstream fout(\"output.txt\"); if (!fout.is_open()) { cout << \"open failed\" << endl; return 1; } for (int i = 0; i < 1000; ++i) { fout << i << endl; } fout.close(); } .is_open() \u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u67e5\u770b\u6587\u4ef6\u662f\u5426\u88ab stream object \u6b63\u786e\u6253\u5f00. .close() \u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5173\u95ed\u4e00\u4e2a fstream\uff0c\u8fd9\u6837\u5176\u4ed6 program \u5c31\u53ef\u4ee5\u5b89\u5168\u5730\u8bbf\u95ee\u5b83\u521a\u624d open \u7684\u8fd9\u4e2a file.","title":"12.3.1 \u4f7f\u7528 stream \u578b objects \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6"},{"location":"12-Stream-and-IO.html#12312","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c ofstream \u4f1a override \u6587\u4ef6\u7684\u6240\u6709\u5185\u5bb9. \u4f46\u662f\u6211\u4eec\u4e0d\u5e0c\u671b\u8fd9\u6837. \u6211\u4eec\u53ef\u4ee5\u6307\u5b9a fstream \u7684\u591a\u79cd\u6a21\u5f0f\uff1a std::ios::app : \u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u8ffd\u52a0\u5230\u6587\u4ef6\u672b\u5c3e\uff0c\u6587\u4ef6\u4e0d\u4f1a\u88ab\u622a\u65ad\uff08\u5373\u4e0d\u4f1a\u6e05\u7a7a\u73b0\u6709\u5185\u5bb9\uff09\uff0c\u5373\u4f7f\u6587\u4ef6\u5df2\u5b58\u5728. std::ios::ate \uff1a\u6253\u5f00\u6587\u4ef6\u5e76\u76f4\u63a5\u79fb\u52a8\u5230\u6587\u4ef6\u672b\u5c3e\uff0c\u53ef\u4ee5\u7528\u4e8e\u5728\u6587\u4ef6\u672b\u5c3e\u4e4b\u524d\u7684\u4efb\u4f55\u4f4d\u7f6e\u6dfb\u52a0\u5185\u5bb9\uff0c\u800c\u4e0d\u8986\u76d6\u73b0\u6709\u5185\u5bb9\u3002 ofstream file(\"example.txt\", ios::app);","title":"12.3.1.2 \u5982\u4f55\u8ffd\u52a0\u800c\u975e\u8986\u76d6\u6587\u4ef6\u5185\u5bb9"},{"location":"12-Stream-and-IO.html#124-stream-inputoutput","text":"\u6211\u4eec\u77e5\u9053 << \u662f insertion operator \uff0c\u4ee3\u8868 stream output. >> \u662f extraction operator \uff0c\u4ee3\u8868 stream input. The behavior is specific to the type of object. \u8fd9\u4e24\u4e2a operator \u9996\u5148 read/write\uff0c\u7136\u540e turns back into the itself.","title":"12.4 Stream Input/Output"},{"location":"12-Stream-and-IO.html#1241-stream-operation","text":"\u9996\u5148\u6211\u4eec\u77e5\u9053 >> , << \u662f operator\uff0c\u800c\u4e00\u4e2a operator \u4e00\u5b9a\u6709\u4e00\u4e2a bool value. \u56e0\u800c\u5b83\u81ea\u8eab\u7684\u503c\u5c31\u4ee3\u8868\u4e86\u5b83\u662f\u5426\u6210\u529f. while (fin >> word) { // Read until end of file if (word == \"bee\") { cout << \"cat\" << endl; } else { cout << word << endl; } } while (getline(fin, line)) { // \u4e5f\u4e00\u6837 ... } \u4e0d\u4ec5\u5982\u6b64\uff0cstream objects \u81ea\u8eab\u8fd8\u53ef\u4ee5\u88ab \"contextually\" \u8f6c\u5316\u4e3a bool value. if (fin) { cout << \"stream is ok!\" << endl; } \u503c\u90fd\u662f\u8868\u793a\u662f\u5426\u6709 read/write operations \u5931\u8d25.","title":"12.4.1 \u5982\u679c\u5224\u65ad stream operation \u662f\u5426\u6210\u529f"},{"location":"12-Stream-and-IO.html#1242-mixing-and-getline","text":"\u6211\u4eec\u5e94\u5f53\u5728\u6df7\u5408\u4f7f\u7528 >> \u548c gitline() \u65f6\u6ce8\u610f. \u4ee5\u524d\u5df2\u7ecf\u5b66\u8fc7\uff1a >> \u4f1a\u7559\u4e0b newline character\uff0c\u4f46\u662f\u4e0b\u4e00\u4e2a cin \u4f1a\u65e0\u89c6\u5e76\u9500\u6bc1\u5b83. getline() \u5e76\u4e0d\u4f1a. getline() \u4f1a\u8bfb\u53d6\u5305\u62ec newline character \u5728\u5185\u7684\u5185\u5bb9\uff0c\u5373\u4fbf\u53ea\u6709\u4e00\u4e2a newline character \u4e5f\u7b97\u662f\u4e00\u884c. ifstream fin(\"hello.txt\"); string word; fin >> word; cout << word << endl; string line; getline(fin, line); cout << line << endl; \u8fd9\u91cc\u7684\u95ee\u9898\u5728\u4e8e\uff1aThe first fin >> word leaves the newline character in the stream\uff0c\u800c getline() reads a blank line. Fix: add fin >> ws before any getline following >> input.","title":"12.4.2 Mixing &lt;&lt; and getline()"},{"location":"12-Stream-and-IO.html#1243-function-stream-parameters","text":"// REQUIRES: img points to a valid Image // EFFECTS: Writes the image to the given output stream // in PPM format. // ... // ... void Image_print(const Image* img, ostream& os); \u6211\u4eec\u53ef\u4ee5 Pass streams by reference \u6765\u4f7f\u7528 fucntion \u64cd\u4f5c stream. \u4e0a\u9762\u8fd9\u4e2a function \u53ef\u4ee5 write to \u4efb\u4f55 output stream\uff0c\u6211\u4eec\u77e5\u9053 ofstream , ostringstream , cout , cerr \u90fd\u5c5e\u4e8e ostream . \u5b83\u4eec\u90fd\u652f\u6301 >> operator.","title":"12.4.3 function \u4e2d\u7684 stream parameters"},{"location":"12-Stream-and-IO.html#125-stringstreams","text":"istringstream \u662f\u4e00\u79cd\u7528\u4e00\u4e2a string \u4f5c\u4e3a source \u7684 input stream. \u5b83\u53ef\u4ee5\u7528\u6765 simulating stream input from a \"hardcoded\" string. TEST(test_image_basic) { // A hardcoded PPM image string input = \"P3\\n2 2\\n255\\n255 0 0 0 255 0 \\n\"; // Use istringstream for simulated input istringstream ss_input(input); Image *img = new Image; Image_init(img, ss_input); ASSERT_EQUAL(Image_width(img), 2); Pixel red = { 255, 0, 0 }; ASSERT_TRUE(Pixel_equal(Image_get_pixel(img, 0, 0), red)); delete img; } \u540c\u6837\u7684\uff0c ostringstream \u662f\u4e00\u79cd\u53ef\u4ee5\u7528 .str() \u8f6c\u6210 string \u7684 stream. \u53ef\u4ee5\u7528\u6765 check for correctness of output. TEST(test_matrix_basic) { Matrix *mat = new Matrix; Matrix_init(mat, 3, 3); Matrix_fill(mat, 0); Matrix_fill_border(mat, 1); // Hardcoded correct output string output_correct = \"3 3\\n1 1 1 \\n1 0 1 \\n1 1 1 \\n\"; // Capture output in ostringstream ostringstream ss_output; Matrix_print(mat, ss_output); ASSERT_EQUAL(ss_output.str(), output_correct); delete mat; }","title":"12.5 Stringstreams"},{"location":"13-ADT-in-C%2B%2B.html","text":"13 ADT in C++ 13.1 Class Declaration 13.1.1 \u524d\u60c5\u63d0\u8981: class \u578b\u7684 object \u53ef\u4ee5\u4f7f\u7528 = \u8d4b\u503c 13.2 Calling a member function 13.2.1 \u81ea\u52a8\u521b\u5efa\u7684 this \u4f5c\u4e3a\u6307\u9488\u53d8\u91cf 13.2.2 const function 13.2.3 this \u4e0d\u4ec5\u53ef\u4ee5 -> member variable \u8fd8\u53ef\u4ee5 -> member function 13.2.4 const \u914d\u5bf9: const \u7684 object \u4e0d\u80fd\u4f7f\u7528\u975e const \u7684 member function 13.2.5 \u53c2\u6570\u5305\u542b\u5176\u4ed6\u540c class object \u7684 member function 13.2.6 \u4e0d\u4f7f\u7528 this implement member function: compiler \u81ea\u52a8\u8865\u5168 13.3 Member Accessibility (\u6216\u79f0 visibility) 13.4 Initialization 13.4.1 \u4f7f\u7528 member initializer list \u7684 Constructors 13.4.2 \u591a\u4e2a Constructors 13.4.3 Classes \u4f5c\u4e3a members 13.4.4 Check Invariants 13 ADT in C++ struct \u662f C-style heterogeneous aggregate data type\uff0c\u800c class \u662f C++-style heterogeneous aggregate data type. struct \u548c class \u7684\u533a\u522b\u5728\u4e8e\uff1a struct \u7684 member variables \u5fc5\u987b call init function \u6765 initialize, \u800c class \u53ef\u4ee5\u5199 default constrctor \u81ea\u52a8 initialize struct \u7684\u6240\u6709 data \u90fd\u662f public by default \u7684\uff0c class \u7684\u6240\u6709 data \u90fd\u662f private by default \u7684. struct \u53ea\u5305\u542b member variables\uff0cfunctions \u662f technically separate \u7684\uff0c\u800c class \u5305\u542b\u4e86\u81ea\u5df1\u7684 member variables \u548c member functions. \u56e0\u800c\u7528 class \u53ef\u4ee5\uff1a \u2022 Enforce the interface \u2022 Maintain representation invariants 13.1 Class Declaration \u683c\u5f0f\uff1a class Triangle { private: // private(\u4e00\u822c\u662fvariables/data) double a; double b; double c; public: // public(\u5927\u90e8\u5206functions) Triangle(double a_in, double b_in, double c_in) { ... } // Constructor(s) double perimeter() const { // \u6ce8\u610f\u4e0d\u6539\u53d8 member variables \u7684 function \u8981\u52a0 const ... } void scale(double s) { ... } }; // \u6ce8\u610f\u548cstruct\u4e00\u6837\u8981\u52a0semicolom! initialize \u4e00\u4e2a instance object\uff1a int main() { Triangle t1{3, 4, 5}; } 13.1.1 \u524d\u60c5\u63d0\u8981: class \u578b\u7684 object \u53ef\u4ee5\u4f7f\u7528 = \u8d4b\u503c int main() { Triangle t1(3, 4, 5); Triangle t2 = t1; ... } \u80fd\u8fd9\u4e48\u505a\u3002 13.2 Calling a member function \u4e00\u4e2a Class \u7684\u6bcf\u4e2a object \u90fd\u6709\u5b83\u81ea\u5df1\u7684 copy of each member variable. \u8c03\u7528 Class \u7684 member function \u603b\u662f\u5728\u67d0\u4e2a object \u4e0a\uff0c\u4f7f\u7528 . \u8c03\u7528\u3002\u6bd4\u5982 Triangle \u6709\u4e00\u4e2a member function \u53eb\u505a scale() \uff0c\u90a3\u4e48\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u8c03\u7528 scale() \uff0c\u800c\u662f\u5fc5\u987b\u5728\u67d0\u4e2a instance object \u4e0a\u8c03\u7528\uff0c\u6bd4\u5982 t1 \u662f\u4e00\u4e2a object\uff0c t1.scale() . 13.2.1 \u81ea\u52a8\u521b\u5efa\u7684 this \u4f5c\u4e3a\u6307\u9488\u53d8\u91cf \u8bb0\u5f97\u5728 struct \u4e2d\uff0c\u6211\u4eec\u662f\u5148\u81ea\u5df1\u521b\u5efa\u67d0\u4e2a object \u7684\u4e00\u4e2a\u6307\u9488\u53d8\u91cf\u6216\u8005\u76f4\u63a5\u4f7f\u7528 &t1 \u628a\u5730\u5740\u4f20\u8fdb\u53bb\u4f5c\u4e3a\u4e00\u4e2a\u6307\u9488\u578b\u53d8\u91cf\uff0c\u7136\u540e\u628a\u5b83\u4f20\u7ed9\u4e00\u4e2a \u4ee5\u6307\u9488 Triangle *ptr \u4f5c\u4e3a\u53c2\u6570\u7684 function \uff0c\u8fd9\u4e2a function \u901a\u8fc7 ptr -> a \u8fd9\u6837\u4f7f\u7528 -> operator \u83b7\u53d6 \u4f20\u8fdb\u6765\u7684\u6307\u9488\u4f5c\u4e3a\u53c2\u6570\u6307\u5411\u5bf9\u8c61\u7684 member variable. \u800c class \u4e2d\u5c31\u4e0d\u540c\u3002\u6211\u4eec\u53ef\u4ee5\u5728 member functon \u4e2d\u4f7f\u7528 this \u8fd9\u4e2a\u5173\u952e\u8bcd\uff0c\u4f7f\u5f97\u5f53\u4e00\u4e2a object \u8c03\u7528\u8fd9\u4e2a function \u65f6 \u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u6307\u5411\u8fd9\u4e2a object \u7684\u6307\u9488 this \uff0c \u7136\u540e\u901a\u8fc7 this -> a \u8fd9\u6837\u4f7f\u7528 -> operator \u6765 access \u539f\u5bf9\u8c61\u53c2\u6570\u7684 member variable. The object on which a function is called is pointed to by the pointer named this . \u5c31\u662f\u8bf4\u5982\u679c\u6211\u4eec\u5728 member function \u4e2d\u7528 this \u8fd9\u4e2a\u5173\u952e\u8bcd\uff0c\u610f\u601d\u5c31\u662f this \u662f\u6307\u5411\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684 object \u7684\u4e00\u4e2a\u6307\u9488\u3002 void Triangle::scale(double s) { this -> a *= s; this -> b *= s; this -> c *= c; } int main() { Triangle t1(3, 4, 5); t1.scale(2); // 6 8 10 } \u5bf9\u6bd4\u4e00\u4e0b C-style ( struct ): void Triangle_scale(Triangle *tri, double s) { tri->a *= s; tri->b *= s; tri->c *= s; } int main() { Triangle t1; Triangle_init(&t1, 3, 4, 5); Triangle_scale(&t1, 2); // 6 8 10 } 13.2.2 const function \u5728\u4f7f\u7528 struct \u7684\u51fd\u6570\u4e2d\u6211\u4eec\u5982\u679c\u9700\u8981\u4e0d\u6539\u53d8\u539f object \u5c31\u9700\u8981\u4f7f\u7528 pointer to const . double Triangle_perimeter(Triangle const *tri) { // pointer to const return tri->a + tri->b + tri->c; } int main() { Triangle t1; Triangle_init(&t1, 3, 4, 5); cout << Triangle_perimeter(&t1); // \u4f7f\u7528 & \u4f20\u5730\u5740\u4f5c\u4e3a\u6307\u9488\u53d8\u91cf } \u800c\u5728 class \u4e2d\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7ed9 member function \u52a0\u4e0a const \u8868\u793a\u5b83\u4e0d\u6539\u53d8\u8c03\u7528\u5b83\u7684\u539f object \u7684\u503c\u3002 double Triangle::perimeter() const{ // const function return this->a + this->b + this->c; } int main() { Triangle t1(3, 4, 5); cout << t1.perimeter(); // \u4e0d\u9700\u8981\u4f20\u5165\u5730\u5740 } 13.2.3 this \u4e0d\u4ec5\u53ef\u4ee5 -> member variable \u8fd8\u53ef\u4ee5 -> member function int operation() { this -> scale(2.0); cout << this -> perimeter(); } this -> scale() \u5c31\u662f *(this).scale() . \u8868\u793a\u5728 member function \u91cc\u8c03\u7528\u5176\u4ed6 member function. 13.2.4 const \u914d\u5bf9: const \u7684 object \u4e0d\u80fd\u4f7f\u7528\u975e const \u7684 member function class Triangle { private: ... public: double scale(double s); double perimeter() const; ... } int main() { const Triangle t1(3, 4, 5); t1.scale(); // error, \u56e0\u4e3ascale\u4e0d\u662fconst function. \u5b83\u5728\u5c1d\u8bd5strip off t1's const cout << t1.perimeter(); //ok } 13.2.5 \u53c2\u6570\u5305\u542b\u5176\u4ed6\u540c class object \u7684 member function int double(const Triangle &anothertriangle) const { this->scale(2.0); //\u4e0d\u884c, cout << this->perimeter(); //\u53ef\u4ee5 anothertriangle.scale(2.0); //\u4e5f\u4e0d\u884c, \u56e0\u4e3a anothertriangle \u662f\u4e00\u4e2a const reference cout << anothertriangle.perimeter(); //\u53ef\u4ee5 } 13.2.6 \u4e0d\u4f7f\u7528 this implement member function: compiler \u81ea\u52a8\u8865\u5168 class Triangle { private: double a, b, c; public: void scale(double s) { this->a *= s; this->b *= s; this->c *= s; } void shrink(double s) { this->scale(1.0 / s); } }; \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4e0d\u5199 this -> . compiler \u4f1a\u81ea\u52a8\u5e2e\u6211\u4eec\u8865\u5168 this -> . \u7b49\u4e8e\uff1a class Triangle { private: double a, b, c; public: void scale(double s) { a *= s; b *= s; c *= s; } void shrink(double s) { scale(1.0 / s); } }; 13.3 Member Accessibility (\u6216\u79f0 visibility) \u6211\u4eec\u77e5\u9053 private \u7684 member \u53ea\u80fd\u5728 class scope \u91cc access\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7 public member function \u6765 access. \u4f46\u662f\u6211\u4eec\u8981\u8865\u5145\u4e00\u70b9\u662f\uff1a**\u53ea\u8981\u662f\u540c\u4e00\u4e2a class\uff0c\u90a3\u4e48\u8fd9\u4e2a class \u5176\u4ed6 object \u7684 member \u4e5f\u53ef\u4ee5\u7531 member function access. \u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a member function \u4e0d\u53ea\u53ef\u4ee5\u7528 this -> access \u81ea\u5df1\u7684 private \u5c5e\u6027\uff0c\u8fd8\u53ef\u4ee5\u968f\u4fbf\u7528 . access \u5176\u4ed6\u540c\u7c7b object \u7684 private \u5c5e\u6027. ** \u6bd4\u5982\uff1a class Triangle { private: double a; double b; double c; public: bool isSame(const Triangle &someOtherTriangle) { return a == someOtherTriangle.a && b == someOtherTriangle.b && c == someOtherTriangle.c; // private\u7684, \u4f46\u662f\u53ef\u4ee5 } }; int main() { Triangle t1(3, 4, 5); Triangle t2(3, 4, 7); cout << t1.isSame(t2); // \u4e0d\u4f1a\u6709 error } \u8fd9\u5c31\u51f8\u663e\u4e86 class \u7684\u7075\u6d3b\u6027\u3002 13.4 Initialization Every object in C++ is initialized upon creation. explictly initialized c++ Triangle t1(3, 4, 5); Triangle t2 = Triangle(3, 4, 5); default initialized c++ Triangle t3; Atomic objects (int, double, bool, char, pointers) default initialization \u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c. Array objects default initialization \u7ed9\u6bcf\u4e2a\u5143\u7d20\u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c. Compound objects \u901a\u8fc7 default constructor \u6765 default initialization. \u8fd9\u4e2a constructor \u4e3a Triangle(){} , \u662f compiler \u81ea\u52a8\u52a0\u7684\uff0c\u7ed9\u6bcf\u4e2a member variable \u8d4b\u4e86 junk\u3002 \u4e00\u65e6\u4f60\u81ea\u5df1\u5199\u5199\u4e86\u5176\u4ed6 constructor\uff0c\u8fd9\u4e2a default \u5c31\u5931\u6548\u4e86\uff01\u8fd9\u4e2a\u65f6\u5019\u4f60\u518d Triangle t \u5c31\u4f1a\u62a5 error\uff01 int main() { int y; // contains junk int array2[3]; //each element contains junk Triangle t3; // \u6839\u636e default constructor } Triangle::Triangle(double a_in, double b_in, double c_in) { a = a_in; b = b_in; c = c_in; } int main() { Triangle t; // error! } 13.4.1 \u4f7f\u7528 member initializer list \u7684 Constructors \u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u4e00\u76f4\u4ee5\u6765\u4f7f\u7528\u7684\u50cf\u521a\u624d\u8fd9\u6837\u7684 constructors \u6709\u65f6\u5019\u662f**\u4f4e\u6548\u800c\u4e14\u751a\u81f3\u5728\u6709\u4e9b\u65f6\u5019\u662f\u4f1a\u51fa\u9519\u8bef\u7684\u3002 ** class Triangle { private: double a; double b; double c; public: Triangle(double a_in, double b_in, double c_in) { a = a_in; b = b_in; c = c_in; } }; \u6211\u4eec\u6709\u4e00\u4e2a\u66f4\u52a0\u9ad8\u6548\u7684\u65b9\u5f0f\u53eb\u505a member initializer list : class Triangle { private: double a; double b; double c; public: Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) {} //\u8fd9\u91cc\u7684\u987a\u5e8f\u4e0d\u91cd\u8981. {}\u91cc\u9762\u4e0d\u9700\u8981\u5199\u4e1c\u897f }; \u8fd9\u4e24\u4e2a constructor \u5728\u8fd9\u91cc\u5e76\u6ca1\u6709\u4f5c\u7528\u548c\u6027\u80fd\u4e0a\u7684\u533a\u522b\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u7684 class Triangle \u7684 member \u91cc\u5305\u542b\u4e86\u53e6\u4e00\u4e2a class \u578b\u7684\u53d8\u91cf\uff0c\u90a3\u4e48\u5c31\u51fa\u73b0\u4e86\u5f88\u5927\u7684\u533a\u522b\u3002 \u56e0\u4e3a\u5176\u5b9e compiler \u5bf9\u4e8e constructor \u4f1a\u81ea\u52a8\u52a0\u4e0a initializer list. \u8fd9\u4e2a\u81ea\u52a8\u7684 initializer list \u662f\u4e00\u4e2a\u53ea\u58f0\u660e\u53d8\u91cf\uff0c\u800c\u4e0d\u8d4b\u503c\u7684 list. \u5c31\u662f: // \u5bf9\u4e8e Triangle(double a_in, double b_in, double c_in) { a = a_in; b = b_in; c = c_in; } // compiler \u4f1a\u81ea\u52a8\u52a0\u4e0a initializer list, \u76f8\u5f53\u4e8e\uff1a Triangle(double a_in, double b_in, double c_in) : a, b, c { a = a_in; b = b_in; c = c_in; } \u5bf9\u4e8e int , double \u8fd9\u4e9b types \u7684\u7c7b\u6210\u5458\uff0ccompiler \u5e76\u4e0d\u4f1a\u7ed9\u5b83\u4eec\u8d4b\u9ed8\u8ba4\u503c\uff0c\u800c\u662f\u53ea\u662f\u58f0\u660e\u4e00\u4e2a\u8fd9\u6837\u7684\u53d8\u91cf\u3002\u6240\u4ee5\u4e0d\u8bba\u662f initializer list \u8fd8\u662f\u76f4\u63a5\u5199\u5728\u6846\u91cc\u90fd\u4e00\u6837\uff0c\u56e0\u4e3a\u8fd9\u4e0d\u4f1a\u6709\u6027\u80fd\u7684\u533a\u522b \u4f46\u662f\u81ea\u7136\u5730\uff0c\u5bf9\u4e8e class \u578b\u7684\u6210\u5458\uff0c\u8fd9\u4e2a default \u7684\u884c\u4e3a\u4f1a\u5148\u4f7f\u7528\u8be5 class \u6210\u5458\u7684 default constructor \u6765\u521d\u59cb\u5316\u8fd9\u4e2a\u6210\u5458\uff0c\u7136\u540e\u518d\u8fdb\u5165\u6846\u4f53\u3002\u56e0\u4e3a\u58f0\u660e class \u578b\u7684\u53d8\u91cf\u7684\u540c\u65f6\u5c31\u9ed8\u8ba4\u5b83\u88ab default constucted. \u6240\u4ee5\u8bf4\uff0c\u5982\u679c\u8fd9\u4e2a class \u7684\u6210\u5458\u4e2d\u5305\u62ec\u4e86\u53e6\u4e00\u4e2a class\uff0c\u90a3\u4e48 compiler \u5c31\u4f1a\u81ea\u52a8\u8c03\u7528\u8fd9\u4e2a\u53e6\u4e00\u4e2a class \u7684 default constructor \u6765\u8fdb\u884c initialize \u8fd9\u4e2a\u6210\u5458\u3002\u800c\u540e\uff0c\u6211\u4eec\u624d\u5728\u6846\u4f53\u4e2d\u91cd\u65b0\u7ed9\u8fd9\u4e2a class member \u8d4b\u65b0\u503c\u3002 \u8fd9\u6837\u7684\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5982\u679c\u8fd9\u4e2a\u4f5c\u4e3a\u6210\u5458\u7684 class \u5f88\u5927\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6d6a\u8d39\u4e86\u51e0\u4e4e\u4e00\u500d\u7684\u6027\u80fd\u3002 \u53e6\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5982\u679c\u8fd9\u4e2a\u4f5c\u4e3a\u6210\u5458\u7684 class \u53ea\u5199\u4e86\u5e26\u53c2\u6570\u7684 constructor \u800c\u5bfc\u81f4\u5b83\u5df2\u7ecf\u6ca1\u6709 default constructor \u4e86\uff0c\u90a3\u4e48\u5c31\u4f1a\u76f4\u63a5\u62a5\u9519\u3002\u5c3d\u7ba1\u6211\u4eec\u5728\u6846\u4f53\u91cc\u5199\u4e86\u8c03\u7528\u90a3\u4e2a\u5e26\u53c2\u6570\u7684 constructor \u6765\u521d\u59cb\u5316\u8fd9\u4e2a member\uff0c\u7531\u4e8e compiler \u81ea\u52a8\u5c1d\u8bd5\u8c03\u7528\u5b83\u7684 default constructor\uff0c\u8fd8\u662f\u53d1\u751f\u4e86\u9519\u8bef\u3002 \u800c initializer list \u5c31\u4f1a\u907f\u514d\u8fd9\u4e2a\u9519\u8bef\uff0c\u76f4\u63a5\u628a compiler \u81ea\u52a8\u5c1d\u8bd5\u8c03\u7528\u5b83\u7684 default constructor \u7684\u884c\u4e3a\u6362\u6210\u4e86\u8c03\u7528\u4f60\u9009\u5b9a\u7684\u6b63\u786e\u7684 constructor\u3002 13.4.2 \u591a\u4e2a Constructors class Triangle { private: double a; double b; double c; public: Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) {} Triangle(double side) : a(side), b(side), c(side) {} Triangle() :a(1), b(1), c(1) {} }; \u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a constructor\uff0c\u9488\u5bf9\u4e0d\u540c\u7684 arguments \u6570\u91cf\u3002 \u6ce8\u610f\uff1a \u4f7f\u7528 0-argument construtor \u7684\u5199\u6cd5\u6bd4\u8f83\u7279\u6b8a\uff0c\u662f\u5fc5\u987b\u5199 Triangle t; \u800c\u4e0d\u80fd\u5199 Triangle t(); \uff0c\u540e\u8005\u4f1a\u88ab compiler \u8ba4\u4e3a\u662f declare \u4e86\u4e00\u4e2a return Triangle \u7684 function \u53eb\u505a t \uff0c\u6ca1\u6709\u53c2\u6570\u3002 \u6ce8\u610f2\uff1a\u5982\u679c\u6211\u4eec\u6ca1\u6709\u5199\u67d0\u4e2a argument \u6570\u91cf\u7684 constructor\uff0c\u90a3\u5c31\u4e0d\u80fd\u7528\u3002\u6bd4\u5982\u8fd9\u91cc\u6211\u4eec\u6ca1\u6709\u5199\u4e24\u4e2a\u53c2\u6570\u7684 constructor\uff0c\u6240\u4ee5 Triangle t(3, 4); \u4f1a\u62a5\u9519\u3002 13.4.3 Classes \u4f5c\u4e3a members class Professor { private: string name; vector<string> students; Coffee facCoffee; Triangle favTriangle; public: Professor(const string &name) : name(name), favCoffee(0, 0, false); }; \u6709\u4e00\u70b9\u6ce8\u610f\u662f\uff0c\u6211\u4eec\u4e0d\u8981\u8fd9\u6837\u5199\uff1a Professor(const string &name) : name(name), favCoffee = Coffee(0, 0, false); \u56e0\u4e3a\u8fd9\u6837\u7684\u8bdd compiler \u5c31\u4f1a\u5148 default construct favCoffee \uff0c\u7136\u540e\u518d\u7528\u8fd9\u4e2a constructor \u6784\u5efa\uff0cwhich causes error because \u8fd9\u4e2a\u65f6\u5019\u5df2\u7ecf\u6ca1\u6709 default constructor \u4e86. 13.4.4 Check Invariants \u5e94\u8be5\u5199\u4e00\u4e2a respect interface \u7684\u51fd\u6570\uff0c\u5e76\u4e14\u585e\u5728 constructor \u91cc\u3002 class Triangle { private: double a; double b; double c; void check_invariants() { assert(0 < a && 0 < b && 0 < c); assert(a + b < c && a + c > b && b + c > a) } public: Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) { check_invariants(); } };","title":"Overview"},{"location":"13-ADT-in-C%2B%2B.html#13-adt-in-c","text":"struct \u662f C-style heterogeneous aggregate data type\uff0c\u800c class \u662f C++-style heterogeneous aggregate data type. struct \u548c class \u7684\u533a\u522b\u5728\u4e8e\uff1a struct \u7684 member variables \u5fc5\u987b call init function \u6765 initialize, \u800c class \u53ef\u4ee5\u5199 default constrctor \u81ea\u52a8 initialize struct \u7684\u6240\u6709 data \u90fd\u662f public by default \u7684\uff0c class \u7684\u6240\u6709 data \u90fd\u662f private by default \u7684. struct \u53ea\u5305\u542b member variables\uff0cfunctions \u662f technically separate \u7684\uff0c\u800c class \u5305\u542b\u4e86\u81ea\u5df1\u7684 member variables \u548c member functions. \u56e0\u800c\u7528 class \u53ef\u4ee5\uff1a \u2022 Enforce the interface \u2022 Maintain representation invariants","title":"13 ADT in C++"},{"location":"13-ADT-in-C%2B%2B.html#131-class-declaration","text":"\u683c\u5f0f\uff1a class Triangle { private: // private(\u4e00\u822c\u662fvariables/data) double a; double b; double c; public: // public(\u5927\u90e8\u5206functions) Triangle(double a_in, double b_in, double c_in) { ... } // Constructor(s) double perimeter() const { // \u6ce8\u610f\u4e0d\u6539\u53d8 member variables \u7684 function \u8981\u52a0 const ... } void scale(double s) { ... } }; // \u6ce8\u610f\u548cstruct\u4e00\u6837\u8981\u52a0semicolom! initialize \u4e00\u4e2a instance object\uff1a int main() { Triangle t1{3, 4, 5}; }","title":"13.1 Class Declaration"},{"location":"13-ADT-in-C%2B%2B.html#1311-class-object","text":"int main() { Triangle t1(3, 4, 5); Triangle t2 = t1; ... } \u80fd\u8fd9\u4e48\u505a\u3002","title":"13.1.1 \u524d\u60c5\u63d0\u8981: class \u578b\u7684 object \u53ef\u4ee5\u4f7f\u7528 = \u8d4b\u503c"},{"location":"13-ADT-in-C%2B%2B.html#132-calling-a-member-function","text":"\u4e00\u4e2a Class \u7684\u6bcf\u4e2a object \u90fd\u6709\u5b83\u81ea\u5df1\u7684 copy of each member variable. \u8c03\u7528 Class \u7684 member function \u603b\u662f\u5728\u67d0\u4e2a object \u4e0a\uff0c\u4f7f\u7528 . \u8c03\u7528\u3002\u6bd4\u5982 Triangle \u6709\u4e00\u4e2a member function \u53eb\u505a scale() \uff0c\u90a3\u4e48\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u8c03\u7528 scale() \uff0c\u800c\u662f\u5fc5\u987b\u5728\u67d0\u4e2a instance object \u4e0a\u8c03\u7528\uff0c\u6bd4\u5982 t1 \u662f\u4e00\u4e2a object\uff0c t1.scale() .","title":"13.2 Calling a member function"},{"location":"13-ADT-in-C%2B%2B.html#1321-this","text":"\u8bb0\u5f97\u5728 struct \u4e2d\uff0c\u6211\u4eec\u662f\u5148\u81ea\u5df1\u521b\u5efa\u67d0\u4e2a object \u7684\u4e00\u4e2a\u6307\u9488\u53d8\u91cf\u6216\u8005\u76f4\u63a5\u4f7f\u7528 &t1 \u628a\u5730\u5740\u4f20\u8fdb\u53bb\u4f5c\u4e3a\u4e00\u4e2a\u6307\u9488\u578b\u53d8\u91cf\uff0c\u7136\u540e\u628a\u5b83\u4f20\u7ed9\u4e00\u4e2a \u4ee5\u6307\u9488 Triangle *ptr \u4f5c\u4e3a\u53c2\u6570\u7684 function \uff0c\u8fd9\u4e2a function \u901a\u8fc7 ptr -> a \u8fd9\u6837\u4f7f\u7528 -> operator \u83b7\u53d6 \u4f20\u8fdb\u6765\u7684\u6307\u9488\u4f5c\u4e3a\u53c2\u6570\u6307\u5411\u5bf9\u8c61\u7684 member variable. \u800c class \u4e2d\u5c31\u4e0d\u540c\u3002\u6211\u4eec\u53ef\u4ee5\u5728 member functon \u4e2d\u4f7f\u7528 this \u8fd9\u4e2a\u5173\u952e\u8bcd\uff0c\u4f7f\u5f97\u5f53\u4e00\u4e2a object \u8c03\u7528\u8fd9\u4e2a function \u65f6 \u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u6307\u5411\u8fd9\u4e2a object \u7684\u6307\u9488 this \uff0c \u7136\u540e\u901a\u8fc7 this -> a \u8fd9\u6837\u4f7f\u7528 -> operator \u6765 access \u539f\u5bf9\u8c61\u53c2\u6570\u7684 member variable. The object on which a function is called is pointed to by the pointer named this . \u5c31\u662f\u8bf4\u5982\u679c\u6211\u4eec\u5728 member function \u4e2d\u7528 this \u8fd9\u4e2a\u5173\u952e\u8bcd\uff0c\u610f\u601d\u5c31\u662f this \u662f\u6307\u5411\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684 object \u7684\u4e00\u4e2a\u6307\u9488\u3002 void Triangle::scale(double s) { this -> a *= s; this -> b *= s; this -> c *= c; } int main() { Triangle t1(3, 4, 5); t1.scale(2); // 6 8 10 } \u5bf9\u6bd4\u4e00\u4e0b C-style ( struct ): void Triangle_scale(Triangle *tri, double s) { tri->a *= s; tri->b *= s; tri->c *= s; } int main() { Triangle t1; Triangle_init(&t1, 3, 4, 5); Triangle_scale(&t1, 2); // 6 8 10 }","title":"13.2.1 \u81ea\u52a8\u521b\u5efa\u7684 this \u4f5c\u4e3a\u6307\u9488\u53d8\u91cf"},{"location":"13-ADT-in-C%2B%2B.html#1322-const-function","text":"\u5728\u4f7f\u7528 struct \u7684\u51fd\u6570\u4e2d\u6211\u4eec\u5982\u679c\u9700\u8981\u4e0d\u6539\u53d8\u539f object \u5c31\u9700\u8981\u4f7f\u7528 pointer to const . double Triangle_perimeter(Triangle const *tri) { // pointer to const return tri->a + tri->b + tri->c; } int main() { Triangle t1; Triangle_init(&t1, 3, 4, 5); cout << Triangle_perimeter(&t1); // \u4f7f\u7528 & \u4f20\u5730\u5740\u4f5c\u4e3a\u6307\u9488\u53d8\u91cf } \u800c\u5728 class \u4e2d\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7ed9 member function \u52a0\u4e0a const \u8868\u793a\u5b83\u4e0d\u6539\u53d8\u8c03\u7528\u5b83\u7684\u539f object \u7684\u503c\u3002 double Triangle::perimeter() const{ // const function return this->a + this->b + this->c; } int main() { Triangle t1(3, 4, 5); cout << t1.perimeter(); // \u4e0d\u9700\u8981\u4f20\u5165\u5730\u5740 }","title":"13.2.2 const function"},{"location":"13-ADT-in-C%2B%2B.html#1323-this-member-variable-member-function","text":"int operation() { this -> scale(2.0); cout << this -> perimeter(); } this -> scale() \u5c31\u662f *(this).scale() . \u8868\u793a\u5728 member function \u91cc\u8c03\u7528\u5176\u4ed6 member function.","title":"13.2.3 this \u4e0d\u4ec5\u53ef\u4ee5 -&gt; member variable \u8fd8\u53ef\u4ee5 -&gt; member function"},{"location":"13-ADT-in-C%2B%2B.html#1324-const-const-object-const-member-function","text":"class Triangle { private: ... public: double scale(double s); double perimeter() const; ... } int main() { const Triangle t1(3, 4, 5); t1.scale(); // error, \u56e0\u4e3ascale\u4e0d\u662fconst function. \u5b83\u5728\u5c1d\u8bd5strip off t1's const cout << t1.perimeter(); //ok }","title":"13.2.4 const \u914d\u5bf9: const \u7684 object \u4e0d\u80fd\u4f7f\u7528\u975e const \u7684 member function"},{"location":"13-ADT-in-C%2B%2B.html#1325-class-object-member-function","text":"int double(const Triangle &anothertriangle) const { this->scale(2.0); //\u4e0d\u884c, cout << this->perimeter(); //\u53ef\u4ee5 anothertriangle.scale(2.0); //\u4e5f\u4e0d\u884c, \u56e0\u4e3a anothertriangle \u662f\u4e00\u4e2a const reference cout << anothertriangle.perimeter(); //\u53ef\u4ee5 }","title":"13.2.5 \u53c2\u6570\u5305\u542b\u5176\u4ed6\u540c class object \u7684 member function"},{"location":"13-ADT-in-C%2B%2B.html#1326-this-implement-member-function-compiler","text":"class Triangle { private: double a, b, c; public: void scale(double s) { this->a *= s; this->b *= s; this->c *= s; } void shrink(double s) { this->scale(1.0 / s); } }; \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4e0d\u5199 this -> . compiler \u4f1a\u81ea\u52a8\u5e2e\u6211\u4eec\u8865\u5168 this -> . \u7b49\u4e8e\uff1a class Triangle { private: double a, b, c; public: void scale(double s) { a *= s; b *= s; c *= s; } void shrink(double s) { scale(1.0 / s); } };","title":"13.2.6 \u4e0d\u4f7f\u7528 this implement member function: compiler \u81ea\u52a8\u8865\u5168"},{"location":"13-ADT-in-C%2B%2B.html#133-member-accessibility-visibility","text":"\u6211\u4eec\u77e5\u9053 private \u7684 member \u53ea\u80fd\u5728 class scope \u91cc access\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7 public member function \u6765 access. \u4f46\u662f\u6211\u4eec\u8981\u8865\u5145\u4e00\u70b9\u662f\uff1a**\u53ea\u8981\u662f\u540c\u4e00\u4e2a class\uff0c\u90a3\u4e48\u8fd9\u4e2a class \u5176\u4ed6 object \u7684 member \u4e5f\u53ef\u4ee5\u7531 member function access. \u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a member function \u4e0d\u53ea\u53ef\u4ee5\u7528 this -> access \u81ea\u5df1\u7684 private \u5c5e\u6027\uff0c\u8fd8\u53ef\u4ee5\u968f\u4fbf\u7528 . access \u5176\u4ed6\u540c\u7c7b object \u7684 private \u5c5e\u6027. ** \u6bd4\u5982\uff1a class Triangle { private: double a; double b; double c; public: bool isSame(const Triangle &someOtherTriangle) { return a == someOtherTriangle.a && b == someOtherTriangle.b && c == someOtherTriangle.c; // private\u7684, \u4f46\u662f\u53ef\u4ee5 } }; int main() { Triangle t1(3, 4, 5); Triangle t2(3, 4, 7); cout << t1.isSame(t2); // \u4e0d\u4f1a\u6709 error } \u8fd9\u5c31\u51f8\u663e\u4e86 class \u7684\u7075\u6d3b\u6027\u3002","title":"13.3 Member Accessibility (\u6216\u79f0 visibility)"},{"location":"13-ADT-in-C%2B%2B.html#134-initialization","text":"Every object in C++ is initialized upon creation. explictly initialized c++ Triangle t1(3, 4, 5); Triangle t2 = Triangle(3, 4, 5); default initialized c++ Triangle t3; Atomic objects (int, double, bool, char, pointers) default initialization \u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c. Array objects default initialization \u7ed9\u6bcf\u4e2a\u5143\u7d20\u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c. Compound objects \u901a\u8fc7 default constructor \u6765 default initialization. \u8fd9\u4e2a constructor \u4e3a Triangle(){} , \u662f compiler \u81ea\u52a8\u52a0\u7684\uff0c\u7ed9\u6bcf\u4e2a member variable \u8d4b\u4e86 junk\u3002 \u4e00\u65e6\u4f60\u81ea\u5df1\u5199\u5199\u4e86\u5176\u4ed6 constructor\uff0c\u8fd9\u4e2a default \u5c31\u5931\u6548\u4e86\uff01\u8fd9\u4e2a\u65f6\u5019\u4f60\u518d Triangle t \u5c31\u4f1a\u62a5 error\uff01 int main() { int y; // contains junk int array2[3]; //each element contains junk Triangle t3; // \u6839\u636e default constructor } Triangle::Triangle(double a_in, double b_in, double c_in) { a = a_in; b = b_in; c = c_in; } int main() { Triangle t; // error! }","title":"13.4 Initialization"},{"location":"13-ADT-in-C%2B%2B.html#1341-member-initializer-list-constructors","text":"\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u4e00\u76f4\u4ee5\u6765\u4f7f\u7528\u7684\u50cf\u521a\u624d\u8fd9\u6837\u7684 constructors \u6709\u65f6\u5019\u662f**\u4f4e\u6548\u800c\u4e14\u751a\u81f3\u5728\u6709\u4e9b\u65f6\u5019\u662f\u4f1a\u51fa\u9519\u8bef\u7684\u3002 ** class Triangle { private: double a; double b; double c; public: Triangle(double a_in, double b_in, double c_in) { a = a_in; b = b_in; c = c_in; } }; \u6211\u4eec\u6709\u4e00\u4e2a\u66f4\u52a0\u9ad8\u6548\u7684\u65b9\u5f0f\u53eb\u505a member initializer list : class Triangle { private: double a; double b; double c; public: Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) {} //\u8fd9\u91cc\u7684\u987a\u5e8f\u4e0d\u91cd\u8981. {}\u91cc\u9762\u4e0d\u9700\u8981\u5199\u4e1c\u897f }; \u8fd9\u4e24\u4e2a constructor \u5728\u8fd9\u91cc\u5e76\u6ca1\u6709\u4f5c\u7528\u548c\u6027\u80fd\u4e0a\u7684\u533a\u522b\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u7684 class Triangle \u7684 member \u91cc\u5305\u542b\u4e86\u53e6\u4e00\u4e2a class \u578b\u7684\u53d8\u91cf\uff0c\u90a3\u4e48\u5c31\u51fa\u73b0\u4e86\u5f88\u5927\u7684\u533a\u522b\u3002 \u56e0\u4e3a\u5176\u5b9e compiler \u5bf9\u4e8e constructor \u4f1a\u81ea\u52a8\u52a0\u4e0a initializer list. \u8fd9\u4e2a\u81ea\u52a8\u7684 initializer list \u662f\u4e00\u4e2a\u53ea\u58f0\u660e\u53d8\u91cf\uff0c\u800c\u4e0d\u8d4b\u503c\u7684 list. \u5c31\u662f: // \u5bf9\u4e8e Triangle(double a_in, double b_in, double c_in) { a = a_in; b = b_in; c = c_in; } // compiler \u4f1a\u81ea\u52a8\u52a0\u4e0a initializer list, \u76f8\u5f53\u4e8e\uff1a Triangle(double a_in, double b_in, double c_in) : a, b, c { a = a_in; b = b_in; c = c_in; } \u5bf9\u4e8e int , double \u8fd9\u4e9b types \u7684\u7c7b\u6210\u5458\uff0ccompiler \u5e76\u4e0d\u4f1a\u7ed9\u5b83\u4eec\u8d4b\u9ed8\u8ba4\u503c\uff0c\u800c\u662f\u53ea\u662f\u58f0\u660e\u4e00\u4e2a\u8fd9\u6837\u7684\u53d8\u91cf\u3002\u6240\u4ee5\u4e0d\u8bba\u662f initializer list \u8fd8\u662f\u76f4\u63a5\u5199\u5728\u6846\u91cc\u90fd\u4e00\u6837\uff0c\u56e0\u4e3a\u8fd9\u4e0d\u4f1a\u6709\u6027\u80fd\u7684\u533a\u522b \u4f46\u662f\u81ea\u7136\u5730\uff0c\u5bf9\u4e8e class \u578b\u7684\u6210\u5458\uff0c\u8fd9\u4e2a default \u7684\u884c\u4e3a\u4f1a\u5148\u4f7f\u7528\u8be5 class \u6210\u5458\u7684 default constructor \u6765\u521d\u59cb\u5316\u8fd9\u4e2a\u6210\u5458\uff0c\u7136\u540e\u518d\u8fdb\u5165\u6846\u4f53\u3002\u56e0\u4e3a\u58f0\u660e class \u578b\u7684\u53d8\u91cf\u7684\u540c\u65f6\u5c31\u9ed8\u8ba4\u5b83\u88ab default constucted. \u6240\u4ee5\u8bf4\uff0c\u5982\u679c\u8fd9\u4e2a class \u7684\u6210\u5458\u4e2d\u5305\u62ec\u4e86\u53e6\u4e00\u4e2a class\uff0c\u90a3\u4e48 compiler \u5c31\u4f1a\u81ea\u52a8\u8c03\u7528\u8fd9\u4e2a\u53e6\u4e00\u4e2a class \u7684 default constructor \u6765\u8fdb\u884c initialize \u8fd9\u4e2a\u6210\u5458\u3002\u800c\u540e\uff0c\u6211\u4eec\u624d\u5728\u6846\u4f53\u4e2d\u91cd\u65b0\u7ed9\u8fd9\u4e2a class member \u8d4b\u65b0\u503c\u3002 \u8fd9\u6837\u7684\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5982\u679c\u8fd9\u4e2a\u4f5c\u4e3a\u6210\u5458\u7684 class \u5f88\u5927\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6d6a\u8d39\u4e86\u51e0\u4e4e\u4e00\u500d\u7684\u6027\u80fd\u3002 \u53e6\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5982\u679c\u8fd9\u4e2a\u4f5c\u4e3a\u6210\u5458\u7684 class \u53ea\u5199\u4e86\u5e26\u53c2\u6570\u7684 constructor \u800c\u5bfc\u81f4\u5b83\u5df2\u7ecf\u6ca1\u6709 default constructor \u4e86\uff0c\u90a3\u4e48\u5c31\u4f1a\u76f4\u63a5\u62a5\u9519\u3002\u5c3d\u7ba1\u6211\u4eec\u5728\u6846\u4f53\u91cc\u5199\u4e86\u8c03\u7528\u90a3\u4e2a\u5e26\u53c2\u6570\u7684 constructor \u6765\u521d\u59cb\u5316\u8fd9\u4e2a member\uff0c\u7531\u4e8e compiler \u81ea\u52a8\u5c1d\u8bd5\u8c03\u7528\u5b83\u7684 default constructor\uff0c\u8fd8\u662f\u53d1\u751f\u4e86\u9519\u8bef\u3002 \u800c initializer list \u5c31\u4f1a\u907f\u514d\u8fd9\u4e2a\u9519\u8bef\uff0c\u76f4\u63a5\u628a compiler \u81ea\u52a8\u5c1d\u8bd5\u8c03\u7528\u5b83\u7684 default constructor \u7684\u884c\u4e3a\u6362\u6210\u4e86\u8c03\u7528\u4f60\u9009\u5b9a\u7684\u6b63\u786e\u7684 constructor\u3002","title":"13.4.1 \u4f7f\u7528 member initializer list \u7684 Constructors"},{"location":"13-ADT-in-C%2B%2B.html#1342-constructors","text":"class Triangle { private: double a; double b; double c; public: Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) {} Triangle(double side) : a(side), b(side), c(side) {} Triangle() :a(1), b(1), c(1) {} }; \u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a constructor\uff0c\u9488\u5bf9\u4e0d\u540c\u7684 arguments \u6570\u91cf\u3002 \u6ce8\u610f\uff1a \u4f7f\u7528 0-argument construtor \u7684\u5199\u6cd5\u6bd4\u8f83\u7279\u6b8a\uff0c\u662f\u5fc5\u987b\u5199 Triangle t; \u800c\u4e0d\u80fd\u5199 Triangle t(); \uff0c\u540e\u8005\u4f1a\u88ab compiler \u8ba4\u4e3a\u662f declare \u4e86\u4e00\u4e2a return Triangle \u7684 function \u53eb\u505a t \uff0c\u6ca1\u6709\u53c2\u6570\u3002 \u6ce8\u610f2\uff1a\u5982\u679c\u6211\u4eec\u6ca1\u6709\u5199\u67d0\u4e2a argument \u6570\u91cf\u7684 constructor\uff0c\u90a3\u5c31\u4e0d\u80fd\u7528\u3002\u6bd4\u5982\u8fd9\u91cc\u6211\u4eec\u6ca1\u6709\u5199\u4e24\u4e2a\u53c2\u6570\u7684 constructor\uff0c\u6240\u4ee5 Triangle t(3, 4); \u4f1a\u62a5\u9519\u3002","title":"13.4.2 \u591a\u4e2a Constructors"},{"location":"13-ADT-in-C%2B%2B.html#1343-classes-members","text":"class Professor { private: string name; vector<string> students; Coffee facCoffee; Triangle favTriangle; public: Professor(const string &name) : name(name), favCoffee(0, 0, false); }; \u6709\u4e00\u70b9\u6ce8\u610f\u662f\uff0c\u6211\u4eec\u4e0d\u8981\u8fd9\u6837\u5199\uff1a Professor(const string &name) : name(name), favCoffee = Coffee(0, 0, false); \u56e0\u4e3a\u8fd9\u6837\u7684\u8bdd compiler \u5c31\u4f1a\u5148 default construct favCoffee \uff0c\u7136\u540e\u518d\u7528\u8fd9\u4e2a constructor \u6784\u5efa\uff0cwhich causes error because \u8fd9\u4e2a\u65f6\u5019\u5df2\u7ecf\u6ca1\u6709 default constructor \u4e86.","title":"13.4.3 Classes \u4f5c\u4e3a members"},{"location":"13-ADT-in-C%2B%2B.html#1344-check-invariants","text":"\u5e94\u8be5\u5199\u4e00\u4e2a respect interface \u7684\u51fd\u6570\uff0c\u5e76\u4e14\u585e\u5728 constructor \u91cc\u3002 class Triangle { private: double a; double b; double c; void check_invariants() { assert(0 < a && 0 < b && 0 < c); assert(a + b < c && a + c > b && b + c > a) } public: Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) { check_invariants(); } };","title":"13.4.4 Check Invariants"},{"location":"14-Derived-Classes-and-Inheritance.html","text":"14 Derived Classes and Inheritance 14.1 Derived Classes 14.1.1 \u81ea\u52a8 inherit 14.1.2 \u6dfb\u52a0 member variables \u548c member functions 14.1.3 \u6dfb\u52a0 Derived Class \u81ea\u5df1\u7684 check invariant 14.1.4 Derived Class \u65e0\u6cd5 assess Base Class \u4e2d\u7684 Private members 14.1.5 keyword: protected \u8868\u793a\u5b50\u7c7b\u80fd\u591f access \u7684\u7236\u7c7b private member 14.1.6 Scope resoluton operator :: 14.2 Enums 14.3 Derived class constructor 14.3.1 Derived class \u7684 Constructor \u4f1a\u5728 initializer list \u4e2d\u81ea\u52a8\u8c03\u7528 Base Class \u7684 default constructor 14.3.2 \u901a\u8fc7 base class \u975edefault constructor \u6765\u5236\u4f5c derived class \u7684 default constructor \u7684 member initializer list 14.4 \u5728 Derived Class \u4e2d override base class \u7684 member functions 14.4.1 Override \u548c Overload \u7684\u533a\u522b 14.4.2 UML(unified modeling language) diagram 14 Derived Classes and Inheritance class Vehicle { private: int num_wheels; string color; int year; void check_invariant(); public: Vehicle(); Vehicle(int nw_in, string color__in, int year_in); double get_insurance_amount(); }; \u73b0\u5728\u6211\u4eec\u60f3\u8981\u521b\u5efa\u4e00\u4e2a Special type of Vehicles \u53eb\u505a Car \uff0c \u5bf9\u4e8e Car \uff0c\u6211\u4eec\u9700\u8981\u66f4\u591a\u7684\u53ea\u5c5e\u4e8e Car \u81ea\u5df1\u7684 Member functions\uff0c\u6bd4\u5982 replace_tires() \uff0c\u5176\u4ed6\u7684 Vehicles \u662f\u6ca1\u6709\u7684\u3002 \u5e76\u4e14\uff0c\u6211\u4eec\u9700\u8981\u66f4\u6362\u4e00\u4e9b member functions\uff0c\u6bd4\u5982 get_insurance_amount() \uff0c\u56e0\u4e3a Car \u7684 insurance \u548c\u5176\u4ed6 Vehicles \u662f\u4e0d\u4e00\u6837\u7684\u3002 \u4e8e\u662f\u6211\u4eec\u9700\u8981\u4e00\u4e2a Derived Class . 14.1 Derived Classes \u6211\u4eec\u7684 Vehicle class \u662f\u4e00\u4e2a base class \uff0c\u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u5b83\u5efa\u7acb\u4e00\u4e9b derived Classes . \u4e00\u4e2a Derived class \u53ef\u4ee5 inherit base class \u6240\u6709\u7684 member variables \u548c member functions. \u5e76\u4e14\u5b83\u8fd8\u53ef\u4ee5\u53ea\u5bf9\u4e8e\u81ea\u5df1\u8fd9\u4e2a derived class \u66f4\u6539\u548c\u6dfb\u52a0 member functions \u548c member variables\uff0c\u6765\u5efa\u7acb\u72ec\u7279\u7684 functioning \u548c invariants. class Bicycle: public Vehicle { // empty } \u8fd9\u91cc bicycle \u81ea\u52a8\u7ee7\u627f\u4e86\u6240\u6709\u7684 member variables \u548c functions of Vehicle \uff0c \u9664\u4e86 constructor\u4e4b\u5916 \u3002 14.1.1 \u81ea\u52a8 inherit 14.1.2 \u6dfb\u52a0 member variables \u548c member functions class Bicycle : public Vehicle { private: string type; // a new member variable public: Bicycle(); Bicycle(string color_in, int year_in, string type_in); void set_type(string type_in); }; string Bicycle::get_type() const { return type; } string Bicycle::set_type(string type_in) { type = type_in; } 14.1.3 \u6dfb\u52a0 Derived Class \u81ea\u5df1\u7684 check invariant class Bicycle : public Vehicle { private: string type; // a new member variable void Bicycle::check_invariant(); public: Bicycle(); Bicycle(string color_in, int year_in, string type_in); void set_type(string type_in); }; void Bicycle::check_invariant() { if(type == \"eBike\") {assert(year >= 1997 && year <= 2024);} } Bicycle::Bicycle() :color(\"red\"), year_in(1997), type_in(MOUNTAIN) {} Bicycle::Bicycle(string color_in, int year_in, string type_in) :color(color_in), year_in(year_in), type_in(type_in) { check_invariant(); // \u5bf9\u4e8e\u975e default \u7684 constructor, \u9700\u8981 check invariant\u4ee5\u9632\u6b62\u7834\u574f interface } 14.1.4 Derived Class \u65e0\u6cd5 assess Base Class \u4e2d\u7684 Private members class Vehicle { private: int num_wheels; string color; int year; ... public: int get_year(); void set_year(); ... } class Bicycle : public Vehicle { private: Bicycletype type; void check_invariant(); }; \u8fd9\u4e2a\u65f6\u5019\uff1a void Bicycle::check_invariants() { if(type == ELECTRIC) assert(year >= 1997 && year <= 2024); // error assert(get_year() >= 1997 && get_year() <= 2024); //\u53ef\u4ee5 } Bicycle \u7684\u786e\u7ee7\u627f\u4e86 year \u8fd9\u4e2a Base Class \u7684 member\uff0c\u4f46\u662f\u662f\u65e0\u6cd5 access \u7684\u3002\u5bf9\u4e8e\u7236\u7c7b\u7684 private mamber\uff0c\u5b50\u7c7b\u5fc5\u987b\u901a\u8fc7\u7236\u7c7b\u7684 public function \u6765 access. 14.1.5 keyword: protected \u8868\u793a\u5b50\u7c7b\u80fd\u591f access \u7684\u7236\u7c7b private member \u5bf9\u4e8e\u521a\u624d\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u529e\u6cd5\uff0c\u5c31\u662f\u628a\u6211\u4eec\u60f3\u8981\u8ba9\u5b50\u7c7b\u4e5f\u80fd\u591f access \u7684 private member \u8bbe\u7f6e\u6210 protected \u800c\u4e0d\u662f private . class Vehicle { protected: int year; int num_wheels; ... private: ... public: ... } \u603b\u7ed3\u4e00\u4e0b\uff1a member \u6709\u4e09\u79cd\u5b89\u5168\u6027\u7ea7\u522b\uff0c\u4ece\u4f4e\u5230\u9ad8\uff1a public : \u6240\u6709 code \u90fd\u80fd access. protected : \u8fd9\u4e2a class \u548c\u5b83\u6240\u6709\u7684 derived classes \u91cc\u7684 code \u90fd\u80fd access. private : \u53ea\u6709\u8fd9\u4e2a class \u91cc\u9762\u7684 code \u80fd\u591f access. 14.1.6 Scope resoluton operator :: \u6211\u4eec\u53ef\u4ee5\u5728 derived class \u4e2d call base class \u7684 functions\uff0c\u4f46\u662f\u5fc5\u987b\u8981\u52a0\u4e0a :: void Bicycle::check_invariants(){ Vehicle::check_invariants(); // \u8c03\u7528 base class \u91cc\u7684 functions if(type == ELECTRIC) { assert(get_year() >= 1997 && get_year() <= 2024); } } 14.2 Enums \u4e00\u4e2a enum \u5373 enumerated type\uff0c\u662f\u4e00\u79cd \u5b9a\u4e49 named int constants \u7684\u65b9\u6cd5\u3002 \u4e00\u4e2a enum \u7c7b\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5b83\u7684\u4e00\u4e2a object \u5c31\u662f\u4e00\u4e2a int \uff0c \u6211\u4eec\u5728\u8fd9\u4e2a enum \u4e2d\u7ed9\u51fa\u4e86\u4e00\u4e9b constants\uff0c\u8fd9\u4e9b constants\uff0c\u5982\u679c\u6ca1\u6709\u7279\u522b\u6307\u5b9a\u6bcf\u4e00\u4e2a\u5206\u914d\u7684 int \u503c\u662f\u591a\u5c11\uff0c\u4f1a\u88ab\u81ea\u52a8\u5206\u914d 0, 1, 2, ... \u7684\u503c. \u800c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u8be5 enum \u7c7b\u53d8\u91cf\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u7ed9\u4ed6\u8d4b\u4e00\u4e2a constant\u3002\u6bd4\u5982 Bicycletype a = MOUNTAIN \uff0c\u5c31\u662f\u628a MOUNTAIN \u8fd9\u4e2a constant \u4e5f\u5c31\u662f 0 \u8d4b\u7ed9\u4e86 a . enum \u7684\u76ee\u7684\u662f\u8ba9\u4ee3\u7801\u7ed3\u6784\u548c\u610f\u56fe\u66f4\u52a0\u6e05\u6670\u3002 enum Bicycletype { MOUNTAIN, ROAD, ELECTRIC, RACING }; class Bicycle : public Vehicle { private: Bicycletype type; // type \u662f\u4e00\u4e2a Bicycletype }; void Bicycle::check_invariants() { if(type == ELECTRIC) {assert(get_year() >= 1997 && get_year() <= 2024);} // \u5982\u679c type \u662f ELECTRIC \u4e5f\u5c31\u662f\u503c\u4e3a 2, \u90a3\u4e48\u6267\u884c\u8fd9\u4e2a\u51fd\u6570 } \u8fd9\u91cc Bicycletype \u662f\u4e00\u4e2a\u6211\u4eec\u5b9a\u4e49\u7684\u53d8\u91cf\u7c7b\u578b\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7c7b\u578b\u91cc\u6709 4 \u4e2a\u4e0d\u540c\u7684\u53ef\u9009\u503c\uff1a MOUNTAIN , ROAD , ELECTRIC \u548c RACING . \u5206\u522b\u5bf9\u5e94\u4e860\uff0c1\uff0c2\uff0c3\uff1b\u8fd9\u5c31\u50cf\u662f bool \u7c7b\u578b\u53ea\u6709 2 \u4e2a\u4e0d\u540c\u7684\u53ef\u9009\u503c True \u548c False \u5206\u522b\u5bf9\u5e94\u4e86 1 \u548c 0 \u4e00\u6837\u3002 14.3 Derived class constructor Constructors \u5e76\u4e0d\u4f1a\u88ab inherited. \u56e0\u800c Derived class \u4e5f\u9700\u8981\u81ea\u5df1\u7684 Constructor. \u4f46\u662f\uff0cConstructors \u4f1a\u81ea\u52a8 strat with the base class\uff0c\u4e5f\u5c31\u662f\u8bf4 Bicycle \u7684 constructor \u4e0d\u9700\u8981\u5199\u4efb\u4f55 Vehicle() \u7684 default constructor \u7684\u91cd\u590d\u5185\u5bb9\uff0c\u800c\u662f\u4f1a\u81ea\u52a8\u6dfb\u52a0\u3002\u6211\u4eec\u53ea\u9700\u8981\u5728 \u5176\u4e2d\u6dfb\u52a0 Bicycle \u7684\u72ec\u7279\u5c5e\u6027\u5c31\u53ef\u3002 14.3.1 Derived class \u7684 Constructor \u4f1a\u5728 initializer list \u4e2d\u81ea\u52a8\u8c03\u7528 Base Class \u7684 default constructor Bicycle::Bicycle() : type(MOUNTAIN) {} \u6211\u4eec\u8fd9\u91cc\u7ecf\u5386\u7684\u8fc7\u7a0b\u662f\uff1a 1) Implicitly calls default Vehicle constructor 2) Executes (rest of) Bicycle member initializer list 3) Executes Bicycle constructor body (\u8fd9\u91cc\u662f\u7a7a\u7684) \u800c\u6211\u4eec\u4e5f\u53ef\u4ee5 explicitly call Vehicle() \u7684 constructor. \u4e0b\u9762\u8fd9\u4e2a\u548c\u4e0a\u9762\u8fd9\u4e2a\u662f\u7b49\u4ef7\u7684\u3002 Bicycle::Bicycle() : Vehicle(), type(MOUNTAIN) {} \u6211\u4eec\u8fd9\u91cc\u7ecf\u5386\u7684\u8fc7\u7a0b\u662f\uff1a 1) Explicitly calls default Vehicle constructor 2) Executes (rest of) Bicycle member initializer list 3) Executes Bicycle constructor body (\u8fd9\u91cc\u662f\u7a7a\u7684) \u4e8e\u662f\u5982\u679c\u6211\u4eec\u6ca1\u6709\u4e13\u95e8 specify Bicycle \u8fd9\u4e2a derived class \u4e0e base class \u5728\u5171\u6709\u5c5e\u6027\u4e0a\u7684\u4e0d\u540c\uff0c\u8fd0\u884c\u5b83\u7684 constructor \u4e00\u5b9a\u4f1a\u7ee7\u627f Vehicle() \u7684 default constructor \u4e2d specify \u7684\u5c5e\u6027\u3002 14.3.2 \u901a\u8fc7 base class \u975edefault constructor \u6765\u5236\u4f5c derived class \u7684 default constructor \u7684 member initializer list \u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5199 Bicycle \u7684 default constructor: Bicycle::Bicycle() :Vehicle(2, \"black\", 2023), type(MOUNTAIN) {} \u8fd9\u91cc\u6211\u4eec\uff1a \u6211\u4eec\u8fd9\u91cc\u7ecf\u5386\u7684\u8fc7\u7a0b\u662f\uff1a 1) Explicitly calls non-default Vehicle constructor 2) Executes (rest of) Bicycle member initializer list 3) Executes Bicycle constructor body (\u8fd9\u91cc\u662f\u7a7a\u7684) \u4e8e\u662f\u6211\u4eec\u6bcf\u4e2a default \u7684 Bicycle \u90fd\u53d8\u6210\u4e86\u8fd9\u6837\u7684\uff1a \u6211\u4eec\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1amember initializer list \u662f\u5728 derived class \u7684 constructor \u4e2d\u8c03\u7528 base class \u7684\u552f\u4e00\u65b9\u6cd5\uff01\u5728\u6846\u4f53\u91cc\u8c03\u7528\u5c31\u4f1a\u51fa\u95ee\u9898\uff01 \u6bd4\u5982\u6211\u4eec: Bicycle::Bicycle() :type(MOUNTAIN) { Vehicle(2, \"black\", 2023), } \u8fd9\u91cc\u6211\u4eec\u5b9e\u9645\u4e0a\u662f create \u4e86\u4e00\u4e2a \u65b0\u7684 Vehicle object\uff0c\u5e76\u4e14\u9a6c\u4e0a\u628a\u5b83\u6254\u6389\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u7528 variable \u5b58\u5b83\uff08 Bicycle \u6ca1\u6709\u7c7b\u578b\u4e3a Vehicle \u7684 member variable\uff0c\u5e76\u4e14\u5373\u4fbf\u6709\uff0c\u8fd9\u6837\u4e5f\u6ca1\u5b58) \u6240\u4ee5\u8fd9\u4e2a initialization \u5e76\u4e0d\u6210\u529f\u3002 14.4 \u5728 Derived Class \u4e2d override base class \u7684 member functions class Vehicle { private: Vehicle(); Vehicle(string color_in,int year_in); int num_wheels; string color; int year; void check_invariant(); public: ... double get_insurance_amount(); }; class Bicycle : public Vehicle { public: Bicycle(); Bicycle(string color_in,int year_in); double get_insurance_amount(); private: double Bicycle::get_insurance_amount(){ return 5; } }; 14.4.1 Override \u548c Overload \u7684\u533a\u522b \u4e00\u4e2a Function override \u6307\u7684\u662f derived class \u7684 function\uff0c\u5176 name and prototype \u548c parent \u7684\u4e00\u6837. Vehicle::get_insurance_amount(); Bicycle::get_insurance_amount(); \u4e00\u4e2a Function overload \u6307\u7684\u662f\u540c\u4e00\u4e2a class \u4e2d\u4e24\u4e2a\u4e0d\u540c\u7684 function\uff0cname \u76f8\u540c\u4f46\u662f prototype \u4e0d\u4e00\u6837\uff0c\u8868\u793a\u5728\u63a5\u6536\u4e0d\u540c\u53c2\u6570\u65f6 function \u4e0d\u540c\u8868\u73b0\u3002 Vehicle::Vehicle(); Vehicle::Vehicle(int nw_in, string color_in, int year_in); \u6211\u4eec\u53ef\u4ee5\u5728 Derived class \u7684 override \u7684 function \u540e\u9762\u5199\u4e0a override \u3002\u8fd9\u4e2a\u662f optional \u7684\u4f46\u662f\u6709\u7528\u3002\u6709\u52a9\u4e8e catch mistakes\u3002 double get_insurance_amount() const override; 14.4.2 UML(unified modeling language) diagram","title":"Overview"},{"location":"14-Derived-Classes-and-Inheritance.html#14-derived-classes-and-inheritance","text":"class Vehicle { private: int num_wheels; string color; int year; void check_invariant(); public: Vehicle(); Vehicle(int nw_in, string color__in, int year_in); double get_insurance_amount(); }; \u73b0\u5728\u6211\u4eec\u60f3\u8981\u521b\u5efa\u4e00\u4e2a Special type of Vehicles \u53eb\u505a Car \uff0c \u5bf9\u4e8e Car \uff0c\u6211\u4eec\u9700\u8981\u66f4\u591a\u7684\u53ea\u5c5e\u4e8e Car \u81ea\u5df1\u7684 Member functions\uff0c\u6bd4\u5982 replace_tires() \uff0c\u5176\u4ed6\u7684 Vehicles \u662f\u6ca1\u6709\u7684\u3002 \u5e76\u4e14\uff0c\u6211\u4eec\u9700\u8981\u66f4\u6362\u4e00\u4e9b member functions\uff0c\u6bd4\u5982 get_insurance_amount() \uff0c\u56e0\u4e3a Car \u7684 insurance \u548c\u5176\u4ed6 Vehicles \u662f\u4e0d\u4e00\u6837\u7684\u3002 \u4e8e\u662f\u6211\u4eec\u9700\u8981\u4e00\u4e2a Derived Class .","title":"14 Derived Classes and Inheritance"},{"location":"14-Derived-Classes-and-Inheritance.html#141-derived-classes","text":"\u6211\u4eec\u7684 Vehicle class \u662f\u4e00\u4e2a base class \uff0c\u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u5b83\u5efa\u7acb\u4e00\u4e9b derived Classes . \u4e00\u4e2a Derived class \u53ef\u4ee5 inherit base class \u6240\u6709\u7684 member variables \u548c member functions. \u5e76\u4e14\u5b83\u8fd8\u53ef\u4ee5\u53ea\u5bf9\u4e8e\u81ea\u5df1\u8fd9\u4e2a derived class \u66f4\u6539\u548c\u6dfb\u52a0 member functions \u548c member variables\uff0c\u6765\u5efa\u7acb\u72ec\u7279\u7684 functioning \u548c invariants. class Bicycle: public Vehicle { // empty } \u8fd9\u91cc bicycle \u81ea\u52a8\u7ee7\u627f\u4e86\u6240\u6709\u7684 member variables \u548c functions of Vehicle \uff0c \u9664\u4e86 constructor\u4e4b\u5916 \u3002","title":"14.1 Derived Classes"},{"location":"14-Derived-Classes-and-Inheritance.html#1411-inherit","text":"","title":"14.1.1 \u81ea\u52a8 inherit"},{"location":"14-Derived-Classes-and-Inheritance.html#1412-member-variables-member-functions","text":"class Bicycle : public Vehicle { private: string type; // a new member variable public: Bicycle(); Bicycle(string color_in, int year_in, string type_in); void set_type(string type_in); }; string Bicycle::get_type() const { return type; } string Bicycle::set_type(string type_in) { type = type_in; }","title":"14.1.2 \u6dfb\u52a0 member variables \u548c member functions"},{"location":"14-Derived-Classes-and-Inheritance.html#1413-derived-class-check-invariant","text":"class Bicycle : public Vehicle { private: string type; // a new member variable void Bicycle::check_invariant(); public: Bicycle(); Bicycle(string color_in, int year_in, string type_in); void set_type(string type_in); }; void Bicycle::check_invariant() { if(type == \"eBike\") {assert(year >= 1997 && year <= 2024);} } Bicycle::Bicycle() :color(\"red\"), year_in(1997), type_in(MOUNTAIN) {} Bicycle::Bicycle(string color_in, int year_in, string type_in) :color(color_in), year_in(year_in), type_in(type_in) { check_invariant(); // \u5bf9\u4e8e\u975e default \u7684 constructor, \u9700\u8981 check invariant\u4ee5\u9632\u6b62\u7834\u574f interface }","title":"14.1.3 \u6dfb\u52a0 Derived Class \u81ea\u5df1\u7684 check invariant"},{"location":"14-Derived-Classes-and-Inheritance.html#1414-derived-class-assess-base-class-private-members","text":"class Vehicle { private: int num_wheels; string color; int year; ... public: int get_year(); void set_year(); ... } class Bicycle : public Vehicle { private: Bicycletype type; void check_invariant(); }; \u8fd9\u4e2a\u65f6\u5019\uff1a void Bicycle::check_invariants() { if(type == ELECTRIC) assert(year >= 1997 && year <= 2024); // error assert(get_year() >= 1997 && get_year() <= 2024); //\u53ef\u4ee5 } Bicycle \u7684\u786e\u7ee7\u627f\u4e86 year \u8fd9\u4e2a Base Class \u7684 member\uff0c\u4f46\u662f\u662f\u65e0\u6cd5 access \u7684\u3002\u5bf9\u4e8e\u7236\u7c7b\u7684 private mamber\uff0c\u5b50\u7c7b\u5fc5\u987b\u901a\u8fc7\u7236\u7c7b\u7684 public function \u6765 access.","title":"14.1.4 Derived Class \u65e0\u6cd5 assess Base Class \u4e2d\u7684 Private members"},{"location":"14-Derived-Classes-and-Inheritance.html#1415-keyword-protected-access-private-member","text":"\u5bf9\u4e8e\u521a\u624d\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u529e\u6cd5\uff0c\u5c31\u662f\u628a\u6211\u4eec\u60f3\u8981\u8ba9\u5b50\u7c7b\u4e5f\u80fd\u591f access \u7684 private member \u8bbe\u7f6e\u6210 protected \u800c\u4e0d\u662f private . class Vehicle { protected: int year; int num_wheels; ... private: ... public: ... } \u603b\u7ed3\u4e00\u4e0b\uff1a member \u6709\u4e09\u79cd\u5b89\u5168\u6027\u7ea7\u522b\uff0c\u4ece\u4f4e\u5230\u9ad8\uff1a public : \u6240\u6709 code \u90fd\u80fd access. protected : \u8fd9\u4e2a class \u548c\u5b83\u6240\u6709\u7684 derived classes \u91cc\u7684 code \u90fd\u80fd access. private : \u53ea\u6709\u8fd9\u4e2a class \u91cc\u9762\u7684 code \u80fd\u591f access.","title":"14.1.5 keyword: protected \u8868\u793a\u5b50\u7c7b\u80fd\u591f access \u7684\u7236\u7c7b private member"},{"location":"14-Derived-Classes-and-Inheritance.html#1416-scope-resoluton-operator","text":"\u6211\u4eec\u53ef\u4ee5\u5728 derived class \u4e2d call base class \u7684 functions\uff0c\u4f46\u662f\u5fc5\u987b\u8981\u52a0\u4e0a :: void Bicycle::check_invariants(){ Vehicle::check_invariants(); // \u8c03\u7528 base class \u91cc\u7684 functions if(type == ELECTRIC) { assert(get_year() >= 1997 && get_year() <= 2024); } }","title":"14.1.6 Scope resoluton operator ::"},{"location":"14-Derived-Classes-and-Inheritance.html#142-enums","text":"\u4e00\u4e2a enum \u5373 enumerated type\uff0c\u662f\u4e00\u79cd \u5b9a\u4e49 named int constants \u7684\u65b9\u6cd5\u3002 \u4e00\u4e2a enum \u7c7b\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5b83\u7684\u4e00\u4e2a object \u5c31\u662f\u4e00\u4e2a int \uff0c \u6211\u4eec\u5728\u8fd9\u4e2a enum \u4e2d\u7ed9\u51fa\u4e86\u4e00\u4e9b constants\uff0c\u8fd9\u4e9b constants\uff0c\u5982\u679c\u6ca1\u6709\u7279\u522b\u6307\u5b9a\u6bcf\u4e00\u4e2a\u5206\u914d\u7684 int \u503c\u662f\u591a\u5c11\uff0c\u4f1a\u88ab\u81ea\u52a8\u5206\u914d 0, 1, 2, ... \u7684\u503c. \u800c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u8be5 enum \u7c7b\u53d8\u91cf\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u7ed9\u4ed6\u8d4b\u4e00\u4e2a constant\u3002\u6bd4\u5982 Bicycletype a = MOUNTAIN \uff0c\u5c31\u662f\u628a MOUNTAIN \u8fd9\u4e2a constant \u4e5f\u5c31\u662f 0 \u8d4b\u7ed9\u4e86 a . enum \u7684\u76ee\u7684\u662f\u8ba9\u4ee3\u7801\u7ed3\u6784\u548c\u610f\u56fe\u66f4\u52a0\u6e05\u6670\u3002 enum Bicycletype { MOUNTAIN, ROAD, ELECTRIC, RACING }; class Bicycle : public Vehicle { private: Bicycletype type; // type \u662f\u4e00\u4e2a Bicycletype }; void Bicycle::check_invariants() { if(type == ELECTRIC) {assert(get_year() >= 1997 && get_year() <= 2024);} // \u5982\u679c type \u662f ELECTRIC \u4e5f\u5c31\u662f\u503c\u4e3a 2, \u90a3\u4e48\u6267\u884c\u8fd9\u4e2a\u51fd\u6570 } \u8fd9\u91cc Bicycletype \u662f\u4e00\u4e2a\u6211\u4eec\u5b9a\u4e49\u7684\u53d8\u91cf\u7c7b\u578b\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7c7b\u578b\u91cc\u6709 4 \u4e2a\u4e0d\u540c\u7684\u53ef\u9009\u503c\uff1a MOUNTAIN , ROAD , ELECTRIC \u548c RACING . \u5206\u522b\u5bf9\u5e94\u4e860\uff0c1\uff0c2\uff0c3\uff1b\u8fd9\u5c31\u50cf\u662f bool \u7c7b\u578b\u53ea\u6709 2 \u4e2a\u4e0d\u540c\u7684\u53ef\u9009\u503c True \u548c False \u5206\u522b\u5bf9\u5e94\u4e86 1 \u548c 0 \u4e00\u6837\u3002","title":"14.2 Enums"},{"location":"14-Derived-Classes-and-Inheritance.html#143-derived-class-constructor","text":"Constructors \u5e76\u4e0d\u4f1a\u88ab inherited. \u56e0\u800c Derived class \u4e5f\u9700\u8981\u81ea\u5df1\u7684 Constructor. \u4f46\u662f\uff0cConstructors \u4f1a\u81ea\u52a8 strat with the base class\uff0c\u4e5f\u5c31\u662f\u8bf4 Bicycle \u7684 constructor \u4e0d\u9700\u8981\u5199\u4efb\u4f55 Vehicle() \u7684 default constructor \u7684\u91cd\u590d\u5185\u5bb9\uff0c\u800c\u662f\u4f1a\u81ea\u52a8\u6dfb\u52a0\u3002\u6211\u4eec\u53ea\u9700\u8981\u5728 \u5176\u4e2d\u6dfb\u52a0 Bicycle \u7684\u72ec\u7279\u5c5e\u6027\u5c31\u53ef\u3002","title":"14.3 Derived class constructor"},{"location":"14-Derived-Classes-and-Inheritance.html#1431-derived-class-constructor-initializer-list-base-class-default-constructor","text":"Bicycle::Bicycle() : type(MOUNTAIN) {} \u6211\u4eec\u8fd9\u91cc\u7ecf\u5386\u7684\u8fc7\u7a0b\u662f\uff1a 1) Implicitly calls default Vehicle constructor 2) Executes (rest of) Bicycle member initializer list 3) Executes Bicycle constructor body (\u8fd9\u91cc\u662f\u7a7a\u7684) \u800c\u6211\u4eec\u4e5f\u53ef\u4ee5 explicitly call Vehicle() \u7684 constructor. \u4e0b\u9762\u8fd9\u4e2a\u548c\u4e0a\u9762\u8fd9\u4e2a\u662f\u7b49\u4ef7\u7684\u3002 Bicycle::Bicycle() : Vehicle(), type(MOUNTAIN) {} \u6211\u4eec\u8fd9\u91cc\u7ecf\u5386\u7684\u8fc7\u7a0b\u662f\uff1a 1) Explicitly calls default Vehicle constructor 2) Executes (rest of) Bicycle member initializer list 3) Executes Bicycle constructor body (\u8fd9\u91cc\u662f\u7a7a\u7684) \u4e8e\u662f\u5982\u679c\u6211\u4eec\u6ca1\u6709\u4e13\u95e8 specify Bicycle \u8fd9\u4e2a derived class \u4e0e base class \u5728\u5171\u6709\u5c5e\u6027\u4e0a\u7684\u4e0d\u540c\uff0c\u8fd0\u884c\u5b83\u7684 constructor \u4e00\u5b9a\u4f1a\u7ee7\u627f Vehicle() \u7684 default constructor \u4e2d specify \u7684\u5c5e\u6027\u3002","title":"14.3.1 Derived class \u7684 Constructor \u4f1a\u5728 initializer list \u4e2d\u81ea\u52a8\u8c03\u7528 Base Class \u7684 default constructor"},{"location":"14-Derived-Classes-and-Inheritance.html#1432-base-class-default-constructor-derived-class-default-constructor-member-initializer-list","text":"\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5199 Bicycle \u7684 default constructor: Bicycle::Bicycle() :Vehicle(2, \"black\", 2023), type(MOUNTAIN) {} \u8fd9\u91cc\u6211\u4eec\uff1a \u6211\u4eec\u8fd9\u91cc\u7ecf\u5386\u7684\u8fc7\u7a0b\u662f\uff1a 1) Explicitly calls non-default Vehicle constructor 2) Executes (rest of) Bicycle member initializer list 3) Executes Bicycle constructor body (\u8fd9\u91cc\u662f\u7a7a\u7684) \u4e8e\u662f\u6211\u4eec\u6bcf\u4e2a default \u7684 Bicycle \u90fd\u53d8\u6210\u4e86\u8fd9\u6837\u7684\uff1a \u6211\u4eec\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1amember initializer list \u662f\u5728 derived class \u7684 constructor \u4e2d\u8c03\u7528 base class \u7684\u552f\u4e00\u65b9\u6cd5\uff01\u5728\u6846\u4f53\u91cc\u8c03\u7528\u5c31\u4f1a\u51fa\u95ee\u9898\uff01 \u6bd4\u5982\u6211\u4eec: Bicycle::Bicycle() :type(MOUNTAIN) { Vehicle(2, \"black\", 2023), } \u8fd9\u91cc\u6211\u4eec\u5b9e\u9645\u4e0a\u662f create \u4e86\u4e00\u4e2a \u65b0\u7684 Vehicle object\uff0c\u5e76\u4e14\u9a6c\u4e0a\u628a\u5b83\u6254\u6389\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u7528 variable \u5b58\u5b83\uff08 Bicycle \u6ca1\u6709\u7c7b\u578b\u4e3a Vehicle \u7684 member variable\uff0c\u5e76\u4e14\u5373\u4fbf\u6709\uff0c\u8fd9\u6837\u4e5f\u6ca1\u5b58) \u6240\u4ee5\u8fd9\u4e2a initialization \u5e76\u4e0d\u6210\u529f\u3002","title":"14.3.2 \u901a\u8fc7 base class \u975edefault constructor \u6765\u5236\u4f5c derived class \u7684 default constructor \u7684 member initializer list"},{"location":"14-Derived-Classes-and-Inheritance.html#144-derived-class-override-base-class-member-functions","text":"class Vehicle { private: Vehicle(); Vehicle(string color_in,int year_in); int num_wheels; string color; int year; void check_invariant(); public: ... double get_insurance_amount(); }; class Bicycle : public Vehicle { public: Bicycle(); Bicycle(string color_in,int year_in); double get_insurance_amount(); private: double Bicycle::get_insurance_amount(){ return 5; } };","title":"14.4 \u5728 Derived Class \u4e2d override base class \u7684 member functions"},{"location":"14-Derived-Classes-and-Inheritance.html#1441-override-overload","text":"\u4e00\u4e2a Function override \u6307\u7684\u662f derived class \u7684 function\uff0c\u5176 name and prototype \u548c parent \u7684\u4e00\u6837. Vehicle::get_insurance_amount(); Bicycle::get_insurance_amount(); \u4e00\u4e2a Function overload \u6307\u7684\u662f\u540c\u4e00\u4e2a class \u4e2d\u4e24\u4e2a\u4e0d\u540c\u7684 function\uff0cname \u76f8\u540c\u4f46\u662f prototype \u4e0d\u4e00\u6837\uff0c\u8868\u793a\u5728\u63a5\u6536\u4e0d\u540c\u53c2\u6570\u65f6 function \u4e0d\u540c\u8868\u73b0\u3002 Vehicle::Vehicle(); Vehicle::Vehicle(int nw_in, string color_in, int year_in); \u6211\u4eec\u53ef\u4ee5\u5728 Derived class \u7684 override \u7684 function \u540e\u9762\u5199\u4e0a override \u3002\u8fd9\u4e2a\u662f optional \u7684\u4f46\u662f\u6709\u7528\u3002\u6709\u52a9\u4e8e catch mistakes\u3002 double get_insurance_amount() const override;","title":"14.4.1 Override \u548c Overload \u7684\u533a\u522b"},{"location":"14-Derived-Classes-and-Inheritance.html#1442-umlunified-modeling-language-diagram","text":"","title":"14.4.2 UML(unified modeling language) diagram"},{"location":"15-Polymorphism.html","text":"15 Polymorphism \u9898\u5916\u8bdd1: auto type \u9898\u5916\u8bdd2: vectors 15.1 Static type \u548c Dynamic type 15.1.1 Static type 15.1.2 Dynamic type: \u7531 derived classes \u5bfc\u81f4\u7684 runtime type 15.1.3 Static Binding 15.1.4 Virtual function and Dynamic Binding 15.2 Abstract Classes 15.2.1 Pure virtual function \u7eaf\u865a\u51fd\u6570 15.2.2 Abstract class \u62bd\u8c61\u7c7b 15.2.3 \u5c06 Abstract Class \u7684 ptr \u6216 ref \u53d8\u91cf\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570 15.2.4 Pure Abstract Class 15.3 \u5bb9\u7eb3 different derived classes \u7684 ptr/ref \u7684 container 15.4 Upcasting \u548c Downcasting 15.4.1 Upcasting 15.4.2 Downcasting 15.4.3 \u4e0d\u8981\u8fd9\u6837\u4f7f\u7528 dynamic_cast 15 Polymorphism \u9898\u5916\u8bdd1: auto type auto \u7684\u610f\u601d\u662f\u8ba9 compiler \u81ea\u5df1\u6839\u636e\u8bed\u5883\u5224\u65ad\u8fd9\u662f\u4e2a\u4ec0\u4e48 type. auto i = 5; auto d = 3.5; auto \u5728\u6bd4\u8f83\u65b0\u7684 C++ version \u91cc\u9762\u53ef\u4ee5\u7528\u4f5c parameter type. \u9898\u5916\u8bdd2: vectors std::vector \u652f\u6301\u4e00\u79cd\u7c7b\u4f3c\u4e8e python \u4e00\u6837\u7684\u904d\u5386\u65b9\u5f0f\uff1a std::vector<int> v = {10, 11, 12, 100}; // \u6b63\u5e38 for(int i = 0; i < int(v.size()); i++) std::cout << v[i] << endl; // \u7b80\u77ed for(int num: v) cout <<num << endl; // \u751a\u81f3 auto for (auto num: v) cout << num << endl; \u590d\u4e60\u4e00\u4e0b vector \u6dfb\u52a0\u5143\u7d20\u7684\u65b9\u5f0f\uff1a std::vector<int> v = {10, 11, 12, 100}; v.push_back(101); Vector \u53bb\u9664\u4e00\u4e2a\u5143\u7d20\u7684\u65b9\u5f0f\uff1a std::vector<int> vec = {10, 20, 30, 40, 50}; int index = 2; // \u5047\u8bbe\u6211\u4eec\u60f3\u8981\u79fb\u9664\u7d22\u5f15\u4e3a 2 \u7684\u5143\u7d20\uff08\u5373 30\uff09 // \u68c0\u67e5\u7d22\u5f15\u6709\u6548\u6027 if (index >= 0 && index < vec.size()) { vec.erase(vec.begin() + index); } 15.1 Static type \u548c Dynamic type \"Dynamic type\" \u662f\u56e0\u4e3a derived class \u7684\u51fa\u73b0\u800c\u5bfc\u81f4\u7684\u73b0\u8c61\u3002 \u53ea\u6709 1. pointer \u7c7b\u578b\u4ee5\u53ca 2. \u4f5c\u4e3a\u5f15\u7528\u7684 variables \u624d\u4f1a\u6709 dynamic type\uff01\uff01 \u7efc\u4e0a\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u6709 class \u7c7b\u578b\u7684 variables \u7684\u6307\u9488\u6216\u8005\u5f15\u7528\u53d8\u91cf\u624d\u6709 dynamic type \u8fd9\u4e2a\u8bf4\u6cd5. 15.1.1 Static type \u4e00\u4e2a variable \u7684 static type \u6307\u7684\u662f\u5b83\u5728 compile time \u7684 type\uff0c\u4e5f\u5c31\u662f\u6211\u4eec declare \u7684 type. Vehicle v; cout << v.get_insurance_amount(); Vehicle *v_ptr = &v; cout << v_ptr -> get_insurance_amount(); // 1, v_ptr \u7684 static type \u4e3a Vehicle *, \u8c03\u7528 Vehicle \u7684\u8be5\u51fd\u6570 Car c; cout << c.get_insurance_amount(); Car *c_ptr = &c; cout << c_ptr -> get_insurance_amount(); // 2, c_ptr \u7684 static type \u4e3a Car *, \u8c03\u7528 Car \u7684\u6210\u5458\u51fd\u6570 15.1.2 Dynamic type: \u7531 derived classes \u5bfc\u81f4\u7684 runtime type \u56e0\u4e3a Derived classes \u7684\u5b58\u5728\uff0c\u4e00\u4e9b variables (\u4e3b\u8981\u662f parameters) \u6709\u6f5c\u5728\u7684 dynamic type. \u4e00\u4e2a variable \u7684 dynamic type \u662f\u5b83\u5728 runtime \u65f6\u7684 type. \u6bd4\u5982\uff1a Animal* animal = new Dog(); \u8fd9\u91cc animal \u7684 static type \u662f Animal * \uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec declare \u5b83\u7684\u7c7b\u578b\u662f Animal * \uff1b\u800c\u5b83\u7684 dynamic type \u662f Dog * \uff0c\u56e0\u4e3a\u5b83 runtime \u65f6\u901a\u8fc7 new Dog() \u6210\u4e3a\u4e86 Dog * . \u4f5c\u4e3a\u51fd\u6570\u7684\u53c2\u6570\u7684\u53d8\u91cf\u7684 dynamic type \u53d6\u51b3\u4e8e what is passed. \u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u7684 parameter variable vp . void fp(Vehicle *vp) { //vp \u7684 static type \u662f Vehicle *, \u56e0\u4e3a\u6211\u4eec\u8fd9\u6837 declare cout << vp -> get_insurance_amount() << endl; } int main() { Vehicle mv; fp(&mv); //\u8fd9\u91cc parameter vp \u7684 dynamic type \u662f Vehicle *, \u56e0\u4e3a compile \u65f6\u4f20\u8fdb\u53bb\u7684\u7c7b\u578b\u662f\u4e2a Vehicle *. // \u7ed3\u679c\u662f 1 Car mc; fp(&mc); //\u8fd9\u91cc parameter vp \u7684 dynamic type \u662f Car *, \u56e0\u4e3a compile \u65f6\u4f20\u8fdb\u53bb\u7684\u7c7b\u578b\u662f\u4e2a Car *. // \u4f46\u662f\u7ed3\u679c\u8fd8\u662f 1 } \u8fd9\u91cc\u5c3d\u7ba1 vp \u7684 dynamic type \u662f Car * \uff0c\u6211\u4eec\u5bf9\u5b83\u4f7f\u7528\u7684\u4ecd\u7136\u662f Vehicle * \u7684\u51fd\u6570\uff0c\u8fd9\u662f\u56e0\u4e3a\u4e0b\u9762\u8bb2\u7684 Static Binding\u3002 15.1.3 Static Binding C++ \u4e2d\uff0cby default\uff0c\u5f53\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a variable \u7684\u6210\u5458\u51fd\u6570\uff08\u4ee5\u53ca\u6210\u5458\uff09\u65f6\uff0c\u4f7f\u7528\u7684\u662f\u5b83\u7684 static type \u5bf9\u5e94\u7684 class \u7684\u6210\u5458\u548c\u65b9\u6cd5\u3002\u8fd9\u53eb\u505a Static Binding . \uff08\u6ce8\u610f\u6210\u5458\u51fd\u6570\u4e5f\u53ea\u80fd\u63a5\u89e6\u5b83 static type \u7684\u6210\u5458\uff0c\u6bd4\u5982 Bicycle \u5982\u679c\u6709\u4e2a\u6210\u5458\u53eb a \u800c Vehicle \u6ca1\u6709\uff0c\u4e00\u4e2a\u53d8\u91cf\u7684 dynamic type \u662f Bicycle * \uff0c\u800c static type \u662f Vehicle * \uff0c\u90a3\u4e48 by default\uff0c\u5b83\u4e5f\u6ca1\u6cd5 access a \u8fd9\u4e2a\u6210\u5458\uff09\u3002 \u6bd4\u5982 void fp(Vehicle *vp) { cout << vp -> get_insurance_amount() << endl; } \u4e2d\uff0c\u5982\u679c\u6211\u4eec\uff1a Car mc; fp(&mc); \u6211\u4eec\u4f20\u7ed9 fp \u7684\u53c2\u6570 vp \u7684\u662f &mc \uff0c\u56e0\u800c vp \u8fd9\u4e2a\u6307\u9488\u53d8\u91cf\u7684 Static type \u662f Vehicle * \uff0cDynamic type \u662f Car * \uff1b \u800c\u7531\u4e8e Static Binding\uff0c get_insurance_amount() \u662f based on vp \u7684 Static type \u7684\uff0c\u4e5f\u5c31\u662f Vehicle \u7684\u5bf9\u5e94\u51fd\u6570\u3002\u56e0\u800c\u6211\u4eec\u7528\u7684\u662f Vehicle \u4e0b\u7684 get_insurance_amount() \u6210\u5458\u51fd\u6570\uff0c\u6240\u4ee5\u83b7\u5f97\u7ed3\u679c\u662f 1 \u800c\u4e0d\u662f 2 . \uff08\u9898\u5916\u8bdd\uff1aJava \u4e2d\u5219\u662f\u9ed8\u8ba4 dynamic binding \u7684\uff0c\u8fd9\u5c31\u662f\u8bed\u8a00\u7684\u4e0d\u540c\u3002\uff09 15.1.4 Virtual function and Dynamic Binding \"polymorph\" \u7684\u610f\u601d\u662f\u591a\u4e2a forms. Dynamic type \u5141\u8bb8\u4e86 polymorphism \u884c\u4e3a\u7684\u53d1\u751f\uff0c\u5373\u540c\u4e00\u4e2a interface \u53ef\u4ee5\u7528\u6765\u8c03\u7528\u4e0d\u540c\u7684 implementation\uff1b\u800c polymorphism \u7684\u4f7f\u7528\u65b9\u5f0f\u5c31\u662f virtual function\uff1a\u7ed9\u6210\u5458\u51fd\u6570\u52a0\u4e0a virtual \u8fd9\u4e2a\u5173\u952e\u8bcd\u3002 \u5f53\u7ed9 member function \u52a0\u4e0a virtual \u4e4b\u540e\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a dynamic binding \u7684\u51fd\u6570\u3002 \u8fd9\u5c31\u662f polymorphism \u7684\u51fd\u6570\uff0c\u56e0\u4e3a \u8c03\u7528\u5b83\u7684\u5b50\u7c7b\u578b\u662f\u54ea\u4e00\u4e2a\uff0c\u5b83\u5c31\u8868\u793a\u54ea\u4e00\u4e2a\u5b50\u7c7b\u578b\u7684 override \u51fd\u6570\u3002 class Vehicle { public: virtual double get_insurance_amount () const; ... } class Car : public Vehicle { public: double get_insurance_amount () const; ... } void fp(Vehicle *vp) { cout << vp -> get_insurance_amount() << endl; } // \u7531\u4e8e get_insurance_amount \u73b0\u5728\u662f\u4e00\u4e2a virtual function \u652f\u6301 dynamic binding, \u5b83\u73b0\u5728\u662f called on variable \u7684 dynamic type \u7684 int main() { Vehicle mv; fp(&mv); // 1 Car mc; fp(&mc); // 2 } \u8fd9\u91cc\u6709\u4e00\u4e9b\u70b9\u9700\u8981\u58f0\u660e\uff0cprofessor \u6839\u672c\u6ca1\u6709\u8bf4\u4f46\u662f\u7b14\u8005\u67e5\u9605\u4e4b\u540e\u89c9\u5f97\u58f0\u660e\u8fd9\u51e0\u70b9\u5bf9\u4e8e\u7406\u89e3\u8fd9\u4e2a\u4e1c\u897f\u662f\u5f88\u91cd\u8981\u7684\uff1a virtual \u5fc5\u987b\u4ece base class \u5f00\u59cb \uff0c\u4e0d\u5b58\u5728 derived class \u7684 override \u4e2d\u8fd9\u4e2a function \u662f virtual \u7684\u4f46\u662f base class \u4e2d\u540c\u4e00\u4e2a function \u5374\u4e0d\u662f\uff0c\u8fd9\u79cd\u53ef\u80fd\u6027\u3002 \u4e00\u65e6 base class \u4e2d\u4e00\u4e2a member function \u662f virtual \u7684\uff0c\u90a3\u4e48\u5b83\u7684 derived class \u4e2d\u6240\u6709\u8fd9\u4e2a\u51fd\u6570\u7684 override \u51fd\u6570\u81ea\u52a8\u53d8\u6210 virtual \u7684 \uff0c\u4e0d\u9700\u8981\u52a0\u4e0a virtual \u5173\u952e\u8bcd\u3002 \u5c31\u662f\u8bf4\uff1a\u4e00\u4e2a\u6210\u5458\u51fd\u6570\u8981\u4e48\u662f virtual \u7684\u8981\u4e48\u4e0d\u662f virtual \u7684\uff0c\u4e0d\u8bba\u600e\u4e48 override \u8fd9\u4e2a virtuality \u90fd\u4e0d\u53d8\uff01\u8fd9\u4e2a virtuality \u4e5f\u662f\u4f1a\u88ab\u7ee7\u627f\u7684\u3002 \uff08\u6240\u4ee5\u8bf4\uff0c\u5982\u679c\u4ece A \u7684\u4e00\u4e2a\u5b50\u7c7b B \u5f00\u59cb\u591a\u51fa\u4e86\u4e00\u4e2a\u65b0\u7684\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u628a\u5b83\u5b9a\u4e49\u4e3a virtual \u7684\uff0c\u8fd9\u6837\u8fd9\u4e2a B \u4f5c\u4e3a B \u7684\u5b50\u7c7b\u7684\u57fa\u7c7b\uff0c\u5b83\u7684\u5b50\u7c7b\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f dynamic binding \u7684.\uff09 \uff08\u9898\u5916\u8bdd\uff1a\u4e0a\u4e00\u8282\u6211\u4eec\u8bf4\u4e86\u867d\u7136 override \u5173\u952e\u8bcd\u662f\u53ef\u4ee5\u5ffd\u7565\u4e0d\u5199\u7684\uff0c\u4f46\u662f\u8fd8\u662f\u5efa\u8bae\u5199\uff0c\u8fd9\u662f\u56e0\u4e3a\u76f8\u5bf9\u4e8e override \u8fd8\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u5173\u952e\u8bcd final . \u4f7f\u7528 override \u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u68c0\u67e5\u8be5\u51fd\u6570\u662f\u5426\u771f\u7684\u8986\u76d6\u4e86\u57fa\u7c7b\u4e2d\u7684\u4e00\u4e2a\u865a\u51fd\u6570\u3002\u5982\u679c\u6ca1\u6709\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519\u3002 \u4f7f\u7528 final \u53ef\u4ee5\u963b\u6b62\u8fdb\u4e00\u6b65\u7684\u7ee7\u627f\u3002 \uff09 Exercise: ```c++ class Fruit { public: int f1() {return 1;} virtual int f2() {return 2;} }; class Citrus : public Fruit { public: int f1() {return 3;} int f2() override {return 4;} }; class Lemon : public Citrus { public: int f1() {return 5;} int f2() override {return 6;} }; int main() { Fruit fruit; Cirtrus citrus; Lemon lemon; Fruit fptr = &lemon; Citrus cptr = &citrus; cout << fruit.f2(); //2 cout << citrus.f1(); //3 cout << fptr -> f1(); //1, \u56e0\u4e3a fptr static \u4e3a Fruit , dynamic \u4e3a Lemon , f1 \u4e0d\u662f\u4e00\u4e2a virtual function \u56e0\u800c static binding, \u4f7f\u7528 Fruit \u7684 f1(); cout << fptr -> f2(); //6, \u56e0\u4e3a f2 \u662f\u4e00\u4e2a virtual function \u56e0\u800c dynamic binding, \u4f7f\u7528 Lemon \u7684 f2(); cout << cptr -> f2(); //4, cptr static \u548c dynamic \u90fd\u4e3a Citrus* cPtr = &lemon; //\u66f4\u6539 Citrus* \u7c7b\u578b\u7684\u53d8\u91cf cPtr \u7684\u503c\u4e3a\u6307\u5411 Citrus \u7684\u5b50\u7c7b Lemon \u7684\u4e00\u4e2a object \u7684\u503c, \u6ce8\u610f\u8fd9\u662f\u53ef\u884c\u7684!!! cout << cptr -> f1; //3, \u56e0\u4e3a\u73b0\u5728 cptr static \u4e3a Citrus \u800c dynamic \u4e3a Lemon , f1 \u4e0d\u662f\u4e00\u4e2a virtual function \u56e0\u800c static binding, \u4f7f\u7528 Cirtrus \u7684 f1(); cout << cptr -> f2; //6, f2 \u662f\u4e00\u4e2a virtual function \u56e0\u800c dynamic binding, \u4f7f\u7528 Lemon \u7684 f2(); } ``` \u4e00\u4e2a polymorphic object\uff08\u591a\u6001\u5bf9\u8c61\uff09 \u662f\u81f3\u5c11\u6709\u4e00\u4e2a virtual function \u7684 Class \u7684 \u4e00\u4e2a instance. 15.2 Abstract Classes 15.2.1 Pure virtual function \u7eaf\u865a\u51fd\u6570 \u4e00\u4e2a pure virtual function \u6307\u7684\u662f\u4e00\u4e2a\u4ee5 =0 \u4e3a\u7ed3\u5c3e declare \u7684 function\u3002\u8fd9\u4e2a\u7ed3\u5c3e\u58f0\u660e\u8868\u793a\u8fd9\u4e2a function \u662f\u6ca1\u6709\u5b9a\u4e49\u7684\uff0c\u8fd9\u5c31\u662f\u201cpure virtual\"\u7684\u610f\u601d\u3002 \u8fd9\u6837\u7684\u4e00\u4e2a function \u5728 Base class \u4e2d\u662f \u4e0d\u80fd\u6709 implementation \u7684\uff0c\u5e76\u4e14 \u8981\u6c42\u6240\u6709\u7684 non-abstract derived Class \u63d0\u4f9b\u4e00\u4e2a implementation. Derived classes \u7684 implementation \u4e2d\uff0coverride \u7684\u51fd\u6570\u5c31\u4e0d\u662f\u4e00\u4e2a pure virtual function \u4e86\uff0c\u7ed3\u5c3e\u4e5f\u6ca1\u6709 =0 . pure virtual function \u7684\u4e3b\u8981\u76ee\u7684\u662f\u5b9a\u4e49\u4e00\u4e2a interface\uff0c\u5f3a\u5236 derived classes \u9075\u5faa\u67d0\u79cd si nature \uff08\u8bbe\u8ba1\u534f\u8bae\uff09\uff1b\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0cbase class \u5b9a\u4e49\u4e86\u4e00\u4e2a\u6709\u5f85\u6d3e\u751f\u7c7b implemnent \u7684\u51fd\u6570\u6846\u67b6\uff0c\u4ece\u800c\u5b9e\u73b0 polymorphism\u3002 class Shape { public: virtual double area() const = 0; // pure virtual function ... }; class Circle : public Shape { private: double radius; public: Circle(double r) : radius(r) {} double area() const override { // pure virtual function override return 3.14159 * radius * radius; } }; 15.2.2 Abstract class \u62bd\u8c61\u7c7b \u4e00\u4e2a abstract class \u6307\u5305\u542b\u81f3\u5c11\u4e00\u4e2a pure virtual function \u7684 class. \u4e00\u4e2a abstract class \u662f\u65e0\u6cd5 instantiate (\u5b9e\u4f8b\u5316) \u7684\uff0c\u56e0\u800c\u4e5f\u65e0\u6cd5\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u3002 class Vehicle { ... virtual double get_insurance_amount() const = 0; }; // \u65e0\u6cd5 instantiate Vehicle v; //error void f(Vehicle v) { //error: object slicing ... } (\u5728C++\u4e2d\uff0c\"object slicing\"\uff08\u5bf9\u8c61\u5207\u7247\uff09\u662f\u6307\u5f53\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\u88ab\u8d4b\u503c\u7ed9\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u65f6\uff0c\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e2d\u8d85\u51fa\u57fa\u7c7b\u90e8\u5206\u7684\u4fe1\u606f\u4f1a\u88ab\u5207\u9664\u7684\u73b0\u8c61\u3002\u8fd9\u901a\u5e38\u53d1\u751f\u5728\u901a\u8fc7\u503c\u4f20\u9012\u5bf9\u8c61\u7ed9\u51fd\u6570\uff0c\u6216\u8005\u4ece\u51fd\u6570\u8fd4\u56de\u5bf9\u8c61\u65f6\uff0c\u4ee5\u53ca\u5728\u8d4b\u503c\u64cd\u4f5c\u4e2d\u3002) 15.2.3 \u5c06 Abstract Class \u7684 ptr \u6216 ref \u53d8\u91cf\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570 \u6211\u4eec\u521a\u624d\u8bf4\u5230\uff0c\u4e00\u4e2a abstract class \u65e0\u6cd5 instantiate\uff0c\u4e5f\u65e0\u6cd5\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\uff1b \u4f46\u662f \u4e00\u4e2a ptr or ref to an abstract class type \u5219\u53ef\u4ee5\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u6570\u3002 int main() { // Vehicle \u662f\u4e00\u4e2a abstract class, Car \u662f\u5b83\u7684\u4e00\u4e2a derived class Car c; Vehicle * vp = &c; // ptr Vehicle & vr = c; // ref fp(&c); fp(vp); fp(&vr); fr(c); fr(*vp); fr(vr); } void fp(Vehicle * v) { cout << v->get_insurance_amount() << endl; } void fr(Vehicle & v) { cout << v.get_insurance_amount() << endl; } \u6211\u4eec\u53d1\u73b0\uff0c\u5176\u5b9e\u6211\u4eec\u662f\u9700\u8981\u5efa\u7acb\u4e00\u4e2a abstract class \u7684 non-abstract derived class \u7684 instance\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u6307\u5411 abstract base class \u7684 ref \u6216 ptr \u578b\u53d8\u91cf\u6765\u6307\u5411\u5b83\uff0c\u4ece\u800c\u5b9e\u73b0 polymorphism\u3002 **\u53ef\u4ee5\u770b\u5230\u8fd9\u5c31\u662f polymorphism \u7684\u5de5\u4f5c\u65b9\u5f0f\u3002\u6211\u4eec\u7684 virtual member function \u662f\u57fa\u4e8e\u62bd\u8c61\u57fa\u7c7b\u7684\uff0c\u4f46\u662f\u5f53\u6211\u4eec\u5199\u4e00\u4e9b\u53c2\u6570\u662f\u62bd\u8c61\u57fa\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u7684\u51fd\u6570\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4efb\u4f55\u5b83\u7684\u975e\u62bd\u8c61\u5b50\u7c7b\u4f20\u9012\u7ed9\u8fd9\u4e2a\u51fd\u6570\uff0c\u5e76\u4e14\u4f1a\u4f7f\u7528\u8fd9\u4e9b\u5b50\u7c7b\u7684 member\uff0c\u4ece\u800c\u53ea\u7528\u4e86\u4e00\u4e2a\u51fd\u6570\u5c31\u6db5\u76d6\u4e86\u6240\u6709\u5b50\u7c7b\u7684\u4e0d\u540c\u60c5\u51b5\uff0c\u8fd9\u5c31\u662f polymorphism. ** 15.2.4 Pure Abstract Class \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a abstract class \u867d\u7136\u4e0d\u80fd instantiate\uff0c\u4f46\u5982\u679c\u6709 data member\uff0c\u5219\u4ecd\u7136\u9700\u8981\u4e00\u4e2a constructor\u3002\u8fd9\u662f\u56e0\u4e3a\u6240\u6709 instances of a derived class \u90fd\u662f\u4ece construct base class \u5f00\u59cb\u7684\u3002 class Bicycle : public Vehicle { //... Bicycle(){ cout << \"Bicycle default ctor\\n\";} Bicycle(int year_in) : year(year_in) {cout << \" Bicycle int ctor\\n\";} }; // \u8bbe\u6211\u4eec\u5bf9 base class \u548c\u5176\u4ed6\u6240\u6709 derived classes \u4e5f\u8fd9\u6837 int main() { ElectricCar e1; // \u8f93\u51fa: // Vehicle default ctor // Car default ctor // ElectricCar default ctor ElectricCar e2(1); // \u8f93\u51fa: // Vehicle default ctor // Car default ctor // ElectricCar int ctor } \u4f46\u662f\u6211\u4eec\u6709\u4e00\u4e2a\u65b0\u7684\u5b9a\u4e49\uff1a pure abstract class \uff0c\u6307 \u6240\u6709\u51fd\u6570\u90fd\u662f abstract functions\uff0c\u5e76\u4e14\u6ca1\u6709 data members \u7684 class. pure abstract class \u5c31\u662f\u4e00\u4e2a\u7eaf interface\uff0c\u4e0d\u9700\u8981\u5199 constructor\uff1b\u5e76\u4e14 compiler \u4f1a\u81ea\u52a8 implicitly \u4e3a pure abstract class \u63d0\u4f9b\u4e00\u4e2a default constructor\u3002\uff08\u666e\u901a\u7684 abstract class \u4e0d\u4f1a\u8fd9\u6837\uff09 15.3 \u5bb9\u7eb3 different derived classes \u7684 ptr/ref \u7684 container Polymorphism \u7684\u53e6\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u6307\u5411\u4e00\u4e2a base class \u7684\u4e0d\u540c derived classes \u7684 objects \u7684 ptr/ref \u653e\u5728\u540c\u4e00\u4e2a\u57fa\u7c7b\u7684 ptr/ref \u7684 container \u91cc\u9762\u3002 Car c(2); Bicycle b(1); ElectricCar e(5); vector<Vehicle*> fleet = {&c, &b, &e}; double monthly_cost = 0; for (auto veh:fleet) monthly_cost += veh->get_insurance_amount(); cout << \"total insurance cost = \" << monthly_cost << \"\\n\"; //\u6839\u636edynamic type \u5bf9\u5e94\u7684 member function \u4ea7\u751f\u4e0d\u540c\u7ed3\u679c \uff08\u5176\u5b9e\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u628a\u4e0d\u540c\u5b50\u7c7b objects \u653e\u8fdb\u540c\u4e00\u4e2a container\uff0c\u4f46\u662f\u8fd9\u4f1a\u5bfc\u81f4 object slicing.\uff09 15.4 Upcasting \u548c Downcasting 15.4.1 Upcasting Bicycle b; Vehicle* vp = &b; //upcasting \u8fd9\u5c31\u662f\u4e00\u4e2a upcasting. \u73b0\u5728 vp \u7684 static type \u4e3a Vehicle* \uff0cdynamic type \u4e3a Bicycle* . 15.4.2 Downcasting Downcasting \u5c1d\u8bd5 move down the class hierachy. Bicycle b; Vehicle* vp = &b; //upcasting Bicycle* bp = vp; //\u5c1d\u8bd5downcast, \u4f46\u662ferror compiler \u62a5\u9519\u7684\u539f\u56e0\u662f\u8fd9\u79cd\u505a\u6cd5\u6709\u6f5c\u5728\u7684\u98ce\u9669\uff0c\u6bd4\u5982\uff1a Bicycle b; Vehicle* vp = &b; //upcasting Car c; vp = &c; Bicycle* bp = vp; //\u5982\u679c\u5141\u8bb8\u8fd9\u6837downcast\u90a3\u8fd9\u4e2a\u65f6\u5019\u5c31\u4e0d\u5bf9\u4e86 \u56e0\u800c\u6709\u4e00\u4e2afunction dynamic_cast<Derived*>() \u4f5c\u4e3a downcasting \u7684\u9014\u5f84\u3002 Bicycle b; Vehicle* vp = &b; //upcasting Bicycle* bp = dynamic_cast<Bicycle*>(vp); //downcast \u5982\u679c cast fail \u4e86\uff0c\u90a3\u4e48 bp \u4f1a\u6210\u4e3a\u4e00\u4e2a nullptr \u5982\u679c\u6211\u4eec\u60f3 dynamic_cast \u4e00\u4e2a ref \u800c\u4e0d\u662f ptr\uff0c\u90a3\u4e48\u5982\u679c cast fail \u4e86\u5c31\u4f1a\u62a5\u9519\u3002 15.4.3 \u4e0d\u8981\u8fd9\u6837\u4f7f\u7528 dynamic_cast if(it_is_ElectricCar) do_electric_thing(); else if(it_is_car) do_car_thing; else ... \u56e0\u4e3a\u5982\u679c\u8981\u7ed9\u8fd9\u4e2a hierarchy \u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684 class\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u627e\u5230\u6240\u6709\u8fd9\u6837\u7684\u4ee3\u7801\u5e76\u628a\u8fd9\u4e2a\u65b0 class \u7684\u4e1c\u897f\u52a0\u8fdb\u53bb\u3002","title":"Overview"},{"location":"15-Polymorphism.html#15-polymorphism","text":"","title":"15 Polymorphism"},{"location":"15-Polymorphism.html#1-auto-type","text":"auto \u7684\u610f\u601d\u662f\u8ba9 compiler \u81ea\u5df1\u6839\u636e\u8bed\u5883\u5224\u65ad\u8fd9\u662f\u4e2a\u4ec0\u4e48 type. auto i = 5; auto d = 3.5; auto \u5728\u6bd4\u8f83\u65b0\u7684 C++ version \u91cc\u9762\u53ef\u4ee5\u7528\u4f5c parameter type.","title":"\u9898\u5916\u8bdd1: auto type"},{"location":"15-Polymorphism.html#2-vectors","text":"std::vector \u652f\u6301\u4e00\u79cd\u7c7b\u4f3c\u4e8e python \u4e00\u6837\u7684\u904d\u5386\u65b9\u5f0f\uff1a std::vector<int> v = {10, 11, 12, 100}; // \u6b63\u5e38 for(int i = 0; i < int(v.size()); i++) std::cout << v[i] << endl; // \u7b80\u77ed for(int num: v) cout <<num << endl; // \u751a\u81f3 auto for (auto num: v) cout << num << endl; \u590d\u4e60\u4e00\u4e0b vector \u6dfb\u52a0\u5143\u7d20\u7684\u65b9\u5f0f\uff1a std::vector<int> v = {10, 11, 12, 100}; v.push_back(101); Vector \u53bb\u9664\u4e00\u4e2a\u5143\u7d20\u7684\u65b9\u5f0f\uff1a std::vector<int> vec = {10, 20, 30, 40, 50}; int index = 2; // \u5047\u8bbe\u6211\u4eec\u60f3\u8981\u79fb\u9664\u7d22\u5f15\u4e3a 2 \u7684\u5143\u7d20\uff08\u5373 30\uff09 // \u68c0\u67e5\u7d22\u5f15\u6709\u6548\u6027 if (index >= 0 && index < vec.size()) { vec.erase(vec.begin() + index); }","title":"\u9898\u5916\u8bdd2: vectors"},{"location":"15-Polymorphism.html#151-static-type-dynamic-type","text":"\"Dynamic type\" \u662f\u56e0\u4e3a derived class \u7684\u51fa\u73b0\u800c\u5bfc\u81f4\u7684\u73b0\u8c61\u3002 \u53ea\u6709 1. pointer \u7c7b\u578b\u4ee5\u53ca 2. \u4f5c\u4e3a\u5f15\u7528\u7684 variables \u624d\u4f1a\u6709 dynamic type\uff01\uff01 \u7efc\u4e0a\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u6709 class \u7c7b\u578b\u7684 variables \u7684\u6307\u9488\u6216\u8005\u5f15\u7528\u53d8\u91cf\u624d\u6709 dynamic type \u8fd9\u4e2a\u8bf4\u6cd5.","title":"15.1 Static type \u548c Dynamic type"},{"location":"15-Polymorphism.html#1511-static-type","text":"\u4e00\u4e2a variable \u7684 static type \u6307\u7684\u662f\u5b83\u5728 compile time \u7684 type\uff0c\u4e5f\u5c31\u662f\u6211\u4eec declare \u7684 type. Vehicle v; cout << v.get_insurance_amount(); Vehicle *v_ptr = &v; cout << v_ptr -> get_insurance_amount(); // 1, v_ptr \u7684 static type \u4e3a Vehicle *, \u8c03\u7528 Vehicle \u7684\u8be5\u51fd\u6570 Car c; cout << c.get_insurance_amount(); Car *c_ptr = &c; cout << c_ptr -> get_insurance_amount(); // 2, c_ptr \u7684 static type \u4e3a Car *, \u8c03\u7528 Car \u7684\u6210\u5458\u51fd\u6570","title":"15.1.1 Static type"},{"location":"15-Polymorphism.html#1512-dynamic-type-derived-classes-runtime-type","text":"\u56e0\u4e3a Derived classes \u7684\u5b58\u5728\uff0c\u4e00\u4e9b variables (\u4e3b\u8981\u662f parameters) \u6709\u6f5c\u5728\u7684 dynamic type. \u4e00\u4e2a variable \u7684 dynamic type \u662f\u5b83\u5728 runtime \u65f6\u7684 type. \u6bd4\u5982\uff1a Animal* animal = new Dog(); \u8fd9\u91cc animal \u7684 static type \u662f Animal * \uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec declare \u5b83\u7684\u7c7b\u578b\u662f Animal * \uff1b\u800c\u5b83\u7684 dynamic type \u662f Dog * \uff0c\u56e0\u4e3a\u5b83 runtime \u65f6\u901a\u8fc7 new Dog() \u6210\u4e3a\u4e86 Dog * . \u4f5c\u4e3a\u51fd\u6570\u7684\u53c2\u6570\u7684\u53d8\u91cf\u7684 dynamic type \u53d6\u51b3\u4e8e what is passed. \u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2a\u51fd\u6570\u7684 parameter variable vp . void fp(Vehicle *vp) { //vp \u7684 static type \u662f Vehicle *, \u56e0\u4e3a\u6211\u4eec\u8fd9\u6837 declare cout << vp -> get_insurance_amount() << endl; } int main() { Vehicle mv; fp(&mv); //\u8fd9\u91cc parameter vp \u7684 dynamic type \u662f Vehicle *, \u56e0\u4e3a compile \u65f6\u4f20\u8fdb\u53bb\u7684\u7c7b\u578b\u662f\u4e2a Vehicle *. // \u7ed3\u679c\u662f 1 Car mc; fp(&mc); //\u8fd9\u91cc parameter vp \u7684 dynamic type \u662f Car *, \u56e0\u4e3a compile \u65f6\u4f20\u8fdb\u53bb\u7684\u7c7b\u578b\u662f\u4e2a Car *. // \u4f46\u662f\u7ed3\u679c\u8fd8\u662f 1 } \u8fd9\u91cc\u5c3d\u7ba1 vp \u7684 dynamic type \u662f Car * \uff0c\u6211\u4eec\u5bf9\u5b83\u4f7f\u7528\u7684\u4ecd\u7136\u662f Vehicle * \u7684\u51fd\u6570\uff0c\u8fd9\u662f\u56e0\u4e3a\u4e0b\u9762\u8bb2\u7684 Static Binding\u3002","title":"15.1.2 Dynamic type: \u7531 derived classes \u5bfc\u81f4\u7684 runtime type"},{"location":"15-Polymorphism.html#1513-static-binding","text":"C++ \u4e2d\uff0cby default\uff0c\u5f53\u6211\u4eec\u4f7f\u7528\u4e00\u4e2a variable \u7684\u6210\u5458\u51fd\u6570\uff08\u4ee5\u53ca\u6210\u5458\uff09\u65f6\uff0c\u4f7f\u7528\u7684\u662f\u5b83\u7684 static type \u5bf9\u5e94\u7684 class \u7684\u6210\u5458\u548c\u65b9\u6cd5\u3002\u8fd9\u53eb\u505a Static Binding . \uff08\u6ce8\u610f\u6210\u5458\u51fd\u6570\u4e5f\u53ea\u80fd\u63a5\u89e6\u5b83 static type \u7684\u6210\u5458\uff0c\u6bd4\u5982 Bicycle \u5982\u679c\u6709\u4e2a\u6210\u5458\u53eb a \u800c Vehicle \u6ca1\u6709\uff0c\u4e00\u4e2a\u53d8\u91cf\u7684 dynamic type \u662f Bicycle * \uff0c\u800c static type \u662f Vehicle * \uff0c\u90a3\u4e48 by default\uff0c\u5b83\u4e5f\u6ca1\u6cd5 access a \u8fd9\u4e2a\u6210\u5458\uff09\u3002 \u6bd4\u5982 void fp(Vehicle *vp) { cout << vp -> get_insurance_amount() << endl; } \u4e2d\uff0c\u5982\u679c\u6211\u4eec\uff1a Car mc; fp(&mc); \u6211\u4eec\u4f20\u7ed9 fp \u7684\u53c2\u6570 vp \u7684\u662f &mc \uff0c\u56e0\u800c vp \u8fd9\u4e2a\u6307\u9488\u53d8\u91cf\u7684 Static type \u662f Vehicle * \uff0cDynamic type \u662f Car * \uff1b \u800c\u7531\u4e8e Static Binding\uff0c get_insurance_amount() \u662f based on vp \u7684 Static type \u7684\uff0c\u4e5f\u5c31\u662f Vehicle \u7684\u5bf9\u5e94\u51fd\u6570\u3002\u56e0\u800c\u6211\u4eec\u7528\u7684\u662f Vehicle \u4e0b\u7684 get_insurance_amount() \u6210\u5458\u51fd\u6570\uff0c\u6240\u4ee5\u83b7\u5f97\u7ed3\u679c\u662f 1 \u800c\u4e0d\u662f 2 . \uff08\u9898\u5916\u8bdd\uff1aJava \u4e2d\u5219\u662f\u9ed8\u8ba4 dynamic binding \u7684\uff0c\u8fd9\u5c31\u662f\u8bed\u8a00\u7684\u4e0d\u540c\u3002\uff09","title":"15.1.3 Static Binding"},{"location":"15-Polymorphism.html#1514-virtual-function-and-dynamic-binding","text":"\"polymorph\" \u7684\u610f\u601d\u662f\u591a\u4e2a forms. Dynamic type \u5141\u8bb8\u4e86 polymorphism \u884c\u4e3a\u7684\u53d1\u751f\uff0c\u5373\u540c\u4e00\u4e2a interface \u53ef\u4ee5\u7528\u6765\u8c03\u7528\u4e0d\u540c\u7684 implementation\uff1b\u800c polymorphism \u7684\u4f7f\u7528\u65b9\u5f0f\u5c31\u662f virtual function\uff1a\u7ed9\u6210\u5458\u51fd\u6570\u52a0\u4e0a virtual \u8fd9\u4e2a\u5173\u952e\u8bcd\u3002 \u5f53\u7ed9 member function \u52a0\u4e0a virtual \u4e4b\u540e\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a dynamic binding \u7684\u51fd\u6570\u3002 \u8fd9\u5c31\u662f polymorphism \u7684\u51fd\u6570\uff0c\u56e0\u4e3a \u8c03\u7528\u5b83\u7684\u5b50\u7c7b\u578b\u662f\u54ea\u4e00\u4e2a\uff0c\u5b83\u5c31\u8868\u793a\u54ea\u4e00\u4e2a\u5b50\u7c7b\u578b\u7684 override \u51fd\u6570\u3002 class Vehicle { public: virtual double get_insurance_amount () const; ... } class Car : public Vehicle { public: double get_insurance_amount () const; ... } void fp(Vehicle *vp) { cout << vp -> get_insurance_amount() << endl; } // \u7531\u4e8e get_insurance_amount \u73b0\u5728\u662f\u4e00\u4e2a virtual function \u652f\u6301 dynamic binding, \u5b83\u73b0\u5728\u662f called on variable \u7684 dynamic type \u7684 int main() { Vehicle mv; fp(&mv); // 1 Car mc; fp(&mc); // 2 } \u8fd9\u91cc\u6709\u4e00\u4e9b\u70b9\u9700\u8981\u58f0\u660e\uff0cprofessor \u6839\u672c\u6ca1\u6709\u8bf4\u4f46\u662f\u7b14\u8005\u67e5\u9605\u4e4b\u540e\u89c9\u5f97\u58f0\u660e\u8fd9\u51e0\u70b9\u5bf9\u4e8e\u7406\u89e3\u8fd9\u4e2a\u4e1c\u897f\u662f\u5f88\u91cd\u8981\u7684\uff1a virtual \u5fc5\u987b\u4ece base class \u5f00\u59cb \uff0c\u4e0d\u5b58\u5728 derived class \u7684 override \u4e2d\u8fd9\u4e2a function \u662f virtual \u7684\u4f46\u662f base class \u4e2d\u540c\u4e00\u4e2a function \u5374\u4e0d\u662f\uff0c\u8fd9\u79cd\u53ef\u80fd\u6027\u3002 \u4e00\u65e6 base class \u4e2d\u4e00\u4e2a member function \u662f virtual \u7684\uff0c\u90a3\u4e48\u5b83\u7684 derived class \u4e2d\u6240\u6709\u8fd9\u4e2a\u51fd\u6570\u7684 override \u51fd\u6570\u81ea\u52a8\u53d8\u6210 virtual \u7684 \uff0c\u4e0d\u9700\u8981\u52a0\u4e0a virtual \u5173\u952e\u8bcd\u3002 \u5c31\u662f\u8bf4\uff1a\u4e00\u4e2a\u6210\u5458\u51fd\u6570\u8981\u4e48\u662f virtual \u7684\u8981\u4e48\u4e0d\u662f virtual \u7684\uff0c\u4e0d\u8bba\u600e\u4e48 override \u8fd9\u4e2a virtuality \u90fd\u4e0d\u53d8\uff01\u8fd9\u4e2a virtuality \u4e5f\u662f\u4f1a\u88ab\u7ee7\u627f\u7684\u3002 \uff08\u6240\u4ee5\u8bf4\uff0c\u5982\u679c\u4ece A \u7684\u4e00\u4e2a\u5b50\u7c7b B \u5f00\u59cb\u591a\u51fa\u4e86\u4e00\u4e2a\u65b0\u7684\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u628a\u5b83\u5b9a\u4e49\u4e3a virtual \u7684\uff0c\u8fd9\u6837\u8fd9\u4e2a B \u4f5c\u4e3a B \u7684\u5b50\u7c7b\u7684\u57fa\u7c7b\uff0c\u5b83\u7684\u5b50\u7c7b\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f dynamic binding \u7684.\uff09 \uff08\u9898\u5916\u8bdd\uff1a\u4e0a\u4e00\u8282\u6211\u4eec\u8bf4\u4e86\u867d\u7136 override \u5173\u952e\u8bcd\u662f\u53ef\u4ee5\u5ffd\u7565\u4e0d\u5199\u7684\uff0c\u4f46\u662f\u8fd8\u662f\u5efa\u8bae\u5199\uff0c\u8fd9\u662f\u56e0\u4e3a\u76f8\u5bf9\u4e8e override \u8fd8\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u5173\u952e\u8bcd final . \u4f7f\u7528 override \u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u68c0\u67e5\u8be5\u51fd\u6570\u662f\u5426\u771f\u7684\u8986\u76d6\u4e86\u57fa\u7c7b\u4e2d\u7684\u4e00\u4e2a\u865a\u51fd\u6570\u3002\u5982\u679c\u6ca1\u6709\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519\u3002 \u4f7f\u7528 final \u53ef\u4ee5\u963b\u6b62\u8fdb\u4e00\u6b65\u7684\u7ee7\u627f\u3002 \uff09 Exercise: ```c++ class Fruit { public: int f1() {return 1;} virtual int f2() {return 2;} }; class Citrus : public Fruit { public: int f1() {return 3;} int f2() override {return 4;} }; class Lemon : public Citrus { public: int f1() {return 5;} int f2() override {return 6;} }; int main() { Fruit fruit; Cirtrus citrus; Lemon lemon; Fruit fptr = &lemon; Citrus cptr = &citrus; cout << fruit.f2(); //2 cout << citrus.f1(); //3 cout << fptr -> f1(); //1, \u56e0\u4e3a fptr static \u4e3a Fruit , dynamic \u4e3a Lemon , f1 \u4e0d\u662f\u4e00\u4e2a virtual function \u56e0\u800c static binding, \u4f7f\u7528 Fruit \u7684 f1(); cout << fptr -> f2(); //6, \u56e0\u4e3a f2 \u662f\u4e00\u4e2a virtual function \u56e0\u800c dynamic binding, \u4f7f\u7528 Lemon \u7684 f2(); cout << cptr -> f2(); //4, cptr static \u548c dynamic \u90fd\u4e3a Citrus* cPtr = &lemon; //\u66f4\u6539 Citrus* \u7c7b\u578b\u7684\u53d8\u91cf cPtr \u7684\u503c\u4e3a\u6307\u5411 Citrus \u7684\u5b50\u7c7b Lemon \u7684\u4e00\u4e2a object \u7684\u503c, \u6ce8\u610f\u8fd9\u662f\u53ef\u884c\u7684!!! cout << cptr -> f1; //3, \u56e0\u4e3a\u73b0\u5728 cptr static \u4e3a Citrus \u800c dynamic \u4e3a Lemon , f1 \u4e0d\u662f\u4e00\u4e2a virtual function \u56e0\u800c static binding, \u4f7f\u7528 Cirtrus \u7684 f1(); cout << cptr -> f2; //6, f2 \u662f\u4e00\u4e2a virtual function \u56e0\u800c dynamic binding, \u4f7f\u7528 Lemon \u7684 f2(); } ``` \u4e00\u4e2a polymorphic object\uff08\u591a\u6001\u5bf9\u8c61\uff09 \u662f\u81f3\u5c11\u6709\u4e00\u4e2a virtual function \u7684 Class \u7684 \u4e00\u4e2a instance.","title":"15.1.4 Virtual function and Dynamic Binding"},{"location":"15-Polymorphism.html#152-abstract-classes","text":"","title":"15.2 Abstract Classes"},{"location":"15-Polymorphism.html#1521-pure-virtual-function","text":"\u4e00\u4e2a pure virtual function \u6307\u7684\u662f\u4e00\u4e2a\u4ee5 =0 \u4e3a\u7ed3\u5c3e declare \u7684 function\u3002\u8fd9\u4e2a\u7ed3\u5c3e\u58f0\u660e\u8868\u793a\u8fd9\u4e2a function \u662f\u6ca1\u6709\u5b9a\u4e49\u7684\uff0c\u8fd9\u5c31\u662f\u201cpure virtual\"\u7684\u610f\u601d\u3002 \u8fd9\u6837\u7684\u4e00\u4e2a function \u5728 Base class \u4e2d\u662f \u4e0d\u80fd\u6709 implementation \u7684\uff0c\u5e76\u4e14 \u8981\u6c42\u6240\u6709\u7684 non-abstract derived Class \u63d0\u4f9b\u4e00\u4e2a implementation. Derived classes \u7684 implementation \u4e2d\uff0coverride \u7684\u51fd\u6570\u5c31\u4e0d\u662f\u4e00\u4e2a pure virtual function \u4e86\uff0c\u7ed3\u5c3e\u4e5f\u6ca1\u6709 =0 . pure virtual function \u7684\u4e3b\u8981\u76ee\u7684\u662f\u5b9a\u4e49\u4e00\u4e2a interface\uff0c\u5f3a\u5236 derived classes \u9075\u5faa\u67d0\u79cd si nature \uff08\u8bbe\u8ba1\u534f\u8bae\uff09\uff1b\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0cbase class \u5b9a\u4e49\u4e86\u4e00\u4e2a\u6709\u5f85\u6d3e\u751f\u7c7b implemnent \u7684\u51fd\u6570\u6846\u67b6\uff0c\u4ece\u800c\u5b9e\u73b0 polymorphism\u3002 class Shape { public: virtual double area() const = 0; // pure virtual function ... }; class Circle : public Shape { private: double radius; public: Circle(double r) : radius(r) {} double area() const override { // pure virtual function override return 3.14159 * radius * radius; } };","title":"15.2.1 Pure virtual function \u7eaf\u865a\u51fd\u6570"},{"location":"15-Polymorphism.html#1522-abstract-class","text":"\u4e00\u4e2a abstract class \u6307\u5305\u542b\u81f3\u5c11\u4e00\u4e2a pure virtual function \u7684 class. \u4e00\u4e2a abstract class \u662f\u65e0\u6cd5 instantiate (\u5b9e\u4f8b\u5316) \u7684\uff0c\u56e0\u800c\u4e5f\u65e0\u6cd5\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u3002 class Vehicle { ... virtual double get_insurance_amount() const = 0; }; // \u65e0\u6cd5 instantiate Vehicle v; //error void f(Vehicle v) { //error: object slicing ... } (\u5728C++\u4e2d\uff0c\"object slicing\"\uff08\u5bf9\u8c61\u5207\u7247\uff09\u662f\u6307\u5f53\u4e00\u4e2a\u6d3e\u751f\u7c7b\u5bf9\u8c61\u88ab\u8d4b\u503c\u7ed9\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u65f6\uff0c\u6d3e\u751f\u7c7b\u5bf9\u8c61\u4e2d\u8d85\u51fa\u57fa\u7c7b\u90e8\u5206\u7684\u4fe1\u606f\u4f1a\u88ab\u5207\u9664\u7684\u73b0\u8c61\u3002\u8fd9\u901a\u5e38\u53d1\u751f\u5728\u901a\u8fc7\u503c\u4f20\u9012\u5bf9\u8c61\u7ed9\u51fd\u6570\uff0c\u6216\u8005\u4ece\u51fd\u6570\u8fd4\u56de\u5bf9\u8c61\u65f6\uff0c\u4ee5\u53ca\u5728\u8d4b\u503c\u64cd\u4f5c\u4e2d\u3002)","title":"15.2.2 Abstract class \u62bd\u8c61\u7c7b"},{"location":"15-Polymorphism.html#1523-abstract-class-ptr-ref","text":"\u6211\u4eec\u521a\u624d\u8bf4\u5230\uff0c\u4e00\u4e2a abstract class \u65e0\u6cd5 instantiate\uff0c\u4e5f\u65e0\u6cd5\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\uff1b \u4f46\u662f \u4e00\u4e2a ptr or ref to an abstract class type \u5219\u53ef\u4ee5\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u6570\u3002 int main() { // Vehicle \u662f\u4e00\u4e2a abstract class, Car \u662f\u5b83\u7684\u4e00\u4e2a derived class Car c; Vehicle * vp = &c; // ptr Vehicle & vr = c; // ref fp(&c); fp(vp); fp(&vr); fr(c); fr(*vp); fr(vr); } void fp(Vehicle * v) { cout << v->get_insurance_amount() << endl; } void fr(Vehicle & v) { cout << v.get_insurance_amount() << endl; } \u6211\u4eec\u53d1\u73b0\uff0c\u5176\u5b9e\u6211\u4eec\u662f\u9700\u8981\u5efa\u7acb\u4e00\u4e2a abstract class \u7684 non-abstract derived class \u7684 instance\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u6307\u5411 abstract base class \u7684 ref \u6216 ptr \u578b\u53d8\u91cf\u6765\u6307\u5411\u5b83\uff0c\u4ece\u800c\u5b9e\u73b0 polymorphism\u3002 **\u53ef\u4ee5\u770b\u5230\u8fd9\u5c31\u662f polymorphism \u7684\u5de5\u4f5c\u65b9\u5f0f\u3002\u6211\u4eec\u7684 virtual member function \u662f\u57fa\u4e8e\u62bd\u8c61\u57fa\u7c7b\u7684\uff0c\u4f46\u662f\u5f53\u6211\u4eec\u5199\u4e00\u4e9b\u53c2\u6570\u662f\u62bd\u8c61\u57fa\u7c7b\u7684\u6307\u9488\u6216\u5f15\u7528\u7684\u51fd\u6570\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4efb\u4f55\u5b83\u7684\u975e\u62bd\u8c61\u5b50\u7c7b\u4f20\u9012\u7ed9\u8fd9\u4e2a\u51fd\u6570\uff0c\u5e76\u4e14\u4f1a\u4f7f\u7528\u8fd9\u4e9b\u5b50\u7c7b\u7684 member\uff0c\u4ece\u800c\u53ea\u7528\u4e86\u4e00\u4e2a\u51fd\u6570\u5c31\u6db5\u76d6\u4e86\u6240\u6709\u5b50\u7c7b\u7684\u4e0d\u540c\u60c5\u51b5\uff0c\u8fd9\u5c31\u662f polymorphism. **","title":"15.2.3 \u5c06 Abstract Class \u7684 ptr \u6216 ref \u53d8\u91cf\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570"},{"location":"15-Polymorphism.html#1524-pure-abstract-class","text":"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a abstract class \u867d\u7136\u4e0d\u80fd instantiate\uff0c\u4f46\u5982\u679c\u6709 data member\uff0c\u5219\u4ecd\u7136\u9700\u8981\u4e00\u4e2a constructor\u3002\u8fd9\u662f\u56e0\u4e3a\u6240\u6709 instances of a derived class \u90fd\u662f\u4ece construct base class \u5f00\u59cb\u7684\u3002 class Bicycle : public Vehicle { //... Bicycle(){ cout << \"Bicycle default ctor\\n\";} Bicycle(int year_in) : year(year_in) {cout << \" Bicycle int ctor\\n\";} }; // \u8bbe\u6211\u4eec\u5bf9 base class \u548c\u5176\u4ed6\u6240\u6709 derived classes \u4e5f\u8fd9\u6837 int main() { ElectricCar e1; // \u8f93\u51fa: // Vehicle default ctor // Car default ctor // ElectricCar default ctor ElectricCar e2(1); // \u8f93\u51fa: // Vehicle default ctor // Car default ctor // ElectricCar int ctor } \u4f46\u662f\u6211\u4eec\u6709\u4e00\u4e2a\u65b0\u7684\u5b9a\u4e49\uff1a pure abstract class \uff0c\u6307 \u6240\u6709\u51fd\u6570\u90fd\u662f abstract functions\uff0c\u5e76\u4e14\u6ca1\u6709 data members \u7684 class. pure abstract class \u5c31\u662f\u4e00\u4e2a\u7eaf interface\uff0c\u4e0d\u9700\u8981\u5199 constructor\uff1b\u5e76\u4e14 compiler \u4f1a\u81ea\u52a8 implicitly \u4e3a pure abstract class \u63d0\u4f9b\u4e00\u4e2a default constructor\u3002\uff08\u666e\u901a\u7684 abstract class \u4e0d\u4f1a\u8fd9\u6837\uff09","title":"15.2.4 Pure Abstract Class"},{"location":"15-Polymorphism.html#153-different-derived-classes-ptrref-container","text":"Polymorphism \u7684\u53e6\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u6307\u5411\u4e00\u4e2a base class \u7684\u4e0d\u540c derived classes \u7684 objects \u7684 ptr/ref \u653e\u5728\u540c\u4e00\u4e2a\u57fa\u7c7b\u7684 ptr/ref \u7684 container \u91cc\u9762\u3002 Car c(2); Bicycle b(1); ElectricCar e(5); vector<Vehicle*> fleet = {&c, &b, &e}; double monthly_cost = 0; for (auto veh:fleet) monthly_cost += veh->get_insurance_amount(); cout << \"total insurance cost = \" << monthly_cost << \"\\n\"; //\u6839\u636edynamic type \u5bf9\u5e94\u7684 member function \u4ea7\u751f\u4e0d\u540c\u7ed3\u679c \uff08\u5176\u5b9e\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u628a\u4e0d\u540c\u5b50\u7c7b objects \u653e\u8fdb\u540c\u4e00\u4e2a container\uff0c\u4f46\u662f\u8fd9\u4f1a\u5bfc\u81f4 object slicing.\uff09","title":"15.3 \u5bb9\u7eb3 different derived classes \u7684 ptr/ref \u7684 container"},{"location":"15-Polymorphism.html#154-upcasting-downcasting","text":"","title":"15.4 Upcasting \u548c Downcasting"},{"location":"15-Polymorphism.html#1541-upcasting","text":"Bicycle b; Vehicle* vp = &b; //upcasting \u8fd9\u5c31\u662f\u4e00\u4e2a upcasting. \u73b0\u5728 vp \u7684 static type \u4e3a Vehicle* \uff0cdynamic type \u4e3a Bicycle* .","title":"15.4.1 Upcasting"},{"location":"15-Polymorphism.html#1542-downcasting","text":"Downcasting \u5c1d\u8bd5 move down the class hierachy. Bicycle b; Vehicle* vp = &b; //upcasting Bicycle* bp = vp; //\u5c1d\u8bd5downcast, \u4f46\u662ferror compiler \u62a5\u9519\u7684\u539f\u56e0\u662f\u8fd9\u79cd\u505a\u6cd5\u6709\u6f5c\u5728\u7684\u98ce\u9669\uff0c\u6bd4\u5982\uff1a Bicycle b; Vehicle* vp = &b; //upcasting Car c; vp = &c; Bicycle* bp = vp; //\u5982\u679c\u5141\u8bb8\u8fd9\u6837downcast\u90a3\u8fd9\u4e2a\u65f6\u5019\u5c31\u4e0d\u5bf9\u4e86 \u56e0\u800c\u6709\u4e00\u4e2afunction dynamic_cast<Derived*>() \u4f5c\u4e3a downcasting \u7684\u9014\u5f84\u3002 Bicycle b; Vehicle* vp = &b; //upcasting Bicycle* bp = dynamic_cast<Bicycle*>(vp); //downcast \u5982\u679c cast fail \u4e86\uff0c\u90a3\u4e48 bp \u4f1a\u6210\u4e3a\u4e00\u4e2a nullptr \u5982\u679c\u6211\u4eec\u60f3 dynamic_cast \u4e00\u4e2a ref \u800c\u4e0d\u662f ptr\uff0c\u90a3\u4e48\u5982\u679c cast fail \u4e86\u5c31\u4f1a\u62a5\u9519\u3002","title":"15.4.2 Downcasting"},{"location":"15-Polymorphism.html#1543-dynamic_cast","text":"if(it_is_ElectricCar) do_electric_thing(); else if(it_is_car) do_car_thing; else ... \u56e0\u4e3a\u5982\u679c\u8981\u7ed9\u8fd9\u4e2a hierarchy \u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684 class\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u627e\u5230\u6240\u6709\u8fd9\u6837\u7684\u4ee3\u7801\u5e76\u628a\u8fd9\u4e2a\u65b0 class \u7684\u4e1c\u897f\u52a0\u8fdb\u53bb\u3002","title":"15.4.3 \u4e0d\u8981\u8fd9\u6837\u4f7f\u7528 dynamic_cast"},{"location":"16-ContainerADT-I.html","text":"16 Container ADT 16.1 Write a container ADT example: set 16.1.1 Static member variables 16.1.2 private helper function 16.2 Operator overloading 16.3 Template: generic programming 16.3.1 Template Notation 16.4 \u6ce8\u610f\u4e8b\u9879 16.4.1 template class \u7684 declarations \u548c definitions \u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u6587\u4ef6 16.4.2 Include Guards 16 Container ADT 16.1 Write a container ADT example: set \u6211\u4eec\u9700\u8981 set \u8fd9\u4e2a Container ADT \u6ee1\u8db3\u7684\u6761\u4ef6\uff1a \u5927\u5c0f\u662f immutable \u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u83b7\u53d6 \u6bcf\u4e2a\u5143\u7d20\u662f unique \u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u67e5\u627e \u53ef\u4ee5\u63d2\u5165\u548c\u79fb\u9664\u5143\u7d20 \u53ef\u4ee5\u6253\u5370 ... \u4e0b\u9762\u4e3a expect \u7684\u64cd\u4f5c\uff1a int main() { Set s; // s is empty s.insert(5); s.insert(12); s.insert(5); // ignored \u2013 5 already in set cout << s << endl; // {5, 12} or {12, 5} cout << s.size() << endl; // 2 s.remove(5); cout << s << endl; // {12} if (s.contains(14)) // should return false cout << \"Where did this come from??\" << endl; return 0; } \u6240\u4ee5\u4e00\u90e8\u5206 interface \u5e94\u8be5\u662f\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a class Set{ public: // EFFECTS: Constructs a Set, with size 0. Set(); // EFFECTS: Adds element e to the Set if not already present void insert(int e); // EFFECTS: Removes element e from the Set if present void remove(int e); // EFFECTS: Returns true if e is in the set, false otherwise bool contains(int e) const; // EFFECTS: Returns the number of elements in the Set int size() const; void print(std::ostream &os) const; }; 16.1.1 Static member variables \u6211\u4eec\u5148\u5047\u8bbe\u8fd9\u662f\u4e00\u4e2a\u5bb9\u7eb3 int \u578b\u7684 set. set \u7684\u5bb9\u91cf\u6709\u4e00\u5b9a\u9650\u5236\uff08\u56e0\u4e3a\u8fd9\u662f\u8ba1\u7b97\u673a\u91cc\uff0c\u548c\u73b0\u5b9e\u7684 set \u4e0d\u540c\uff0c\u4e0d\u80fd\u662f\u65e0\u9650\u7684\uff09 \u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u6700\u5927\u5bb9\u91cf\uff1a private: static const int CAPACITY = 10; // set \u80fd\u591f\u5bb9\u7eb3\u7684\u6700\u5927\u5bb9\u91cf int elts[CAPACITY]; // \u5f53\u524d set \u7684\u5916\u89c2, \u7528 array \u5bb9\u7eb3 int elts_size; // \u5f53\u524d set \u7684\u5927\u5c0f }; \u8fd9\u91cc static \u662f\u4e00\u4e2a keyword\uff0c\u5b83\u7684\u610f\u4e49\u662f\uff1a \u8fd9\u4e2a class \u7684\u6240\u6709 instances \u90fd share \u8fd9\u4e2a member variable. static storage duration\uff0clives throughout the whole program\uff0c\u5c31\u50cf global variable\uff0c\u53ea\u4e0d\u8fc7\u4ec5\u9650\u4e8e\u8fd9\u4e2a class \u53ef\u4f7f\u7528. lives inside a class's scope\uff0c\u6bd4\u8d77 global variable lives in the global scope \u800c\u8a00\u66f4\u52a0 organized \u4e00\u70b9. \uff08\u590d\u4e60\uff1aglobal variable\uff09 global variable \u5c31\u662f scope \u4e3a\u6574\u4e2a program \u7684 variable\uff0c\u53ef\u4ee5\u5728\u4efb\u4f55 scope\uff0c\u6bd4\u5982\u4efb\u4f55\u51fd\u6570\u4f53\u5185\u88ab\u8bbf\u95ee\u3002 ```c++ #include int globalVar = 10; // \u8fd9\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf void demoFunction() { std::cout << globalVar << std::endl; // \u53ef\u4ee5\u8bbf\u95ee } int main() { std::cout << globalVar << std::endl; // \u53ef\u4ee5\u8bbf\u95ee demoFunction(); return 0; } ``` static \u5c31\u662f throughout \u67d0\u4e2a class \u7684\uff0c\u5bf9\u4e8e\u8fd9\u4e2a class \u800c\u8a00\u5168\u5c40\u7684\u53d8\u91cf\u3002 16.1.2 private helper function \u6211\u4eec\u53d1\u73b0\u8fd9\u4e09\u4e2a member function \u90fd\u8981\u505a\u4e00\u4ef6\u4e8b\u60c5: contains : search the array looking for a specific number remove : search the array for a number; if it exists, remove it insert : search the array for a number; if it doesn't exist, add it \u6211\u4eec\u8fd9\u4e2a\u65f6\u5019\u80af\u5b9a\u8981\u5199\u4e00\u4e2a search \u7684 function \u6765\u9632\u6b62 code reproduction\uff0c\u5426\u5219\u5982\u679c\u6211\u4eec\u8981\u66f4\u6539\u4ee3\u7801\u5c31\u8981\u6539\u4e09\u6b21\uff0c\u8fd9\u5728\u5927\u5de5\u7a0b\u91cc\u662f\u5f88\u4e0d\u597d\u7684\u3002 \u6211\u4eec\u9700\u8981\u8fd9\u4e2a helper function \u662f private \u7684\uff0c\u56e0\u4e3a\u5b83\u5728 class \u4e4b\u5916\u662f\u4e0d\u9700\u8981\u7684\u3002\u8fd9\u6837\u4e5f\u53ef\u4ee5\u907f\u514d exposing implementation details\u3002 int Set::index_of(int e) const { // serch helper function for (int i = 0; i < elts_size; ++i) { if (elts[i] == e) return i; //found } return -1; //not found } Set::Set() // constructor : elts_size(0) {} int Set::size() const { return elts_size; } bool Set::contains(int e) const { return index_of(e) != -1; } void Set::insert(int e) { if (contains(e)) // e already in the set return; assert(elts_size < CAPACITY); //REQUIRES! elts[elts_size] = e; // add e to the array elts_size ++; } void Set::remove(int e) { int target = index_of(e); if (target == -1) // not found return; elts[target] = elts[elts_size - 1]; --elts_size; // we have one fewer elements now! } 16.2 Operator overloading \u6211\u4eec\u60f3\u8981\u968f\u65f6\u80fd\u591f\u7075\u6d3b\u5730\u6253\u5370\u4e00\u4e2a container ADT \u7684\u7ed3\u6784\uff0c\u5c31\u9700\u8981 overload operator. \u6bd4\u5982 < , == , << , >> ...... \u8fd9\u4e9b operator \u90fd\u53ef\u4ee5 overload. \u6807\u51c6\u5e93\u53ea\u5199\u4e86\u53c2\u6570\u4e3a\u6807\u51c6\u6570\u636e\u7c7b\u578b\uff08 int , string ....) \u7684\u8fd9\u4e9b operator. \u6211\u4eec\u53ef\u4ee5\u5728 class \u5185\u58f0\u660e\u4e00\u4e2a friend function. \u8868\u793a\u8fd9\u4e2a function \u662f class \u5916\u7684 \uff08\u5e76\u4e0d\u662f set::... \u7684 function\uff09\uff0c\u4f46\u662f\u5b83\u88ab\u5141\u8bb8 access \u8fd9\u4e2a class \u7684 private \u548c protected \u7684 members. class Set { public: ... private: ... friend std::ostream &operator<<(ostream &os, const Set &s); // friend \u5173\u952e\u8bcd\u7684 function, \u8868\u793a\u8fd9\u4e2a function \u662f\u6765\u81ea class \u5916\u90e8\u7684, \u5e76\u4e0d\u662f\u4e00\u4e2a member, \u4f46\u662f\u5b83\u88ab\u5141\u8bb8 access \u8fd9\u4e2a class \u7684 private \u548c protected \u7684 members. }; void Set::print(ostream &os) const { os << \"{\"; for (int i = 0; i < elts_size - 1; ++i) os << elts[i] << \", \"; os << elts[elts_size - 1] << \"} \"; } std::ostream &operator<<(ostream &os, const Set &s) { s.print(os); return os; } \u8fd9\u4e2a overloading \u8fd8\u662f\u5f88\u8bb2\u7a76\u7684\u3002 \u4f20\u8fdb\u53bb\u7684\u53c2\u6570\u4f9d\u6b21\u5206\u522b\u662f \u5de6\u53f3\u4e24\u8fb9\u7684 object \u7684 ref \u3002\u901a\u5e38\u6211\u4eec\u90fd\u4f7f\u7528 \u5f15\u7528\u4f20\u9012 \uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u60f3\u968f\u4fbf\u521b\u9020 copy\uff0c\u56e0\u4e3a\u53ef\u80fd obejct \u5f88\u5927\uff0c\u4f1a\u5f71\u54cd\u6027\u80fd\u3002 \u65e2\u7136\u53c2\u6570\u90fd\u662f\u5f15\u7528\u53d8\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6ce8\u610f\u8981\u4e0d\u8981\u52a0\u4e0a const . \u6bd4\u5982 << \uff0c\u5de6\u8fb9\u662f ostream , \u53f3\u8fb9\u662f\u8981\u5199\u7684\u4e1c\u897f\u3002\u6211\u4eec\u8981\u4fee\u6539 ostream \uff0c\u6240\u4ee5\u4e0d\u52a0 const \uff1b\u4f46\u662f\u5199\u7684\u4e1c\u897f\u6211\u4eec\u4e0d\u8981\u4fee\u6539\uff0c\u6240\u4ee5\u8981\u52a0\u4e0a const . \u6700\u540e \u8fd4\u56de\u7684\u662f\u6211\u4eec\u4f20\u8fdb\u53bb\u7684 ostream os , \u6bd4\u5982 cout \uff0c\u8fd9\u6837\u4e4b\u540e\u53c8\u53ef\u4ee5 chainly \u7ee7\u7eed write. return \u7684 ostream \u4e5f\u662f pass by reference \u7684\uff01 \u6700\u540e\u7684\u6548\u679c\u662f\uff1a Set s; cout << s; // \u4f20\u8fdb\u53bb\u7684\u53c2\u6570\u662f &cout, &s Set s1, s2, s3, s4; cout << s1 << s2 << s3 << endl; // \u5176\u5b9e\u5c31\u662f (((cout << s1) << s2) << s3) << endl; // \u8fd9\u91cc (cout << s1) \u6539\u53d8\u4e86 cout \u8fd9\u4e2a ostream \u5e76\u628a cout \u8fd4\u56de\u51fa\u6765\u4e86 // \u56e0\u800c\u4e4b\u540e\u5c31\u662f ((cout << s2) << s3) << endl; // \u4e4b\u540e: (cout << s3) << endl; // cout << endl; // \u6700\u540e\u53ea\u5269\u4e00\u4e2a cout, \u7ed3\u675f 16.3 Template: generic programming Generic programming(\u6cdb\u578b\u7f16\u7a0b) \u6307 implement algorithm without data types\uff0c\u800c specify data types later. C++ \u4e2d\u652f\u6301 generic programming \u7684 mechanism \u662f template(\u6a21\u7248) . \u5b9e\u9645\u4e0a\u6211\u4eec\u4e00\u76f4\u90fd\u5728\u4f7f\u7528\u4e00\u4e2a template container ADT\uff0c\u5c31\u662f vector. vector \u7684\u6210\u5458\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b\u7684\uff0c\u6bd4\u5982 int , double , ..., \u751a\u81f3\u662f\u6211\u4eec\u81ea\u5df1\u5b9a\u4e49\u7684 ADT. vector<double> data; \u6211\u4eec\u53ef\u4ee5\u628a\u6211\u4eec\u7684 set \u4e5f\u52a0\u4e0a template\uff0c\u8fd9\u6837\u5b83\u5c31\u53ef\u4ee5\u662f\u4e00\u4e2a\u5e7f\u6cdb\u7c7b\u578b\u7684 set\uff0c\u800c\u4e0d\u5c40\u9650\u4e8e\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u3002 Template \u4e5f\u662f\u4e00\u79cd polymorphism. \u4e4b\u524d\u7684 Dynamic type \u662f Subtype polymorphism \u800c template \u662f parametric polymorphism. 16.3.1 Template Notation template <typename T> \u5728 function \u6216\u8005 class \u7684 declaration \u7684\u524d\u52a0\u4e0a\u8fd9\u4e00\u884c\uff0c\u8868\u793a\u4e0b\u9762\u8fd9\u4e2a function/class \u4e2d\u6240\u6709\u51fa\u73b0\u7684 T \u4f5c\u4e3a typename\uff0c\u90fd\u7528\u4f60\u4f20\u8fdb\u6765\u7684\u4ee3\u66ff\u3002 Template \u53ef\u4ee5\u7528\u4e8e class \u6216\u8005 function. \u6ce8\u610f\uff1a \u5f53\u7528\u4e8e class \u7684\u65f6\u5019\uff0cclass \u7684\u6240\u6709 member functions \u5982\u679c implement \u5728 class declaration \u5916\uff0c\u524d\u9762\u90fd\u8981\u91cd\u65b0\u52a0\u4e0a template <typename T> \uff01\uff01 \u6240\u6709\u4f60\u4f7f\u7528 class \u540d\u79f0\u7684\u5730\u65b9\u90fd\u8981\u52a0\u4e0a <T> . \u6bd4\u5982\u6240\u6709 Set \u51fa\u73b0\u7684\u5730\u65b9\u90fd\u8981\u53d8\u4e3a Set<T> \uff0c \u9664\u4e86 constructor\uff01\uff01 c++ Set<T>::Set() :... {} \u7528\u4e8e function: template <typename T> T max(T a, T b) { // \u6bd4\u5982\u5982\u679c\u4f60\u4f20\u8fdb\u53bb\u7684 x, y \u4e3a int, \u5219\u662f int max(int a, int b); return a > b ? a : b; //condition? expression1 : expression2; // \u8fd9\u4e2a > ? :\u662f\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26, \u8868\u793a\u6761\u4ef6\u5982\u679c\u4e3a\u771f\u5c31\u8fd4\u56de1\u7684\u7ed3\u679c, \u5047\u5c31\u8fd4\u56de2\u7684\u7ed3\u679c } int main() { int x = 1; int y = 2; cout << max(x, y); } \u7528\u4e8e class: template <typename T> class Set{ public: // EFFECTS: Constructs a Set, with size 0. Set(); // EFFECTS: Adds element e to the Set if not already present void insert(T e); // EFFECTS: Removes element e from the Set if present void remove(T e); // EFFECTS: Returns true if e is in the set, false otherwise bool contains(T e) const; // EFFECTS: Returns the number of elements in the Set int size() const; void print(std::ostream &os) const; private: //EFFECTS: returns the index of e if it is in the // set, -1 otherwise. int index_of(T e) const; static const int CAPACITY = 10; T elts[CAPACITY]; int elts_size; }; template <typename T> std::ostream &operator<<(std::ostream &os, const Set<T> &s); template <typename T> int Set<T>::index_of(T e) const { for (int i = 0; i < elts_size; ++i) { if (elts[i] == e) return i; // found } return -1; // not found } template <typename T> Set<T>::Set() : elts_size(0) { } template <typename T> int Set<T>::size() const { return elts_size; } template <typename T> bool Set<T>::contains(T e) const { return index_of(e) != -1; } template <typename T> void Set<T>::insert(T e) { if (contains(e)) // e already in the set return; assert(elts_size < CAPACITY); //REQUIRES! elts[elts_size] = e; // add e to the array elts_size++; } template <typename T> void Set<T>::remove(T e) { int target = index_of(e); if (target == -1) // not found return; elts[target] = elts[elts_size - 1]; --elts_size; // we have one fewer elements now! } template <typename T> void Set<T>::print(std::ostream &os) const { os << \"{\"; for (int i = 0; i < elts_size - 1; ++i) os << elts[i] << \", \"; os << elts[elts_size - 1] << \"} \"; } template <typename T> std::ostream &operator<<(std::ostream &os, const Set<T> &s) { s.print(os); return os; } #endif \u4f7f\u7528\u4f8b\uff1a int main() { Set<int> si; // si is empty si.insert(5); si.insert(12); si.insert(5); // ignored \u2013 5 already in set cout << si << endl; // {5, 12} or {12, 5} cout << si.size() << endl; // 2 si.remove(5); cout << si << endl; // {12} if (si.contains(14)) // should return false cout << \"Where did this come from??\" << endl; cout << \"==========================\" << endl; Set<string> ss; // ss is empty ss.insert(\"apple\"); ss.insert(\"banana\"); ss.insert(\"apple\"); // ignored \u2013 apple already in set cout << ss << endl; // {apple, banana} or {banana, apple} cout << ss.size() << endl; // 2 ss.remove(\"apple\"); cout << ss << endl; // {banana} if (ss.contains(\"cranberry\")) // should return false cout << \"Where did this come from??\" << endl; return 0; } 16.4 \u6ce8\u610f\u4e8b\u9879 16.4.1 template class \u7684 declarations \u548c definitions \u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u6587\u4ef6 \u6211\u4eec\u81f3\u4eca\u4e3a\u6b62\u5e73\u65f6\u5728\u5199\u975e template class \u7684\u65f6\u5019\u603b\u662f\u5c06 declarations \u653e\u5728 .hpp \u4e2d\uff0c\u5c06\u5b9a\u4e49\u653e\u5728 .cpp \u4e2d\uff0c\u4e3a\u4e86\u66f4\u7b80\u6d01\u7684 interface. \u4f46\u662f \u4e00\u65e6\u4f7f\u7528 template\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5fc5\u987b\u628a declarations \u548c definitions \u90fd\u653e\u5728\u540c\u4e00\u4e2a (.hpp) \u6587\u4ef6\u91cc\u3002 \u539f\u56e0\u662f\uff1a\u5f53\u4f7f\u7528 template \u5b9a\u4e49\u4e00\u4e2a class \u6216 function \u65f6\uff0c\u5b9e\u9645\u4e0a \u662f\u5728\u5b9a\u4e49\u4e00\u4e2a\u6a21\u677f\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u5b9e\u9645\u53ef\u7f16\u8bd1\u7684\u4e1c\u897f \u3002\u800c Initialization \u5374\u662f\u5728 compiler \u9047\u5230 template \u7684\u5177\u4f53\u4f7f\u7528\u65f6\u8fdb\u884c\u7684\u3002compiler \u5728 initializaiton \u65f6\u7684\u5177\u4f53\u505a\u6cd5\u662f\u6839\u636e template \u4e3a\u6bcf\u79cd\u7c7b\u578b\u751f\u6210\u4e13\u95e8\u7684\u4ee3\u7801\u3002 \u4f8b\u5982\uff0c\u5f53\u4f60\u521b\u5efa\u4e00\u4e2a std::vector<int> \u65f6\uff0ccompiler \u4f1a\u5bf9\u7167\u7740 template \u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u628a template \u4e2d\u7684 T \u6362\u6210 int \u7684\u51fd\u6570\uff0c\u7136\u540e\u5bf9\u5e94\u8fd9\u6bb5\u81ea\u52a8\u751f\u6210\u7684\u4ee3\u7801\u6765 instantiate \u8fd9\u4e2a object \u3002 \u7531\u4e8e template \u7684\u8fd9\u79cd\u5de5\u4f5c\u539f\u7406\uff0c compiler \u5728 compile template code \u65f6\u5fc5\u987b\u6709 template \u7684\u5b8c\u6574 definitions\u3002 \u6211\u4eec\u5e73\u65f6\u5199\u7684\u975e template \u7684 code compilation: \u5f53 compiler compile \u4e00\u4e2a source file (\u5982 set.cpp \uff0c main.cpp )\u7684\u65f6\u5019\uff0c\u5982\u679c\u8be5\u6587\u4ef6 #include \u4e86\u4e00\u4e2a class \u7684 hpp declaration\uff0ccompiler \u4f1a\u68c0\u67e5 source file \u4e2d\u5bf9\u8be5 class \u7684\u6210\u5458\u7684\u5f15\u7528\u662f\u5426\u4e0e hpp \u4e2d\u7684 declaration \u5339\u914d\uff0c\u53ea\u8981\u8bed\u6cd5\u6b63\u786e\u5c31\u4f1a\u7f16\u8bd1\u6210\u529f\uff0c\u751f\u6210 .o \u7684 object file. \u8fd9\u4e2aobject file \u5305\u542b\u4e86\u672a\u88ab\u89e3\u6790\u7684 declarations \u7684\u7b26\u53f7\u5f15\u7528\uff0c\u8fd9\u4e9b\u5f15\u7528\u6307\u5411\u6211\u4eec\u5728 source file \u4e2d\u5199\u7684 definitions. linking: linker \u628a\u6240\u6709 object files \u5408\u5e76\u6210\u4e00\u4e2a .exe \u6587\u4ef6\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0clinker \u4f1a\u89e3\u6790\u4e4b\u524d compilation \u9636\u6bb5\u7559\u4e0b\u7684\u672a\u89e3\u6790\u7684 declarations \u7684\u7b26\u53f7\u5f15\u7528\uff0c\u67e5\u627e\u5176\u6307\u5411\u7684 definitions. \u8fd9\u4e00\u8fc7\u7a0b\u5141\u8bb8\u6211\u4eec\u5c06 non-template class \u7684 declaration \u548c definition \u5206\u79bb\u5f00\u3002 Non-template class \u53ef\u4ee5\u5206\u79bb declaration \u548c definitions\uff0c\u662f\u56e0\u4e3a compilation \u548c linking \u8fc7\u7a0b\u662f\u5206\u5f00\u7684 \uff0ccompiler \u751f\u6210\u7684\u662f\u5bf9\u7b26\u53f7\u7684 ref\uff0c\u5728 linking \u9636\u6bb5\u8fd9\u4e9b refs \u624d\u88ab\u89e3\u6790\u5230\u5177\u4f53\u7684 definitions\u3002 \u800c\u76f8\u53cd\uff0c template \u7684 instantiation \u662f\u4e00\u4e2a compile-time process\uff0c\u5728 linking \u524d\u5c31\u8981\u5b8c\u6210\uff0c\u9700\u8981\u5728\u6a21\u677f\u88ab\u4f7f\u7528\u65f6\u5177\u6709\u53ef\u8bbf\u95ee\u7684\u5b8c\u6574\u5b9a\u4e49\u3002 \u53ea\u6709\u5f53 compiler \u770b\u5230 template \u7684\u5b8c\u6574\u5b9a\u4e49\u65f6\uff0c\u5b83\u624d\u80fd\u4e3a\u7279\u5b9a\u7684 typename \u5b9e\u4f8b\u5316 template\u3002\u5426\u5219\u4f1a\u4ea7\u751f linker error\u3002 16.4.2 Include Guards include \u540c\u4e00\u4e2a header file \u8d85\u8fc7\u4e00\u6b21\u4f1a\u5bfc\u81f4 compiler error. \u5c24\u5176\u662f\u5f53 A include B \u548c C\uff0cB include C\uff0c\u90a3\u4e48 A \u5c31\u7b49\u540c\u4e8e include \u4e86 C \u4e24\u6b21\uff0c\u5bfc\u81f4\u4e86 compiler error\u3002 \u4e3a\u4e86\u9632\u6b62\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u5728 header files \u91cc\u52a0\u4e0a include guards \u3002\u4f5c\u7528\u662f\u8ba9 compiler ignore the code if the header is included a second time. #ifndef SOMETHING.hpp #define SOMETHING.hpp //... #endif","title":"Overview"},{"location":"16-ContainerADT-I.html#16-container-adt","text":"","title":"16 Container ADT"},{"location":"16-ContainerADT-I.html#161-write-a-container-adt-example-set","text":"\u6211\u4eec\u9700\u8981 set \u8fd9\u4e2a Container ADT \u6ee1\u8db3\u7684\u6761\u4ef6\uff1a \u5927\u5c0f\u662f immutable \u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u83b7\u53d6 \u6bcf\u4e2a\u5143\u7d20\u662f unique \u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u67e5\u627e \u53ef\u4ee5\u63d2\u5165\u548c\u79fb\u9664\u5143\u7d20 \u53ef\u4ee5\u6253\u5370 ... \u4e0b\u9762\u4e3a expect \u7684\u64cd\u4f5c\uff1a int main() { Set s; // s is empty s.insert(5); s.insert(12); s.insert(5); // ignored \u2013 5 already in set cout << s << endl; // {5, 12} or {12, 5} cout << s.size() << endl; // 2 s.remove(5); cout << s << endl; // {12} if (s.contains(14)) // should return false cout << \"Where did this come from??\" << endl; return 0; } \u6240\u4ee5\u4e00\u90e8\u5206 interface \u5e94\u8be5\u662f\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a class Set{ public: // EFFECTS: Constructs a Set, with size 0. Set(); // EFFECTS: Adds element e to the Set if not already present void insert(int e); // EFFECTS: Removes element e from the Set if present void remove(int e); // EFFECTS: Returns true if e is in the set, false otherwise bool contains(int e) const; // EFFECTS: Returns the number of elements in the Set int size() const; void print(std::ostream &os) const; };","title":"16.1 Write a container ADT example: set"},{"location":"16-ContainerADT-I.html#1611-static-member-variables","text":"\u6211\u4eec\u5148\u5047\u8bbe\u8fd9\u662f\u4e00\u4e2a\u5bb9\u7eb3 int \u578b\u7684 set. set \u7684\u5bb9\u91cf\u6709\u4e00\u5b9a\u9650\u5236\uff08\u56e0\u4e3a\u8fd9\u662f\u8ba1\u7b97\u673a\u91cc\uff0c\u548c\u73b0\u5b9e\u7684 set \u4e0d\u540c\uff0c\u4e0d\u80fd\u662f\u65e0\u9650\u7684\uff09 \u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u6700\u5927\u5bb9\u91cf\uff1a private: static const int CAPACITY = 10; // set \u80fd\u591f\u5bb9\u7eb3\u7684\u6700\u5927\u5bb9\u91cf int elts[CAPACITY]; // \u5f53\u524d set \u7684\u5916\u89c2, \u7528 array \u5bb9\u7eb3 int elts_size; // \u5f53\u524d set \u7684\u5927\u5c0f }; \u8fd9\u91cc static \u662f\u4e00\u4e2a keyword\uff0c\u5b83\u7684\u610f\u4e49\u662f\uff1a \u8fd9\u4e2a class \u7684\u6240\u6709 instances \u90fd share \u8fd9\u4e2a member variable. static storage duration\uff0clives throughout the whole program\uff0c\u5c31\u50cf global variable\uff0c\u53ea\u4e0d\u8fc7\u4ec5\u9650\u4e8e\u8fd9\u4e2a class \u53ef\u4f7f\u7528. lives inside a class's scope\uff0c\u6bd4\u8d77 global variable lives in the global scope \u800c\u8a00\u66f4\u52a0 organized \u4e00\u70b9. \uff08\u590d\u4e60\uff1aglobal variable\uff09 global variable \u5c31\u662f scope \u4e3a\u6574\u4e2a program \u7684 variable\uff0c\u53ef\u4ee5\u5728\u4efb\u4f55 scope\uff0c\u6bd4\u5982\u4efb\u4f55\u51fd\u6570\u4f53\u5185\u88ab\u8bbf\u95ee\u3002 ```c++ #include int globalVar = 10; // \u8fd9\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf void demoFunction() { std::cout << globalVar << std::endl; // \u53ef\u4ee5\u8bbf\u95ee } int main() { std::cout << globalVar << std::endl; // \u53ef\u4ee5\u8bbf\u95ee demoFunction(); return 0; } ``` static \u5c31\u662f throughout \u67d0\u4e2a class \u7684\uff0c\u5bf9\u4e8e\u8fd9\u4e2a class \u800c\u8a00\u5168\u5c40\u7684\u53d8\u91cf\u3002","title":"16.1.1 Static member variables"},{"location":"16-ContainerADT-I.html#1612-private-helper-function","text":"\u6211\u4eec\u53d1\u73b0\u8fd9\u4e09\u4e2a member function \u90fd\u8981\u505a\u4e00\u4ef6\u4e8b\u60c5: contains : search the array looking for a specific number remove : search the array for a number; if it exists, remove it insert : search the array for a number; if it doesn't exist, add it \u6211\u4eec\u8fd9\u4e2a\u65f6\u5019\u80af\u5b9a\u8981\u5199\u4e00\u4e2a search \u7684 function \u6765\u9632\u6b62 code reproduction\uff0c\u5426\u5219\u5982\u679c\u6211\u4eec\u8981\u66f4\u6539\u4ee3\u7801\u5c31\u8981\u6539\u4e09\u6b21\uff0c\u8fd9\u5728\u5927\u5de5\u7a0b\u91cc\u662f\u5f88\u4e0d\u597d\u7684\u3002 \u6211\u4eec\u9700\u8981\u8fd9\u4e2a helper function \u662f private \u7684\uff0c\u56e0\u4e3a\u5b83\u5728 class \u4e4b\u5916\u662f\u4e0d\u9700\u8981\u7684\u3002\u8fd9\u6837\u4e5f\u53ef\u4ee5\u907f\u514d exposing implementation details\u3002 int Set::index_of(int e) const { // serch helper function for (int i = 0; i < elts_size; ++i) { if (elts[i] == e) return i; //found } return -1; //not found } Set::Set() // constructor : elts_size(0) {} int Set::size() const { return elts_size; } bool Set::contains(int e) const { return index_of(e) != -1; } void Set::insert(int e) { if (contains(e)) // e already in the set return; assert(elts_size < CAPACITY); //REQUIRES! elts[elts_size] = e; // add e to the array elts_size ++; } void Set::remove(int e) { int target = index_of(e); if (target == -1) // not found return; elts[target] = elts[elts_size - 1]; --elts_size; // we have one fewer elements now! }","title":"16.1.2 private helper function"},{"location":"16-ContainerADT-I.html#162-operator-overloading","text":"\u6211\u4eec\u60f3\u8981\u968f\u65f6\u80fd\u591f\u7075\u6d3b\u5730\u6253\u5370\u4e00\u4e2a container ADT \u7684\u7ed3\u6784\uff0c\u5c31\u9700\u8981 overload operator. \u6bd4\u5982 < , == , << , >> ...... \u8fd9\u4e9b operator \u90fd\u53ef\u4ee5 overload. \u6807\u51c6\u5e93\u53ea\u5199\u4e86\u53c2\u6570\u4e3a\u6807\u51c6\u6570\u636e\u7c7b\u578b\uff08 int , string ....) \u7684\u8fd9\u4e9b operator. \u6211\u4eec\u53ef\u4ee5\u5728 class \u5185\u58f0\u660e\u4e00\u4e2a friend function. \u8868\u793a\u8fd9\u4e2a function \u662f class \u5916\u7684 \uff08\u5e76\u4e0d\u662f set::... \u7684 function\uff09\uff0c\u4f46\u662f\u5b83\u88ab\u5141\u8bb8 access \u8fd9\u4e2a class \u7684 private \u548c protected \u7684 members. class Set { public: ... private: ... friend std::ostream &operator<<(ostream &os, const Set &s); // friend \u5173\u952e\u8bcd\u7684 function, \u8868\u793a\u8fd9\u4e2a function \u662f\u6765\u81ea class \u5916\u90e8\u7684, \u5e76\u4e0d\u662f\u4e00\u4e2a member, \u4f46\u662f\u5b83\u88ab\u5141\u8bb8 access \u8fd9\u4e2a class \u7684 private \u548c protected \u7684 members. }; void Set::print(ostream &os) const { os << \"{\"; for (int i = 0; i < elts_size - 1; ++i) os << elts[i] << \", \"; os << elts[elts_size - 1] << \"} \"; } std::ostream &operator<<(ostream &os, const Set &s) { s.print(os); return os; } \u8fd9\u4e2a overloading \u8fd8\u662f\u5f88\u8bb2\u7a76\u7684\u3002 \u4f20\u8fdb\u53bb\u7684\u53c2\u6570\u4f9d\u6b21\u5206\u522b\u662f \u5de6\u53f3\u4e24\u8fb9\u7684 object \u7684 ref \u3002\u901a\u5e38\u6211\u4eec\u90fd\u4f7f\u7528 \u5f15\u7528\u4f20\u9012 \uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u60f3\u968f\u4fbf\u521b\u9020 copy\uff0c\u56e0\u4e3a\u53ef\u80fd obejct \u5f88\u5927\uff0c\u4f1a\u5f71\u54cd\u6027\u80fd\u3002 \u65e2\u7136\u53c2\u6570\u90fd\u662f\u5f15\u7528\u53d8\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6ce8\u610f\u8981\u4e0d\u8981\u52a0\u4e0a const . \u6bd4\u5982 << \uff0c\u5de6\u8fb9\u662f ostream , \u53f3\u8fb9\u662f\u8981\u5199\u7684\u4e1c\u897f\u3002\u6211\u4eec\u8981\u4fee\u6539 ostream \uff0c\u6240\u4ee5\u4e0d\u52a0 const \uff1b\u4f46\u662f\u5199\u7684\u4e1c\u897f\u6211\u4eec\u4e0d\u8981\u4fee\u6539\uff0c\u6240\u4ee5\u8981\u52a0\u4e0a const . \u6700\u540e \u8fd4\u56de\u7684\u662f\u6211\u4eec\u4f20\u8fdb\u53bb\u7684 ostream os , \u6bd4\u5982 cout \uff0c\u8fd9\u6837\u4e4b\u540e\u53c8\u53ef\u4ee5 chainly \u7ee7\u7eed write. return \u7684 ostream \u4e5f\u662f pass by reference \u7684\uff01 \u6700\u540e\u7684\u6548\u679c\u662f\uff1a Set s; cout << s; // \u4f20\u8fdb\u53bb\u7684\u53c2\u6570\u662f &cout, &s Set s1, s2, s3, s4; cout << s1 << s2 << s3 << endl; // \u5176\u5b9e\u5c31\u662f (((cout << s1) << s2) << s3) << endl; // \u8fd9\u91cc (cout << s1) \u6539\u53d8\u4e86 cout \u8fd9\u4e2a ostream \u5e76\u628a cout \u8fd4\u56de\u51fa\u6765\u4e86 // \u56e0\u800c\u4e4b\u540e\u5c31\u662f ((cout << s2) << s3) << endl; // \u4e4b\u540e: (cout << s3) << endl; // cout << endl; // \u6700\u540e\u53ea\u5269\u4e00\u4e2a cout, \u7ed3\u675f","title":"16.2 Operator overloading"},{"location":"16-ContainerADT-I.html#163-template-generic-programming","text":"Generic programming(\u6cdb\u578b\u7f16\u7a0b) \u6307 implement algorithm without data types\uff0c\u800c specify data types later. C++ \u4e2d\u652f\u6301 generic programming \u7684 mechanism \u662f template(\u6a21\u7248) . \u5b9e\u9645\u4e0a\u6211\u4eec\u4e00\u76f4\u90fd\u5728\u4f7f\u7528\u4e00\u4e2a template container ADT\uff0c\u5c31\u662f vector. vector \u7684\u6210\u5458\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b\u7684\uff0c\u6bd4\u5982 int , double , ..., \u751a\u81f3\u662f\u6211\u4eec\u81ea\u5df1\u5b9a\u4e49\u7684 ADT. vector<double> data; \u6211\u4eec\u53ef\u4ee5\u628a\u6211\u4eec\u7684 set \u4e5f\u52a0\u4e0a template\uff0c\u8fd9\u6837\u5b83\u5c31\u53ef\u4ee5\u662f\u4e00\u4e2a\u5e7f\u6cdb\u7c7b\u578b\u7684 set\uff0c\u800c\u4e0d\u5c40\u9650\u4e8e\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u3002 Template \u4e5f\u662f\u4e00\u79cd polymorphism. \u4e4b\u524d\u7684 Dynamic type \u662f Subtype polymorphism \u800c template \u662f parametric polymorphism.","title":"16.3 Template: generic programming"},{"location":"16-ContainerADT-I.html#1631-template-notation","text":"template <typename T> \u5728 function \u6216\u8005 class \u7684 declaration \u7684\u524d\u52a0\u4e0a\u8fd9\u4e00\u884c\uff0c\u8868\u793a\u4e0b\u9762\u8fd9\u4e2a function/class \u4e2d\u6240\u6709\u51fa\u73b0\u7684 T \u4f5c\u4e3a typename\uff0c\u90fd\u7528\u4f60\u4f20\u8fdb\u6765\u7684\u4ee3\u66ff\u3002 Template \u53ef\u4ee5\u7528\u4e8e class \u6216\u8005 function. \u6ce8\u610f\uff1a \u5f53\u7528\u4e8e class \u7684\u65f6\u5019\uff0cclass \u7684\u6240\u6709 member functions \u5982\u679c implement \u5728 class declaration \u5916\uff0c\u524d\u9762\u90fd\u8981\u91cd\u65b0\u52a0\u4e0a template <typename T> \uff01\uff01 \u6240\u6709\u4f60\u4f7f\u7528 class \u540d\u79f0\u7684\u5730\u65b9\u90fd\u8981\u52a0\u4e0a <T> . \u6bd4\u5982\u6240\u6709 Set \u51fa\u73b0\u7684\u5730\u65b9\u90fd\u8981\u53d8\u4e3a Set<T> \uff0c \u9664\u4e86 constructor\uff01\uff01 c++ Set<T>::Set() :... {} \u7528\u4e8e function: template <typename T> T max(T a, T b) { // \u6bd4\u5982\u5982\u679c\u4f60\u4f20\u8fdb\u53bb\u7684 x, y \u4e3a int, \u5219\u662f int max(int a, int b); return a > b ? a : b; //condition? expression1 : expression2; // \u8fd9\u4e2a > ? :\u662f\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26, \u8868\u793a\u6761\u4ef6\u5982\u679c\u4e3a\u771f\u5c31\u8fd4\u56de1\u7684\u7ed3\u679c, \u5047\u5c31\u8fd4\u56de2\u7684\u7ed3\u679c } int main() { int x = 1; int y = 2; cout << max(x, y); } \u7528\u4e8e class: template <typename T> class Set{ public: // EFFECTS: Constructs a Set, with size 0. Set(); // EFFECTS: Adds element e to the Set if not already present void insert(T e); // EFFECTS: Removes element e from the Set if present void remove(T e); // EFFECTS: Returns true if e is in the set, false otherwise bool contains(T e) const; // EFFECTS: Returns the number of elements in the Set int size() const; void print(std::ostream &os) const; private: //EFFECTS: returns the index of e if it is in the // set, -1 otherwise. int index_of(T e) const; static const int CAPACITY = 10; T elts[CAPACITY]; int elts_size; }; template <typename T> std::ostream &operator<<(std::ostream &os, const Set<T> &s); template <typename T> int Set<T>::index_of(T e) const { for (int i = 0; i < elts_size; ++i) { if (elts[i] == e) return i; // found } return -1; // not found } template <typename T> Set<T>::Set() : elts_size(0) { } template <typename T> int Set<T>::size() const { return elts_size; } template <typename T> bool Set<T>::contains(T e) const { return index_of(e) != -1; } template <typename T> void Set<T>::insert(T e) { if (contains(e)) // e already in the set return; assert(elts_size < CAPACITY); //REQUIRES! elts[elts_size] = e; // add e to the array elts_size++; } template <typename T> void Set<T>::remove(T e) { int target = index_of(e); if (target == -1) // not found return; elts[target] = elts[elts_size - 1]; --elts_size; // we have one fewer elements now! } template <typename T> void Set<T>::print(std::ostream &os) const { os << \"{\"; for (int i = 0; i < elts_size - 1; ++i) os << elts[i] << \", \"; os << elts[elts_size - 1] << \"} \"; } template <typename T> std::ostream &operator<<(std::ostream &os, const Set<T> &s) { s.print(os); return os; } #endif \u4f7f\u7528\u4f8b\uff1a int main() { Set<int> si; // si is empty si.insert(5); si.insert(12); si.insert(5); // ignored \u2013 5 already in set cout << si << endl; // {5, 12} or {12, 5} cout << si.size() << endl; // 2 si.remove(5); cout << si << endl; // {12} if (si.contains(14)) // should return false cout << \"Where did this come from??\" << endl; cout << \"==========================\" << endl; Set<string> ss; // ss is empty ss.insert(\"apple\"); ss.insert(\"banana\"); ss.insert(\"apple\"); // ignored \u2013 apple already in set cout << ss << endl; // {apple, banana} or {banana, apple} cout << ss.size() << endl; // 2 ss.remove(\"apple\"); cout << ss << endl; // {banana} if (ss.contains(\"cranberry\")) // should return false cout << \"Where did this come from??\" << endl; return 0; }","title":"16.3.1 Template Notation"},{"location":"16-ContainerADT-I.html#164","text":"","title":"16.4 \u6ce8\u610f\u4e8b\u9879"},{"location":"16-ContainerADT-I.html#1641-template-class-declarations-definitions","text":"\u6211\u4eec\u81f3\u4eca\u4e3a\u6b62\u5e73\u65f6\u5728\u5199\u975e template class \u7684\u65f6\u5019\u603b\u662f\u5c06 declarations \u653e\u5728 .hpp \u4e2d\uff0c\u5c06\u5b9a\u4e49\u653e\u5728 .cpp \u4e2d\uff0c\u4e3a\u4e86\u66f4\u7b80\u6d01\u7684 interface. \u4f46\u662f \u4e00\u65e6\u4f7f\u7528 template\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5fc5\u987b\u628a declarations \u548c definitions \u90fd\u653e\u5728\u540c\u4e00\u4e2a (.hpp) \u6587\u4ef6\u91cc\u3002 \u539f\u56e0\u662f\uff1a\u5f53\u4f7f\u7528 template \u5b9a\u4e49\u4e00\u4e2a class \u6216 function \u65f6\uff0c\u5b9e\u9645\u4e0a \u662f\u5728\u5b9a\u4e49\u4e00\u4e2a\u6a21\u677f\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u5b9e\u9645\u53ef\u7f16\u8bd1\u7684\u4e1c\u897f \u3002\u800c Initialization \u5374\u662f\u5728 compiler \u9047\u5230 template \u7684\u5177\u4f53\u4f7f\u7528\u65f6\u8fdb\u884c\u7684\u3002compiler \u5728 initializaiton \u65f6\u7684\u5177\u4f53\u505a\u6cd5\u662f\u6839\u636e template \u4e3a\u6bcf\u79cd\u7c7b\u578b\u751f\u6210\u4e13\u95e8\u7684\u4ee3\u7801\u3002 \u4f8b\u5982\uff0c\u5f53\u4f60\u521b\u5efa\u4e00\u4e2a std::vector<int> \u65f6\uff0ccompiler \u4f1a\u5bf9\u7167\u7740 template \u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u628a template \u4e2d\u7684 T \u6362\u6210 int \u7684\u51fd\u6570\uff0c\u7136\u540e\u5bf9\u5e94\u8fd9\u6bb5\u81ea\u52a8\u751f\u6210\u7684\u4ee3\u7801\u6765 instantiate \u8fd9\u4e2a object \u3002 \u7531\u4e8e template \u7684\u8fd9\u79cd\u5de5\u4f5c\u539f\u7406\uff0c compiler \u5728 compile template code \u65f6\u5fc5\u987b\u6709 template \u7684\u5b8c\u6574 definitions\u3002 \u6211\u4eec\u5e73\u65f6\u5199\u7684\u975e template \u7684 code compilation: \u5f53 compiler compile \u4e00\u4e2a source file (\u5982 set.cpp \uff0c main.cpp )\u7684\u65f6\u5019\uff0c\u5982\u679c\u8be5\u6587\u4ef6 #include \u4e86\u4e00\u4e2a class \u7684 hpp declaration\uff0ccompiler \u4f1a\u68c0\u67e5 source file \u4e2d\u5bf9\u8be5 class \u7684\u6210\u5458\u7684\u5f15\u7528\u662f\u5426\u4e0e hpp \u4e2d\u7684 declaration \u5339\u914d\uff0c\u53ea\u8981\u8bed\u6cd5\u6b63\u786e\u5c31\u4f1a\u7f16\u8bd1\u6210\u529f\uff0c\u751f\u6210 .o \u7684 object file. \u8fd9\u4e2aobject file \u5305\u542b\u4e86\u672a\u88ab\u89e3\u6790\u7684 declarations \u7684\u7b26\u53f7\u5f15\u7528\uff0c\u8fd9\u4e9b\u5f15\u7528\u6307\u5411\u6211\u4eec\u5728 source file \u4e2d\u5199\u7684 definitions. linking: linker \u628a\u6240\u6709 object files \u5408\u5e76\u6210\u4e00\u4e2a .exe \u6587\u4ef6\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0clinker \u4f1a\u89e3\u6790\u4e4b\u524d compilation \u9636\u6bb5\u7559\u4e0b\u7684\u672a\u89e3\u6790\u7684 declarations \u7684\u7b26\u53f7\u5f15\u7528\uff0c\u67e5\u627e\u5176\u6307\u5411\u7684 definitions. \u8fd9\u4e00\u8fc7\u7a0b\u5141\u8bb8\u6211\u4eec\u5c06 non-template class \u7684 declaration \u548c definition \u5206\u79bb\u5f00\u3002 Non-template class \u53ef\u4ee5\u5206\u79bb declaration \u548c definitions\uff0c\u662f\u56e0\u4e3a compilation \u548c linking \u8fc7\u7a0b\u662f\u5206\u5f00\u7684 \uff0ccompiler \u751f\u6210\u7684\u662f\u5bf9\u7b26\u53f7\u7684 ref\uff0c\u5728 linking \u9636\u6bb5\u8fd9\u4e9b refs \u624d\u88ab\u89e3\u6790\u5230\u5177\u4f53\u7684 definitions\u3002 \u800c\u76f8\u53cd\uff0c template \u7684 instantiation \u662f\u4e00\u4e2a compile-time process\uff0c\u5728 linking \u524d\u5c31\u8981\u5b8c\u6210\uff0c\u9700\u8981\u5728\u6a21\u677f\u88ab\u4f7f\u7528\u65f6\u5177\u6709\u53ef\u8bbf\u95ee\u7684\u5b8c\u6574\u5b9a\u4e49\u3002 \u53ea\u6709\u5f53 compiler \u770b\u5230 template \u7684\u5b8c\u6574\u5b9a\u4e49\u65f6\uff0c\u5b83\u624d\u80fd\u4e3a\u7279\u5b9a\u7684 typename \u5b9e\u4f8b\u5316 template\u3002\u5426\u5219\u4f1a\u4ea7\u751f linker error\u3002","title":"16.4.1 template class \u7684 declarations \u548c definitions \u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u6587\u4ef6"},{"location":"16-ContainerADT-I.html#1642-include-guards","text":"include \u540c\u4e00\u4e2a header file \u8d85\u8fc7\u4e00\u6b21\u4f1a\u5bfc\u81f4 compiler error. \u5c24\u5176\u662f\u5f53 A include B \u548c C\uff0cB include C\uff0c\u90a3\u4e48 A \u5c31\u7b49\u540c\u4e8e include \u4e86 C \u4e24\u6b21\uff0c\u5bfc\u81f4\u4e86 compiler error\u3002 \u4e3a\u4e86\u9632\u6b62\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u5728 header files \u91cc\u52a0\u4e0a include guards \u3002\u4f5c\u7528\u662f\u8ba9 compiler ignore the code if the header is included a second time. #ifndef SOMETHING.hpp #define SOMETHING.hpp //... #endif","title":"16.4.2 Include Guards"},{"location":"17-ContainerADT-II.html","text":"17 Container ADT II 17.1 Measuring the efficiency of an algorithm 17.1.1 binary search 17.1.2 binary search \u7684\u8981\u6c42: orderd set 17.1.3 \u9898\u5916\u8bdd: c++ \u7684 short-circuited && 17.1.4 Efficiency Comparison 17.2 Operator Overloading 17.3 main.cpp using using 17.4 \u5176\u4ed6\u4e8b\u9879 17.4.1 Static v.s. dynamic polymorphism 17.4.2 check_invariant 17 Container ADT II template <typename T> int set<T>::index_of(T e) const { for (size_t i = 0; i < T.size; i++) { if (ele[i] == e) {return i;} } return -1; } \u8fd9\u91cc ele[i] \u548c e \u7684 comparisons \u6b21\u6570\uff1a \u5982\u679c T.size \u4e3a n\uff0c\u90a3\u4e48 best case \u662f 1 \u6b21\uff08\u7b2c\u4e00\u4e2a\u5c31\u662f\uff09\uff1bworst case \u662f n \u6b21\uff08\u76f4\u5230\u6700\u540e\u4e00\u4e2a\u624d\u662f\uff09 \u8fd9\u4e2a search algorithm \u7684\u540d\u5b57\u5c31\u53eb linear search \u6216\u8005\u79f0 sequential search\uff0c\u56e0\u4e3a\u5b83\u7684 time complexity \u4e3a $O(n)$ 17.1 Measuring the efficiency of an algorithm \u786e\u8ba4 problem size: \u79f0\u4e3a n. \u6bd4\u5982\u521a\u624d\u5728 set \u4e2d\u5bfb\u627e\u5143\u7d20\uff0cn \u5c31\u662f set \u4e2d\u7684\u5143\u7d20\u6570\u91cf \u9009\u62e9\u4e00\u4e2a basic operation\uff1a\u6bd4\u5982 == \u8fd9\u4e2a\u6bd4\u8f83 \u627e\u51fa function C(n) \u7528\u6765\u8868\u793a number of basic operations required for the problem of size n \u901a\u5e38\u6211\u4eec\u9009\u62e9 worst case. (\u4f46\u662f\u66f4\u52a0 careful \u7684 algorithm analysis \u4e2d best \u548c average case\u4e5f\u6709\u5176\u4ed6\u7528\u5904). $C(n)$ is constant: time complexity is in $O(1)$. $C(n) = ax + b$: time complexity is in $O(n)$. $C(n) = log_m n$: time complexity is in $O(log \\; n)$ \u901a\u8fc7\u6211\u4eec\u521a\u624d\u7684\u5206\u6790\uff0c linear search is in $O(n)$\uff1bbinary search is in $O(log \\; n)$. 17.1.1 binary search Algorithm idea: Look in the middle position of the array indices under consideration (err to the left if no perfect middle) \u5982\u679c\u627e\u5230\u4e86\uff1areturn the index\uff1b\u5426\u5219\uff1a Limit your search to the left or right subarray as appropriate\uff0c\u7136\u540e\u4f1a\u56de\u5230 step 1. (\u5982\u679c\u6211\u4eec\u8981\u627e\u7684\u5143\u7d20\u4e0d\u5728 array \u4e2d\uff1f\u90a3\u4e48\u5c31 return -1.) /* Requires: arr is in sorted order (least to greatest) * size is the size of the array * Effects: returns the index at which target appears in the * array, or -1 if not found */ int binarySearch(int arr[], int size, int target) { int left = 0; int right = size - 1; while (left <= right) { int mid = (left + right) / 2; // binary split! if (arr[left] == target) {return mid;} // found! if (arr[mid] < target) {left = mid + 1;} // not found: move side else {right = mid - 1;} } return -1; // if not found: not in the array } binary search \u7684 time complexity \u5f88\u660e\u663e\u662f $O(log \\; n)$\uff0c\u56e0\u4e3a\u6211\u4eec\u5bf9 2^10 = 1024 \u4e2a\u5143\u7d20\u53ea\u9700\u8981 10 \u6b21\u6bd4\u8f83\u6765\u641c\u7d22\u51fa\u60f3\u8981\u7684\u5143\u7d20\u3002 \u8fd9\u4e2a binary search \u6709\u4e00\u4e2a\u7f3a\u70b9\uff1a\u5fc5\u987b\u8981 array \u662f\u88ab\u6392\u5e8f\u597d\u7684\u624d\u53ef\u4ee5\u8fd0\u884c\uff0c\u5426\u5219\u79fb\u52a8\u5de6\u53f3\u4fa7\u7684\u6b65\u9aa4\u6ca1\u6cd5\u8fdb\u884c\u3002 17.1.2 binary search \u7684\u8981\u6c42: orderd set \u5982\u679c\u6211\u4eec\u60f3\u4f7f\u7528 binary search\uff0c\u5fc5\u987b\u8981\u5728 orderd set \u4e0a\u3002\u6240\u4ee5\u539f\u672c\u7684 unordered set \u5e76\u4e0d\u662f\u7406\u60f3\u7684 data structure. \u73b0\u5728\u6211\u4eec\u5728\u672c\u6765\u7684 unordered set \u7684\u57fa\u7840\u4e0a\u52a0\u4e00\u70b9\u4ee3\u7801\uff0c\u505a\u4e00\u4e2a unordered set. \u539f\u672c\u6211\u4eec\u7684 insert \u53ea\u662f\u628a\u65b0\u5143\u7d20\u52a0\u5230\u6700\u540e\uff0c\u800c\u73b0\u5728\u6211\u4eec\u901a\u8fc7\u67e5\u627e\u8fd9\u4e2a\u5143\u7d20\u6309\u7167\u987a\u5e8f\u5e94\u8be5\u653e\u7684\u4f4d\u7f6e\uff0c\u5e76\u628a\u6240\u6709\u8be5\u4f4d\u7f6e\u4e4b\u540e\u7684\u5143\u7d20\u540e\u6240\u6709\u5143\u7d20\u53f3\u79fb\u6765\u5b9e\u73b0\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6bcf\u6b21\u6211\u4eec insert \u65b0\u5143\u7d20\u90fd\u662f in order \u7684\uff0c\u4ece\u800c induction \u4e0b\u6240\u6709\u5143\u7d20\u90fd\u662f in order \u7684\u3002 template <typename T> void ordered_set<T>::insert(T e) { if (contains(e)) return; assert (size < CAPACITY); int i = size; // find supposed order, at the same time // shifting right all elements before finding that while (i > 0 && e < ele[i - 1]) { ele[i] = ele[i - 1]; --i; } // put in the right position (start with nothing so 0) ele[i] = e; ++size; } \u540c\u6837\u7684\u903b\u8f91\uff0c\u6211\u4eec\u901a\u8fc7\u628a\u5236\u5b9a\u5143\u7d20\u4f4d\u7f6e\u4e4b\u540e\u7684\u5143\u7d20\u540e\u6240\u6709\u5143\u7d20\u5de6\u79fb\u6765\u5b9e\u73b0 remove . template <typename T> void ordered_set<T>::remove(T e) { int target = index_of(e); if (target == -1) {return;} --size; while (i < elts_size) { elts[i] = elts[i + 1]; ++i; } } 17.1.3 \u9898\u5916\u8bdd: c++ \u7684 short-circuited && \u8fd9\u91cc\u6ce8\u610f\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u62c5\u5fc3 while (i > 0 && e < elts[i - 1]) \u56e0\u4e3a i-1 out of boundary \u800c\u51fa\u73b0 compiler error\uff0c\u4f46\u5176\u5b9e\u4e0d\u7528\u3002\u56e0\u4e3a c++ \u4f7f\u7528 short-circuited && \uff0c\u610f\u601d\u662f\u8bf4\u5f53\u7b2c\u4e00\u4e2a expression \u4e3a false \u65f6\uff0c\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u5c06\u4e0d\u88ab\u8003\u8651\u3002\u6240\u4ee5\u4e0d\u4f1a\u6709 compiler error. 17.1.4 Efficiency Comparison \u6211\u4eec\u5728 insert \u548c remove \u8fd9\u4e24\u4e2a member function \u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\u5faa\u73af\uff0c\u6240\u4ee5\u770b\u8d77\u6765 ordered set \u7684\u590d\u6742\u5ea6\u597d\u50cf\u589e\u52a0\u4e86\uff0c\u4f46\u5176\u5b9e\u5e76\u6ca1\u6709\u3002 \u5728 unordered set \u4e2d\uff0c\u6211\u4eec insert \u548c remove \u672c\u8eab\u5c31\u8981\u5148\u4f7f\u7528 contain \u6765 linear search\uff0c$C(n) = n$\uff0c\u56e0\u800c\u590d\u6742\u5ea6\u662f $O(n)$\uff1bordered set \u4e2d\uff0c\u6211\u4eec insert \u548c remove \u7684\u590d\u6742\u5ea6\u662f $O(log\\;n) + O(n) = O(n)$. \u867d\u7136\u589e\u52a0\u4e86\u4e00\u4e2a\u5faa\u73af\u4f7f\u5f97 $C(n) = log_2 n + n$\uff0c\u4f46\u662f\u590d\u6742\u5ea6\uff08worst case\uff09\u4e0d\u53d8. \u800c contain \u7684\u590d\u6742\u5ea6\u5219\u5927\u5e45\u4e0b\u964d. \u8fd9\u5728\u5904\u7406\u5f88\u5927\u7684\u96c6\u5408\u65f6\u6781\u5927\u63d0\u9ad8\u4e86\u6548\u7387\u3002 17.2 Operator Overloading \u6211\u4eec\u5728 search \u4e2d\uff0c\u7528\u5230\u4e86 > \uff0c == \u7b49 comparison operator. \u6211\u4eec\u53ef\u4ee5\u968f\u4fbf declare ordered_set<int> \uff0c ordered_set<string> \u7b49\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u5982\u679c declare \u4e00\u4e2a ordered_set<person> \uff0c\u5176\u4e2d person \u662f\u53e6\u5916\u4e00\u4e2a class\uff0c\u90a3\u4e48\u5219\u4f1a\u51fa\u73b0 compiler error\u3002\u56e0\u4e3a\u6211\u4eec\u5e76\u6ca1\u6709\u5b9a\u4e49 person objects \u7684 == , < , > \u7b49\u7b26\u53f7. \u56e0\u800c\u6211\u4eec\u9700\u8981\u5728 person \u8fd9\u4e2a class \u4e2d\u58f0\u660e operator< , operator== \u7b49 functions \u4e3afriend fucntion\uff0c\u5e76\u5728\u5916\u9762\u5bf9\u8fd9\u4e9b functions \u4e5f\u8fdb\u884c\u53c2\u6570\u662f person \u7684overload. \uff08\u4e5f\u53ef\u4ee5\u5728 class \u4e2d\u4f5c\u4e3a member functions \u800c\u4e0d\u662f friend functions \u6765\u5b9a\u4e49\u3002\uff09 \u8fd9\u4e9b comparison operator \u90fd\u662f binary operator\uff08\u4e8c\u5143\u8fd0\u7b97\u7b26\uff09 \uff0c\u4e5f\u5c31\u662f\u8bf4 operator function \u7684\u53c2\u6570\u6709\u4e24\u4e2a\uff0c\u7b2c\u4e00\u4e2a\u662f operator \u5de6\u4fa7\u7684\uff0c\u7b2c\u4e8c\u4e2a\u662f operator \u53f3\u4fa7\u7684\u3002 class Person { private: std::string name; public: ... friend bool operator<(const Person &p1, const Person &p2); friend bool operator==(const Person &p1, const Person &p2); }; bool operator<(const Person &p1, const Person &p2) { return p1.name < p2.name; } bool operator==(const Person &p1, const Person &p2) { return p1.name == p2.name; } \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u548c return stream \u7684 operators \u4e0d\u4e00\u6837\u7684\u662f\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u5c31\u4e0d\u7528\u8fd4\u56de\u5f15\u7528\u503c\u4e86\u3002\u56e0\u4e3a\u4e0d\u7528\u8fde\u7eed\u8fd0\u7b97\u3002 17.3 main.cpp using using \u6211\u4eec\u5199\u4e86\u4e24\u4e2a set class\uff0c\u5982\u4f55\u7b80\u4fbf\u5730\u9009\u62e9 main.cpp \u4f7f\u7528\u54ea\u4e00\u4e2a\uff1a \u9009\u62e9 unordered_set: #include \"Unordered_set.hpp\" #include \"Ordered_set.hpp\" //Select one implementation template <typename T> using Set = unordered_set<T>; int main() { Set<int> is; //... Set<string> desserts; //... } \u9009\u62e9 ordered_set: #include \"Unordered_set.hpp\" #include \"Ordered_set.hpp\" //Select one implementation template <typename T> using Set = ordered_set<T>; int main() { Set<int> is; //... Set<string> desserts; //... } 17.4 \u5176\u4ed6\u4e8b\u9879 17.4.1 Static v.s. dynamic polymorphism Subtype polymorphism \u4e5f\u5c31\u662f dynamic polymorphism. \u53d1\u751f\u5728 run time, Generic programming with templates \u4e5f\u5c31\u662f static polymorphism. \u53d1\u751f\u4e8e compile time. \u6211\u4eec\u5728 set \u7684 implementation \u4e2d\u4f7f\u7528 static polymorphism \u662f\u56e0\u4e3a type \u4e0d\u5728 runtime \u53d8\u5316. 17.4.2 check_invariant For ordered_set: template <typename T> bool Ordered_set<T>::check_invariant() const { for (int i = 0; i < elts_size - 1; ++i) { if (elts[i] >= elts[i+1]) return false; } return true; } For unordered_set: template <typename T> bool Unordered_set<T>::check_invariant() { for (int i = 0; i < elts_size; ++i) { for (int j = i+1; j < elts_size; ++j) { if (elts[i] == elts[j]) return false; } } return true; } \u6211\u4eec\u53d1\u73b0\u4e0d\u5f97\u4e0d\u5728 check_invariant() \u4e2d\u4f7f\u7528 nested loop. \u8fd9\u4f7f\u5f97\u7a0b\u5e8f\u53d8\u5f97\u5f88\u6162. \u8fd9\u5728testing \u4e2d\u662f\u503c\u5f97\u7684, \u4f46\u662f\u5728 final product \u4e2d\u4e0d\u5e94\u8be5\u7528\u3002 \u6211\u4eec\u53ef\u4ee5\u5728\u7a0b\u5e8f\u4e2d\u7981\u7528\u8fd9\u4e9b asserts\uff0c\u5c31\u662f\u78b0\u5230\u8fd9\u4e9b\u4ee3\u7801\u5c31\u5ffd\u7565\u3002\u65b9\u6cd5\u662f compiling with the NDEBUG preprocessor. variable defined. \u6709\u4e24\u4e2a\u529e\u6cd5\u505a\u5230\uff1a \u5728 include <cassert> \u4e4b\u524d\u52a0\u4e0a NDEBUG \u7684\u5b8f\u3002 c++ #define NDEBUG #include <cassert> \u5728 command line \u5199\u660e\u6211\u4eec\u5305\u62ec NDEBUG \u8fdb\u884c\u7f16\u8bd1. shell g++ -DNDEBUG...","title":"Overview"},{"location":"17-ContainerADT-II.html#17-container-adt-ii","text":"template <typename T> int set<T>::index_of(T e) const { for (size_t i = 0; i < T.size; i++) { if (ele[i] == e) {return i;} } return -1; } \u8fd9\u91cc ele[i] \u548c e \u7684 comparisons \u6b21\u6570\uff1a \u5982\u679c T.size \u4e3a n\uff0c\u90a3\u4e48 best case \u662f 1 \u6b21\uff08\u7b2c\u4e00\u4e2a\u5c31\u662f\uff09\uff1bworst case \u662f n \u6b21\uff08\u76f4\u5230\u6700\u540e\u4e00\u4e2a\u624d\u662f\uff09 \u8fd9\u4e2a search algorithm \u7684\u540d\u5b57\u5c31\u53eb linear search \u6216\u8005\u79f0 sequential search\uff0c\u56e0\u4e3a\u5b83\u7684 time complexity \u4e3a $O(n)$","title":"17 Container ADT II"},{"location":"17-ContainerADT-II.html#171-measuring-the-efficiency-of-an-algorithm","text":"\u786e\u8ba4 problem size: \u79f0\u4e3a n. \u6bd4\u5982\u521a\u624d\u5728 set \u4e2d\u5bfb\u627e\u5143\u7d20\uff0cn \u5c31\u662f set \u4e2d\u7684\u5143\u7d20\u6570\u91cf \u9009\u62e9\u4e00\u4e2a basic operation\uff1a\u6bd4\u5982 == \u8fd9\u4e2a\u6bd4\u8f83 \u627e\u51fa function C(n) \u7528\u6765\u8868\u793a number of basic operations required for the problem of size n \u901a\u5e38\u6211\u4eec\u9009\u62e9 worst case. (\u4f46\u662f\u66f4\u52a0 careful \u7684 algorithm analysis \u4e2d best \u548c average case\u4e5f\u6709\u5176\u4ed6\u7528\u5904). $C(n)$ is constant: time complexity is in $O(1)$. $C(n) = ax + b$: time complexity is in $O(n)$. $C(n) = log_m n$: time complexity is in $O(log \\; n)$ \u901a\u8fc7\u6211\u4eec\u521a\u624d\u7684\u5206\u6790\uff0c linear search is in $O(n)$\uff1bbinary search is in $O(log \\; n)$.","title":"17.1 Measuring the efficiency of an algorithm"},{"location":"17-ContainerADT-II.html#1711-binary-search","text":"Algorithm idea: Look in the middle position of the array indices under consideration (err to the left if no perfect middle) \u5982\u679c\u627e\u5230\u4e86\uff1areturn the index\uff1b\u5426\u5219\uff1a Limit your search to the left or right subarray as appropriate\uff0c\u7136\u540e\u4f1a\u56de\u5230 step 1. (\u5982\u679c\u6211\u4eec\u8981\u627e\u7684\u5143\u7d20\u4e0d\u5728 array \u4e2d\uff1f\u90a3\u4e48\u5c31 return -1.) /* Requires: arr is in sorted order (least to greatest) * size is the size of the array * Effects: returns the index at which target appears in the * array, or -1 if not found */ int binarySearch(int arr[], int size, int target) { int left = 0; int right = size - 1; while (left <= right) { int mid = (left + right) / 2; // binary split! if (arr[left] == target) {return mid;} // found! if (arr[mid] < target) {left = mid + 1;} // not found: move side else {right = mid - 1;} } return -1; // if not found: not in the array } binary search \u7684 time complexity \u5f88\u660e\u663e\u662f $O(log \\; n)$\uff0c\u56e0\u4e3a\u6211\u4eec\u5bf9 2^10 = 1024 \u4e2a\u5143\u7d20\u53ea\u9700\u8981 10 \u6b21\u6bd4\u8f83\u6765\u641c\u7d22\u51fa\u60f3\u8981\u7684\u5143\u7d20\u3002 \u8fd9\u4e2a binary search \u6709\u4e00\u4e2a\u7f3a\u70b9\uff1a\u5fc5\u987b\u8981 array \u662f\u88ab\u6392\u5e8f\u597d\u7684\u624d\u53ef\u4ee5\u8fd0\u884c\uff0c\u5426\u5219\u79fb\u52a8\u5de6\u53f3\u4fa7\u7684\u6b65\u9aa4\u6ca1\u6cd5\u8fdb\u884c\u3002","title":"17.1.1 binary search"},{"location":"17-ContainerADT-II.html#1712-binary-search-orderd-set","text":"\u5982\u679c\u6211\u4eec\u60f3\u4f7f\u7528 binary search\uff0c\u5fc5\u987b\u8981\u5728 orderd set \u4e0a\u3002\u6240\u4ee5\u539f\u672c\u7684 unordered set \u5e76\u4e0d\u662f\u7406\u60f3\u7684 data structure. \u73b0\u5728\u6211\u4eec\u5728\u672c\u6765\u7684 unordered set \u7684\u57fa\u7840\u4e0a\u52a0\u4e00\u70b9\u4ee3\u7801\uff0c\u505a\u4e00\u4e2a unordered set. \u539f\u672c\u6211\u4eec\u7684 insert \u53ea\u662f\u628a\u65b0\u5143\u7d20\u52a0\u5230\u6700\u540e\uff0c\u800c\u73b0\u5728\u6211\u4eec\u901a\u8fc7\u67e5\u627e\u8fd9\u4e2a\u5143\u7d20\u6309\u7167\u987a\u5e8f\u5e94\u8be5\u653e\u7684\u4f4d\u7f6e\uff0c\u5e76\u628a\u6240\u6709\u8be5\u4f4d\u7f6e\u4e4b\u540e\u7684\u5143\u7d20\u540e\u6240\u6709\u5143\u7d20\u53f3\u79fb\u6765\u5b9e\u73b0\u3002 \u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u6bcf\u6b21\u6211\u4eec insert \u65b0\u5143\u7d20\u90fd\u662f in order \u7684\uff0c\u4ece\u800c induction \u4e0b\u6240\u6709\u5143\u7d20\u90fd\u662f in order \u7684\u3002 template <typename T> void ordered_set<T>::insert(T e) { if (contains(e)) return; assert (size < CAPACITY); int i = size; // find supposed order, at the same time // shifting right all elements before finding that while (i > 0 && e < ele[i - 1]) { ele[i] = ele[i - 1]; --i; } // put in the right position (start with nothing so 0) ele[i] = e; ++size; } \u540c\u6837\u7684\u903b\u8f91\uff0c\u6211\u4eec\u901a\u8fc7\u628a\u5236\u5b9a\u5143\u7d20\u4f4d\u7f6e\u4e4b\u540e\u7684\u5143\u7d20\u540e\u6240\u6709\u5143\u7d20\u5de6\u79fb\u6765\u5b9e\u73b0 remove . template <typename T> void ordered_set<T>::remove(T e) { int target = index_of(e); if (target == -1) {return;} --size; while (i < elts_size) { elts[i] = elts[i + 1]; ++i; } }","title":"17.1.2 binary search \u7684\u8981\u6c42: orderd set"},{"location":"17-ContainerADT-II.html#1713-c-short-circuited","text":"\u8fd9\u91cc\u6ce8\u610f\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u62c5\u5fc3 while (i > 0 && e < elts[i - 1]) \u56e0\u4e3a i-1 out of boundary \u800c\u51fa\u73b0 compiler error\uff0c\u4f46\u5176\u5b9e\u4e0d\u7528\u3002\u56e0\u4e3a c++ \u4f7f\u7528 short-circuited && \uff0c\u610f\u601d\u662f\u8bf4\u5f53\u7b2c\u4e00\u4e2a expression \u4e3a false \u65f6\uff0c\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u5c06\u4e0d\u88ab\u8003\u8651\u3002\u6240\u4ee5\u4e0d\u4f1a\u6709 compiler error.","title":"17.1.3 \u9898\u5916\u8bdd: c++ \u7684 short-circuited &amp;&amp;"},{"location":"17-ContainerADT-II.html#1714-efficiency-comparison","text":"\u6211\u4eec\u5728 insert \u548c remove \u8fd9\u4e24\u4e2a member function \u4e2d\u52a0\u5165\u4e86\u4e00\u4e2a\u5faa\u73af\uff0c\u6240\u4ee5\u770b\u8d77\u6765 ordered set \u7684\u590d\u6742\u5ea6\u597d\u50cf\u589e\u52a0\u4e86\uff0c\u4f46\u5176\u5b9e\u5e76\u6ca1\u6709\u3002 \u5728 unordered set \u4e2d\uff0c\u6211\u4eec insert \u548c remove \u672c\u8eab\u5c31\u8981\u5148\u4f7f\u7528 contain \u6765 linear search\uff0c$C(n) = n$\uff0c\u56e0\u800c\u590d\u6742\u5ea6\u662f $O(n)$\uff1bordered set \u4e2d\uff0c\u6211\u4eec insert \u548c remove \u7684\u590d\u6742\u5ea6\u662f $O(log\\;n) + O(n) = O(n)$. \u867d\u7136\u589e\u52a0\u4e86\u4e00\u4e2a\u5faa\u73af\u4f7f\u5f97 $C(n) = log_2 n + n$\uff0c\u4f46\u662f\u590d\u6742\u5ea6\uff08worst case\uff09\u4e0d\u53d8. \u800c contain \u7684\u590d\u6742\u5ea6\u5219\u5927\u5e45\u4e0b\u964d. \u8fd9\u5728\u5904\u7406\u5f88\u5927\u7684\u96c6\u5408\u65f6\u6781\u5927\u63d0\u9ad8\u4e86\u6548\u7387\u3002","title":"17.1.4 Efficiency Comparison"},{"location":"17-ContainerADT-II.html#172-operator-overloading","text":"\u6211\u4eec\u5728 search \u4e2d\uff0c\u7528\u5230\u4e86 > \uff0c == \u7b49 comparison operator. \u6211\u4eec\u53ef\u4ee5\u968f\u4fbf declare ordered_set<int> \uff0c ordered_set<string> \u7b49\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u5982\u679c declare \u4e00\u4e2a ordered_set<person> \uff0c\u5176\u4e2d person \u662f\u53e6\u5916\u4e00\u4e2a class\uff0c\u90a3\u4e48\u5219\u4f1a\u51fa\u73b0 compiler error\u3002\u56e0\u4e3a\u6211\u4eec\u5e76\u6ca1\u6709\u5b9a\u4e49 person objects \u7684 == , < , > \u7b49\u7b26\u53f7. \u56e0\u800c\u6211\u4eec\u9700\u8981\u5728 person \u8fd9\u4e2a class \u4e2d\u58f0\u660e operator< , operator== \u7b49 functions \u4e3afriend fucntion\uff0c\u5e76\u5728\u5916\u9762\u5bf9\u8fd9\u4e9b functions \u4e5f\u8fdb\u884c\u53c2\u6570\u662f person \u7684overload. \uff08\u4e5f\u53ef\u4ee5\u5728 class \u4e2d\u4f5c\u4e3a member functions \u800c\u4e0d\u662f friend functions \u6765\u5b9a\u4e49\u3002\uff09 \u8fd9\u4e9b comparison operator \u90fd\u662f binary operator\uff08\u4e8c\u5143\u8fd0\u7b97\u7b26\uff09 \uff0c\u4e5f\u5c31\u662f\u8bf4 operator function \u7684\u53c2\u6570\u6709\u4e24\u4e2a\uff0c\u7b2c\u4e00\u4e2a\u662f operator \u5de6\u4fa7\u7684\uff0c\u7b2c\u4e8c\u4e2a\u662f operator \u53f3\u4fa7\u7684\u3002 class Person { private: std::string name; public: ... friend bool operator<(const Person &p1, const Person &p2); friend bool operator==(const Person &p1, const Person &p2); }; bool operator<(const Person &p1, const Person &p2) { return p1.name < p2.name; } bool operator==(const Person &p1, const Person &p2) { return p1.name == p2.name; } \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u548c return stream \u7684 operators \u4e0d\u4e00\u6837\u7684\u662f\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u5c31\u4e0d\u7528\u8fd4\u56de\u5f15\u7528\u503c\u4e86\u3002\u56e0\u4e3a\u4e0d\u7528\u8fde\u7eed\u8fd0\u7b97\u3002","title":"17.2 Operator Overloading"},{"location":"17-ContainerADT-II.html#173-maincpp-using-using","text":"\u6211\u4eec\u5199\u4e86\u4e24\u4e2a set class\uff0c\u5982\u4f55\u7b80\u4fbf\u5730\u9009\u62e9 main.cpp \u4f7f\u7528\u54ea\u4e00\u4e2a\uff1a \u9009\u62e9 unordered_set: #include \"Unordered_set.hpp\" #include \"Ordered_set.hpp\" //Select one implementation template <typename T> using Set = unordered_set<T>; int main() { Set<int> is; //... Set<string> desserts; //... } \u9009\u62e9 ordered_set: #include \"Unordered_set.hpp\" #include \"Ordered_set.hpp\" //Select one implementation template <typename T> using Set = ordered_set<T>; int main() { Set<int> is; //... Set<string> desserts; //... }","title":"17.3 main.cpp using using"},{"location":"17-ContainerADT-II.html#174","text":"","title":"17.4 \u5176\u4ed6\u4e8b\u9879"},{"location":"17-ContainerADT-II.html#1741-static-vs-dynamic-polymorphism","text":"Subtype polymorphism \u4e5f\u5c31\u662f dynamic polymorphism. \u53d1\u751f\u5728 run time, Generic programming with templates \u4e5f\u5c31\u662f static polymorphism. \u53d1\u751f\u4e8e compile time. \u6211\u4eec\u5728 set \u7684 implementation \u4e2d\u4f7f\u7528 static polymorphism \u662f\u56e0\u4e3a type \u4e0d\u5728 runtime \u53d8\u5316.","title":"17.4.1 Static v.s. dynamic polymorphism"},{"location":"17-ContainerADT-II.html#1742-check_invariant","text":"For ordered_set: template <typename T> bool Ordered_set<T>::check_invariant() const { for (int i = 0; i < elts_size - 1; ++i) { if (elts[i] >= elts[i+1]) return false; } return true; } For unordered_set: template <typename T> bool Unordered_set<T>::check_invariant() { for (int i = 0; i < elts_size; ++i) { for (int j = i+1; j < elts_size; ++j) { if (elts[i] == elts[j]) return false; } } return true; } \u6211\u4eec\u53d1\u73b0\u4e0d\u5f97\u4e0d\u5728 check_invariant() \u4e2d\u4f7f\u7528 nested loop. \u8fd9\u4f7f\u5f97\u7a0b\u5e8f\u53d8\u5f97\u5f88\u6162. \u8fd9\u5728testing \u4e2d\u662f\u503c\u5f97\u7684, \u4f46\u662f\u5728 final product \u4e2d\u4e0d\u5e94\u8be5\u7528\u3002 \u6211\u4eec\u53ef\u4ee5\u5728\u7a0b\u5e8f\u4e2d\u7981\u7528\u8fd9\u4e9b asserts\uff0c\u5c31\u662f\u78b0\u5230\u8fd9\u4e9b\u4ee3\u7801\u5c31\u5ffd\u7565\u3002\u65b9\u6cd5\u662f compiling with the NDEBUG preprocessor. variable defined. \u6709\u4e24\u4e2a\u529e\u6cd5\u505a\u5230\uff1a \u5728 include <cassert> \u4e4b\u524d\u52a0\u4e0a NDEBUG \u7684\u5b8f\u3002 c++ #define NDEBUG #include <cassert> \u5728 command line \u5199\u660e\u6211\u4eec\u5305\u62ec NDEBUG \u8fdb\u884c\u7f16\u8bd1. shell g++ -DNDEBUG...","title":"17.4.2 check_invariant"},{"location":"18-Memory-Model-and-Dynamic-Memory.html","text":"18 Memory model and Dynamic Memory 18.1 Global(Static), Local(automatic) and dynamic variables 18.1.1 Global(static) variables 18.1.2 Local (Automatic) variables 18.1.3 Dynamic variables 18.1.4 \u4f7f\u7528 dynamic variables \u7684\u539f\u56e0 18.2 Dynamic Memory \u7684\u4f7f\u7528 18.2.1 new 18.2.2 delete 18.2.2.1 assert(nullptr) 18.2.3 Pitfall: double delete \u662f undefined behavior 18.2.4 Pitfall: memory leak! 18.3 Program Segments 18.3.1 The little void 18.3.2 Text segment 18.3.3 Global segment 18.3.4 Heap segment 18.3.5 The BIG VOID(\u672a\u4f7f\u7528\u533a\u57df) \u4ee5\u53ca Stack 18.4 Dynamic arrays 18.4.1 delete[] 18 Memory model and Dynamic Memory 18.1 Global(Static), Local(automatic) and dynamic variables \u56de\u987e\uff1a \u4e00\u4e2a object \u662f memory \u4e2d\u7684 a piece of data. \u4e00\u4e2a object lives at an address in memory \u4e00\u4e2a object \u53ea\u80fd\u5728\u5176 lifetime \u88ab\u4f7f\u7528\uff0clifetime \u53d6\u51b3\u4e8e storage duration. c++ \u4e2d\u6709\u4e09\u79cd storage durations: \u25aa Global / static \u25aa Local / automatic \u25aa Dynamic 18.1.1 Global(static) variables \u6709\u4e09\u79cd\uff1a \u7b2c\u4e00\u79cd: \u5728 function/class definition \u5916\u7684 globle variables. \u5728 program \u8fd0\u884c\u524d\u5c31\u88ab\u521b\u9020\uff0c\u4e00\u76f4\u751f\u5b58\u5230 program \u7ed3\u675f\u3002 c++ const int SIZE=10; int main() { //... } \u7b2c\u4e8c\u79cd: static within a class definition. c++ class Set { private: static const int CAPACITY = 100; //... }; static within a function c++ int main() { static const int SIZE = 10; //... } 18.1.2 Local (Automatic) variables A local variable lives inside a block { } . \u5728 declaration \u88ab run \u7684\u65f6\u5019\u88ab initialized. \u5728 block finish \u7684\u65f6\u5019 die. 18.1.3 Dynamic variables Lifetime \u5728 runtime \u88ab\u51b3\u5b9a. Programmer \u51b3\u5b9a\u5b83\u88ab created \u4ee5\u53ca destroyed \u7684\u65f6\u95f4. 18.1.4 \u4f7f\u7528 dynamic variables \u7684\u539f\u56e0 int * pointerToThree() { int x = 3; return &x; } int main() { int *z = pointerToThree(); cout << *z; } \u8fd9\u6bb5\u4ee3\u7801 error. \u56e0\u4e3a pointerToThree() \u521b\u9020\u7684 x \u53ca\u5176\u5730\u5740\u4f5c\u4e3a\u7684\u6307\u9488\u53d8\u91cf\u662f\u4e00\u4e2a local variable\uff0c\u5728 pointerToThree() \u8fd0\u884c\u7ed3\u675f\u7684\u65f6\u5019\u5c31\u65e0\u4e86\u3002\u56e0\u800c\u8fd9\u7247\u5730\u5740\u4e0a\u4e0d\u518d\u662f\u4e00\u4e2a int \u4e86\uff0c\u6240\u4ee5 type error. \u56e0\u800c\u6211\u4eec\u9700\u8981 dynamic variable. \u6211\u4eec\u53ef\u4ee5\u81ea\u4e3b\u63a7\u5236\u5176 lifetime\uff0c\u8fd9\u6837 pointers to the same object can exist in different scopes. \u9664\u4e86\u8fd9\u4e2a\u597d\u5904\u5916\uff0cheap \u7684\u5bb9\u91cf\u5927\u5c0f\u4e5f\u6bd4 stack \u8981\u8fdc\u5927\u3002 18.2 Dynamic Memory \u7684\u4f7f\u7528 18.2.1 new new \u5728 dunamic memory \u4e2d \u521b\u9020\u4e00\u4e2a object\uff0c\u5e76 return \u6307\u5411\u8fd9\u4e2a object \u7684\u4e00\u4e2a pointer. int * pointerToThree() { int *p = new int; *p = 3; return p; } // \u6216\u8005 int * pointerToThree() { int *p = new int(3); return p; } \u5728\u8fd9\u91cc\uff0c p \u662f pointerToThree \u7684 stack frame \u4e2d\u7684\u4e00\u4e2a local variable\uff01 \u5b83\u7684\u7c7b\u578b\u662f int * . \u4e00\u65e6 pointerToThree \u8fd0\u884c\u7ed3\u675f\uff0c\u5b83\u5c31 die \u4e86. \u800c\u503c\u4e3a int(3) \u7684\u53d8\u91cf\u5219\u662f\u5728 heap \u7684 dynamic memory \u4e2d\u7684\u4e00\u4e2a int \u578b variable\u3002\u6211\u4eec\u5c06\u7528 int(3) \u6765\u79f0\u547c\u5b83\u3002\u6211\u4eec\u901a\u8fc7\u4f7f\u7528 new \u628a heap \u7684\u4e00\u6bb5 memory \u7ed9 allocate \u7ed9\u4e86\u5b83\u3002 \u5728 pointerToThree \u8fd0\u884c\u7ed3\u675f\u540e\uff0c\u5b83\u4ecd\u7136\u5b58\u5728\uff01 pointerToThree \u8fd0\u884c\u7ed3\u675f\u4e4b\u540e\uff0c p die \u4e86\uff0c p \u7684 memory \u88ab\u81ea\u52a8 release \u4e86\uff1b\u4f46\u662f p \u7684\u503c\uff0c\u4e5f\u5c31\u662f int(3) \u7684\u5730\u5740\uff0c\u88ab return \u4e86\u3002 \u53ea\u8981\u6211\u4eec\u4e0d\u624b\u52a8 delete \uff0c int(3) \u5c06\u59cb\u7ec8\u5728 dynamic memory \u76f4\u5230 program \u7ed3\u675f\uff01 \u73b0\u5728\u6211\u4eec\u8c03\u7528 pointerToThree \uff0c\u5c06\u5b83\u8fd4\u56de\u503c\u5206\u914d\u7ed9 main \u4e2d\u7684\u53d8\u91cf\u3002 int main() { int *z = pointerToThree(); cout << *z; //... } \u4e8e\u662f p \u7684\u503c\u5728 p \u6b7b\u540e\u88ab return \u7ed9\u4e86 main \u4e2d\u7684 int * \u53d8\u91cf z . 18.2.2 delete delete \u53ef\u4ee5 destroy dynamic variables. int main() { int *z = pointerToThree(); cout << *z; delete z; } \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u6211\u4eec\u5199\u7684\u662f delete z \uff0c z \u662f\u4e00\u4e2a main \u7684 stackframe \u4e2d\u7684\u4e00\u4e2a local variable\uff0c\u4f46\u5176\u5b9e\u5b83\u505a\u7684\u662f destroy z \u6240\u6307\u5411\u7684 dynamic memory \u4e2d\u7684 dynamic object \uff0c\u4e5f\u5c31\u662f\u503c\u4e3a int(3) \u7684\u90a3\u4e2a\u53d8\u91cf\uff01 \u5728\u6211\u4eec\u7684 delete \u4e4b\u540e\uff1a z \u4ecd\u7136\u6307\u5411 heap \u4e2d\u7684\u540c\u4e00\u4f4d\u7f6e\uff0c z \u7684\u503c\u5e76\u4e0d\u4f1a\u6539\u53d8\uff01\uff01 \u4f46\u6b64\u65f6\u6211\u4eec\u5df2\u7ecf\u4e0d\u80fd dereference \u5b83\u4e86\uff0c\u8fd9\u4f1a\u662f\u4e00\u4e2a undefined behavior. \u6211\u4eec\u53ef\u4ee5\u91cd\u65b0\u7ed9 z \u8d4b\u503c \u6211\u4eec\u6ce8\u610f\u5230\u6709\u4e00\u4e2a\u6bd4\u8f83\u62bd\u8c61\u7684\u4e8b\u60c5\uff1a \u6211\u4eec\u53d1\u73b0\u5728 delete \u540e dereference z \u6765\u83b7\u53d6\u5df2\u7ecf\u91ca\u653e\u7684 dynamic memory \u4e0a\u7684\u4e1c\u897f\u4ecd\u7136\u662f\u53ef\u4ee5\u7684\uff0c**\u53ea\u662f\u4e00\u4e2a undefined behavior \u800c\u4e0d\u662f\u4e00\u4e2a error. ** \u7406\u8bba\u4e0a\uff0c\u5728 delete \u4ee5\u540e\uff0c\u8be5 object \u6240\u5360\u7528\u7684 memory \u88ab\u5f52\u8fd8\u7ed9 operating system \u4e86\uff0c\u7528\u4e8e\u672a\u6765\u7684 allocation\u3002\u4ece\u903b\u8f91\u4e0a\u8be5 object \u4e0d\u518d\u5b58\u5728. \u7136\u800c\uff0c\u5728\u7269\u7406\u5c42\u9762\u4e0a\uff0c\u8be5 memory \u5728\u88ab delete \u4e4b\u540e\u4e0e\u7acb\u5373\u91cd\u7528\u4e4b\u524d\uff0c\u5176\u5185\u5bb9\u53ef\u80fd\u4ecd\u7136\u4fdd\u7559\u672a\u66f4\u6539\u7684\u72b6\u6001\uff0c\u5c31\u662f\u8bf4\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u503c\u53ef\u80fd\u4ecd\u7136\u662f\u4e00\u4e2a int(3) . \u7136\u800c\u6b64\u65f6 dereferene \u662f undefined behavior\uff0c\u662f\u4e0d\u5b89\u5168\u7684\u3002 18.2.2.1 assert(nullptr) \u6709\u4e00\u4e2a\u597d\u7684\u505a\u6cd5\u7ed9\u6307\u5411\u5df2\u7ecf\u5220\u9664\u7684 dynamic object \u7684 ptr \u53d8\u91cf\u5206\u914d nullptr \uff0c\u8fd9\u6837\u9996\u5148\u8fd9\u4e2a ptr \u5c31\u4e0d\u518d\u662f\u4e00\u4e2a dangling pointer \u4e86\uff0c\u5176\u6b21\u6211\u4eec\u53ef\u4ee5\u5728\u5408\u9002\u7684\u5730\u65b9 assert \u5b83\u6765 identify problems. \u6ce8\u610f\uff1a assert(nullptr) \u7684\u7ed3\u679c\u662f segfault\uff0c\u56e0\u800c\u5b83\u6709\u52a9\u4e8e\u52d8\u63a2\u95ee\u9898\u3002 int main() { int *p = new int(100); delete p; p = nullptr; assert(p); //SegError } 18.2.3 Pitfall: double delete \u662f undefined behavior int main() { int *p1 = new int(3); int *p2 = p1; // p2 \u73b0\u5728\u4e5f\u6307\u5411\u8be5 dynamic object delete p1; // delete \u4e86\u8fd9\u4e2a dynamic object delete p2; // double delete, Undefined behavior! } \u8fd9\u91cc p1 \u548c p2 \u6307\u5411\u7684\u662f\u540c\u4e00\u4e2a dynamic object\uff0c\u56e0\u800c\u53ea\u9700\u8981\u4e5f\u53ea\u81f3\u591a\u5e94\u8be5 delete \u4e00\u6b21\u3002\u5982\u679c\u6211\u4eec\u5fd8\u8bb0\u4e86\uff0c\u524d\u540e delete \u4e86 p1 \u53c8 delete \u4e86 p2 \uff0c\u90a3\u4e48\u5c31\u4f1a\u5bfc\u81f4 undefined behavior\uff0c\u5e76\u4e14\u5f88\u53ef\u80fd runtime error. 18.2.4 Pitfall: memory leak! int main() { int *p1 = new int(1); int *p2 = new int(2); p1 = p2; // \u73b0\u5728\u6ca1\u6709\u4e1c\u897f\u6307\u5411\u503c\u4e3a int(1) \u7684\u90a3\u4e2a dynamic object \u4e86 delete p1; } // how much memory is leaked? sizeof(int) == 4B. Dynamic variables \u4f1a\u4e00\u76f4\u5b58\u5728\u76f4\u5230\u88ab delete \uff0c\u5373\u4fbf\u5df2\u7ecf\u6ca1\u6709\u4e1c\u897f\u6307\u5411\u5b83\u4e86\u3002 \u8fd9\u4e5f\u610f\u5473\u7740\uff1a \u6211\u4eec\u5982\u679c\u4e0d\u5c0f\u5fc3\u628a\u6307\u5411\u4e00\u4e2a dynamic object \u7684 ptr \u53d8\u91cf\u7684\u503c\u6539\u6389\uff0c\u8ba9\u5b83\u4e0d\u518d\u6307\u5411\u8fd9\u4e2a dynamic object\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u518d\u4e5f\u65e0\u6cd5 delete \u5b83\u4e86\u3002 \u8fd9\u5c31\u53eb\u505a\u4e00\u4e2a memory leak. \u4e0d\u4ec5\u5982\u6b64\uff0c\u6709\u5f88\u591a\u4e2a\u6e20\u9053\u80fd\u591f\u5bfc\u81f4\u8fd9\u79cd\u4e8b\u60c5\u3002\u6bd4\u5982\u6307\u5411 dynamic object \u7684 ptr \u53d8\u91cf\u51fa\u4e86\u81ea\u5df1\u7684 scope \u6b7b\u4e86\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u628a\u503c\u4f20\u9012\u51fa\u53bb\u3002 void f() { int *p = new int(1); cout << *p; } int main() { f(); // memory leak } 18.3 Program Segments \u4e00\u4e2a running program \u6709\u4e00\u4e2a \"address space\", \u5c31\u662f\u4e00\u7cfb\u5217 memory locations that are accessible to it. \u6bcf\u4e2a address space \u90fd private \u4e8e\u4e00\u4e2a running program\uff0c\u6ca1\u6709\u5176\u4ed6\u7684 running program \u80fd\u591f access \u6216\u8005 modify \u5b83\uff01 \u9664\u4e86 heap segment \u4e4b\u5916\uff0c\u4e00\u4e2a running program \u8fd8\u6709\u5176\u4ed6\u7684 segments. Operating system manages virtual memory \uff0c\u4f7f\u5f97 \u6bcf\u4e2a program \u90fd\u80fd\u591f\u88c5\u4f5c\u5b83 occupies \u6574\u4e2a address space \uff0c\u4ece address 0 \u5230 address max. 18.3.1 The little void \u5927\u591a\u6570 operating systems \u90fd reserve \u4e86\u4ece 0 \u5f00\u59cb\u7684\u524d\u51e0\u5343\u4e2a addresses\uff0c\u8fd9\u90e8\u5206\u6784\u6210\u4e86 the little void . (Ps: address 0 \u4e5f\u5c31\u662f\u6240\u6709 nullptr \u5b58\u50a8\u7684\u5730\u5740) 18.3.2 Text segment \u8fd9\u4e2a segment \u5305\u542b\u7684\u662f the machine code (\u4e5f\u5c31\u662f binary)\uff0c\u5305\u542b\u4e86\u6574\u4e2a compiled program \u7684 binary code\u3002\u5b83\u7684 address \u6240\u5728\u4f4d\u7f6e\u4e5f\u5f88\u4f4e\uff0c\u4ec5\u5728 little void \u4e4b\u540e\u3002 18.3.3 Global segment space for the global variables \u4ee5\u53ca static variables. 18.3.4 Heap segment new \u548c delete \u662f c++ \u4e2d\u6211\u4eec interact with heap segment \u7684\u65b9\u6cd5\uff0c\u800c C \u4e2d\u6211\u4eec\u4e5f\u6709\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff0c malloc() \u548c free() \u5c31\u662f C \u7684 new \u548c delete . heap segment \u4e2d\uff0c \u6bcf\u4e2a heap object \u90fd\u6709\u81ea\u5df1\u7684 lifetime\uff0c\u4e0e\u5b83\u5468\u56f4\u7684\u5176\u4ed6 objects \u65e0\u5173\uff01 \u4e0d\u50cf stack frame \u4e2d\uff0cobject \u7684 lifetime \u5728\u5176\u6240\u5728\u7684 stack frame \u88ab\u5efa\u7acb\u65f6\u5f00\u59cb\uff0c\u88ab destroy \u65f6\u7ed3\u675f\u3002 18.3.5 The BIG VOID(\u672a\u4f7f\u7528\u533a\u57df) \u4ee5\u53ca Stack The BIG VOID \u662f\u5728 heap segment \u548c stack segment \u4e4b\u95f4\u7684\u533a\u57df\uff0c for the stack and heap to grow. Stack \u5c31\u662f\u6211\u4eec\u719f\u6089\u7684\u6808\u3002Stack \u5728\u6240\u6709 segments \u7684\u6700\u9876\u4e0a\u3002 18.4 Dynamic arrays \u6211\u4eec\u5e73\u65f6\u7528\u7684 statically allocated array \u7684 size \u5fc5\u987b\u662f\u5728 compile time \u5c31\u786e\u5b9a\u7684 \uff0c\u8fd9\u662f C++ standard. \u4f46\u662f dynamically allocated array \u7684\u5927\u5c0f\u53ef\u4ee5\u5728 runtime \u88ab\u786e\u5b9a\u3002 int howMany; cin >> howMany; int *arrPtr = new int[howMany]; new \u521b\u5efa\u7684 dynamic array \u662f\u4e00\u4e2a\u6307\u5411\u5b83\u9996\u5143\u7d20\u7684 pointer. \u4f46\u662f\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528 [] operator \u6765\u83b7\u53d6\u5143\u7d20\u3002 int main() { cout << \"How many elements? \"; int howMany; cin >> howMany; int *arrPtr = new int[howMany]; for (int i = 0; i < howMany; ++i) arrPtr[i] = 42; } 18.4.1 delete[] \u6709\u4e00\u4e2a\u95ee\u9898\u662f\uff1aruntime environment \u662f\u65e0\u6cd5 distinguish \u5728 heap \u4e0a\u6307\u5411\u5355\u4e2a\u5143\u7d20\u548c\u6307\u5411 dynamic array \u7684\u9996\u5143\u7d20\u7684\u6307\u9488\u7684\u3002 \u56e0\u800c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u7279\u522b\u7684 delete[] syntax for arrays. int main() { int *ptr1 = new int(42); int *ptr2 = new int[howMany]; //... delete ptr1; delete[] ptr2; }","title":"Overview"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#18-memory-model-and-dynamic-memory","text":"","title":"18 Memory model and Dynamic Memory"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#181-globalstatic-localautomatic-and-dynamic-variables","text":"\u56de\u987e\uff1a \u4e00\u4e2a object \u662f memory \u4e2d\u7684 a piece of data. \u4e00\u4e2a object lives at an address in memory \u4e00\u4e2a object \u53ea\u80fd\u5728\u5176 lifetime \u88ab\u4f7f\u7528\uff0clifetime \u53d6\u51b3\u4e8e storage duration. c++ \u4e2d\u6709\u4e09\u79cd storage durations: \u25aa Global / static \u25aa Local / automatic \u25aa Dynamic","title":"18.1 Global(Static), Local(automatic) and dynamic variables"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1811-globalstatic-variables","text":"\u6709\u4e09\u79cd\uff1a \u7b2c\u4e00\u79cd: \u5728 function/class definition \u5916\u7684 globle variables. \u5728 program \u8fd0\u884c\u524d\u5c31\u88ab\u521b\u9020\uff0c\u4e00\u76f4\u751f\u5b58\u5230 program \u7ed3\u675f\u3002 c++ const int SIZE=10; int main() { //... } \u7b2c\u4e8c\u79cd: static within a class definition. c++ class Set { private: static const int CAPACITY = 100; //... }; static within a function c++ int main() { static const int SIZE = 10; //... }","title":"18.1.1 Global(static) variables"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1812-local-automatic-variables","text":"A local variable lives inside a block { } . \u5728 declaration \u88ab run \u7684\u65f6\u5019\u88ab initialized. \u5728 block finish \u7684\u65f6\u5019 die.","title":"18.1.2 Local (Automatic) variables"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1813-dynamic-variables","text":"Lifetime \u5728 runtime \u88ab\u51b3\u5b9a. Programmer \u51b3\u5b9a\u5b83\u88ab created \u4ee5\u53ca destroyed \u7684\u65f6\u95f4.","title":"18.1.3 Dynamic variables"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1814-dynamic-variables","text":"int * pointerToThree() { int x = 3; return &x; } int main() { int *z = pointerToThree(); cout << *z; } \u8fd9\u6bb5\u4ee3\u7801 error. \u56e0\u4e3a pointerToThree() \u521b\u9020\u7684 x \u53ca\u5176\u5730\u5740\u4f5c\u4e3a\u7684\u6307\u9488\u53d8\u91cf\u662f\u4e00\u4e2a local variable\uff0c\u5728 pointerToThree() \u8fd0\u884c\u7ed3\u675f\u7684\u65f6\u5019\u5c31\u65e0\u4e86\u3002\u56e0\u800c\u8fd9\u7247\u5730\u5740\u4e0a\u4e0d\u518d\u662f\u4e00\u4e2a int \u4e86\uff0c\u6240\u4ee5 type error. \u56e0\u800c\u6211\u4eec\u9700\u8981 dynamic variable. \u6211\u4eec\u53ef\u4ee5\u81ea\u4e3b\u63a7\u5236\u5176 lifetime\uff0c\u8fd9\u6837 pointers to the same object can exist in different scopes. \u9664\u4e86\u8fd9\u4e2a\u597d\u5904\u5916\uff0cheap \u7684\u5bb9\u91cf\u5927\u5c0f\u4e5f\u6bd4 stack \u8981\u8fdc\u5927\u3002","title":"18.1.4 \u4f7f\u7528 dynamic variables \u7684\u539f\u56e0"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#182-dynamic-memory","text":"","title":"18.2 Dynamic Memory \u7684\u4f7f\u7528"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1821-new","text":"new \u5728 dunamic memory \u4e2d \u521b\u9020\u4e00\u4e2a object\uff0c\u5e76 return \u6307\u5411\u8fd9\u4e2a object \u7684\u4e00\u4e2a pointer. int * pointerToThree() { int *p = new int; *p = 3; return p; } // \u6216\u8005 int * pointerToThree() { int *p = new int(3); return p; } \u5728\u8fd9\u91cc\uff0c p \u662f pointerToThree \u7684 stack frame \u4e2d\u7684\u4e00\u4e2a local variable\uff01 \u5b83\u7684\u7c7b\u578b\u662f int * . \u4e00\u65e6 pointerToThree \u8fd0\u884c\u7ed3\u675f\uff0c\u5b83\u5c31 die \u4e86. \u800c\u503c\u4e3a int(3) \u7684\u53d8\u91cf\u5219\u662f\u5728 heap \u7684 dynamic memory \u4e2d\u7684\u4e00\u4e2a int \u578b variable\u3002\u6211\u4eec\u5c06\u7528 int(3) \u6765\u79f0\u547c\u5b83\u3002\u6211\u4eec\u901a\u8fc7\u4f7f\u7528 new \u628a heap \u7684\u4e00\u6bb5 memory \u7ed9 allocate \u7ed9\u4e86\u5b83\u3002 \u5728 pointerToThree \u8fd0\u884c\u7ed3\u675f\u540e\uff0c\u5b83\u4ecd\u7136\u5b58\u5728\uff01 pointerToThree \u8fd0\u884c\u7ed3\u675f\u4e4b\u540e\uff0c p die \u4e86\uff0c p \u7684 memory \u88ab\u81ea\u52a8 release \u4e86\uff1b\u4f46\u662f p \u7684\u503c\uff0c\u4e5f\u5c31\u662f int(3) \u7684\u5730\u5740\uff0c\u88ab return \u4e86\u3002 \u53ea\u8981\u6211\u4eec\u4e0d\u624b\u52a8 delete \uff0c int(3) \u5c06\u59cb\u7ec8\u5728 dynamic memory \u76f4\u5230 program \u7ed3\u675f\uff01 \u73b0\u5728\u6211\u4eec\u8c03\u7528 pointerToThree \uff0c\u5c06\u5b83\u8fd4\u56de\u503c\u5206\u914d\u7ed9 main \u4e2d\u7684\u53d8\u91cf\u3002 int main() { int *z = pointerToThree(); cout << *z; //... } \u4e8e\u662f p \u7684\u503c\u5728 p \u6b7b\u540e\u88ab return \u7ed9\u4e86 main \u4e2d\u7684 int * \u53d8\u91cf z .","title":"18.2.1 new"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1822-delete","text":"delete \u53ef\u4ee5 destroy dynamic variables. int main() { int *z = pointerToThree(); cout << *z; delete z; } \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u6211\u4eec\u5199\u7684\u662f delete z \uff0c z \u662f\u4e00\u4e2a main \u7684 stackframe \u4e2d\u7684\u4e00\u4e2a local variable\uff0c\u4f46\u5176\u5b9e\u5b83\u505a\u7684\u662f destroy z \u6240\u6307\u5411\u7684 dynamic memory \u4e2d\u7684 dynamic object \uff0c\u4e5f\u5c31\u662f\u503c\u4e3a int(3) \u7684\u90a3\u4e2a\u53d8\u91cf\uff01 \u5728\u6211\u4eec\u7684 delete \u4e4b\u540e\uff1a z \u4ecd\u7136\u6307\u5411 heap \u4e2d\u7684\u540c\u4e00\u4f4d\u7f6e\uff0c z \u7684\u503c\u5e76\u4e0d\u4f1a\u6539\u53d8\uff01\uff01 \u4f46\u6b64\u65f6\u6211\u4eec\u5df2\u7ecf\u4e0d\u80fd dereference \u5b83\u4e86\uff0c\u8fd9\u4f1a\u662f\u4e00\u4e2a undefined behavior. \u6211\u4eec\u53ef\u4ee5\u91cd\u65b0\u7ed9 z \u8d4b\u503c \u6211\u4eec\u6ce8\u610f\u5230\u6709\u4e00\u4e2a\u6bd4\u8f83\u62bd\u8c61\u7684\u4e8b\u60c5\uff1a \u6211\u4eec\u53d1\u73b0\u5728 delete \u540e dereference z \u6765\u83b7\u53d6\u5df2\u7ecf\u91ca\u653e\u7684 dynamic memory \u4e0a\u7684\u4e1c\u897f\u4ecd\u7136\u662f\u53ef\u4ee5\u7684\uff0c**\u53ea\u662f\u4e00\u4e2a undefined behavior \u800c\u4e0d\u662f\u4e00\u4e2a error. ** \u7406\u8bba\u4e0a\uff0c\u5728 delete \u4ee5\u540e\uff0c\u8be5 object \u6240\u5360\u7528\u7684 memory \u88ab\u5f52\u8fd8\u7ed9 operating system \u4e86\uff0c\u7528\u4e8e\u672a\u6765\u7684 allocation\u3002\u4ece\u903b\u8f91\u4e0a\u8be5 object \u4e0d\u518d\u5b58\u5728. \u7136\u800c\uff0c\u5728\u7269\u7406\u5c42\u9762\u4e0a\uff0c\u8be5 memory \u5728\u88ab delete \u4e4b\u540e\u4e0e\u7acb\u5373\u91cd\u7528\u4e4b\u524d\uff0c\u5176\u5185\u5bb9\u53ef\u80fd\u4ecd\u7136\u4fdd\u7559\u672a\u66f4\u6539\u7684\u72b6\u6001\uff0c\u5c31\u662f\u8bf4\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u503c\u53ef\u80fd\u4ecd\u7136\u662f\u4e00\u4e2a int(3) . \u7136\u800c\u6b64\u65f6 dereferene \u662f undefined behavior\uff0c\u662f\u4e0d\u5b89\u5168\u7684\u3002","title":"18.2.2 delete"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#18221-assertnullptr","text":"\u6709\u4e00\u4e2a\u597d\u7684\u505a\u6cd5\u7ed9\u6307\u5411\u5df2\u7ecf\u5220\u9664\u7684 dynamic object \u7684 ptr \u53d8\u91cf\u5206\u914d nullptr \uff0c\u8fd9\u6837\u9996\u5148\u8fd9\u4e2a ptr \u5c31\u4e0d\u518d\u662f\u4e00\u4e2a dangling pointer \u4e86\uff0c\u5176\u6b21\u6211\u4eec\u53ef\u4ee5\u5728\u5408\u9002\u7684\u5730\u65b9 assert \u5b83\u6765 identify problems. \u6ce8\u610f\uff1a assert(nullptr) \u7684\u7ed3\u679c\u662f segfault\uff0c\u56e0\u800c\u5b83\u6709\u52a9\u4e8e\u52d8\u63a2\u95ee\u9898\u3002 int main() { int *p = new int(100); delete p; p = nullptr; assert(p); //SegError }","title":"18.2.2.1 assert(nullptr)"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1823-pitfall-double-delete-undefined-behavior","text":"int main() { int *p1 = new int(3); int *p2 = p1; // p2 \u73b0\u5728\u4e5f\u6307\u5411\u8be5 dynamic object delete p1; // delete \u4e86\u8fd9\u4e2a dynamic object delete p2; // double delete, Undefined behavior! } \u8fd9\u91cc p1 \u548c p2 \u6307\u5411\u7684\u662f\u540c\u4e00\u4e2a dynamic object\uff0c\u56e0\u800c\u53ea\u9700\u8981\u4e5f\u53ea\u81f3\u591a\u5e94\u8be5 delete \u4e00\u6b21\u3002\u5982\u679c\u6211\u4eec\u5fd8\u8bb0\u4e86\uff0c\u524d\u540e delete \u4e86 p1 \u53c8 delete \u4e86 p2 \uff0c\u90a3\u4e48\u5c31\u4f1a\u5bfc\u81f4 undefined behavior\uff0c\u5e76\u4e14\u5f88\u53ef\u80fd runtime error.","title":"18.2.3 Pitfall: double delete \u662f undefined behavior"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1824-pitfall-memory-leak","text":"int main() { int *p1 = new int(1); int *p2 = new int(2); p1 = p2; // \u73b0\u5728\u6ca1\u6709\u4e1c\u897f\u6307\u5411\u503c\u4e3a int(1) \u7684\u90a3\u4e2a dynamic object \u4e86 delete p1; } // how much memory is leaked? sizeof(int) == 4B. Dynamic variables \u4f1a\u4e00\u76f4\u5b58\u5728\u76f4\u5230\u88ab delete \uff0c\u5373\u4fbf\u5df2\u7ecf\u6ca1\u6709\u4e1c\u897f\u6307\u5411\u5b83\u4e86\u3002 \u8fd9\u4e5f\u610f\u5473\u7740\uff1a \u6211\u4eec\u5982\u679c\u4e0d\u5c0f\u5fc3\u628a\u6307\u5411\u4e00\u4e2a dynamic object \u7684 ptr \u53d8\u91cf\u7684\u503c\u6539\u6389\uff0c\u8ba9\u5b83\u4e0d\u518d\u6307\u5411\u8fd9\u4e2a dynamic object\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u518d\u4e5f\u65e0\u6cd5 delete \u5b83\u4e86\u3002 \u8fd9\u5c31\u53eb\u505a\u4e00\u4e2a memory leak. \u4e0d\u4ec5\u5982\u6b64\uff0c\u6709\u5f88\u591a\u4e2a\u6e20\u9053\u80fd\u591f\u5bfc\u81f4\u8fd9\u79cd\u4e8b\u60c5\u3002\u6bd4\u5982\u6307\u5411 dynamic object \u7684 ptr \u53d8\u91cf\u51fa\u4e86\u81ea\u5df1\u7684 scope \u6b7b\u4e86\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u628a\u503c\u4f20\u9012\u51fa\u53bb\u3002 void f() { int *p = new int(1); cout << *p; } int main() { f(); // memory leak }","title":"18.2.4 Pitfall: memory leak!"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#183-program-segments","text":"\u4e00\u4e2a running program \u6709\u4e00\u4e2a \"address space\", \u5c31\u662f\u4e00\u7cfb\u5217 memory locations that are accessible to it. \u6bcf\u4e2a address space \u90fd private \u4e8e\u4e00\u4e2a running program\uff0c\u6ca1\u6709\u5176\u4ed6\u7684 running program \u80fd\u591f access \u6216\u8005 modify \u5b83\uff01 \u9664\u4e86 heap segment \u4e4b\u5916\uff0c\u4e00\u4e2a running program \u8fd8\u6709\u5176\u4ed6\u7684 segments. Operating system manages virtual memory \uff0c\u4f7f\u5f97 \u6bcf\u4e2a program \u90fd\u80fd\u591f\u88c5\u4f5c\u5b83 occupies \u6574\u4e2a address space \uff0c\u4ece address 0 \u5230 address max.","title":"18.3 Program Segments"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1831-the-little-void","text":"\u5927\u591a\u6570 operating systems \u90fd reserve \u4e86\u4ece 0 \u5f00\u59cb\u7684\u524d\u51e0\u5343\u4e2a addresses\uff0c\u8fd9\u90e8\u5206\u6784\u6210\u4e86 the little void . (Ps: address 0 \u4e5f\u5c31\u662f\u6240\u6709 nullptr \u5b58\u50a8\u7684\u5730\u5740)","title":"18.3.1 The little void"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1832-text-segment","text":"\u8fd9\u4e2a segment \u5305\u542b\u7684\u662f the machine code (\u4e5f\u5c31\u662f binary)\uff0c\u5305\u542b\u4e86\u6574\u4e2a compiled program \u7684 binary code\u3002\u5b83\u7684 address \u6240\u5728\u4f4d\u7f6e\u4e5f\u5f88\u4f4e\uff0c\u4ec5\u5728 little void \u4e4b\u540e\u3002","title":"18.3.2 Text segment"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1833-global-segment","text":"space for the global variables \u4ee5\u53ca static variables.","title":"18.3.3 Global segment"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1834-heap-segment","text":"new \u548c delete \u662f c++ \u4e2d\u6211\u4eec interact with heap segment \u7684\u65b9\u6cd5\uff0c\u800c C \u4e2d\u6211\u4eec\u4e5f\u6709\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff0c malloc() \u548c free() \u5c31\u662f C \u7684 new \u548c delete . heap segment \u4e2d\uff0c \u6bcf\u4e2a heap object \u90fd\u6709\u81ea\u5df1\u7684 lifetime\uff0c\u4e0e\u5b83\u5468\u56f4\u7684\u5176\u4ed6 objects \u65e0\u5173\uff01 \u4e0d\u50cf stack frame \u4e2d\uff0cobject \u7684 lifetime \u5728\u5176\u6240\u5728\u7684 stack frame \u88ab\u5efa\u7acb\u65f6\u5f00\u59cb\uff0c\u88ab destroy \u65f6\u7ed3\u675f\u3002","title":"18.3.4 Heap segment"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1835-the-big-void-stack","text":"The BIG VOID \u662f\u5728 heap segment \u548c stack segment \u4e4b\u95f4\u7684\u533a\u57df\uff0c for the stack and heap to grow. Stack \u5c31\u662f\u6211\u4eec\u719f\u6089\u7684\u6808\u3002Stack \u5728\u6240\u6709 segments \u7684\u6700\u9876\u4e0a\u3002","title":"18.3.5 The BIG VOID(\u672a\u4f7f\u7528\u533a\u57df) \u4ee5\u53ca Stack"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#184-dynamic-arrays","text":"\u6211\u4eec\u5e73\u65f6\u7528\u7684 statically allocated array \u7684 size \u5fc5\u987b\u662f\u5728 compile time \u5c31\u786e\u5b9a\u7684 \uff0c\u8fd9\u662f C++ standard. \u4f46\u662f dynamically allocated array \u7684\u5927\u5c0f\u53ef\u4ee5\u5728 runtime \u88ab\u786e\u5b9a\u3002 int howMany; cin >> howMany; int *arrPtr = new int[howMany]; new \u521b\u5efa\u7684 dynamic array \u662f\u4e00\u4e2a\u6307\u5411\u5b83\u9996\u5143\u7d20\u7684 pointer. \u4f46\u662f\u6211\u4eec\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528 [] operator \u6765\u83b7\u53d6\u5143\u7d20\u3002 int main() { cout << \"How many elements? \"; int howMany; cin >> howMany; int *arrPtr = new int[howMany]; for (int i = 0; i < howMany; ++i) arrPtr[i] = 42; }","title":"18.4 Dynamic arrays"},{"location":"18-Memory-Model-and-Dynamic-Memory.html#1841-delete","text":"\u6709\u4e00\u4e2a\u95ee\u9898\u662f\uff1aruntime environment \u662f\u65e0\u6cd5 distinguish \u5728 heap \u4e0a\u6307\u5411\u5355\u4e2a\u5143\u7d20\u548c\u6307\u5411 dynamic array \u7684\u9996\u5143\u7d20\u7684\u6307\u9488\u7684\u3002 \u56e0\u800c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u7279\u522b\u7684 delete[] syntax for arrays. int main() { int *ptr1 = new int(42); int *ptr2 = new int[howMany]; //... delete ptr1; delete[] ptr2; }","title":"18.4.1 delete[]"},{"location":"19-Managing-Dynamic-Memory.html","text":"19 Managing Dynamic Memory 19.1.1 (\u9898\u5916\u8bdd) constructor \u7684 default argument 19.1.2 Destructor 19.1.3 \u5982\u679c class object \u672c\u8eab\u662f dynamic \u7684: destructor \u4f1a\u5728 delete class object \u65f6\u81ea\u52a8\u8fd0\u884c 19.1.4 RAII principle: Resource Acquisition is Initialization 19.2 \u66f4\u6539\u5176\u4ed6 function implementations \u4ee5\u9002\u5e94 dynamic set 19.2.1 insert 19.3 Performance of Set \u9898\u5916\u8bdd: garbage collection \u548c smart pointer 19 Managing Dynamic Memory Review: Memory leaks/errors memory leak : object \u65e0\u6cd5 delete orphaned memory : \u5931\u53bb address \u7684 hold \u4f7f\u5f97 leak \u4e0d\u53ef\u907f\u514d double delete : \u5c1d\u8bd5 delete \u540c\u4e00\u4e2a heap object \u591a\u6b21 Non-heap delete : \u5bf9\u4e00\u4e2a\u6307\u5411 non-heap object \u7684 ptr \u4f7f\u7528 delete wrong delete : \u9519\u7528 delete \u548c delete[] use a dead object : dereference \u4e86\u4e00\u4e2a\u5df2\u7ecf dead \u7684 heap object. ## 19.1 Building dynamic set with dynamic array \u6211\u4eec\u4e4b\u524d\u5199\u7684 set \u7684\u5927\u5c0f\u5b9e\u9645\u4e0a\u662f\u56fa\u5b9a\u7684\u3002\u6211\u4eec\u7528\u4e86\u4e00\u4e2a const \u7684 Capacity \u4f5c\u4e3a array \u5927\u5c0f\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u901a\u8fc7\u9650\u5236\u7528\u6237\u80fd\u591f\u63a5\u89e6\u5230\u7684\u5143\u7d20\u6765\u6a21\u62df set \u7684\u5927\u5c0f\u53d8\u52a8\u3002 \u8fd9\u4e2a set \u7684\u4e00\u4e2a\u5f88\u5927\u7684\u7f3a\u70b9\u662f\uff1aset \u7684\u5143\u7d20\u7684\u6570\u91cf\u4e0a\u9650\u5f88\u660e\u786e\u3002\u5982\u679c\u6211\u4eec\u628a Capacity \u8bbe\u4e3a 100\uff0c\u90a3\u5c31\u53ea\u80fd\u88c5 100 \u4e2a\u5143\u7d20\uff1b\u5982\u679c\u6211\u4eec\u628a Capacity \u8bbe\u4e3a 10000\uff0c\u90a3\u4e48\u6211\u4eec\u6bcf\u5efa\u7acb\u4e00\u4e2a set \u5c31\u4f1a\u5360\u636e\u5927\u91cf\u7684 stack memory\uff0c\u5373\u4fbf\u6211\u4eec\u53ea\u9700\u8981\u51e0\u4e2a\u5143\u7d20\u7684 set. \u800c\u73b0\u5728\u6211\u4eec\u4f1a\u5199 dynamic array \u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u771f\u6b63\u5927\u5c0f\u52a8\u6001\u53d8\u5316\u7684 set. template <typename T> class ordered_set { private: static const int DEFAULT_CAPACITY = 100; // for default ctor T *ele; // dynamic array int size; int current_capacity; // dynamic capacity public: ordered_set(); ordered_set(int capacity); } \u7136\u540e\u6211\u4eec\u5199 ctors: template <typename T> ordered_set<T>::ordered_set() :size(0), current_capacity(DEFAULT_CAPACITY) { ele = new int[current_capacity]; // \u521b\u9020 dynamic array } // overloaded ctor template <typename T> ordered_set<T>::ordered_set(int capacity) :size(0), current_capacity(capacity) { ele = new int[current_capacity]; } \u8fd9\u79cd\u53ea\u9700\u8981\u4f20\u4e00\u4e2a\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\u6211\u4eec\u4e5f\u53ef\u4ee5\u53ea\u5199\u4e00\u4e2a\u5e26\u6709 default argument \u7684 ctor: template <typename T> class ordered_set { private: static const int DEFAULT_CAPACITY = 100; // for default ctor T *ele; // dynamic array int size; int current_capacity; // dynamic capacity public: ordered_set(int capacity = DEFAULT_CAPACITY); } 19.1.1 (\u9898\u5916\u8bdd) constructor \u7684 default argument C++ \u7684 class ctor \u7684 default argument \u5b8c\u5168\u4e0d\u5982 python \u7075\u6d3b\u3002 function call \u7684 arguments \u987a\u5e8f\u5fc5\u987b\u548c declaration \u4e2d\u7684\u5339\u914d\u3002 \u53ea\u6709 declaration \u7684 parameter list \u4e2d\u7684\u6700\u540e\u4e00\u4e2a parameter \u624d\u5141\u8bb8\u6709 default value\uff01 \u6240\u4ee5\u57fa\u672c\u6ca1\u4ec0\u4e48\u7528\u3002\u4f46\u662f\u8fd9\u79cd\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\u7684 ctor \u4e2d\u8fd8\u662f\u6bd4\u8f83\u6709\u7528\u7684\u3002 19.1.2 Destructor \u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u5728 constructor \u4e2d\u521b\u5efa\u4e86\u4e00\u4e2a\u52a8\u6001\u6570\u7ec4\uff0c\u4f46\u662f\u6211\u4eec\u5e76\u6ca1\u6709\u8bbe\u7f6e\u65b9\u6cd5\u6765\u5220\u9664\u5b83\uff0c\u8fd9\u4f1a\u5bfc\u81f4 memory leak. \u5c24\u5176\u662f\u5f53\u6211\u4eec\u5728\u4e00\u4e9b\u51fd\u6570\u4e2d\u521b\u5efa dynamic set \u65f6\uff1a void foo() { Unordered set is; } // memory leak when foo() is called \u6211\u4eec\u81ea\u7136\u5730\u60f3\u5230\u4e00\u4e2a\u529e\u6cd5\uff0c\u5c31\u662f\u5199\u4e00\u4e2a Unordered_set::delete_array() \u4e4b\u7c7b\u7684\u65b9\u6cd5\u3002\u4f46\u662f\uff1a1. \u5b83\u4f1a\u7834\u574f encapsulation(\u5c01\u88c5)\uff1b2. \u6211\u4eec\u6bcf\u521b\u5efa\u4e00\u4e2a dynamic set \u90fd\u8981\u8bb0\u5f97 call \u8fd9\u4e2a\u51fd\u6570. C++ \u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u52a0\u597d\u7684\u529e\u6cd5\uff1adestructor\uff0c\u7b80\u79f0 dtor. Destructor run automatically when an object is destroyed. \u6bd4\u5982\u5f53 is \u662f\u4e00\u4e2a\u4f5c\u4e3a local variable \u7684 set\uff0c\u5b83\u5728\u51fa scope \u65f6\u4f1a\u81ea\u52a8\u8fd0\u884c dtor\uff1b\u5f53 is \u662f\u4e00\u4e2a global variable \u65f6\uff0c\u4ed6\u5728 program \u7ed3\u675f\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8fd0\u884c dtor. local variable: int foo() { ordered_set is; // ctor runs } // dtor runs global variable: ordered_set is; // ctor runs int main() {} // dtor runs \u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u80fd\u591f delete \u6240\u6709\u7531\u8fd9\u4e2a class object \u521b\u5efa\u7684 dynamic variables \u7684 destructor. \u5199\u6cd5\u662f\uff1a class ordered_set { public: //.. ~ordered_set(); private: //.. }; ordered_set::~ordered_set() { delete[] ele; } 19.1.3 \u5982\u679c class object \u672c\u8eab\u662f dynamic \u7684: destructor \u4f1a\u5728 delete class object \u65f6\u81ea\u52a8\u8fd0\u884c void foo() { ordered_set *ptr = new ordered_set(3); // memory leak } \u5728\u8fd9\u4e2a\u51fd\u6570\u8fd0\u884c\u7ed3\u675f\u540e\uff0c\u6709\u591a\u5c11\u4e2a Bytes \u7684 memory \u88ab leak \u4e86\uff1f \uff08\u5047\u8bbe int \u4e3a 4B\uff0c int * \u4e3a 8B\uff09 3 * sizeof(int) // int[3] + sizeof(int *) // ele + sizeof(int) // current_capacity + sizeof(int) // size = 28B (leaked) \u6240\u4ee5\u6211\u4eec\u9700\u8981 delete \u6765\u9632\u6b62\u8fd9\u4e9b memory leak. void foo() { ordered_set *ptr = new ordered_set(3); delete ptr; // ok } \u5728\u6211\u4eec delete ptr \uff0c\u4e5f\u5c31\u662f\u5220\u9664\u4e86 ptr \u6307\u5411\u7684 heap \u4e2d\u7684 dynamic sorted_set object \u4e4b\u540e\uff0c\u8be5 object \u81ea\u52a8\u8fd0\u884c dtor \u5220\u9664\u4e86\u5b83\u7684 dynamic variables. 19.1.4 RAII principle: Resource Acquisition is Initialization RAII(Resource Acquisition is Initialization) \u7684\u610f\u601d\u662f\uff1a\u4e00\u4e2a resource (\u6bd4\u5982\u4e00\u4e2a dynamic array) \u7684 life \u5e94\u8be5\u88ab bound to \u9700\u8981\u8fd9\u4e2a resource \u7684 object \u7684 lifetime (\u6bd4\u5982\u8fd9\u4e2a dynamic array \u5bf9\u5e94\u7684 sorted_set instance). \u5728 C++ \u4e2d\u5c31\u5bf9\u5e94\u4e86\u4f7f\u7528 new \u7684 constructor \u548c\u4f7f\u7528 delete \u7684 destructor. 19.2 \u66f4\u6539\u5176\u4ed6 function implementations \u4ee5\u9002\u5e94 dynamic set 19.2.1 insert \u7531\u4e8e\u5bf9 dynamic array \u7684\u4f7f\u7528\uff0c\u6211\u4eec\u5e94\u8be5\u66f4\u6539\u539f\u672c\u7684 insert \u51fd\u6570\u4f7f\u5176\u9002\u5e94 dynamic set. \u6211\u4eec\u5e94\u8be5\uff1a new \u4e00\u4e2a\u66f4\u5927\u7684 dynamic array. \u628a\u539f\u672c\u7684 dynamic array \u590d\u5236\u8fdb\u53bb. delete \u539f\u672c\u7684 dynamic array. \u8ba9 ptr \u6210\u5458\u6307\u5411\u65b0\u7684 dynamic array\uff0c\u5e76\u66f4\u65b0 capacity template <typename T> void ordered_set<T>::grow() { // new a dynamic array into a temporary ptr var int *tmp = new int[current_capacity + 1]; // copy the original dynamic array into the new one for (int i = 0; i < size; i++) { tmp[i] = ele[i]; } delete[] elts; // delete the original dynamic array elts = tmp; // reassign the value of tmp to elts current_capacity++; // update capacity } template <typename T> void ordered_set<T>::insert(T e) { if (contains(e)) return; if (size == current_capacity) {grow();} // grow capacity ele[size++] = v; // increase size to catch up capacity; also inserts new element } 19.3 Performance of Set \u6bcf\u5f53 grow \u88ab call \u7684\u65f6\u5019\uff0c\u6709\u591a\u5c11 elements \u88ab copy \u4e86\uff1f int main() { ordered_set<int> is(1); int n; cin >> n; is.insert(0); is.insert(1); // grow(), 1 copy is.insert(2); // grow(), 2 copies //... is.insert(n); // grow(), n copies // total = 1+2+...+n = n(1+n)/2 copied // So the number of int-copy operations needed is in O(n^2) } \u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u975e\u5e38\u9ad8 \u5e94\u8be5\u4f18\u5316\u4e00\u4e0b\u3002 \u6ce8\u610f\u5230\u6211\u4eec\u7684\u6761\u4ef6\uff1a if (size == current_capacity) {grow();} // grow capacity \u76f4\u5230 size \u8d76\u4e0a capacity \u4e86\uff0c\u6211\u4eec\u624d\u4f7f\u7528 grow() \u6765\u91cd\u65b0\u5efa array\uff0c\u91cd\u65b0 copy. \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u5728 grow \u4e2d\u4e0d\u8981\u4e00\u683c\u4e00\u683c grow\uff0c\u800c\u662f\u9009\u62e9\u4e00\u6b21 grow \u5927\u4e00\u70b9\uff0c\u6bd4\u5982\u6bcf\u6b21 grow \u90fd\u628a array \u7684\u5927\u5c0f\u53d8\u6210\u4e24\u500d template <typename T> void ordered_set<T>::grow() { int *tmp = new int[current_capacity * 2]; // grow \u4e24\u500d for (int i = 0; i < size; i++) { tmp[i] = ele[i]; } delete[] elts; elts = tmp; current_capacity *= 2; } \u8fd9\u6837\u7684\u8bdd\uff1a int main() { Unordered_set is(1); is.insert(0); is.insert(1); // grow(), 1 copy, new capacity=2 is.insert(2); // grow(), 2 copies, new capacity=4 is.insert(3); is.insert(4); // grow(), 4 copies, new capacity=8 is.insert(5); is.insert(6); is.insert(7); is.insert(8); // grow(), 8 copies, new capacity=16 // \u2026 } \u73b0\u5728\u5bf9\u4e8e\u521b\u5efa N \u4e2a\u5143\u7d20\u7684 set\uff0ccopy \u7684\u603b\u6b21\u6570\u4e3a\uff1a $$ T = (N-1) + (N/2 -1) + (N/4 - 1) + \\cdots + 2 + 1 \\ < N + N/2 + N/4 + \\cdots + 2 + 1 = 2N $$ \u56e0\u800c time complexity \u9a6c\u4e0a\u4e0b\u964d\u5230\u4e86 $O(n)$. \u9898\u5916\u8bdd: garbage collection \u548c smart pointer \u6709\u4e00\u4e9b languages \u5141\u8bb8 compiler \u81ea\u52a8\u5220\u9664 dynamic variables\uff0c\u53ea\u8981\u5b83\u4eec\u4e0d\u518d\u88ab\u9700\u8981\u3002 \u8fd9\u4e2a\u884c\u4e3a\u53eb\u505a garbage collections. \u4f46\u662f\u8fd9\u4e2a\u884c\u4e3a\u6709\u4e00\u5b9a\u7684\u4ee3\u4ef7\uff1a\u9996\u5148\u80af\u5b9a\u964d\u4f4e\u4e86\u8fd0\u884c\u901f\u5ea6\uff0c\u5176\u6b21\u4e0d\u6e05\u6670\u7075\u6d3b\uff1agarbage collection behavior may vary, but manual deletion is a clear part of the standard. \u6211\u4eec\u73b0\u5728\u76ee\u524d\u4e3a\u6b62\u8ba8\u8bba\u7684\u90fd\u662f raw pointers . \u800c C++ 11 \u4ee5\u4e0a\u7684\u7248\u672c\u5141\u8bb8\u4f7f\u7528 smart pointers \uff0c\u8fd9\u4e9b smart pointers \u53ef\u4ee5\u505a\u4e00\u4e9b garbage collector \u7684\u4e8b\u60c5\u3002 unique_ptr : only a single pointer to the dynamic variable is possible shared_ptr : multiple pointers to the dynamic variable are possible. When all those pointers are destroyed, the dynamic variable is destroyed. weak_ptr : \u53ea\u8981\u6240\u6709\u6307\u5411\u4e00\u4e2a dynamic variable \u7684 shared_ptr \u88ab destroy\uff0c\u90a3\u4e48\u6307\u5411\u5b83\u7684 weak-ptr \u4e5f\u9a6c\u4e0a\u88ab destroy.","title":"Overview"},{"location":"19-Managing-Dynamic-Memory.html#19-managing-dynamic-memory","text":"Review: Memory leaks/errors memory leak : object \u65e0\u6cd5 delete orphaned memory : \u5931\u53bb address \u7684 hold \u4f7f\u5f97 leak \u4e0d\u53ef\u907f\u514d double delete : \u5c1d\u8bd5 delete \u540c\u4e00\u4e2a heap object \u591a\u6b21 Non-heap delete : \u5bf9\u4e00\u4e2a\u6307\u5411 non-heap object \u7684 ptr \u4f7f\u7528 delete wrong delete : \u9519\u7528 delete \u548c delete[] use a dead object : dereference \u4e86\u4e00\u4e2a\u5df2\u7ecf dead \u7684 heap object. ## 19.1 Building dynamic set with dynamic array \u6211\u4eec\u4e4b\u524d\u5199\u7684 set \u7684\u5927\u5c0f\u5b9e\u9645\u4e0a\u662f\u56fa\u5b9a\u7684\u3002\u6211\u4eec\u7528\u4e86\u4e00\u4e2a const \u7684 Capacity \u4f5c\u4e3a array \u5927\u5c0f\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u901a\u8fc7\u9650\u5236\u7528\u6237\u80fd\u591f\u63a5\u89e6\u5230\u7684\u5143\u7d20\u6765\u6a21\u62df set \u7684\u5927\u5c0f\u53d8\u52a8\u3002 \u8fd9\u4e2a set \u7684\u4e00\u4e2a\u5f88\u5927\u7684\u7f3a\u70b9\u662f\uff1aset \u7684\u5143\u7d20\u7684\u6570\u91cf\u4e0a\u9650\u5f88\u660e\u786e\u3002\u5982\u679c\u6211\u4eec\u628a Capacity \u8bbe\u4e3a 100\uff0c\u90a3\u5c31\u53ea\u80fd\u88c5 100 \u4e2a\u5143\u7d20\uff1b\u5982\u679c\u6211\u4eec\u628a Capacity \u8bbe\u4e3a 10000\uff0c\u90a3\u4e48\u6211\u4eec\u6bcf\u5efa\u7acb\u4e00\u4e2a set \u5c31\u4f1a\u5360\u636e\u5927\u91cf\u7684 stack memory\uff0c\u5373\u4fbf\u6211\u4eec\u53ea\u9700\u8981\u51e0\u4e2a\u5143\u7d20\u7684 set. \u800c\u73b0\u5728\u6211\u4eec\u4f1a\u5199 dynamic array \u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u771f\u6b63\u5927\u5c0f\u52a8\u6001\u53d8\u5316\u7684 set. template <typename T> class ordered_set { private: static const int DEFAULT_CAPACITY = 100; // for default ctor T *ele; // dynamic array int size; int current_capacity; // dynamic capacity public: ordered_set(); ordered_set(int capacity); } \u7136\u540e\u6211\u4eec\u5199 ctors: template <typename T> ordered_set<T>::ordered_set() :size(0), current_capacity(DEFAULT_CAPACITY) { ele = new int[current_capacity]; // \u521b\u9020 dynamic array } // overloaded ctor template <typename T> ordered_set<T>::ordered_set(int capacity) :size(0), current_capacity(capacity) { ele = new int[current_capacity]; } \u8fd9\u79cd\u53ea\u9700\u8981\u4f20\u4e00\u4e2a\u53c2\u6570\u7684\u60c5\u51b5\u4e0b\u6211\u4eec\u4e5f\u53ef\u4ee5\u53ea\u5199\u4e00\u4e2a\u5e26\u6709 default argument \u7684 ctor: template <typename T> class ordered_set { private: static const int DEFAULT_CAPACITY = 100; // for default ctor T *ele; // dynamic array int size; int current_capacity; // dynamic capacity public: ordered_set(int capacity = DEFAULT_CAPACITY); }","title":"19 Managing Dynamic Memory"},{"location":"19-Managing-Dynamic-Memory.html#1911-constructor-default-argument","text":"C++ \u7684 class ctor \u7684 default argument \u5b8c\u5168\u4e0d\u5982 python \u7075\u6d3b\u3002 function call \u7684 arguments \u987a\u5e8f\u5fc5\u987b\u548c declaration \u4e2d\u7684\u5339\u914d\u3002 \u53ea\u6709 declaration \u7684 parameter list \u4e2d\u7684\u6700\u540e\u4e00\u4e2a parameter \u624d\u5141\u8bb8\u6709 default value\uff01 \u6240\u4ee5\u57fa\u672c\u6ca1\u4ec0\u4e48\u7528\u3002\u4f46\u662f\u8fd9\u79cd\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\u7684 ctor \u4e2d\u8fd8\u662f\u6bd4\u8f83\u6709\u7528\u7684\u3002","title":"19.1.1 (\u9898\u5916\u8bdd) constructor \u7684 default argument"},{"location":"19-Managing-Dynamic-Memory.html#1912-destructor","text":"\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u5728 constructor \u4e2d\u521b\u5efa\u4e86\u4e00\u4e2a\u52a8\u6001\u6570\u7ec4\uff0c\u4f46\u662f\u6211\u4eec\u5e76\u6ca1\u6709\u8bbe\u7f6e\u65b9\u6cd5\u6765\u5220\u9664\u5b83\uff0c\u8fd9\u4f1a\u5bfc\u81f4 memory leak. \u5c24\u5176\u662f\u5f53\u6211\u4eec\u5728\u4e00\u4e9b\u51fd\u6570\u4e2d\u521b\u5efa dynamic set \u65f6\uff1a void foo() { Unordered set is; } // memory leak when foo() is called \u6211\u4eec\u81ea\u7136\u5730\u60f3\u5230\u4e00\u4e2a\u529e\u6cd5\uff0c\u5c31\u662f\u5199\u4e00\u4e2a Unordered_set::delete_array() \u4e4b\u7c7b\u7684\u65b9\u6cd5\u3002\u4f46\u662f\uff1a1. \u5b83\u4f1a\u7834\u574f encapsulation(\u5c01\u88c5)\uff1b2. \u6211\u4eec\u6bcf\u521b\u5efa\u4e00\u4e2a dynamic set \u90fd\u8981\u8bb0\u5f97 call \u8fd9\u4e2a\u51fd\u6570. C++ \u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u52a0\u597d\u7684\u529e\u6cd5\uff1adestructor\uff0c\u7b80\u79f0 dtor. Destructor run automatically when an object is destroyed. \u6bd4\u5982\u5f53 is \u662f\u4e00\u4e2a\u4f5c\u4e3a local variable \u7684 set\uff0c\u5b83\u5728\u51fa scope \u65f6\u4f1a\u81ea\u52a8\u8fd0\u884c dtor\uff1b\u5f53 is \u662f\u4e00\u4e2a global variable \u65f6\uff0c\u4ed6\u5728 program \u7ed3\u675f\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8fd0\u884c dtor. local variable: int foo() { ordered_set is; // ctor runs } // dtor runs global variable: ordered_set is; // ctor runs int main() {} // dtor runs \u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u80fd\u591f delete \u6240\u6709\u7531\u8fd9\u4e2a class object \u521b\u5efa\u7684 dynamic variables \u7684 destructor. \u5199\u6cd5\u662f\uff1a class ordered_set { public: //.. ~ordered_set(); private: //.. }; ordered_set::~ordered_set() { delete[] ele; }","title":"19.1.2 Destructor"},{"location":"19-Managing-Dynamic-Memory.html#1913-class-object-dynamic-destructor-delete-class-object","text":"void foo() { ordered_set *ptr = new ordered_set(3); // memory leak } \u5728\u8fd9\u4e2a\u51fd\u6570\u8fd0\u884c\u7ed3\u675f\u540e\uff0c\u6709\u591a\u5c11\u4e2a Bytes \u7684 memory \u88ab leak \u4e86\uff1f \uff08\u5047\u8bbe int \u4e3a 4B\uff0c int * \u4e3a 8B\uff09 3 * sizeof(int) // int[3] + sizeof(int *) // ele + sizeof(int) // current_capacity + sizeof(int) // size = 28B (leaked) \u6240\u4ee5\u6211\u4eec\u9700\u8981 delete \u6765\u9632\u6b62\u8fd9\u4e9b memory leak. void foo() { ordered_set *ptr = new ordered_set(3); delete ptr; // ok } \u5728\u6211\u4eec delete ptr \uff0c\u4e5f\u5c31\u662f\u5220\u9664\u4e86 ptr \u6307\u5411\u7684 heap \u4e2d\u7684 dynamic sorted_set object \u4e4b\u540e\uff0c\u8be5 object \u81ea\u52a8\u8fd0\u884c dtor \u5220\u9664\u4e86\u5b83\u7684 dynamic variables.","title":"19.1.3 \u5982\u679c class object \u672c\u8eab\u662f dynamic \u7684: destructor \u4f1a\u5728 delete class object \u65f6\u81ea\u52a8\u8fd0\u884c"},{"location":"19-Managing-Dynamic-Memory.html#1914-raii-principle-resource-acquisition-is-initialization","text":"RAII(Resource Acquisition is Initialization) \u7684\u610f\u601d\u662f\uff1a\u4e00\u4e2a resource (\u6bd4\u5982\u4e00\u4e2a dynamic array) \u7684 life \u5e94\u8be5\u88ab bound to \u9700\u8981\u8fd9\u4e2a resource \u7684 object \u7684 lifetime (\u6bd4\u5982\u8fd9\u4e2a dynamic array \u5bf9\u5e94\u7684 sorted_set instance). \u5728 C++ \u4e2d\u5c31\u5bf9\u5e94\u4e86\u4f7f\u7528 new \u7684 constructor \u548c\u4f7f\u7528 delete \u7684 destructor.","title":"19.1.4 RAII principle: Resource Acquisition is Initialization"},{"location":"19-Managing-Dynamic-Memory.html#192-function-implementations-dynamic-set","text":"","title":"19.2 \u66f4\u6539\u5176\u4ed6 function implementations \u4ee5\u9002\u5e94 dynamic set"},{"location":"19-Managing-Dynamic-Memory.html#1921-insert","text":"\u7531\u4e8e\u5bf9 dynamic array \u7684\u4f7f\u7528\uff0c\u6211\u4eec\u5e94\u8be5\u66f4\u6539\u539f\u672c\u7684 insert \u51fd\u6570\u4f7f\u5176\u9002\u5e94 dynamic set. \u6211\u4eec\u5e94\u8be5\uff1a new \u4e00\u4e2a\u66f4\u5927\u7684 dynamic array. \u628a\u539f\u672c\u7684 dynamic array \u590d\u5236\u8fdb\u53bb. delete \u539f\u672c\u7684 dynamic array. \u8ba9 ptr \u6210\u5458\u6307\u5411\u65b0\u7684 dynamic array\uff0c\u5e76\u66f4\u65b0 capacity template <typename T> void ordered_set<T>::grow() { // new a dynamic array into a temporary ptr var int *tmp = new int[current_capacity + 1]; // copy the original dynamic array into the new one for (int i = 0; i < size; i++) { tmp[i] = ele[i]; } delete[] elts; // delete the original dynamic array elts = tmp; // reassign the value of tmp to elts current_capacity++; // update capacity } template <typename T> void ordered_set<T>::insert(T e) { if (contains(e)) return; if (size == current_capacity) {grow();} // grow capacity ele[size++] = v; // increase size to catch up capacity; also inserts new element }","title":"19.2.1 insert"},{"location":"19-Managing-Dynamic-Memory.html#193-performance-of-set","text":"\u6bcf\u5f53 grow \u88ab call \u7684\u65f6\u5019\uff0c\u6709\u591a\u5c11 elements \u88ab copy \u4e86\uff1f int main() { ordered_set<int> is(1); int n; cin >> n; is.insert(0); is.insert(1); // grow(), 1 copy is.insert(2); // grow(), 2 copies //... is.insert(n); // grow(), n copies // total = 1+2+...+n = n(1+n)/2 copied // So the number of int-copy operations needed is in O(n^2) } \u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u975e\u5e38\u9ad8 \u5e94\u8be5\u4f18\u5316\u4e00\u4e0b\u3002 \u6ce8\u610f\u5230\u6211\u4eec\u7684\u6761\u4ef6\uff1a if (size == current_capacity) {grow();} // grow capacity \u76f4\u5230 size \u8d76\u4e0a capacity \u4e86\uff0c\u6211\u4eec\u624d\u4f7f\u7528 grow() \u6765\u91cd\u65b0\u5efa array\uff0c\u91cd\u65b0 copy. \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u5728 grow \u4e2d\u4e0d\u8981\u4e00\u683c\u4e00\u683c grow\uff0c\u800c\u662f\u9009\u62e9\u4e00\u6b21 grow \u5927\u4e00\u70b9\uff0c\u6bd4\u5982\u6bcf\u6b21 grow \u90fd\u628a array \u7684\u5927\u5c0f\u53d8\u6210\u4e24\u500d template <typename T> void ordered_set<T>::grow() { int *tmp = new int[current_capacity * 2]; // grow \u4e24\u500d for (int i = 0; i < size; i++) { tmp[i] = ele[i]; } delete[] elts; elts = tmp; current_capacity *= 2; } \u8fd9\u6837\u7684\u8bdd\uff1a int main() { Unordered_set is(1); is.insert(0); is.insert(1); // grow(), 1 copy, new capacity=2 is.insert(2); // grow(), 2 copies, new capacity=4 is.insert(3); is.insert(4); // grow(), 4 copies, new capacity=8 is.insert(5); is.insert(6); is.insert(7); is.insert(8); // grow(), 8 copies, new capacity=16 // \u2026 } \u73b0\u5728\u5bf9\u4e8e\u521b\u5efa N \u4e2a\u5143\u7d20\u7684 set\uff0ccopy \u7684\u603b\u6b21\u6570\u4e3a\uff1a $$ T = (N-1) + (N/2 -1) + (N/4 - 1) + \\cdots + 2 + 1 \\ < N + N/2 + N/4 + \\cdots + 2 + 1 = 2N $$ \u56e0\u800c time complexity \u9a6c\u4e0a\u4e0b\u964d\u5230\u4e86 $O(n)$.","title":"19.3 Performance of Set"},{"location":"19-Managing-Dynamic-Memory.html#garbage-collection-smart-pointer","text":"\u6709\u4e00\u4e9b languages \u5141\u8bb8 compiler \u81ea\u52a8\u5220\u9664 dynamic variables\uff0c\u53ea\u8981\u5b83\u4eec\u4e0d\u518d\u88ab\u9700\u8981\u3002 \u8fd9\u4e2a\u884c\u4e3a\u53eb\u505a garbage collections. \u4f46\u662f\u8fd9\u4e2a\u884c\u4e3a\u6709\u4e00\u5b9a\u7684\u4ee3\u4ef7\uff1a\u9996\u5148\u80af\u5b9a\u964d\u4f4e\u4e86\u8fd0\u884c\u901f\u5ea6\uff0c\u5176\u6b21\u4e0d\u6e05\u6670\u7075\u6d3b\uff1agarbage collection behavior may vary, but manual deletion is a clear part of the standard. \u6211\u4eec\u73b0\u5728\u76ee\u524d\u4e3a\u6b62\u8ba8\u8bba\u7684\u90fd\u662f raw pointers . \u800c C++ 11 \u4ee5\u4e0a\u7684\u7248\u672c\u5141\u8bb8\u4f7f\u7528 smart pointers \uff0c\u8fd9\u4e9b smart pointers \u53ef\u4ee5\u505a\u4e00\u4e9b garbage collector \u7684\u4e8b\u60c5\u3002 unique_ptr : only a single pointer to the dynamic variable is possible shared_ptr : multiple pointers to the dynamic variable are possible. When all those pointers are destroyed, the dynamic variable is destroyed. weak_ptr : \u53ea\u8981\u6240\u6709\u6307\u5411\u4e00\u4e2a dynamic variable \u7684 shared_ptr \u88ab destroy\uff0c\u90a3\u4e48\u6307\u5411\u5b83\u7684 weak-ptr \u4e5f\u9a6c\u4e0a\u88ab destroy.","title":"\u9898\u5916\u8bdd: garbage collection \u548c smart pointer"},{"location":"20-Deep-Copies-and-the-Big-Three.html","text":"20 Deep Copies and the Big Three 20.1 Copy Constructor 20.1.1 \u5982\u4f55 declare \u4e00\u4e2a copy ctor 20.1.2 default copy ctor \u7528\u4ee5\u590d\u5236 dynamic set: shallow copy, \u5bfc\u81f4\u5404\u79cd memory error 20.1.3 \u5199\u4e00\u4e2a custom version of copy ctor \u4ee5\u5b9e\u73b0 deep copy 20.2 Assignment operator = 20.2.1 \u4e24\u79cd\u4e0d\u540c\u7684 Copy: \u4f7f\u7528 copy ctor \u7684 initialization \u548c \u4f7f\u7528 operator = \u7684 assignment 20.2.2 class default overloaded operator= 20.2.3 \u5199\u4e00\u4e2a deep copy \u7684 customed overloaded operator= for a class 20.3 The Rule of The Big Three 20.3.1 the Big Three \u7684\u7279\u70b9\uff1a 20.3.2 \u4ec0\u4e48\u65f6\u5019\u9700\u8981 custom Big Three 20.3.3 Custom the Big Three \u7684\u6ce8\u610f\u4e8b\u9879 20 Deep Copies and the Big Three \u590d\u4e60\uff1a class A { public: A() { std::cout << \"A ctor\" << std::endl; pa = new int(5); } // non-virtual dtor: static binding!!! ~A() { std::cout << \"A dtor\" << std::endl; delete pa; } private: int* pa; }; class D : public A { public: D() { std::cout << \"D ctor\" << std::endl; pd = new int(6); } ~D() { std::cout << \"D dtor\" << std::endl; delete pd; } private: int* pd; }; int main() { A *x = new D(); // 1. \u5728 heap \u4e2d new \u4e86\u4e00\u4e2a\u5bf9\u8c61, \u7c7b\u578b\u662f D. // 2. \u751f\u6210\u4e86\u4e00\u4e2a\u6307\u9488 x: static type \u4e3a A *, \u800c dynamic type: D * // 3. \u5c06 x \u6307\u5411\u8fd9\u4e2a\u5bf9\u8c61 std::cout << \"In main\" << std::endl; delete x; } /* result: A ctor D ctor In main A dtor *. principle(1)\uff1a\u7531\u4e8e D \u662f A \u7684 subtype\uff0c \u5f53\u6211\u4eec call \u4e00\u4e2a D \u7c7b\u578b\u7684 constructor \u65f6\uff0ccompiler \u4e5f\u4f1a\u5148\u81ea\u52a8 call A \u7c7b\u578b\u7684 constructor\uff0c\u7136\u540e\u518d call \u8fd9\u4e2a D \u7684 constructor. principle(2)\uff1a\u540c\u6837\uff0c \u5f53\u6211\u4eec call \u4e00\u4e2a D \u7c7b\u578b\u7684 destructor \u65f6\uff0ccompiler \u4e5f\u4f1a\u5728\u4e4b\u540e\u81ea\u52a8 call A \u7c7b\u578b\u7684 destructor. \u6ce8\u610f ctor \u662f\u5148 call base class \u518d call derived class\uff0cdtor \u662f\u5148 call derived class \u518d call base class\uff01\uff01 \u6240\u4ee5\uff0c\u8fd9\u4e2a\u5730\u65b9\u7531\u4e8e\u6211\u4eec\u5728 heap \u4e2d new \u4e86\u4e00\u4e2a D \u7c7b\u578b\u7684 object\uff0c\u6211\u4eec\u5148\u540e\u81ea\u52a8 call \u4e86 A \u548c D \u7684 default constructor. A ctor D ctor In main \u540c\u65f6\uff0c\u6211\u4eec\u5728 main \u7684 stack frame \u4e2d\u751f\u6210\u4e86\u4e00\u4e2a\u6307\u9488 x: static type \u4e3a A , \u800c dynamic type: D . \u6211\u4eec\u6ce8\u610f\u5230\uff0c ~A \u5e76\u4e0d\u662f\u4e00\u4e2a virtual function\uff0c\u56e0\u800c\u662f static binding \u7684\uff01 \u6240\u4ee5\u5f53 main() \u8fd0\u884c\u7ed3\u675f\u540e\uff0c delete \u53ea\u4f1a call x \u7684 static type \u4e5f\u5c31\u662f A * \u5bf9\u5e94\u7684 A \u7684 dtor\uff0c\u800c\u4e0d\u4f1a call D \u7684 dtor. A dtor \u4f46\u662f\u5982\u679c\u6211\u4eec\u628a ~A \u6539\u6210 virtual function\uff0c\u90a3\u4e48\u5b83\u83b7\u53d6\u5230\u7684\u5c31\u662f x \u7684 dynamic type. \u56e0\u800c\u6839\u636e principle (2)\uff0c\u6211\u4eec\u5c31\u4f1a\u81ea\u52a8\u5728 call A \u7684 destructor \u4e4b\u540e\u4e5f call D \u7684 destructor. virtual ~A() { std::cout << \"A dtor\" << std::endl; delete pa; } /* result: A ctor D ctor In main D dtor A dtor *. 20.1 Copy Constructor Copy ctor\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4ece\u73b0\u6709\u7684 object \u590d\u5236\u51fa\u53e6\u4e00\u4e2a object \u7684 ctor. \u5f62\u5f0f\u5982: Example::Example(const Example &someotherExs) : /*member initializer list...*/ { // body... } \u6211\u4eec\u5373\u4fbf\u4e0d\u5199 copy constructor\uff0cc++ \u4e5f\u4f1a\u81ea\u52a8\u63d0\u4f9b\u4e00\u4e2a implicit copy ctor: Cowboy(const Cowboy& other) : name(other.name) /*contains all member of other*/ {} \u5b9e\u9645\u4e0a\uff0c\u5f53\u6211\u4eec\u5728\u7ed9\u51fd\u6570\u4f20\u9012\u53c2\u6570\uff0c\u5e76\u4e14\u662f pass by value \u7684\u65f6\u5019\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a class object\uff0c\u90a3\u4e48\u6211\u4eec\u76f8\u5f53\u4e8e\u5728\u8fd9\u4e2a\u51fd\u6570\u7684 stack frame \u4e2d\u4f7f\u7528 copy ctor \u521d\u59cb\u5316\u4e86 local variable\uff0c\u56e0\u800c\u662f implicitly call \u4e86 copy ctor. \u4f46\u662f\uff1acopy ctor \u4e2d\u4e00\u5b9a\u662f pass by reference \u7684\u3002 \u7528\u6cd5\u5982\uff1a int main() { Cowboy c2(\"Frankie\"); Cowboy c3(c2); // call copy ctor byVal(c2); //implicitly call copy ctor byRef(c2); //None ctor called(since ref) } 20.1.1 \u5982\u4f55 declare \u4e00\u4e2a copy ctor class Example { public: Example(const Example &other); //all right! } \u8bb0\u5f97 ctor \u4e2d\u6211\u4eec\u8981 copy \u7684\u5bf9\u8c61\u4e00\u5b9a\u662f pass by reference \u7684. \u5f53\u6211\u4eec \u5728\u522b\u7684\u5730\u65b9 call copy ctor \u7684\u65f6\u5019\uff0c\u6211\u4eec\u662f pass by value \u7684 \uff0c\u56e0\u4e3a pass \u4e00\u4e2a class object by value \u5c31\u89e6\u53d1\u4e86 copy ctor \uff0c\u8fd9\u5c31\u662f implicitly call copy ctor \u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a pass class object by value \u5c31\u662f call copy ctor\u3002 \u6b63\u56e0\u6b64\u6211\u4eec \u5199 copy ctor \u5c31\u5fc5\u987b\u628a\u8981 copy \u7684 object pass by reference \uff0c\u5426\u5219\u8fd9\u5c31\u6210\u4e3a\u4e86\u4e00\u4e2a inifite recursion: copy ctor call copy ctor\uff0crecurse inifinitely. class Example { public: Example(const Example other); //error, recurse inifinitely } 20.1.2 default copy ctor \u7528\u4ee5\u590d\u5236 dynamic set: shallow copy, \u5bfc\u81f4\u5404\u79cd memory error template <typename T> class Unordered_set { private: T *elts; int elts_capacity; int elts_size; public: //... } // implicit copy ctor: \u4f1acopy: elts(other.elts); int main() { Unordered_set<int> s1(2); s1.insert(2); s1.insert(3); Unordered_set<int> s2 = s1; // \u73b0\u5728 s1.elts \u548c s2.elts \u6307\u5411\u540c\u4e00\u4e2a dynamic array! s2.insert(4); // s2 \u548c s1 \u6307\u5411\u7684 dynamic array \u56e0\u4e3a capacity \u6ee1\u4e86 \u5e76\u4e14 s2 \u53c8\u8981 insert \u6240\u4ee5\u800c call grow()\u4e86. \u8fd9\u610f\u5473\u7740\u539f\u672c\u7684 dynamic array \u88ab\u5220\u9664\u4e86, \u4f46\u662f\u56e0\u4e3a s2 call \u7684 insert, \u53ea\u6709 s2 \u4f1a\u83b7\u5f97 new \u7684 dynamic array. s1.elts \u5df2\u7ecf dead \u4e86 std::cout << s1 << std::endl; // s1 \u6307\u5411\u7684 dynamic array \u5df2\u7ecf\u88ab s2 \u56e0\u4e3a grow() \u5220\u9664\u4e86, \u6240\u4ee5\u8fd9\u91cc\u662f\u4e00\u4e2a undefined behavior, \u5c1d\u8bd5 cout \u4e00\u4e2a dead object. } \u6211\u4eec\u901a\u8fc7 implicit copy ctor\uff0c s2 = s1 copy \u7684\u662f s1 \u7684\u6bcf\u4e2a member\uff0c\u56e0\u800c s1.elts \u548c s2.elts \u6307\u5411\u7684\u662f heap \u4e2d\u7684\u540c\u4e00\u4e2a dynamic array. \u56e0\u800c\u4efb\u4f55\u5bf9 s1 \u7684\u53d8\u5316\u90fd\u4f1a\u540c\u65f6\u5f71\u54cd s2 . \u8fd9\u79cd\u5f71\u54cd\u4f1a\u5e26\u6765\u4e0d\u53ef\u907f\u514d\u7684\u9519\u8bef\uff0c\u6bd4\u5982\u4e0a\u9762\u7684\u4ee3\u7801\uff1a\u4f7f\u7528\u4e86\u4e00\u4e2a dead object. \u518d\u6bd4\u5982: int main() { Unordered_set<int> s1(2); s1.insert(2); s1.insert(3); Unordered_set<int> s2 = s1; } // \u5728 program \u7ed3\u675f\u540e error, \u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019 s1 \u548c s2 \u90fd\u81ea\u52a8 call dtor, \u4f46\u662f\u5b83\u4eec\u7684 elts \u6307\u5411\u7684 dynamic error \u662f\u540c\u4e00\u4e2a, \u56e0\u800c double delete \u4e86. 20.1.3 \u5199\u4e00\u4e2a custom version of copy ctor \u4ee5\u5b9e\u73b0 deep copy template <typename T> ordered_set<T>::ordered_set(const ordered_set &other) : elts(new T[other.current_capacity]), size(other.size), current_capacity(other.current_capacity) { for (int i = 0; i < elts_size; ++i) { elts[i] = other.elts[i]; } } deep copy : \u521b\u5efa\u4e00\u4e2a following pointer\uff0c\u4e5f\u5c31\u662f new \u4e00\u4e2a\u65b0\u7684 dynamic array \u5e76\u628a\u539f\u6765\u7684 dynamic array \u7684\u5143\u7d20\u5168\u90e8 copy \u8fc7\u6765\uff0c\u800c\u4e0d\u662f copy \u539f\u6765\u7684 dynamic array \u7684\u6307\u9488\u3002\u8fd9\u6837\u5c31\u963b\u6b62\u4e86\u6211\u4eec\u5728 20.1.2 \u4e2d\u7684\u8fd9\u4e9b\u8bf8\u591a memory errors \u4ee5\u53ca undefined behaviors. 20.2 Assignment operator = 20.2.1 \u4e24\u79cd\u4e0d\u540c\u7684 Copy: \u4f7f\u7528 copy ctor \u7684 initialization \u548c \u4f7f\u7528 operator = \u7684 assignment c++ \u4e2d class object \u7684 = \u5728 initializaiton \u548c assignment \u7684 context \u4e0b\u4f7f\u7528\u7684\u51fd\u6570\u662f\u4e0d\u540c\u7684\u3002 int main() { Example a1(2, 3.5); Example a2(a1); // copy ctor Example a3 = a1; // init a3 as copy of a1: copy ctor func(a1); // init parameter a as copy of a1: copy ctor } \u7b2c\u4e00\u6b21 initalize \u4e00\u4e2a class object \u7b49\u4e8e\u53e6\u4e00\u4e2a object\uff1a\u4f7f\u7528\u7684\u662f\u8be5 class \u7684 copy ctor \u51fd\u6570. \uff08\u5305\u62ec function \u7684 pass by value \u4e5f\u662f\u76f8\u540c\u7684.\uff09 int main() { Example a1(2, 3.5); Example a2(4, 6.7); a1 = a2; // assign \u800c\u4e0d\u662f initialize: operator= } \u5e76\u975e\u7b2c\u4e00\u6b21 initialize\uff0c\u800c\u662f\u91cd\u65b0\u7ed9\u4e00\u4e2a class object assign \u53e6\u4e00\u4e2a object \u7684\u503c\uff1a\u4f7f\u7528\u7684\u662f\u8be5 class \u7684 overloaded operator= . \u6211\u4eec\u5373\u4fbf\u4e0d\u5199\u4e00\u4e2a class \u7684 overloaded operator= \uff0c\u8fd9\u4e2a class \u4e5f\u4f1a\u81ea\u52a8\u83b7\u5f97\u4e00\u4e2a default overloaded operator= \uff0c\u5c31\u50cf\u662f\u81ea\u52a8\u83b7\u5f97\u4e00\u4e2a default ctor \u548c default copy ctor \u4e00\u6837\u3002 20.2.2 class default overloaded operator= \u4e00\u4e2a class \u81ea\u52a8\u83b7\u5f97\u7684 defalut overloaded operator= \u662f\u957f\u8fd9\u6837\u7684\uff1a Example & Example::operator=(const Example &rhs) { x = rhs.x; y = rhs.y; return *this; } \u8fd9\u4e2a defalut overloaded operator= \u7684\u4f5c\u7528\u5b9e\u9645\u4e0a\u548c default copy ctor \u505a\u7684\u4e8b\u60c5\u57fa\u672c\u4e00\u6837\uff1a\u90fd\u662f member by member copy\uff0c\u4e5f\u5c31\u662f shallow copy. \u56e0\u800c\u540c\u6837\u4f1a\u51fa\u73b0\u76f8\u540c\u7684 memory errors/undefined behaviors\uff01 a = b; // \u4e5f\u5c31\u662f a.operator=(b), this \u662f\u4e00\u4e2a\u6307\u5411 a \u7684 ptr, \u8fd4\u56de *this, \u4e5f\u5c31\u662f lhs object. \u8fd9\u91cc\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5176\u5b9e operator= \u5b8c\u5168\u53ef\u4ee5\u662f\u4e2a void \u7684\u51fd\u6570\uff0c\u4f46\u662f implementation \u5374\u662f\u8fd4\u56de\u539f class object \u7684\u5f15\u7528\uff0c\u8fd9\u79cd\u8bbe\u8ba1\u662f\u4e3a\u4e86\u5141\u8bb8\u94fe\u5f0f\u8d4b\u503c\u3002 a = b = c; \u51b7\u95e8\u77e5\u8bc6\u4e4b\u8fd9\u662f\u53ef\u884c\u7684\u3002 20.2.3 \u5199\u4e00\u4e2a deep copy \u7684 customed overloaded operator= for a class template <typename T> ordered_set<T> & ordered_set<T>::operator=(const ordered_set<T> & rhs) { if (this != &rhs) { // \u5224\u65ad\u662f\u5426\u662f\u7ed9\u81ea\u5df1\u8d4b\u503c, \u8fd9\u975e\u5e38\u91cd\u8981! delete[] elts; // delete old dynamic array this is pointing to. elts = new T[rhs.current_capacity]; // make a new dynamic array // copy all attributes current_capacity = rhs.current_capacity; size = rhs.size; for (int i = 0; i < size; i++) { ele[i] = rhs.ele[i]; } return *this; } } \u548c\u5199\u4e00\u4e2a deep copy customed copy ctor \u57fa\u672c\u4e00\u6837\uff0c\u903b\u8f91\u5c31\u662f new \u4e00\u4e2a dynamic array \u5e76\u628a rhs \u8fd9\u4e2a object \u7684 dynamic array \u7684\u5143\u7d20\u4ee5\u53ca\u5176\u4ed6 members \u90fd copy \u8fc7\u6765\u3002 \u539f\u5219\u5c31\u662f\uff1a\u5bf9\u4e8e dynamic \u7684 members \uff0c new \u4e00\u4e2a\u65b0\u7684\u5e76\u4f20\u9012 rhs \u7684\u503c\uff1b\u5bf9\u4e8e static \u7684 members\uff0c\u76f4\u63a5\u4f20\u9012\u3002 \u975e\u5e38\u503c\u5f97\u6ce8\u610f\u7684\u4e00\u4e2a\u70b9\u662f\uff1a if(this != &rhs) \u8fd9\u4e00\u53e5\u5b50\u8d4b\u503c\u5224\u65ad\u662f\u5f88\u91cd\u8981\u7684\uff0c\u867d\u7136\u8fd9\u79cd\u81ea\u5df1\u7ed9\u81ea\u5df1 assign \u7684\u60c5\u51b5\u4e0d\u592a\u5e38\u89c1\uff0c\u4f46\u662f\u5982\u679c\u4e0d\u52a0\u8fd9\u4e00\u53e5\u5b50\uff0c\u90a3\u4e48\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b delete[] elts \u5c31\u4f1a\u5220\u9664\u81ea\u5df1\u7684 dynamic array\uff0c\u4ece\u800c\u8fd9\u4e2a set \u5c31\u6ca1\u4e86\u3002 20.3 The Rule of The Big Three The Big Three \u662f\u6307\uff1a Destructor Copy Constructor Assignment Operator ( operator= ) The rule of the Big Three \u6307\u7684\u662f\uff1a \u5982\u679c\u4f60\u9700\u8981\u4e3a any of them \u63d0\u4f9b\u4e00\u4e2a custom implementation\uff0c\u90a3\u4e48\u4f60\u5c31\u5fc5\u987b\u8981\u4e3a all of them \u63d0\u4f9b custom implementations. 20.3.1 the Big Three \u7684\u7279\u70b9\uff1a \u6240\u6709 objects \u90fd\u6709 the big three\uff01\uff01 \u5982\u679c\u4e0d\u5199 custom implementation\uff0c the big three \u90fd\u662f\u6709 Implicit \u7684\u3002\u5e76\u4e14\u5b83\u4eec\u90fd\u6709\u95ee\u9898\uff1aimplicit destructor \u6ca1\u6709 spectial cleanup\uff0cimplicit copy ctor \u548c implicit assignment operator \u90fd\u662f shallow copy \u800c\u4e0d\u662f deep copy. 20.3.2 \u4ec0\u4e48\u65f6\u5019\u9700\u8981 custom Big Three \u5f53\u6211\u4eec\u9700\u8981 deep copy \u7684\u65f6\u5019\uff0c\u901a\u5e38\u662f\u5f53 object owns and manages any resource(\u5373 dynamic memory) \u7684\u65f6\u5019\u3002 20.3.3 Custom the Big Three \u7684\u6ce8\u610f\u4e8b\u9879 Destructor Free resources (e.g., dynamic memory) Copy Constructor Copy regular members from other Deep copy resources from other Assignment Operator Check for self-assignment Free old resources Copy regular members from rhs Deep copy resources from rhs return *this","title":"Overview"},{"location":"20-Deep-Copies-and-the-Big-Three.html#20-deep-copies-and-the-big-three","text":"\u590d\u4e60\uff1a class A { public: A() { std::cout << \"A ctor\" << std::endl; pa = new int(5); } // non-virtual dtor: static binding!!! ~A() { std::cout << \"A dtor\" << std::endl; delete pa; } private: int* pa; }; class D : public A { public: D() { std::cout << \"D ctor\" << std::endl; pd = new int(6); } ~D() { std::cout << \"D dtor\" << std::endl; delete pd; } private: int* pd; }; int main() { A *x = new D(); // 1. \u5728 heap \u4e2d new \u4e86\u4e00\u4e2a\u5bf9\u8c61, \u7c7b\u578b\u662f D. // 2. \u751f\u6210\u4e86\u4e00\u4e2a\u6307\u9488 x: static type \u4e3a A *, \u800c dynamic type: D * // 3. \u5c06 x \u6307\u5411\u8fd9\u4e2a\u5bf9\u8c61 std::cout << \"In main\" << std::endl; delete x; } /* result: A ctor D ctor In main A dtor *. principle(1)\uff1a\u7531\u4e8e D \u662f A \u7684 subtype\uff0c \u5f53\u6211\u4eec call \u4e00\u4e2a D \u7c7b\u578b\u7684 constructor \u65f6\uff0ccompiler \u4e5f\u4f1a\u5148\u81ea\u52a8 call A \u7c7b\u578b\u7684 constructor\uff0c\u7136\u540e\u518d call \u8fd9\u4e2a D \u7684 constructor. principle(2)\uff1a\u540c\u6837\uff0c \u5f53\u6211\u4eec call \u4e00\u4e2a D \u7c7b\u578b\u7684 destructor \u65f6\uff0ccompiler \u4e5f\u4f1a\u5728\u4e4b\u540e\u81ea\u52a8 call A \u7c7b\u578b\u7684 destructor. \u6ce8\u610f ctor \u662f\u5148 call base class \u518d call derived class\uff0cdtor \u662f\u5148 call derived class \u518d call base class\uff01\uff01 \u6240\u4ee5\uff0c\u8fd9\u4e2a\u5730\u65b9\u7531\u4e8e\u6211\u4eec\u5728 heap \u4e2d new \u4e86\u4e00\u4e2a D \u7c7b\u578b\u7684 object\uff0c\u6211\u4eec\u5148\u540e\u81ea\u52a8 call \u4e86 A \u548c D \u7684 default constructor. A ctor D ctor In main \u540c\u65f6\uff0c\u6211\u4eec\u5728 main \u7684 stack frame \u4e2d\u751f\u6210\u4e86\u4e00\u4e2a\u6307\u9488 x: static type \u4e3a A , \u800c dynamic type: D . \u6211\u4eec\u6ce8\u610f\u5230\uff0c ~A \u5e76\u4e0d\u662f\u4e00\u4e2a virtual function\uff0c\u56e0\u800c\u662f static binding \u7684\uff01 \u6240\u4ee5\u5f53 main() \u8fd0\u884c\u7ed3\u675f\u540e\uff0c delete \u53ea\u4f1a call x \u7684 static type \u4e5f\u5c31\u662f A * \u5bf9\u5e94\u7684 A \u7684 dtor\uff0c\u800c\u4e0d\u4f1a call D \u7684 dtor. A dtor \u4f46\u662f\u5982\u679c\u6211\u4eec\u628a ~A \u6539\u6210 virtual function\uff0c\u90a3\u4e48\u5b83\u83b7\u53d6\u5230\u7684\u5c31\u662f x \u7684 dynamic type. \u56e0\u800c\u6839\u636e principle (2)\uff0c\u6211\u4eec\u5c31\u4f1a\u81ea\u52a8\u5728 call A \u7684 destructor \u4e4b\u540e\u4e5f call D \u7684 destructor. virtual ~A() { std::cout << \"A dtor\" << std::endl; delete pa; } /* result: A ctor D ctor In main D dtor A dtor *.","title":"20 Deep Copies and the Big Three"},{"location":"20-Deep-Copies-and-the-Big-Three.html#201-copy-constructor","text":"Copy ctor\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4ece\u73b0\u6709\u7684 object \u590d\u5236\u51fa\u53e6\u4e00\u4e2a object \u7684 ctor. \u5f62\u5f0f\u5982: Example::Example(const Example &someotherExs) : /*member initializer list...*/ { // body... } \u6211\u4eec\u5373\u4fbf\u4e0d\u5199 copy constructor\uff0cc++ \u4e5f\u4f1a\u81ea\u52a8\u63d0\u4f9b\u4e00\u4e2a implicit copy ctor: Cowboy(const Cowboy& other) : name(other.name) /*contains all member of other*/ {} \u5b9e\u9645\u4e0a\uff0c\u5f53\u6211\u4eec\u5728\u7ed9\u51fd\u6570\u4f20\u9012\u53c2\u6570\uff0c\u5e76\u4e14\u662f pass by value \u7684\u65f6\u5019\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a class object\uff0c\u90a3\u4e48\u6211\u4eec\u76f8\u5f53\u4e8e\u5728\u8fd9\u4e2a\u51fd\u6570\u7684 stack frame \u4e2d\u4f7f\u7528 copy ctor \u521d\u59cb\u5316\u4e86 local variable\uff0c\u56e0\u800c\u662f implicitly call \u4e86 copy ctor. \u4f46\u662f\uff1acopy ctor \u4e2d\u4e00\u5b9a\u662f pass by reference \u7684\u3002 \u7528\u6cd5\u5982\uff1a int main() { Cowboy c2(\"Frankie\"); Cowboy c3(c2); // call copy ctor byVal(c2); //implicitly call copy ctor byRef(c2); //None ctor called(since ref) }","title":"20.1 Copy Constructor"},{"location":"20-Deep-Copies-and-the-Big-Three.html#2011-declare-copy-ctor","text":"class Example { public: Example(const Example &other); //all right! } \u8bb0\u5f97 ctor \u4e2d\u6211\u4eec\u8981 copy \u7684\u5bf9\u8c61\u4e00\u5b9a\u662f pass by reference \u7684. \u5f53\u6211\u4eec \u5728\u522b\u7684\u5730\u65b9 call copy ctor \u7684\u65f6\u5019\uff0c\u6211\u4eec\u662f pass by value \u7684 \uff0c\u56e0\u4e3a pass \u4e00\u4e2a class object by value \u5c31\u89e6\u53d1\u4e86 copy ctor \uff0c\u8fd9\u5c31\u662f implicitly call copy ctor \u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a pass class object by value \u5c31\u662f call copy ctor\u3002 \u6b63\u56e0\u6b64\u6211\u4eec \u5199 copy ctor \u5c31\u5fc5\u987b\u628a\u8981 copy \u7684 object pass by reference \uff0c\u5426\u5219\u8fd9\u5c31\u6210\u4e3a\u4e86\u4e00\u4e2a inifite recursion: copy ctor call copy ctor\uff0crecurse inifinitely. class Example { public: Example(const Example other); //error, recurse inifinitely }","title":"20.1.1 \u5982\u4f55 declare \u4e00\u4e2a copy ctor"},{"location":"20-Deep-Copies-and-the-Big-Three.html#2012-default-copy-ctor-dynamic-set-shallow-copy-memory-error","text":"template <typename T> class Unordered_set { private: T *elts; int elts_capacity; int elts_size; public: //... } // implicit copy ctor: \u4f1acopy: elts(other.elts); int main() { Unordered_set<int> s1(2); s1.insert(2); s1.insert(3); Unordered_set<int> s2 = s1; // \u73b0\u5728 s1.elts \u548c s2.elts \u6307\u5411\u540c\u4e00\u4e2a dynamic array! s2.insert(4); // s2 \u548c s1 \u6307\u5411\u7684 dynamic array \u56e0\u4e3a capacity \u6ee1\u4e86 \u5e76\u4e14 s2 \u53c8\u8981 insert \u6240\u4ee5\u800c call grow()\u4e86. \u8fd9\u610f\u5473\u7740\u539f\u672c\u7684 dynamic array \u88ab\u5220\u9664\u4e86, \u4f46\u662f\u56e0\u4e3a s2 call \u7684 insert, \u53ea\u6709 s2 \u4f1a\u83b7\u5f97 new \u7684 dynamic array. s1.elts \u5df2\u7ecf dead \u4e86 std::cout << s1 << std::endl; // s1 \u6307\u5411\u7684 dynamic array \u5df2\u7ecf\u88ab s2 \u56e0\u4e3a grow() \u5220\u9664\u4e86, \u6240\u4ee5\u8fd9\u91cc\u662f\u4e00\u4e2a undefined behavior, \u5c1d\u8bd5 cout \u4e00\u4e2a dead object. } \u6211\u4eec\u901a\u8fc7 implicit copy ctor\uff0c s2 = s1 copy \u7684\u662f s1 \u7684\u6bcf\u4e2a member\uff0c\u56e0\u800c s1.elts \u548c s2.elts \u6307\u5411\u7684\u662f heap \u4e2d\u7684\u540c\u4e00\u4e2a dynamic array. \u56e0\u800c\u4efb\u4f55\u5bf9 s1 \u7684\u53d8\u5316\u90fd\u4f1a\u540c\u65f6\u5f71\u54cd s2 . \u8fd9\u79cd\u5f71\u54cd\u4f1a\u5e26\u6765\u4e0d\u53ef\u907f\u514d\u7684\u9519\u8bef\uff0c\u6bd4\u5982\u4e0a\u9762\u7684\u4ee3\u7801\uff1a\u4f7f\u7528\u4e86\u4e00\u4e2a dead object. \u518d\u6bd4\u5982: int main() { Unordered_set<int> s1(2); s1.insert(2); s1.insert(3); Unordered_set<int> s2 = s1; } // \u5728 program \u7ed3\u675f\u540e error, \u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019 s1 \u548c s2 \u90fd\u81ea\u52a8 call dtor, \u4f46\u662f\u5b83\u4eec\u7684 elts \u6307\u5411\u7684 dynamic error \u662f\u540c\u4e00\u4e2a, \u56e0\u800c double delete \u4e86.","title":"20.1.2 default copy ctor \u7528\u4ee5\u590d\u5236 dynamic set: shallow copy, \u5bfc\u81f4\u5404\u79cd memory error"},{"location":"20-Deep-Copies-and-the-Big-Three.html#2013-custom-version-of-copy-ctor-deep-copy","text":"template <typename T> ordered_set<T>::ordered_set(const ordered_set &other) : elts(new T[other.current_capacity]), size(other.size), current_capacity(other.current_capacity) { for (int i = 0; i < elts_size; ++i) { elts[i] = other.elts[i]; } } deep copy : \u521b\u5efa\u4e00\u4e2a following pointer\uff0c\u4e5f\u5c31\u662f new \u4e00\u4e2a\u65b0\u7684 dynamic array \u5e76\u628a\u539f\u6765\u7684 dynamic array \u7684\u5143\u7d20\u5168\u90e8 copy \u8fc7\u6765\uff0c\u800c\u4e0d\u662f copy \u539f\u6765\u7684 dynamic array \u7684\u6307\u9488\u3002\u8fd9\u6837\u5c31\u963b\u6b62\u4e86\u6211\u4eec\u5728 20.1.2 \u4e2d\u7684\u8fd9\u4e9b\u8bf8\u591a memory errors \u4ee5\u53ca undefined behaviors.","title":"20.1.3 \u5199\u4e00\u4e2a custom version of copy ctor \u4ee5\u5b9e\u73b0 deep copy"},{"location":"20-Deep-Copies-and-the-Big-Three.html#202-assignment-operator","text":"","title":"20.2 Assignment operator ="},{"location":"20-Deep-Copies-and-the-Big-Three.html#2021-copy-copy-ctor-initialization-operator-assignment","text":"c++ \u4e2d class object \u7684 = \u5728 initializaiton \u548c assignment \u7684 context \u4e0b\u4f7f\u7528\u7684\u51fd\u6570\u662f\u4e0d\u540c\u7684\u3002 int main() { Example a1(2, 3.5); Example a2(a1); // copy ctor Example a3 = a1; // init a3 as copy of a1: copy ctor func(a1); // init parameter a as copy of a1: copy ctor } \u7b2c\u4e00\u6b21 initalize \u4e00\u4e2a class object \u7b49\u4e8e\u53e6\u4e00\u4e2a object\uff1a\u4f7f\u7528\u7684\u662f\u8be5 class \u7684 copy ctor \u51fd\u6570. \uff08\u5305\u62ec function \u7684 pass by value \u4e5f\u662f\u76f8\u540c\u7684.\uff09 int main() { Example a1(2, 3.5); Example a2(4, 6.7); a1 = a2; // assign \u800c\u4e0d\u662f initialize: operator= } \u5e76\u975e\u7b2c\u4e00\u6b21 initialize\uff0c\u800c\u662f\u91cd\u65b0\u7ed9\u4e00\u4e2a class object assign \u53e6\u4e00\u4e2a object \u7684\u503c\uff1a\u4f7f\u7528\u7684\u662f\u8be5 class \u7684 overloaded operator= . \u6211\u4eec\u5373\u4fbf\u4e0d\u5199\u4e00\u4e2a class \u7684 overloaded operator= \uff0c\u8fd9\u4e2a class \u4e5f\u4f1a\u81ea\u52a8\u83b7\u5f97\u4e00\u4e2a default overloaded operator= \uff0c\u5c31\u50cf\u662f\u81ea\u52a8\u83b7\u5f97\u4e00\u4e2a default ctor \u548c default copy ctor \u4e00\u6837\u3002","title":"20.2.1 \u4e24\u79cd\u4e0d\u540c\u7684 Copy: \u4f7f\u7528 copy ctor \u7684 initialization \u548c \u4f7f\u7528 operator = \u7684 assignment"},{"location":"20-Deep-Copies-and-the-Big-Three.html#2022-class-default-overloaded-operator","text":"\u4e00\u4e2a class \u81ea\u52a8\u83b7\u5f97\u7684 defalut overloaded operator= \u662f\u957f\u8fd9\u6837\u7684\uff1a Example & Example::operator=(const Example &rhs) { x = rhs.x; y = rhs.y; return *this; } \u8fd9\u4e2a defalut overloaded operator= \u7684\u4f5c\u7528\u5b9e\u9645\u4e0a\u548c default copy ctor \u505a\u7684\u4e8b\u60c5\u57fa\u672c\u4e00\u6837\uff1a\u90fd\u662f member by member copy\uff0c\u4e5f\u5c31\u662f shallow copy. \u56e0\u800c\u540c\u6837\u4f1a\u51fa\u73b0\u76f8\u540c\u7684 memory errors/undefined behaviors\uff01 a = b; // \u4e5f\u5c31\u662f a.operator=(b), this \u662f\u4e00\u4e2a\u6307\u5411 a \u7684 ptr, \u8fd4\u56de *this, \u4e5f\u5c31\u662f lhs object. \u8fd9\u91cc\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5176\u5b9e operator= \u5b8c\u5168\u53ef\u4ee5\u662f\u4e2a void \u7684\u51fd\u6570\uff0c\u4f46\u662f implementation \u5374\u662f\u8fd4\u56de\u539f class object \u7684\u5f15\u7528\uff0c\u8fd9\u79cd\u8bbe\u8ba1\u662f\u4e3a\u4e86\u5141\u8bb8\u94fe\u5f0f\u8d4b\u503c\u3002 a = b = c; \u51b7\u95e8\u77e5\u8bc6\u4e4b\u8fd9\u662f\u53ef\u884c\u7684\u3002","title":"20.2.2 class default overloaded operator="},{"location":"20-Deep-Copies-and-the-Big-Three.html#2023-deep-copy-customed-overloaded-operator-for-a-class","text":"template <typename T> ordered_set<T> & ordered_set<T>::operator=(const ordered_set<T> & rhs) { if (this != &rhs) { // \u5224\u65ad\u662f\u5426\u662f\u7ed9\u81ea\u5df1\u8d4b\u503c, \u8fd9\u975e\u5e38\u91cd\u8981! delete[] elts; // delete old dynamic array this is pointing to. elts = new T[rhs.current_capacity]; // make a new dynamic array // copy all attributes current_capacity = rhs.current_capacity; size = rhs.size; for (int i = 0; i < size; i++) { ele[i] = rhs.ele[i]; } return *this; } } \u548c\u5199\u4e00\u4e2a deep copy customed copy ctor \u57fa\u672c\u4e00\u6837\uff0c\u903b\u8f91\u5c31\u662f new \u4e00\u4e2a dynamic array \u5e76\u628a rhs \u8fd9\u4e2a object \u7684 dynamic array \u7684\u5143\u7d20\u4ee5\u53ca\u5176\u4ed6 members \u90fd copy \u8fc7\u6765\u3002 \u539f\u5219\u5c31\u662f\uff1a\u5bf9\u4e8e dynamic \u7684 members \uff0c new \u4e00\u4e2a\u65b0\u7684\u5e76\u4f20\u9012 rhs \u7684\u503c\uff1b\u5bf9\u4e8e static \u7684 members\uff0c\u76f4\u63a5\u4f20\u9012\u3002 \u975e\u5e38\u503c\u5f97\u6ce8\u610f\u7684\u4e00\u4e2a\u70b9\u662f\uff1a if(this != &rhs) \u8fd9\u4e00\u53e5\u5b50\u8d4b\u503c\u5224\u65ad\u662f\u5f88\u91cd\u8981\u7684\uff0c\u867d\u7136\u8fd9\u79cd\u81ea\u5df1\u7ed9\u81ea\u5df1 assign \u7684\u60c5\u51b5\u4e0d\u592a\u5e38\u89c1\uff0c\u4f46\u662f\u5982\u679c\u4e0d\u52a0\u8fd9\u4e00\u53e5\u5b50\uff0c\u90a3\u4e48\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b delete[] elts \u5c31\u4f1a\u5220\u9664\u81ea\u5df1\u7684 dynamic array\uff0c\u4ece\u800c\u8fd9\u4e2a set \u5c31\u6ca1\u4e86\u3002","title":"20.2.3 \u5199\u4e00\u4e2a deep copy \u7684 customed overloaded operator= for a class"},{"location":"20-Deep-Copies-and-the-Big-Three.html#203-the-rule-of-the-big-three","text":"The Big Three \u662f\u6307\uff1a Destructor Copy Constructor Assignment Operator ( operator= ) The rule of the Big Three \u6307\u7684\u662f\uff1a \u5982\u679c\u4f60\u9700\u8981\u4e3a any of them \u63d0\u4f9b\u4e00\u4e2a custom implementation\uff0c\u90a3\u4e48\u4f60\u5c31\u5fc5\u987b\u8981\u4e3a all of them \u63d0\u4f9b custom implementations.","title":"20.3 The Rule of The Big Three"},{"location":"20-Deep-Copies-and-the-Big-Three.html#2031-the-big-three","text":"\u6240\u6709 objects \u90fd\u6709 the big three\uff01\uff01 \u5982\u679c\u4e0d\u5199 custom implementation\uff0c the big three \u90fd\u662f\u6709 Implicit \u7684\u3002\u5e76\u4e14\u5b83\u4eec\u90fd\u6709\u95ee\u9898\uff1aimplicit destructor \u6ca1\u6709 spectial cleanup\uff0cimplicit copy ctor \u548c implicit assignment operator \u90fd\u662f shallow copy \u800c\u4e0d\u662f deep copy.","title":"20.3.1 the Big Three \u7684\u7279\u70b9\uff1a"},{"location":"20-Deep-Copies-and-the-Big-Three.html#2032-custom-big-three","text":"\u5f53\u6211\u4eec\u9700\u8981 deep copy \u7684\u65f6\u5019\uff0c\u901a\u5e38\u662f\u5f53 object owns and manages any resource(\u5373 dynamic memory) \u7684\u65f6\u5019\u3002","title":"20.3.2 \u4ec0\u4e48\u65f6\u5019\u9700\u8981 custom Big Three"},{"location":"20-Deep-Copies-and-the-Big-Three.html#2033-custom-the-big-three","text":"Destructor Free resources (e.g., dynamic memory) Copy Constructor Copy regular members from other Deep copy resources from other Assignment Operator Check for self-assignment Free old resources Copy regular members from rhs Deep copy resources from rhs return *this","title":"20.3.3 Custom the Big Three \u7684\u6ce8\u610f\u4e8b\u9879"},{"location":"21-Linked-List.html","text":"21 Linked List 21.1 Sequential Container ADT 21.1.1 Array-based Sequential Container ADT: contiguously \u5b58\u50a8 elements 21.1.2 Non-contiguously \u5b58\u50a8 elements: \u4f7f\u7528 node 21.2 Linked List 21.2.1 Based on chain of nodes \u7684 data structure 21.2.2 The IntList interface 21.2.3 Linked_List: Default Ctor 21.2.4 Linked_List: \u83b7\u53d6\u6700\u524d\u65b9\u7684 Node \u4e0a\u7684\u503c 21.2.5 Linked_List: push_front \u5728 list \u9996\u63d2\u5165\u5143\u7d20 21.2.6 Linked_List: pop_front \u5f39\u51fa list \u9996\u5143\u7d20 21.2.7 Linked_List: print \u8fd9\u4e2a list 21.2.8 Check the Big Three 21.2.8.1 Dtor: \u5373pop_all() 21.2.8.2 copy ctor 21.2.8.3 operator= 21.2.9 Linked_list: insert \u5728 index n \u63d2\u5165\u4e00\u4e2a element 21.3 Doubly Linked List 21 Linked List 21.1 Sequential Container ADT Sequential Containers \u5c31\u662f\u5141\u8bb8 sequential access of elements\uff0c \u5373 traversal (\u904d\u5386) \uff1b\u4ee5\u53ca\u4fdd\u6301 elements \u7684\u4e00\u5b9a\u987a\u5e8f\u7684 Container ADT. Sequential Containers \u53ef\u4ee5\u5141\u8bb8 random access via indexing (\u4e5f\u5c31\u662f\u5f62\u5982 a[i] \u8fd9\u79cd\u5f62\u5f0f\u7684 indexing)\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u5141\u8bb8\u3002 \u4f8b\u5b50\uff1aPixels in an image\uff0csequence of characters in a file \u7b49\u7b49 \u6709\u4e00\u4e9b\u6bd4\u8f83\u7ecf\u5178\u7684 sequential Container ADT\uff0c\u6bd4\u5982 queue(\u961f\u5217): First In First Out Stack(\u6808): Last In First Out 21.1.1 Array-based Sequential Container ADT: contiguously \u5b58\u50a8 elements \u6211\u4eec\u89c1\u8fc7\u4e00\u4e9b based on array \u7684 Sequential Containers : \u6bd4\u5982 vector . Pro: Array \u628a elements contiguously \u5b58\u50a8\u5728 memory \u4e2d\uff0c\u56e0\u800c based on array \u7684 sequential container \u7684\u4e00\u4e2a\u597d\u5904\u662f indexing \u975e\u5e38\u5feb\uff1a\u56e0\u4e3a a[i] \u4e5f\u5c31\u662f *(a+i) \uff0cindex \u7684 time complexity \u4e3a $O(1)$. Con: \u4f46\u662f based on array \u7684 Sequential Containers\u4e5f\u6709\u4e00\u4e9b\u574f\u5904\u3002 \u5f53 size == capacity \u65f6\u6211\u4eec\u60f3\u8981\u8ba9\u8fd9\u4e2a array \u201cgrow\"\uff0c\u4e5f\u5c31\u662f\u65b0\u5efa\u4e00\u4e2a capacity \u66f4\u5927\u7684 dynamic array \u5e76\u628a\u539f array copy \u8fdb\u53bb\u3002\u8fd9\u82b1\u8d39\u7684 time complexity \u4e3a $O(n)$. \u5982\u679c\u6211\u4eec\u60f3\u8981 elements \u4fdd\u6301 sorted order\uff0c\u90a3\u4e48\u6bcf\u5f53\u6211\u4eec\u7ed9 dynamic array insert \u65b0\u7684\u5143\u7d20\u6216\u8005 remove \u5143\u7d20\u65f6\uff0c\u6211\u4eec\u90fd\u8981\u8fdb\u884c\u4e00\u4e2a shift \u7684\u64cd\u4f5c\uff08\u590d\u5236 dynamic array\uff0c\u5c06\u6307\u5b9a\u4f4d\u7f6e\u4e4b\u524d/\u4e4b\u540e\u7684\u5143\u7d20\u5411\u5de6/\u5411\u53f3 shift \u4e00\u4e2a\u5355\u4f4d\uff09\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u7684 time complexity \u4e3a $O(n)$. 21.1.2 Non-contiguously \u5b58\u50a8 elements: \u4f7f\u7528 node \u5982\u679c\u6211\u4eec\u8981\u7ecf\u5e38\u63d2\u5165\u5143\u7d20\uff0c\u4f46\u662f\u5374\u5f88\u5c11 indexing\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u53e6\u4e00\u79cd trade off: \u91c7\u53d6\u4e00\u79cd non-contiguous \u7684\u5b58\u50a8\u65b9\u5f0f. \u4e0b\u9762\u662f\u4e00\u4e2a Node \u7ed3\u6784\uff1a struct Node { int datum; // \u4e00\u4e2a element Node *next; // \u4e00\u4e2a pointer to next element }; \u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u7ed3\u6784\u4f5c\u4e3a\u6211\u4eec implementation \u7684\u57fa\u7840\u3002\u4e00\u4e2a Node \u7531\u4e00\u4e2a datum (\u5373\u8fd9\u4e2aNode\u4e0a\u7684\u5143\u7d20) \u4ee5\u53ca\u4e00\u4e2a\u6307\u5411\u4e0b\u4e00\u4e2a Node \u7684 pointer \u7ec4\u6210\u3002 \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u80fd\u505a\u5230\u5feb\u901f\u7684 insert \u548c remove: \u60f3\u8981 insert/remove \u4e00\u4e2a\u5143\u7d20\uff0c\u53ea\u8981\u66f4\u6539\u4e0a\u4e00\u4e2a/\u4e0b\u4e00\u4e2a Node \u7684 next \u5c31\u53ef\u4ee5\uff0ctime complexity \u4e3a $O(1)$. \u5e76\u4e14\uff0c\u6211\u4eec\u5c06\u4e0d\u518d\u9700\u8981 grow \u8fd9\u4e2a container. \u4f46\u662f\u5feb\u901f\u7684 insert/remoe \u6362\u53d6\u7684\u4ee3\u4ef7\u662f\uff1aindexing \u5c06\u53d8\u6162\uff0c\u4e0d\u5f97\u4e0d\u4f7f\u7528 loop \u6765\u8fdb\u884c traversal. 21.2 Linked List 21.2.1 Based on chain of nodes \u7684 data structure \u6709\u4e86\u8fd9\u4e2a Node \u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e2a\u65b0\u7684 Sequential Container ADT: linked list. \u6211\u4eec\u79f0\u8fd9\u79cd \u7528 nodes \u800c\u4e0d\u662f array \u6765\u5b9e\u73b0 \u7684 Sequential Container ADT \u4e3a based on chain of nodes \u7684 data structure. template <typename T> struct Node { T datum; Node *next; }; template <typename T> class Linked_List { private: Node *first; //... } Representative Invariants: first \u53ef\u4ee5\u662f nullptr (\u5bf9\u4e8e\u4e00\u4e2a empty linked list) \u4e5f\u53ef\u4ee5 points to a valid Node . \u5728\u6700\u540e\u4e00\u4e2a Node \u4e2d\uff0c next \u603b\u662f nullptr . \u9664\u4e86 first \u4e0e\u6700\u540e\u4e00\u4e2a Node\uff0c\u5176\u4ed6 Nodes \u90fd\u5fc5\u987b points to \u53e6\u5916\u4e00\u4e2a Node . \u6ca1\u6709 cycle. 21.2.2 The IntList interface template <typename T> class List { public: // EFFECTS: constructs an empty list List(); List(const List &other); ~List(); List & operator=(const List &rhs); // EFFECTS: inserts datum at front of list void push_front(T datum); // REQUIRES: the list is not empty // EFFECTS: Returns (by ref.) first element T & front(); // REQUIRES: the list is not empty // EFFECTS: removes the first element void pop_front(); // EFFECTS: returns true if the list is empty bool empty() const; // EFFECTS: Inserts datum at index n in the list void insert(T datum, int n); void print(std::ostream & os) const; private: struct Node { T datum; Node *next; }; Node *first; // EFFECTS: removes all nodes from the list void pop_all(); // REQUIRES: this list is empty // EFFECTS: copies all nodes from the other list // to this list void push_all(const List &other); }; \u73b0\u5728 Node \u4f5c\u4e3a\u4e00\u4e2a implementation detail\uff0c\u53ea\u80fd\u5728 IntList \u5185\u90e8\u4f7f\u7528\u3002 \u6211\u4eec\u9700\u8981\u9690\u85cf\u8fd9\u4e9b mplementation details\uff0c\u4e5f\u5c31\u662f encapsulation(\u5c01\u88c5). 21.2.3 Linked_List: Default Ctor \u9ed8\u8ba4\u521b\u5efa\u7684\u662f\u4e00\u4e2a empty linked liest: \u4e8e\u662f\u53ea\u8981\u628a first initialize \u4e3a\u4e00\u4e2a nullptr \u5c31\u53ef\u4ee5\u4e86\u3002 template <typename T> List<T>::List() : first(nullptr) { } \u4e8e\u662f\u9644\u4e0a\u4e00\u4e2a\u5224\u65ad\u8fd9\u4e2a linked_list \u662f\u5426\u4e3a\u7a7a\u7684\u51fd\u6570\u3002 template <typename T> bool List<T>::empty() const { return first == nullptr; } 21.2.4 Linked_List: \u83b7\u53d6\u6700\u524d\u65b9\u7684 Node \u4e0a\u7684\u503c \u6211\u4eec\u8fd4\u56de T & \uff0c\u610f\u601d\u662f\u6211\u4eec\u65e2\u53ef\u4ee5\u7528\u5b83\u6765\u83b7\u53d6 Node \u4e0a\u7684\u503c\uff0c\u4e5f\u53ef\u4ee5\u7528\u5b83\u6765 \u66f4\u6539 Node \u4e0a\u7684\u503c\u3002 template <typename T> T & List<T>::front() { assert(!empty()); return first->datum; } 21.2.5 Linked_List: push_front \u5728 list \u9996\u63d2\u5165\u5143\u7d20 \u6211\u4eec\u5982\u679c\u60f3\u628a\u4e00\u4e2a\u503c\u63d2\u5165\u5230 first \u7684\u540e\u9762\uff1a \u9996\u5148\u6211\u4eec\u5e94\u8be5 new \u4e00\u4e2a Node \u5e76 copy \u6211\u4eec\u60f3\u4f20\u8fdb\u53bb\u7684\u503c\u8fdb\u5165\u8fd9\u4e2a Node\uff0c\u8ba9\u8fd9\u4e2a Node \u6307\u5411 \u539f\u672c\u7684\u9996\u5143\u7d20\uff0c\u4e5f\u5c31\u662f\u628a first \u7684\u503c\u4f20\u7ed9\u5b83\uff1b \u7136\u540e\u6211\u4eec\u5e94\u8be5\u628a first \u66f4\u6539\u4e3a\u6307\u5411\u8fd9\u4e2a Node . template <typename T> void List<T>::push_front(T datum) { Node *p = new Node; // new \u4e00\u4e2a\u65b0 Node p->datum = datum; // \u7ed9 Node \u8d4b\u503c p->next = first; // \u8ba9 p \u6307\u5411\u539f\u672c\u7684\u9996\u5143\u7d20 first = p; // \u8ba9 first \u6307\u5411 Node } \u6ce8\u610f\uff0c\u8fd9\u4e2a\u987a\u5e8f\u662f\u4e0d\u80fd\u6539\u53d8\u7684\u3002\u6bd4\u5982\u5982\u679c\u5148\u8ba9 first \u6307\u5411 Node\uff0c\u518d\u8ba9 p \u548c first \u6307\u5411\u540c\u4e00\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u6211\u4eec\u5e8a\u5c31\u521b\u9020\u51fa\u4e00\u4e2a\u4e00\u4e2a\u6307\u5411\u81ea\u5df1\u7684 Node. 21.2.6 Linked_List: pop_front \u5f39\u51fa list \u9996\u5143\u7d20 \u9996\u5148\uff0c\u6211\u4eec\u786e\u4fdd list \u73b0\u5728\u5e76\u4e0d\u662f\u7a7a\u7684\u3002 \u7136\u540e\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a ptr name \u53eb victim \uff0c\u8ba9\u5b83\u6307\u5411 first \u6307\u5411\u7684\uff0c\u4e5f\u5c31\u662f list \u9996\u5143\u7d20\u3002\u8fd9\u4e00\u6b65\u662f\u4e3a\u4e86\u7b49\u4e0b\u8ba9 first \u6307\u5411\u539f\u6765\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20\u540e \u4ecd\u7136\u6709\u529e\u6cd5 access \u539f\u6765\u7684\u9996\u5143\u7d20\uff0c\u9632\u6b62 memory leak. \u7136\u540e\u8ba9 first \u6307\u5411\u539f\u6765\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20\uff0c\u4e5f\u5c31\u662f\u73b0\u5728\u7684 first \u6307\u5411\u7684\u9996 Node \u7684 next . \u7136\u540e delete victim \u6307\u5411\u7684\u539f\u6765\u7684\u9996\u5143\u7d20\u3002\u5b8c\u6210\u3002 template <typename T> void List<T>::pop_front() { assert(!empty()); Node *victim = first; first = first->next; delete victim; } 21.2.7 Linked_List: print \u8fd9\u4e2a list \u8fd9\u91cc\u4ecb\u7ecd\u4e00\u79cd\u5f88\u65b0\u7684 for \u5faa\u73af\u65b9\u5f0f\u3002\u5176\u5b9e\u4e5f\u4e0d\u662f\u5f88\u65b0\uff0c\u5c31\u662f\u548c\u666e\u901a\u7684\u4e0d\u4e00\u6837\u3002 \u603b\u4e4b for loop \u7684\u7b2c\u4e00\u4e2a statement \u662f\u5faa\u73af\u53d8\u91cf\u53ca\u5176\u521d\u59cb\u503c\uff1b\u7b2c\u4e8c\u4e2a statement \u662f\u5faa\u73af\u6761\u4ef6\uff1b\u7b2c\u4e09\u4e2a statement \u662f iteration \u8bed\u53e5\u3002 \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a statement \u521b\u5efa\u4e00\u4e2a\u6307\u9488 np \uff0c\u7ed9\u5b83\u8d4b first \u7684\u503c\u6765\u8ba9\u5b83\u6307\u5411 linked_list \u7684\u9996\u4e2a\u5143\u7d20\uff0c\u63a5\u7740\u8ba9\u5b83 iterate \u4e3a\u6bcf\u4e2a next \u6307\u9488\uff0c\u76f4\u5230\u5b83\u5230 nullptr \u4e5f\u5c31\u662f traversal \u5230\u4e86 linked_list \u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u4e3a\u6b62\u3002 \u4e8e\u662f\u6211\u4eec\u5c06\u901a\u8fc7\u8fd9\u53e5 for \u8868\u8fbe\u5f0f\uff1a for(Node *np = first; np != nullptr; np = np-> next) \u6765 traversal \u6574\u4e2a linked_list. template <typename T> void List<T>::print(std::ostream &os) const { for (Node *np = first; np != nullptr; np = np->next) os << np->datum << \" \"; os << std::endl; } 21.2.8 Check the Big Three Review: the Big Three \u6307\u7684\u662f dtor copy ctor operator= Rule of the Big Three \u6307\uff1a\u5982\u679c\u6211\u4eec\u8981\u7ed9\u8fd9\u4e9b\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a custom \u800c\u4e0d\u662f\u4f7f\u7528 default\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u4e3a\u5269\u4e0b\u4e24\u4e2a\u4e5f custom. \u6211\u4eec\u9996\u5148\u770b\u5230\uff1a template <typename T> void List<T>::push_front(T datum) { Node *p = new Node; // new \u4e00\u4e2a\u65b0 Node p->datum = datum; // \u7ed9 Node \u8d4b\u503c p->next = first; // \u8ba9 p \u6307\u5411\u539f\u672c\u7684\u9996\u5143\u7d20 first = p; // \u8ba9 first \u6307\u5411 Node } \u5728 push_front \u4e2d\u6211\u4eec\u4f7f\u7528\u4e86 dynamic allocation \u6765\u521b\u9020 Node\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a Linked_list \u662f\u548c Dynamic memory \u4e2d\u7684 objects \u5173\u8054\u7684\uff01\u56e0\u800c\u6211\u4eec\u5fc5\u987b\u8981\u901a\u8fc7 custom dtor \u6765 delete \u8fd9\u4e9b dynamic objects. \u56e0\u800c\u6839\u636e Rule of the Big Three\uff0c\u6211\u4eec\u5fc5\u987b custom dtor, copt ctor \u548c operator= . Review: \u6211\u4eec\u8981\u505a\u4e00\u4e0b\u7684\u4e8b\u60c5\uff1a Dtor: Free resources Copy ctor: copy regular members deep copy resources operator= \u68c0\u67e5 self-assignment free resources copy regular members deep copy resources return *this 21.2.8.1 Dtor: \u5373 pop_all() template <typename T> List<T>::~List() { pop_all(); } \u6211\u4eec\u73b0\u5728 implement pop_all : \u5176\u5b9e\u5c31\u662f\u4e0d\u505c pop_front() \u76f4\u5230 list \u4e3a\u7a7a template <typename T> void List<T>::pop_all() { while (!empty()) { pop_front(); } } 21.2.8.2 copy ctor template <typename T> List<T>::List(const List &other) : first(nullptr) { // No regular members to copy push_all(other); } template <typename T> void List<T>::push_all(const List &other) { assert(empty()); // \u786e\u8ba4\u5f53\u524d\u4e3aempty Node *last = nullptr; for (Node *p = other.first; p != nullptr; p = p->next) { Node *q = new Node; q->datum = p->datum; q->next = nullptr; if(last == nullptr) { // this is currently empty first = q; last = q; } else { last->next = q; last = q; } } } 21.2.8.3 operator= template <typename T> List<T> & List<T>::operator=(const List<T> &rhs) { if (this == &rhs) return *this; pop_all(); // free resources // No regular members to copy push_all(rhs); // deep copy return *this; } 21.2.9 Linked_list: insert \u5728 index n \u63d2\u5165\u4e00\u4e2a element // EFFECTS: Inserts datum at index n in the list template <typename T> void List<T>::insert(T datum, int n) { if (n == 0){ // n==0: \u63d2\u5165\u4e3a\u9996\u5143\u7d20 push_front(datum); return; } // n != 0 \u7ee7\u7eed\u8fd0\u884c // \u8fd9\u91cc\u7684\u4e24\u4e2a\u6307\u9488, \u4e00\u4e2a\u7528\u6765\u8fde\u63a5\u524d\u9762\u7684 Node, \u4e00\u4e2a\u7528\u6765\u8fde\u63a5\u540e\u9762\u7684 Node Node *c = first; Node *p = first; while(n > 0) { if (c == nullptr) return; p = c; c = c->next; n--; // p, c \u7684\u6307\u5411\u4e00\u76f4\u5f80\u4e0b\u4e00\u4e2a\u8282\u70b9\u79fb\u52a8, \u76f4\u5230\u5230 n \u7684\u4f4d\u7f6e } // new \u4e00\u4e2a\u65b0 Node Node *nd = new Node; // \u8d4b\u503c nd->datum = datum; // \u548c\u540e\u9762\u7684 Node \u8fde\u63a5 nd->next = c; // \u548c\u524d\u9762\u7684 Node \u8fde\u63a5 p->next = nd; } 21.3 Doubly Linked List template <typename T> class IntDList { //... private: struct Node { Node *next; Node *prev; T datum; }; Node *first; Node *last; }; \u8fd9\u80fd\u8ba9 push_back \u548c pop_back \u66f4\u52a0 efficient.","title":"Overview"},{"location":"21-Linked-List.html#21-linked-list","text":"","title":"21 Linked List"},{"location":"21-Linked-List.html#211-sequential-container-adt","text":"Sequential Containers \u5c31\u662f\u5141\u8bb8 sequential access of elements\uff0c \u5373 traversal (\u904d\u5386) \uff1b\u4ee5\u53ca\u4fdd\u6301 elements \u7684\u4e00\u5b9a\u987a\u5e8f\u7684 Container ADT. Sequential Containers \u53ef\u4ee5\u5141\u8bb8 random access via indexing (\u4e5f\u5c31\u662f\u5f62\u5982 a[i] \u8fd9\u79cd\u5f62\u5f0f\u7684 indexing)\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u5141\u8bb8\u3002 \u4f8b\u5b50\uff1aPixels in an image\uff0csequence of characters in a file \u7b49\u7b49 \u6709\u4e00\u4e9b\u6bd4\u8f83\u7ecf\u5178\u7684 sequential Container ADT\uff0c\u6bd4\u5982 queue(\u961f\u5217): First In First Out Stack(\u6808): Last In First Out","title":"21.1 Sequential Container ADT"},{"location":"21-Linked-List.html#2111-array-based-sequential-container-adt-contiguously-elements","text":"\u6211\u4eec\u89c1\u8fc7\u4e00\u4e9b based on array \u7684 Sequential Containers : \u6bd4\u5982 vector . Pro: Array \u628a elements contiguously \u5b58\u50a8\u5728 memory \u4e2d\uff0c\u56e0\u800c based on array \u7684 sequential container \u7684\u4e00\u4e2a\u597d\u5904\u662f indexing \u975e\u5e38\u5feb\uff1a\u56e0\u4e3a a[i] \u4e5f\u5c31\u662f *(a+i) \uff0cindex \u7684 time complexity \u4e3a $O(1)$. Con: \u4f46\u662f based on array \u7684 Sequential Containers\u4e5f\u6709\u4e00\u4e9b\u574f\u5904\u3002 \u5f53 size == capacity \u65f6\u6211\u4eec\u60f3\u8981\u8ba9\u8fd9\u4e2a array \u201cgrow\"\uff0c\u4e5f\u5c31\u662f\u65b0\u5efa\u4e00\u4e2a capacity \u66f4\u5927\u7684 dynamic array \u5e76\u628a\u539f array copy \u8fdb\u53bb\u3002\u8fd9\u82b1\u8d39\u7684 time complexity \u4e3a $O(n)$. \u5982\u679c\u6211\u4eec\u60f3\u8981 elements \u4fdd\u6301 sorted order\uff0c\u90a3\u4e48\u6bcf\u5f53\u6211\u4eec\u7ed9 dynamic array insert \u65b0\u7684\u5143\u7d20\u6216\u8005 remove \u5143\u7d20\u65f6\uff0c\u6211\u4eec\u90fd\u8981\u8fdb\u884c\u4e00\u4e2a shift \u7684\u64cd\u4f5c\uff08\u590d\u5236 dynamic array\uff0c\u5c06\u6307\u5b9a\u4f4d\u7f6e\u4e4b\u524d/\u4e4b\u540e\u7684\u5143\u7d20\u5411\u5de6/\u5411\u53f3 shift \u4e00\u4e2a\u5355\u4f4d\uff09\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u7684 time complexity \u4e3a $O(n)$.","title":"21.1.1 Array-based Sequential Container ADT: contiguously \u5b58\u50a8 elements"},{"location":"21-Linked-List.html#2112-non-contiguously-elements-node","text":"\u5982\u679c\u6211\u4eec\u8981\u7ecf\u5e38\u63d2\u5165\u5143\u7d20\uff0c\u4f46\u662f\u5374\u5f88\u5c11 indexing\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u53e6\u4e00\u79cd trade off: \u91c7\u53d6\u4e00\u79cd non-contiguous \u7684\u5b58\u50a8\u65b9\u5f0f. \u4e0b\u9762\u662f\u4e00\u4e2a Node \u7ed3\u6784\uff1a struct Node { int datum; // \u4e00\u4e2a element Node *next; // \u4e00\u4e2a pointer to next element }; \u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u7ed3\u6784\u4f5c\u4e3a\u6211\u4eec implementation \u7684\u57fa\u7840\u3002\u4e00\u4e2a Node \u7531\u4e00\u4e2a datum (\u5373\u8fd9\u4e2aNode\u4e0a\u7684\u5143\u7d20) \u4ee5\u53ca\u4e00\u4e2a\u6307\u5411\u4e0b\u4e00\u4e2a Node \u7684 pointer \u7ec4\u6210\u3002 \u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u80fd\u505a\u5230\u5feb\u901f\u7684 insert \u548c remove: \u60f3\u8981 insert/remove \u4e00\u4e2a\u5143\u7d20\uff0c\u53ea\u8981\u66f4\u6539\u4e0a\u4e00\u4e2a/\u4e0b\u4e00\u4e2a Node \u7684 next \u5c31\u53ef\u4ee5\uff0ctime complexity \u4e3a $O(1)$. \u5e76\u4e14\uff0c\u6211\u4eec\u5c06\u4e0d\u518d\u9700\u8981 grow \u8fd9\u4e2a container. \u4f46\u662f\u5feb\u901f\u7684 insert/remoe \u6362\u53d6\u7684\u4ee3\u4ef7\u662f\uff1aindexing \u5c06\u53d8\u6162\uff0c\u4e0d\u5f97\u4e0d\u4f7f\u7528 loop \u6765\u8fdb\u884c traversal.","title":"21.1.2 Non-contiguously \u5b58\u50a8 elements: \u4f7f\u7528 node"},{"location":"21-Linked-List.html#212-linked-list","text":"","title":"21.2 Linked List"},{"location":"21-Linked-List.html#2121-based-on-chain-of-nodes-data-structure","text":"\u6709\u4e86\u8fd9\u4e2a Node \u7ed3\u6784\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e2a\u65b0\u7684 Sequential Container ADT: linked list. \u6211\u4eec\u79f0\u8fd9\u79cd \u7528 nodes \u800c\u4e0d\u662f array \u6765\u5b9e\u73b0 \u7684 Sequential Container ADT \u4e3a based on chain of nodes \u7684 data structure. template <typename T> struct Node { T datum; Node *next; }; template <typename T> class Linked_List { private: Node *first; //... } Representative Invariants: first \u53ef\u4ee5\u662f nullptr (\u5bf9\u4e8e\u4e00\u4e2a empty linked list) \u4e5f\u53ef\u4ee5 points to a valid Node . \u5728\u6700\u540e\u4e00\u4e2a Node \u4e2d\uff0c next \u603b\u662f nullptr . \u9664\u4e86 first \u4e0e\u6700\u540e\u4e00\u4e2a Node\uff0c\u5176\u4ed6 Nodes \u90fd\u5fc5\u987b points to \u53e6\u5916\u4e00\u4e2a Node . \u6ca1\u6709 cycle.","title":"21.2.1 Based on chain of nodes \u7684 data structure"},{"location":"21-Linked-List.html#2122-the-intlist-interface","text":"template <typename T> class List { public: // EFFECTS: constructs an empty list List(); List(const List &other); ~List(); List & operator=(const List &rhs); // EFFECTS: inserts datum at front of list void push_front(T datum); // REQUIRES: the list is not empty // EFFECTS: Returns (by ref.) first element T & front(); // REQUIRES: the list is not empty // EFFECTS: removes the first element void pop_front(); // EFFECTS: returns true if the list is empty bool empty() const; // EFFECTS: Inserts datum at index n in the list void insert(T datum, int n); void print(std::ostream & os) const; private: struct Node { T datum; Node *next; }; Node *first; // EFFECTS: removes all nodes from the list void pop_all(); // REQUIRES: this list is empty // EFFECTS: copies all nodes from the other list // to this list void push_all(const List &other); }; \u73b0\u5728 Node \u4f5c\u4e3a\u4e00\u4e2a implementation detail\uff0c\u53ea\u80fd\u5728 IntList \u5185\u90e8\u4f7f\u7528\u3002 \u6211\u4eec\u9700\u8981\u9690\u85cf\u8fd9\u4e9b mplementation details\uff0c\u4e5f\u5c31\u662f encapsulation(\u5c01\u88c5).","title":"21.2.2 The IntList interface"},{"location":"21-Linked-List.html#2123-linked_list-default-ctor","text":"\u9ed8\u8ba4\u521b\u5efa\u7684\u662f\u4e00\u4e2a empty linked liest: \u4e8e\u662f\u53ea\u8981\u628a first initialize \u4e3a\u4e00\u4e2a nullptr \u5c31\u53ef\u4ee5\u4e86\u3002 template <typename T> List<T>::List() : first(nullptr) { } \u4e8e\u662f\u9644\u4e0a\u4e00\u4e2a\u5224\u65ad\u8fd9\u4e2a linked_list \u662f\u5426\u4e3a\u7a7a\u7684\u51fd\u6570\u3002 template <typename T> bool List<T>::empty() const { return first == nullptr; }","title":"21.2.3 Linked_List: Default Ctor"},{"location":"21-Linked-List.html#2124-linked_list-node","text":"\u6211\u4eec\u8fd4\u56de T & \uff0c\u610f\u601d\u662f\u6211\u4eec\u65e2\u53ef\u4ee5\u7528\u5b83\u6765\u83b7\u53d6 Node \u4e0a\u7684\u503c\uff0c\u4e5f\u53ef\u4ee5\u7528\u5b83\u6765 \u66f4\u6539 Node \u4e0a\u7684\u503c\u3002 template <typename T> T & List<T>::front() { assert(!empty()); return first->datum; }","title":"21.2.4 Linked_List: \u83b7\u53d6\u6700\u524d\u65b9\u7684 Node \u4e0a\u7684\u503c"},{"location":"21-Linked-List.html#2125-linked_list-push_front-list","text":"\u6211\u4eec\u5982\u679c\u60f3\u628a\u4e00\u4e2a\u503c\u63d2\u5165\u5230 first \u7684\u540e\u9762\uff1a \u9996\u5148\u6211\u4eec\u5e94\u8be5 new \u4e00\u4e2a Node \u5e76 copy \u6211\u4eec\u60f3\u4f20\u8fdb\u53bb\u7684\u503c\u8fdb\u5165\u8fd9\u4e2a Node\uff0c\u8ba9\u8fd9\u4e2a Node \u6307\u5411 \u539f\u672c\u7684\u9996\u5143\u7d20\uff0c\u4e5f\u5c31\u662f\u628a first \u7684\u503c\u4f20\u7ed9\u5b83\uff1b \u7136\u540e\u6211\u4eec\u5e94\u8be5\u628a first \u66f4\u6539\u4e3a\u6307\u5411\u8fd9\u4e2a Node . template <typename T> void List<T>::push_front(T datum) { Node *p = new Node; // new \u4e00\u4e2a\u65b0 Node p->datum = datum; // \u7ed9 Node \u8d4b\u503c p->next = first; // \u8ba9 p \u6307\u5411\u539f\u672c\u7684\u9996\u5143\u7d20 first = p; // \u8ba9 first \u6307\u5411 Node } \u6ce8\u610f\uff0c\u8fd9\u4e2a\u987a\u5e8f\u662f\u4e0d\u80fd\u6539\u53d8\u7684\u3002\u6bd4\u5982\u5982\u679c\u5148\u8ba9 first \u6307\u5411 Node\uff0c\u518d\u8ba9 p \u548c first \u6307\u5411\u540c\u4e00\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u6211\u4eec\u5e8a\u5c31\u521b\u9020\u51fa\u4e00\u4e2a\u4e00\u4e2a\u6307\u5411\u81ea\u5df1\u7684 Node.","title":"21.2.5 Linked_List: push_front \u5728 list \u9996\u63d2\u5165\u5143\u7d20"},{"location":"21-Linked-List.html#2126-linked_list-pop_front-list","text":"\u9996\u5148\uff0c\u6211\u4eec\u786e\u4fdd list \u73b0\u5728\u5e76\u4e0d\u662f\u7a7a\u7684\u3002 \u7136\u540e\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a ptr name \u53eb victim \uff0c\u8ba9\u5b83\u6307\u5411 first \u6307\u5411\u7684\uff0c\u4e5f\u5c31\u662f list \u9996\u5143\u7d20\u3002\u8fd9\u4e00\u6b65\u662f\u4e3a\u4e86\u7b49\u4e0b\u8ba9 first \u6307\u5411\u539f\u6765\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20\u540e \u4ecd\u7136\u6709\u529e\u6cd5 access \u539f\u6765\u7684\u9996\u5143\u7d20\uff0c\u9632\u6b62 memory leak. \u7136\u540e\u8ba9 first \u6307\u5411\u539f\u6765\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20\uff0c\u4e5f\u5c31\u662f\u73b0\u5728\u7684 first \u6307\u5411\u7684\u9996 Node \u7684 next . \u7136\u540e delete victim \u6307\u5411\u7684\u539f\u6765\u7684\u9996\u5143\u7d20\u3002\u5b8c\u6210\u3002 template <typename T> void List<T>::pop_front() { assert(!empty()); Node *victim = first; first = first->next; delete victim; }","title":"21.2.6 Linked_List: pop_front \u5f39\u51fa list \u9996\u5143\u7d20"},{"location":"21-Linked-List.html#2127-linked_list-print-list","text":"\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u79cd\u5f88\u65b0\u7684 for \u5faa\u73af\u65b9\u5f0f\u3002\u5176\u5b9e\u4e5f\u4e0d\u662f\u5f88\u65b0\uff0c\u5c31\u662f\u548c\u666e\u901a\u7684\u4e0d\u4e00\u6837\u3002 \u603b\u4e4b for loop \u7684\u7b2c\u4e00\u4e2a statement \u662f\u5faa\u73af\u53d8\u91cf\u53ca\u5176\u521d\u59cb\u503c\uff1b\u7b2c\u4e8c\u4e2a statement \u662f\u5faa\u73af\u6761\u4ef6\uff1b\u7b2c\u4e09\u4e2a statement \u662f iteration \u8bed\u53e5\u3002 \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u5728\u7b2c\u4e00\u4e2a statement \u521b\u5efa\u4e00\u4e2a\u6307\u9488 np \uff0c\u7ed9\u5b83\u8d4b first \u7684\u503c\u6765\u8ba9\u5b83\u6307\u5411 linked_list \u7684\u9996\u4e2a\u5143\u7d20\uff0c\u63a5\u7740\u8ba9\u5b83 iterate \u4e3a\u6bcf\u4e2a next \u6307\u9488\uff0c\u76f4\u5230\u5b83\u5230 nullptr \u4e5f\u5c31\u662f traversal \u5230\u4e86 linked_list \u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u4e3a\u6b62\u3002 \u4e8e\u662f\u6211\u4eec\u5c06\u901a\u8fc7\u8fd9\u53e5 for \u8868\u8fbe\u5f0f\uff1a for(Node *np = first; np != nullptr; np = np-> next) \u6765 traversal \u6574\u4e2a linked_list. template <typename T> void List<T>::print(std::ostream &os) const { for (Node *np = first; np != nullptr; np = np->next) os << np->datum << \" \"; os << std::endl; }","title":"21.2.7 Linked_List: print \u8fd9\u4e2a list"},{"location":"21-Linked-List.html#2128-check-the-big-three","text":"Review: the Big Three \u6307\u7684\u662f dtor copy ctor operator= Rule of the Big Three \u6307\uff1a\u5982\u679c\u6211\u4eec\u8981\u7ed9\u8fd9\u4e9b\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a custom \u800c\u4e0d\u662f\u4f7f\u7528 default\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u4e3a\u5269\u4e0b\u4e24\u4e2a\u4e5f custom. \u6211\u4eec\u9996\u5148\u770b\u5230\uff1a template <typename T> void List<T>::push_front(T datum) { Node *p = new Node; // new \u4e00\u4e2a\u65b0 Node p->datum = datum; // \u7ed9 Node \u8d4b\u503c p->next = first; // \u8ba9 p \u6307\u5411\u539f\u672c\u7684\u9996\u5143\u7d20 first = p; // \u8ba9 first \u6307\u5411 Node } \u5728 push_front \u4e2d\u6211\u4eec\u4f7f\u7528\u4e86 dynamic allocation \u6765\u521b\u9020 Node\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a Linked_list \u662f\u548c Dynamic memory \u4e2d\u7684 objects \u5173\u8054\u7684\uff01\u56e0\u800c\u6211\u4eec\u5fc5\u987b\u8981\u901a\u8fc7 custom dtor \u6765 delete \u8fd9\u4e9b dynamic objects. \u56e0\u800c\u6839\u636e Rule of the Big Three\uff0c\u6211\u4eec\u5fc5\u987b custom dtor, copt ctor \u548c operator= . Review: \u6211\u4eec\u8981\u505a\u4e00\u4e0b\u7684\u4e8b\u60c5\uff1a Dtor: Free resources Copy ctor: copy regular members deep copy resources operator= \u68c0\u67e5 self-assignment free resources copy regular members deep copy resources return *this","title":"21.2.8 Check the Big Three"},{"location":"21-Linked-List.html#21281-dtor-pop_all","text":"template <typename T> List<T>::~List() { pop_all(); } \u6211\u4eec\u73b0\u5728 implement pop_all : \u5176\u5b9e\u5c31\u662f\u4e0d\u505c pop_front() \u76f4\u5230 list \u4e3a\u7a7a template <typename T> void List<T>::pop_all() { while (!empty()) { pop_front(); } }","title":"21.2.8.1 Dtor: \u5373pop_all()"},{"location":"21-Linked-List.html#21282-copy-ctor","text":"template <typename T> List<T>::List(const List &other) : first(nullptr) { // No regular members to copy push_all(other); } template <typename T> void List<T>::push_all(const List &other) { assert(empty()); // \u786e\u8ba4\u5f53\u524d\u4e3aempty Node *last = nullptr; for (Node *p = other.first; p != nullptr; p = p->next) { Node *q = new Node; q->datum = p->datum; q->next = nullptr; if(last == nullptr) { // this is currently empty first = q; last = q; } else { last->next = q; last = q; } } }","title":"21.2.8.2 copy ctor"},{"location":"21-Linked-List.html#21283-operator","text":"template <typename T> List<T> & List<T>::operator=(const List<T> &rhs) { if (this == &rhs) return *this; pop_all(); // free resources // No regular members to copy push_all(rhs); // deep copy return *this; }","title":"21.2.8.3 operator="},{"location":"21-Linked-List.html#2129-linked_list-insert-index-n-element","text":"// EFFECTS: Inserts datum at index n in the list template <typename T> void List<T>::insert(T datum, int n) { if (n == 0){ // n==0: \u63d2\u5165\u4e3a\u9996\u5143\u7d20 push_front(datum); return; } // n != 0 \u7ee7\u7eed\u8fd0\u884c // \u8fd9\u91cc\u7684\u4e24\u4e2a\u6307\u9488, \u4e00\u4e2a\u7528\u6765\u8fde\u63a5\u524d\u9762\u7684 Node, \u4e00\u4e2a\u7528\u6765\u8fde\u63a5\u540e\u9762\u7684 Node Node *c = first; Node *p = first; while(n > 0) { if (c == nullptr) return; p = c; c = c->next; n--; // p, c \u7684\u6307\u5411\u4e00\u76f4\u5f80\u4e0b\u4e00\u4e2a\u8282\u70b9\u79fb\u52a8, \u76f4\u5230\u5230 n \u7684\u4f4d\u7f6e } // new \u4e00\u4e2a\u65b0 Node Node *nd = new Node; // \u8d4b\u503c nd->datum = datum; // \u548c\u540e\u9762\u7684 Node \u8fde\u63a5 nd->next = c; // \u548c\u524d\u9762\u7684 Node \u8fde\u63a5 p->next = nd; }","title":"21.2.9 Linked_list: insert \u5728 index n \u63d2\u5165\u4e00\u4e2a element"},{"location":"21-Linked-List.html#213-doubly-linked-list","text":"template <typename T> class IntDList { //... private: struct Node { Node *next; Node *prev; T datum; }; Node *first; Node *last; }; \u8fd9\u80fd\u8ba9 push_back \u548c pop_back \u66f4\u52a0 efficient.","title":"21.3 Doubly Linked List"},{"location":"22-Iterator.html","text":"22 Iterator 22.1 List<type>::Iterator 22.1.1 Nested class Iterator: interface 22.1.2 Iterator \u901a\u8fc7 overload operators \u6765\u6a21\u62df ptr arithmetic 22.2 Iterator \u7684 implementations 22.2.1 Iterator \u7684 ctor List<T>::Iterator::Iterator(\\*...*\\) 22.2.2 \u5bf9 List \u521d\u59cb\u5316\u4e00\u4e2a iterator: \u8fd4\u56de Iterator\u7684 member function 22.2.2.1 typename keyword 22.2.2.2 List<T> \u7684 begin \u548c end function: return \u4e00\u4e2a\u76f8\u5e94\u4f4d\u7f6e\u7684 Iterator 22.2.3 Iterator: * \u7684 overload 22.2.4 Iterator: ++ \u7684 overload 22.2.4.1 pre-increment evaluated: ++it 22.2.4.2 post-increment: it++ 22.2.5 Iterator: == \u548c != \u7684 overload 22.3 check for the Big Three \u4ee5\u53ca\u4f7f\u7528 Iterator 22.3.1 check for the Big Three 22.3.2 \u5b8c\u6210\u5e76\u4f7f\u7528 Iterator \u6765 traverse \u4e00\u4e2a linked list 22.3.3 Iterator Invalidation 22.3.4 Traversal \u7ec3\u4e60: Check for duplicates 22 Iterator \u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e Linked_list\uff0c\u6211\u4eec\u76ee\u524d\u5e76\u6ca1\u6709\u4e00\u4e2a\u597d\u529e\u6cd5\u6765 traverse \u5b83. \u6211\u4eec\u6216\u8bb8\u4f1a\u5c1d\u8bd5\u50cf\uff1a for (List<int>::Node *np = list.first; np != nullptr; np = np->next) cout << np->datum << endl; } \u4f46\u662f\u8fd9\u6839\u672c\u4e0d\u4f1a compile\uff0c\u56e0\u4e3aNode \u548c first \u90fd\u662f interface\uff0c\u662f user \u65e0\u6cd5 access \u7684\uff08\u90fd\u662f private\u7684\uff09 \u6211\u4eec\u56de\u5fc6\u5982\u4f55\u7528 pointer \u6765 traverse \u4e00\u4e2a array: int *end = arr + SIZE; for (int *ptr = arr; ptr != end; ++ptr) cout << *ptr << endl; \u800c\u73b0\u5728\u6211\u4eec\u8981\u4ecb\u7ecd\u4e00\u79cd\u65b9\u6cd5\uff1a\u5728\u6211\u4eec\u60f3\u8981 iterate \u7684 class (\u6bd4\u5982 Linked List) \u4e2d\u5199\u4e00\u4e2a public \u7684 nested class Iterator \uff0c\u901a\u8fc7 overload \u4e00\u4e9b\u8fd0\u7b97\u7b26\u6765 \u8ba9 Iterator \u8d77\u5230\u50cf\u4e00\u4e2a pointer \u4e00\u6837\u7684\u7528\u9014\uff0c traverse \u6574\u4e2a sequential container ADT object. 22.1 List<type>::Iterator 22.1.1 Nested class Iterator : interface friend class \u5173\u952e\u8bcd: \u8868\u793a List \u8fd9\u4e2a class \u662f Iterator \u7684 friend class\uff0c\u53ef\u4ee5 access Iterator \u7684 private members template <typename T> class List { public: class Iterator { friend class List; // \u58f0\u660e friend: List \u8fd9\u4e2a class \u53ef\u4ee5 access Iterator \u7684 private members public: Iterator(); // ctor T & operator*() const; // overload * Iterator & operator++(); // overload ++ bool operator==(Iterator rhs) const; // overload == bool operator!=(Iterator rhs) const; // overload != //... private: Node *node_ptr; Iterator(Node *np); } Iterator begin(); // at beginning Iterator end(); // \"past the end\" //... }; 22.1.2 Iterator \u901a\u8fc7 overload operators \u6765\u6a21\u62df ptr arithmetic \u6211\u4eec\u901a\u8fc7\u5728 Iterator \u4e2d\uff0coverload \u4ee5\u4e0b\u8fd9\u51e0\u4e2a\u51fd\u6570\u6765\u8fbe\u6210 operator * \uff1a\u6a21\u62df dereference operator ++ \uff1a \u6a21\u62df pointer arithmetic operator == \uff0c operator != \uff1a\u4e24\u4e2a Iterator \u7684 Node * \u662f\u5426\u6307\u5411\u540c\u4e00\u4e2a Node \u6211\u4eec\u60f3\u8981\u7684\u5b9e\u73b0\u7684\u6548\u679c\u662f\uff1a \u5047\u8bbe it \u662f\u4e00\u4e2a Iterator \uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5 *it \u6765\u83b7\u53d6\u5f53\u524d\u7684 Node\uff0c\u6211\u4eec\u53ef\u4ee5 ++it \u6765\u8ba9\u5b83\u79fb\u52a8\u5230 List \u4e2d\u7684\u4e0b\u4e00\u4e2a Node (\u5373\u8ba9\u5b83\u7684 member node_ptr \u7684\u503c\u4ece\u5f53\u524d Node \u7684\u5730\u5740\u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a Node \u7684\u5730\u5740.) 22.2 Iterator \u7684 implementations 22.2.1 Iterator \u7684 ctor List<T>::Iterator::Iterator(\\*...*\\) template <typename T> List<T>::Iterator::Iterator() : node_ptr(nullptr) { } template <typename T> List<T>::Iterator::Iterator(Node *np) : node_ptr(np) { } 22.2.2 \u5bf9 List \u521d\u59cb\u5316\u4e00\u4e2a iterator: \u8fd4\u56de Iterator\u7684 member function 22.2.2.1 typename keyword \u8fd9\u91cc\u662f\u4e00\u4e2a\u65b0\u7684\u8bed\u6cd5\u3002 \u5728\u4efb\u4f55 template function (\u4e0d\u6b62\u662f member function) \u4e2d\uff0c\u53ea\u8981\u6211\u4eec\u9700\u8981\u83b7\u53d6\u7684\u503c\uff08\u6bd4\u5982\u51fd\u6570\u8fd4\u56de\u503c\uff0c\u6216\u8005 initialize \u4e00\u4e2a\u8be5 nested class \u7684 object\uff09\u7684\u7c7b\u578b\u662f\u4e00\u4e2a nested type inside a type which depends on template parameter \uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981 \u5728\u8be5\u8bed\u53e5\u524d\u52a0\u4e0a typename \u8fd9\u4e2a keyword. \u6bd4\u5982\u6211\u4eec\u4e0b\u9762\u8981\u5199\u7684\u4e24\u4e2a List \u7684member function\uff1a \u8fd4\u56de\u4e00\u4e2a List<T>::Iterator \u7684 instance \u7684 begin() \u548c end() \u51fd\u6570\u3002 \u7531\u4e8e \u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u7684 type \u4e3a Iterator \uff0c Iterator \u662f List<T> \u4e2d\u7684 nested type. List<T> \u53d6\u51b3\u4e8e template parameter T . \u56e0\u800c\u6211\u4eec\u5fc5\u987b\u8981\u5728\u51fd\u6570 definition \u524d\u52a0\u4e0a typename \u8fd9\u4e00\u5173\u952e\u8bcd template <typename T> typename List<T>::Iterator List<T>::begin() { return Iterator(first); } template <typename T> typename List<T>::Iterator List<T>::end() { return Iterator(); } \u4e0d\u6b62\u5982\u6b64\uff0c\u6211\u4eec\u5982\u679c\u5199\u4e00\u4e2a\u666e\u901a\u7684 template function\uff0c template <typename T> void func() { IntList::Iterator it1; // does not depend on T List<int>::Iterator it2; // does not depend on T typename List<T>::Iterator it3; // depend on T } \u5176\u4e2d\u6211\u4eec initialize \u4e86\u4e00\u4e2a\u53d6\u51b3\u4e8e T \u7684 type List \u4e2d\u7684\u4e00\u4e2a nested type Iterator \u7684 instance\uff0c\u4e8e\u662f\u5728\u8fd9\u53e5 initialization \u524d\u6211\u4eec\u4e5f\u8981\u52a0\u4e0a typename keyword. \u800c\u5982\u679c\u6211\u4eec\u9700\u8981\u4e00\u4e2a template type \u7684 nested type \u7684 instance\uff0c\u4f46\u662f\u6211\u4eec\u4e3a\u8fd9\u4e2a template class \u786e\u5b9a\u4e86 T\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u52a0\u4e0a typename \uff0c\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019\u8fd9\u4e2a class \u5df2\u7ecf\u4e0d depend on T \u4e86\u3002 22.2.2.2 List<T> \u7684 begin \u548c end function: return \u4e00\u4e2a\u76f8\u5e94\u4f4d\u7f6e\u7684 Iterator template <typename T> typename List<T>::Iterator List<T>::begin() { return Iterator(first); // return an iterator at the beginning. } template <typename T> typename List<T>::Iterator List<T>::end() { return Iterator(); // return an iterator \"past the end\". } 22.2.3 Iterator: * \u7684 overload \u4ece\u8fd9\u91cc\u5f00\u59cb\u5c31\u662f nested class Itertor \u7684\u51fd\u6570\u4e86\u3002\u7531\u4e8e\u662f nested class\uff0c\u5728 definition \u65f6\u6211\u4eec\u9700\u8981\u5148\u52a0\u4e0a List<T> \u7684 scope \u518d\u52a0\u4e0a Iterator \u7684 scope: template <typename T> T & List<T>::Iterator::operator*() const { assert(node_ptr); // \u786e\u4fdd != nullptr, \u5373list\u4e0d\u4e3a\u7a7a, \u4e14Iterator \u5f53\u524d\u5728 list \u4e4b\u5185 return node_ptr->datum; // \u8fd4\u56de Iterator \u7684 node_ptr \u6307\u5411\u7684 Node \u503c } \u6ce8\u610f\uff1a\u6211\u4eec overload \u7684 * \u8fd4\u56de\u7684\u662f reference\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u65e2\u53ef\u4ee5\u7528\u5b83\u6765\u83b7\u53d6\u503c\uff0c\u53c8\u53ef\u4ee5\u7528\u5b83\u6765\u6539\u53d8\u539f\u6765\u7684\u503c\u3002\u8fd9\u6b63\u6a21\u62df\u4e86 * \u8fd0\u7b97\u7b26\u539f\u672c\u7684\u7528\u5904\u3002 22.2.4 Iterator: ++ \u7684 overload \u6ce8\u610f\uff1a operator++ \u505a\u4e86\u4e24\u4ef6\u4e8b\uff0c\u4e00\u4ef6\u4e8b\u662f increment\uff0c\u53e6\u4e00\u4ef6\u4e8b\u662f\u8fd4\u56de\u503c \uff08pre-increment operator++ \u8fd4\u56de\u7684\u662f reference\uff0cpost-increment operator++ \u8fd4\u56de\u7684\u662f value.\uff09 \u56e0\u800c\u6211\u4eec\u8fd9\u91cc\u9700\u8981\u52a0\u4e0a typename \u5173\u952e\u8bcd\uff01 22.2.4.1 pre-increment evaluated: ++it \u5728\u8fd9\u91cc\u6211\u4eec overload \u7684\u662f pre-increment \u7684 ++ \uff0c\u7528\u6cd5\u4e3a ++it . pre-increment \u7684 ++ \u4f1a\u5148 increment \u518d\u8fd4\u56de\u503c\uff0c\u5e76\u4e14\u8fd4\u56de\u7684\u662f\u5f15\u7528\u503c\u3002 template <typename T> typename List<T>::Iterator & List<T>::Iterator::operator++() { assert(node_ptr); node_ptr = node_ptr->next; return *this; } 22.2.4.2 post-increment: it++ \u6211\u4eec\u4e5f\u53ef\u4ee5\u5199\u4e00\u4e2a post-increment \u7684 operator++ \u7684 overload. \u5e26\u6709\u53c2\u6570 int \uff0c\u5e76\u4e14\u4e0d\u8fd4\u56de reference \u800c\u662f\u8fd4\u56de\u503c \u7684\u662f post-increment \u7684 ++ \uff0c\u7528\u6cd5\u4e3a it++ . Post-increment \u7684 ++ \u4f1a\u8fd4\u56de increment \u524d\u7684\u503c\uff0c\u4e14\u662f\u4e00\u4e2a copy. template <typename T> typename List<T>::Iterator List<T>::Iterator::operator++(int) { assert(node_ptr); Node *copy = node_ptr; node_ptr = node_ptr->next; return *copy; } 22.2.5 Iterator: == \u548c != \u7684 overload template <typename T> bool List<T>::Iterator::operator==(Iterator rhs) const { return node_ptr == rhs.node_ptr; } template <typename T> bool List<T>::Iterator::operator!=(const Iterator & rhs) const { return !(*this == rhs); } 22.3 check for the Big Three \u4ee5\u53ca\u4f7f\u7528 Iterator 22.3.1 check for the Big Three \u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u4e3a Iterator custom Big Three. \u8fd9\u662f\u5408\u7406\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u5728 implement Iterator \u65f6\u5e76\u6ca1\u6709\u52a8\u7528 dynamic memory. \u56e0\u800c\u6211\u4eec\u505a\u7684\u4efb\u4f55 Iterator \u7684 copy \u90fd\u662f shallow copy \u800c\u4e0d\u662f deep copy. List<int>::Iterator it2 = it1; \u8fd9\u79cd\u505a\u6cd5\u662f\u6b63\u786e\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u5982\u679c\u8981 deep copy Iterator \u5c31\u4f1a\u5efa\u51fa\u83ab\u540d\u5176\u5999\u7684\u65b0\u7684 linked list. \u8fd9\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u3002 22.3.2 \u5b8c\u6210\u5e76\u4f7f\u7528 Iterator \u6765 traverse \u4e00\u4e2a linked list \u6211\u4eec\u5728 check \u5b8c Big Three \u4e4b\u540e\u5c31\u5b8c\u6210\u4e86 Iterator \u7684\u6784\u5efa\u3002 \u5b9e\u9645\u4e0a\u6211\u4eec\u5199\u7684 Iterator matches the Iterator in the STL. \u901a\u8fc7\u4e3a\u4e0d\u540c\u7684 containers define \u76f8\u540c interface \u7684 iterators\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e0d\u540c\u7684 containers \u4f7f\u7528\u76f8\u540c\u7684 looping code. \u73b0\u5728\u6211\u4eec\u7528\u6211\u4eec\u5199\u5b8c\u7684 Iterator \u6765 traverse \u4e00\u4e2a linked list: int main() { List<int> list; // ( ) list.push_front(1); // ( 1 ) list.push_front(3); // ( 3 2 1 ) list.front() = 4; // ( 4 2 1 ) list.insert(99, 0); // ( 99 4 2 1 ) list.insert(88, 3); // ( 99 4 2 88 1 ) list.pop_front(); // ( 4 2 88 1 ) for (List<int>::Iterator it = list.begin(); it != list.end(); ++it) cout << *it << endl; cout << endl; // 4 // 2 // 88 // 1 } 22.3.3 Iterator Invalidation int main() { List<int> list; // \u2026 fill with values List<int>::Iterator it = list.begin(); List<int>::Iterator it2 = list.begin(); cout << *it << endl; // OK cout << *it2 << endl; // OK list.pop_front(); // \u5220\u9664\u4e86 it, it2 \u6b63 point to \u7684 element cout << *it << endl; // Undefined behavior cout << *it2 << endl; // Undefined behavior } Invalidated iterators \u5c31\u50cf dangling pointers\uff0cdereference \u5b83\u4eec\u4f1a\u5bfc\u81f4 Undefined Behavior\uff0c\u5f88\u4e0d\u5b89\u5168\u3002 pop_front \u8fd9\u79cd\u5b89\u5168\u7684\u64cd\u4f5c\uff0c\u4e5f\u4f1a\u5bfc\u81f4 iterator invalidation. \u56e0\u800c\u4e00\u4e2a function \u7684 documentation \u5e94\u8be5\u660e\u786e\u5199\u660e iterators \u7684\u7c7b\u578b\uff0c\u4ee5\u53ca\u5b83\u4f1a invalidated \u7684\u60c5\u666f\u3002 22.3.4 Traversal \u7ec3\u4e60: Check for duplicates template <typename T> bool hasDuplicates(List<T> list) { auto end = list.end(); for (auto i = list.begin(); i != end; ++i) { auto j = i; ++j; for ( ; j!=end; ++j) { if (*i == *j) return true; } } return false; }","title":"Overview"},{"location":"22-Iterator.html#22-iterator","text":"\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e Linked_list\uff0c\u6211\u4eec\u76ee\u524d\u5e76\u6ca1\u6709\u4e00\u4e2a\u597d\u529e\u6cd5\u6765 traverse \u5b83. \u6211\u4eec\u6216\u8bb8\u4f1a\u5c1d\u8bd5\u50cf\uff1a for (List<int>::Node *np = list.first; np != nullptr; np = np->next) cout << np->datum << endl; } \u4f46\u662f\u8fd9\u6839\u672c\u4e0d\u4f1a compile\uff0c\u56e0\u4e3aNode \u548c first \u90fd\u662f interface\uff0c\u662f user \u65e0\u6cd5 access \u7684\uff08\u90fd\u662f private\u7684\uff09 \u6211\u4eec\u56de\u5fc6\u5982\u4f55\u7528 pointer \u6765 traverse \u4e00\u4e2a array: int *end = arr + SIZE; for (int *ptr = arr; ptr != end; ++ptr) cout << *ptr << endl; \u800c\u73b0\u5728\u6211\u4eec\u8981\u4ecb\u7ecd\u4e00\u79cd\u65b9\u6cd5\uff1a\u5728\u6211\u4eec\u60f3\u8981 iterate \u7684 class (\u6bd4\u5982 Linked List) \u4e2d\u5199\u4e00\u4e2a public \u7684 nested class Iterator \uff0c\u901a\u8fc7 overload \u4e00\u4e9b\u8fd0\u7b97\u7b26\u6765 \u8ba9 Iterator \u8d77\u5230\u50cf\u4e00\u4e2a pointer \u4e00\u6837\u7684\u7528\u9014\uff0c traverse \u6574\u4e2a sequential container ADT object.","title":"22 Iterator"},{"location":"22-Iterator.html#221-listtypeiterator","text":"","title":"22.1 List&lt;type&gt;::Iterator"},{"location":"22-Iterator.html#2211-nested-class-iterator-interface","text":"friend class \u5173\u952e\u8bcd: \u8868\u793a List \u8fd9\u4e2a class \u662f Iterator \u7684 friend class\uff0c\u53ef\u4ee5 access Iterator \u7684 private members template <typename T> class List { public: class Iterator { friend class List; // \u58f0\u660e friend: List \u8fd9\u4e2a class \u53ef\u4ee5 access Iterator \u7684 private members public: Iterator(); // ctor T & operator*() const; // overload * Iterator & operator++(); // overload ++ bool operator==(Iterator rhs) const; // overload == bool operator!=(Iterator rhs) const; // overload != //... private: Node *node_ptr; Iterator(Node *np); } Iterator begin(); // at beginning Iterator end(); // \"past the end\" //... };","title":"22.1.1 Nested class Iterator: interface"},{"location":"22-Iterator.html#2212-iterator-overload-operators-ptr-arithmetic","text":"\u6211\u4eec\u901a\u8fc7\u5728 Iterator \u4e2d\uff0coverload \u4ee5\u4e0b\u8fd9\u51e0\u4e2a\u51fd\u6570\u6765\u8fbe\u6210 operator * \uff1a\u6a21\u62df dereference operator ++ \uff1a \u6a21\u62df pointer arithmetic operator == \uff0c operator != \uff1a\u4e24\u4e2a Iterator \u7684 Node * \u662f\u5426\u6307\u5411\u540c\u4e00\u4e2a Node \u6211\u4eec\u60f3\u8981\u7684\u5b9e\u73b0\u7684\u6548\u679c\u662f\uff1a \u5047\u8bbe it \u662f\u4e00\u4e2a Iterator \uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5 *it \u6765\u83b7\u53d6\u5f53\u524d\u7684 Node\uff0c\u6211\u4eec\u53ef\u4ee5 ++it \u6765\u8ba9\u5b83\u79fb\u52a8\u5230 List \u4e2d\u7684\u4e0b\u4e00\u4e2a Node (\u5373\u8ba9\u5b83\u7684 member node_ptr \u7684\u503c\u4ece\u5f53\u524d Node \u7684\u5730\u5740\u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a Node \u7684\u5730\u5740.)","title":"22.1.2 Iterator \u901a\u8fc7 overload operators \u6765\u6a21\u62df ptr arithmetic"},{"location":"22-Iterator.html#222-iterator-implementations","text":"","title":"22.2 Iterator \u7684 implementations"},{"location":"22-Iterator.html#2221-iterator-ctor-listtiteratoriterator","text":"template <typename T> List<T>::Iterator::Iterator() : node_ptr(nullptr) { } template <typename T> List<T>::Iterator::Iterator(Node *np) : node_ptr(np) { }","title":"22.2.1 Iterator \u7684 ctor List&lt;T&gt;::Iterator::Iterator(\\*...*\\)"},{"location":"22-Iterator.html#2222-list-iterator-iterator-member-function","text":"","title":"22.2.2 \u5bf9 List \u521d\u59cb\u5316\u4e00\u4e2a iterator: \u8fd4\u56de Iterator\u7684 member function"},{"location":"22-Iterator.html#22221-typename-keyword","text":"\u8fd9\u91cc\u662f\u4e00\u4e2a\u65b0\u7684\u8bed\u6cd5\u3002 \u5728\u4efb\u4f55 template function (\u4e0d\u6b62\u662f member function) \u4e2d\uff0c\u53ea\u8981\u6211\u4eec\u9700\u8981\u83b7\u53d6\u7684\u503c\uff08\u6bd4\u5982\u51fd\u6570\u8fd4\u56de\u503c\uff0c\u6216\u8005 initialize \u4e00\u4e2a\u8be5 nested class \u7684 object\uff09\u7684\u7c7b\u578b\u662f\u4e00\u4e2a nested type inside a type which depends on template parameter \uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981 \u5728\u8be5\u8bed\u53e5\u524d\u52a0\u4e0a typename \u8fd9\u4e2a keyword. \u6bd4\u5982\u6211\u4eec\u4e0b\u9762\u8981\u5199\u7684\u4e24\u4e2a List \u7684member function\uff1a \u8fd4\u56de\u4e00\u4e2a List<T>::Iterator \u7684 instance \u7684 begin() \u548c end() \u51fd\u6570\u3002 \u7531\u4e8e \u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u7684 type \u4e3a Iterator \uff0c Iterator \u662f List<T> \u4e2d\u7684 nested type. List<T> \u53d6\u51b3\u4e8e template parameter T . \u56e0\u800c\u6211\u4eec\u5fc5\u987b\u8981\u5728\u51fd\u6570 definition \u524d\u52a0\u4e0a typename \u8fd9\u4e00\u5173\u952e\u8bcd template <typename T> typename List<T>::Iterator List<T>::begin() { return Iterator(first); } template <typename T> typename List<T>::Iterator List<T>::end() { return Iterator(); } \u4e0d\u6b62\u5982\u6b64\uff0c\u6211\u4eec\u5982\u679c\u5199\u4e00\u4e2a\u666e\u901a\u7684 template function\uff0c template <typename T> void func() { IntList::Iterator it1; // does not depend on T List<int>::Iterator it2; // does not depend on T typename List<T>::Iterator it3; // depend on T } \u5176\u4e2d\u6211\u4eec initialize \u4e86\u4e00\u4e2a\u53d6\u51b3\u4e8e T \u7684 type List \u4e2d\u7684\u4e00\u4e2a nested type Iterator \u7684 instance\uff0c\u4e8e\u662f\u5728\u8fd9\u53e5 initialization \u524d\u6211\u4eec\u4e5f\u8981\u52a0\u4e0a typename keyword. \u800c\u5982\u679c\u6211\u4eec\u9700\u8981\u4e00\u4e2a template type \u7684 nested type \u7684 instance\uff0c\u4f46\u662f\u6211\u4eec\u4e3a\u8fd9\u4e2a template class \u786e\u5b9a\u4e86 T\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u52a0\u4e0a typename \uff0c\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019\u8fd9\u4e2a class \u5df2\u7ecf\u4e0d depend on T \u4e86\u3002","title":"22.2.2.1 typename keyword"},{"location":"22-Iterator.html#22222-listt-begin-end-function-return-iterator","text":"template <typename T> typename List<T>::Iterator List<T>::begin() { return Iterator(first); // return an iterator at the beginning. } template <typename T> typename List<T>::Iterator List<T>::end() { return Iterator(); // return an iterator \"past the end\". }","title":"22.2.2.2 List&lt;T&gt; \u7684 begin \u548c end function: return \u4e00\u4e2a\u76f8\u5e94\u4f4d\u7f6e\u7684 Iterator"},{"location":"22-Iterator.html#2223-iterator-overload","text":"\u4ece\u8fd9\u91cc\u5f00\u59cb\u5c31\u662f nested class Itertor \u7684\u51fd\u6570\u4e86\u3002\u7531\u4e8e\u662f nested class\uff0c\u5728 definition \u65f6\u6211\u4eec\u9700\u8981\u5148\u52a0\u4e0a List<T> \u7684 scope \u518d\u52a0\u4e0a Iterator \u7684 scope: template <typename T> T & List<T>::Iterator::operator*() const { assert(node_ptr); // \u786e\u4fdd != nullptr, \u5373list\u4e0d\u4e3a\u7a7a, \u4e14Iterator \u5f53\u524d\u5728 list \u4e4b\u5185 return node_ptr->datum; // \u8fd4\u56de Iterator \u7684 node_ptr \u6307\u5411\u7684 Node \u503c } \u6ce8\u610f\uff1a\u6211\u4eec overload \u7684 * \u8fd4\u56de\u7684\u662f reference\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u65e2\u53ef\u4ee5\u7528\u5b83\u6765\u83b7\u53d6\u503c\uff0c\u53c8\u53ef\u4ee5\u7528\u5b83\u6765\u6539\u53d8\u539f\u6765\u7684\u503c\u3002\u8fd9\u6b63\u6a21\u62df\u4e86 * \u8fd0\u7b97\u7b26\u539f\u672c\u7684\u7528\u5904\u3002","title":"22.2.3 Iterator: * \u7684 overload"},{"location":"22-Iterator.html#2224-iterator-overload","text":"\u6ce8\u610f\uff1a operator++ \u505a\u4e86\u4e24\u4ef6\u4e8b\uff0c\u4e00\u4ef6\u4e8b\u662f increment\uff0c\u53e6\u4e00\u4ef6\u4e8b\u662f\u8fd4\u56de\u503c \uff08pre-increment operator++ \u8fd4\u56de\u7684\u662f reference\uff0cpost-increment operator++ \u8fd4\u56de\u7684\u662f value.\uff09 \u56e0\u800c\u6211\u4eec\u8fd9\u91cc\u9700\u8981\u52a0\u4e0a typename \u5173\u952e\u8bcd\uff01","title":"22.2.4 Iterator: ++ \u7684 overload"},{"location":"22-Iterator.html#22241-pre-increment-evaluated-it","text":"\u5728\u8fd9\u91cc\u6211\u4eec overload \u7684\u662f pre-increment \u7684 ++ \uff0c\u7528\u6cd5\u4e3a ++it . pre-increment \u7684 ++ \u4f1a\u5148 increment \u518d\u8fd4\u56de\u503c\uff0c\u5e76\u4e14\u8fd4\u56de\u7684\u662f\u5f15\u7528\u503c\u3002 template <typename T> typename List<T>::Iterator & List<T>::Iterator::operator++() { assert(node_ptr); node_ptr = node_ptr->next; return *this; }","title":"22.2.4.1 pre-increment evaluated: ++it"},{"location":"22-Iterator.html#22242-post-increment-it","text":"\u6211\u4eec\u4e5f\u53ef\u4ee5\u5199\u4e00\u4e2a post-increment \u7684 operator++ \u7684 overload. \u5e26\u6709\u53c2\u6570 int \uff0c\u5e76\u4e14\u4e0d\u8fd4\u56de reference \u800c\u662f\u8fd4\u56de\u503c \u7684\u662f post-increment \u7684 ++ \uff0c\u7528\u6cd5\u4e3a it++ . Post-increment \u7684 ++ \u4f1a\u8fd4\u56de increment \u524d\u7684\u503c\uff0c\u4e14\u662f\u4e00\u4e2a copy. template <typename T> typename List<T>::Iterator List<T>::Iterator::operator++(int) { assert(node_ptr); Node *copy = node_ptr; node_ptr = node_ptr->next; return *copy; }","title":"22.2.4.2 post-increment: it++"},{"location":"22-Iterator.html#2225-iterator-overload","text":"template <typename T> bool List<T>::Iterator::operator==(Iterator rhs) const { return node_ptr == rhs.node_ptr; } template <typename T> bool List<T>::Iterator::operator!=(const Iterator & rhs) const { return !(*this == rhs); }","title":"22.2.5 Iterator: == \u548c != \u7684 overload"},{"location":"22-Iterator.html#223-check-for-the-big-three-iterator","text":"","title":"22.3 check for the Big Three \u4ee5\u53ca\u4f7f\u7528 Iterator"},{"location":"22-Iterator.html#2231-check-for-the-big-three","text":"\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u5e76\u6ca1\u6709\u4e3a Iterator custom Big Three. \u8fd9\u662f\u5408\u7406\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u5728 implement Iterator \u65f6\u5e76\u6ca1\u6709\u52a8\u7528 dynamic memory. \u56e0\u800c\u6211\u4eec\u505a\u7684\u4efb\u4f55 Iterator \u7684 copy \u90fd\u662f shallow copy \u800c\u4e0d\u662f deep copy. List<int>::Iterator it2 = it1; \u8fd9\u79cd\u505a\u6cd5\u662f\u6b63\u786e\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u5982\u679c\u8981 deep copy Iterator \u5c31\u4f1a\u5efa\u51fa\u83ab\u540d\u5176\u5999\u7684\u65b0\u7684 linked list. \u8fd9\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u3002","title":"22.3.1 check for the Big Three"},{"location":"22-Iterator.html#2232-iterator-traverse-linked-list","text":"\u6211\u4eec\u5728 check \u5b8c Big Three \u4e4b\u540e\u5c31\u5b8c\u6210\u4e86 Iterator \u7684\u6784\u5efa\u3002 \u5b9e\u9645\u4e0a\u6211\u4eec\u5199\u7684 Iterator matches the Iterator in the STL. \u901a\u8fc7\u4e3a\u4e0d\u540c\u7684 containers define \u76f8\u540c interface \u7684 iterators\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e0d\u540c\u7684 containers \u4f7f\u7528\u76f8\u540c\u7684 looping code. \u73b0\u5728\u6211\u4eec\u7528\u6211\u4eec\u5199\u5b8c\u7684 Iterator \u6765 traverse \u4e00\u4e2a linked list: int main() { List<int> list; // ( ) list.push_front(1); // ( 1 ) list.push_front(3); // ( 3 2 1 ) list.front() = 4; // ( 4 2 1 ) list.insert(99, 0); // ( 99 4 2 1 ) list.insert(88, 3); // ( 99 4 2 88 1 ) list.pop_front(); // ( 4 2 88 1 ) for (List<int>::Iterator it = list.begin(); it != list.end(); ++it) cout << *it << endl; cout << endl; // 4 // 2 // 88 // 1 }","title":"22.3.2 \u5b8c\u6210\u5e76\u4f7f\u7528 Iterator \u6765 traverse \u4e00\u4e2a linked list"},{"location":"22-Iterator.html#2233-iterator-invalidation","text":"int main() { List<int> list; // \u2026 fill with values List<int>::Iterator it = list.begin(); List<int>::Iterator it2 = list.begin(); cout << *it << endl; // OK cout << *it2 << endl; // OK list.pop_front(); // \u5220\u9664\u4e86 it, it2 \u6b63 point to \u7684 element cout << *it << endl; // Undefined behavior cout << *it2 << endl; // Undefined behavior } Invalidated iterators \u5c31\u50cf dangling pointers\uff0cdereference \u5b83\u4eec\u4f1a\u5bfc\u81f4 Undefined Behavior\uff0c\u5f88\u4e0d\u5b89\u5168\u3002 pop_front \u8fd9\u79cd\u5b89\u5168\u7684\u64cd\u4f5c\uff0c\u4e5f\u4f1a\u5bfc\u81f4 iterator invalidation. \u56e0\u800c\u4e00\u4e2a function \u7684 documentation \u5e94\u8be5\u660e\u786e\u5199\u660e iterators \u7684\u7c7b\u578b\uff0c\u4ee5\u53ca\u5b83\u4f1a invalidated \u7684\u60c5\u666f\u3002","title":"22.3.3 Iterator Invalidation"},{"location":"22-Iterator.html#2234-traversal-check-for-duplicates","text":"template <typename T> bool hasDuplicates(List<T> list) { auto end = list.end(); for (auto i = list.begin(); i != end; ++i) { auto j = i; ++j; for ( ; j!=end; ++j) { if (*i == *j) return true; } } return false; }","title":"22.3.4 Traversal \u7ec3\u4e60: Check for duplicates"},{"location":"23-Functors-and-Imposter-Syndrome.html","text":"23 Functors and Imposter Syndrome 23.1 template <typename Iter_type> 23.1.1 Exercise 23.2 function pointer 23.2.1 functor \u7684 declaration \u548c assignment syntax 23.2.2 \u4f7f\u7528 function pointers 23.2.3 Advanced application: \u628a function pointer \u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u4ece\u800c\u51cf\u5c11 code duplication 23.2.4 \u4f7f\u7528\u591a\u4e2a template type 23.2.5 Acknowledgement: function pointer \u5728 C++ \u4e2d\u662f\u4e00\u79cd first-class object 23.3 Functors: \u6a21\u62df function \u7684\u884c\u4e3a 23.3.1 \u4f7f\u7528 template class \u4f5c\u4e3a Predicate \u53c2\u6570\u4ee5\u9002\u7528\u4efb\u4f55 Functor 23.3.2 example 2 23.3.3 example 3 23 Functors and Imposter Syndrome 23.1 template <typename Iter_type> \u4e0a\u4e00\u8bb2\u8bb2\u4e86 Iterator: Iterator \u662f\u4e00\u79cd generalized pointer. \u4f46\u662f\u56de\u60f3\u8d77\u6765\uff0c\u6211\u4eec\u5199\u7684 Iterator \u662f\u5185\u5d4c\u4e8e List<T> \u7684 class\u3002\u56e0\u800c\uff1a \u6211\u4eec\u6bcf\u6b21\u5199 Iterator \u4f5c\u4e3a \u53c2\u6570\u5e76\u4e14\u7684\u51fd\u6570\u90fd\u8981 c++ template <typename T> int func(typename List<T>::Iterator, ...) \u4e0d\u4ec5\u5982\u6b64\uff0c\u6211\u4eec\u7684 Iterator \u53ea\u80fd\u7528\u4e8e List\u3002\u4f46\u662f\u5f88\u663e\u7136\uff0c\u5176\u4ed6\u4efb\u4f55 Container \u7684 Iterator \u7684\u8fd0\u884c\u903b\u8f91\u4e5f\u662f\u7c7b\u4f3c\u7684\uff0c\u6240\u4ee5\u4f1a\u5199\u4e00\u4e9b\u786e\u5b9a typename \u7684\u4ee3\u7801\uff0c\u8fd9\u4e9b\u662f\u4e0d\u9700\u8981\u7684\u3002 \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5199\u4e00\u4e2a Iterator \u7684 template function: template <typename Iter_type> Iter_type max_element(Iter_type begin, Iter_type end) { Iter_type maxIt = begin; for (Iter_type it = begin; it != end; ++it) { if (*it > *maxIt) { maxIt = it; } } return maxIt; } \u8fd9\u91cc\uff0c\u6211\u4eec\u7684 template class \u5e76\u4e0d\u662f\u67d0\u4e2a container\uff0c\u800c\u662f\u67d0\u79cd Iterator. Compiler \u4f1a\u81ea\u52a8 infer Iterator \u662f\u54ea\u4e2a Iterator. \u6bd4\u5982: int main() { List<int> list; cout << *max_element(list.begin(), list.end()) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: List<int>::Iterator List<Card> cards; cout << *max_element(cards.begin(), cards.end()) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: List<Card>::Iterator vector<int> vec; cout << *max_element(vec.begin(), vec.end()) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: vector<int>::Iterator } \u518d\u6bd4\u5982: \u771f\u6b63\u7684 pointer \u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e4b\u7c7b\u7684 Iter_type . int main() { int const SIZE = 10; double arr[SIZE]; //array cout << *max_element(arr, arr + SIZE) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: double* // } 23.1.1 Exercise // REQUIRES: begin is before end (or begin == end) // EFFECTS: Returns true if any element in the // sequence [begin, end) is odd. template <typename Iter_type> bool any_of_odd(Iter_type begin, Iter_type end) { for ( ; begin != end; ++begin) { if (*begin & 2 != 0) {return true;} } return false; } 23.2 function pointer \u6211\u4eec\u76ee\u524d\u4e3a\u6b62\u4f7f\u7528\u7684 pointer \u90fd\u662f\u6307\u5411 data \u7684 pointer\uff0c\u4f46\u662f c++ \u8fd8\u652f\u6301\u6307\u5411 function \u7684 pointer\u3002 \u683c\u5f0f\u4e3a\uff1a int (*fn)(int, int) = max; \u8fd9\u91cc\u7684\u610f\u601d\u662f\uff1a fn \u662f\u4e00\u4e2a\u6307\u5411\u4e00\u4e2a \u53c2\u6570\u4e3a (int, int) \u5e76\u4e14\u8fd4\u56de\u503c\u4e3a int \u7684 function \u7684 pointer\uff1b\u5e76\u4e14\u6211\u4eec\u7ed9\u5b83\u6307\u5411\u7684\u5bf9\u8c61 assign \u4e86 max(int ..., int ...) \u8fd9\u4e2a\u51fd\u6570\u3002 23.2.1 functor \u7684 declaration \u548c assignment syntax \u68b3\u7406\u4e00\u4e0b\uff1a int (*fn) \u8868\u793a\uff1a\u6211\u4eec\u8fd9\u91cc declare \u4e00\u4e2a function pointer \u53eb\u505a fn \uff0c\u8fd9\u4e2a funtor \u662f\u4e00\u4e2a\u6307\u5411\u8fd4\u56de\u503c\u4e3a int \u7684 function \u7684 pointer. (int, int) \u8868\u793a\u7684\u662f\uff1a fn \u6307\u5411\u7684 function \u7684\u53c2\u6570\u7684\u7c7b\u578b\u5fc5\u987b\u662f int \u548c int . =max \u8868\u793a\u6211\u4eec\u628a max \u8fd9\u4e2a\u51fd\u6570\u4f5c\u4e3a fn \u5f53\u524d\u6307\u5411\u7684\u51fd\u6570\u3002 \u53e6\uff0c\u6ce8\u610f 1\uff1ac++ declaration \u662f inside out \u7684\u3002 [] , () \u8fd9\u79cd postfix operators \u6bd4\u8d77 prefix operators \u5982 & , * \u7b49\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002 \u6ce8\u610f 2: \u6211\u4eec\u7ed9\u666e\u901a\u7684 ptr \u6307\u5411\u7684\u5bf9\u8c61\u8d4b\u503c\u9700\u8981\u5148\u89e3\u5f15\u7528\uff0c\u6216\u8005\u628a\u9700\u8981\u6307\u5411\u7684 data object \u7684 address \u8d4b\u7ed9 ptr\uff1a int *p; *p = 1; // dereference \u4e4b\u540e assign value int a = 2; p = &a; // \u628a a \u7684 address \u8d4b\u7ed9 p \u4f46\u662f\u6211\u4eec\u7ed9 function pointer \u8d4b\u503c\u662f \u6ca1\u6709\u5148 dereference \u518d\u8d4b\u503c\u7684\u8fd9\u79cd syntax \u7684\uff0c\u53ea\u6709\u628a\u9700\u8981\u6307\u5411\u7684 function object \u7684 address \u8d4b\u7ed9 ptr \u8fd9\u79cd\u65b9\u6cd5\uff01 \uff1b \u5e76\u4e14\uff0c\u6211\u4eec\u751a\u81f3\u4e5f\u4e0d\u7528\u8fd9\u4e48\u5199\u3002 \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5199 function pointer = \u67d0\u4e2a function\uff0ccompiler \u4f1a\u81ea\u52a8\u63a8\u6d4b\u610f\u601d\uff0c\u8865\u5168\u4e3a\u628a\u8be5 function \u7684 address \u8d4b\u7ed9\u8fd9\u4e2a function pointer\uff01 int (*fn)(int, int) = nullptr; *fn = std::max; // error, \u4e0d\u652f\u6301\u8fd9\u79cd\u5199\u6cd5 int (*fn2)(int, int) = nullptr; fn2 = &std::max; // ok, \u628a std::max \u7684 address \u8d4b\u7ed9 p int (*fn3)(int, int) = nullptr; fn3 = std::max; // ok, \u8fd9\u91cc compiler \u81ea\u52a8\u7406\u89e3\u610f\u601d, \u628a std::max \u7684 address \u8d4b\u7ed9 p 23.2.2 \u4f7f\u7528 function pointers Function pointer \u4e0d\u4ec5 declaration, assignment \u548c\u666e\u901a\u7684 pointer \u6709\u533a\u522b\uff0c\u5177\u4f53\u7684\u4f7f\u7528\u4e5f\u548c\u666e\u901a\u7684 pointer \u6709\u533a\u522b\uff1a\u6211\u4eec\u4f7f\u7528 function pointer \u4e0d\u9700\u8981 dereference. int (*fn2)(int, int) = max; cout << fn2(9, 8) << endl; fn2(9, 8) \u7684\u503c\u5c31\u662f max(9, 8) \u7684\u503c\u3002 \uff08\u5176\u5b9e\u6211\u611f\u89c9 function pointer \u66f4\u50cf\u662f\u5bf9 function \u7684\u5f15\u7528\u800c\u4e0d\u50cf\u662f pointer\uff0c\u6216\u8005\u8bf4\u662f reference \u548c pointer \u7684\u7ed3\u5408\uff1apointer \u7684 declaration \u65b9\u5f0f\u548c reference \u7684\u4f7f\u7528\u65b9\u5f0f\uff09 23.2.3 Advanced application: \u628a function pointer \u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u4ece\u800c\u51cf\u5c11 code duplication Def: \u4e00\u4e2a predicate \u662f\u4e00\u4e2a\u8fd4\u56de bool \u503c\u7684\u51fd\u6570. \u5047\u8bbe\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u8fd9\u6837\u7684\u51fd\u6570\uff1a \u6211\u4eec\u6709\u4e00\u4e2a predicate\uff0c\u4ee5\u53ca\u4e00\u4e2a\u968f\u610f\u7684 int container\u3002\u5982\u679c\u8fd9\u4e2a container \u4e2d\u6709\u4efb\u4f55\u6ee1\u8db3\u8fd9\u4e2a predicate \u7684 data\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de true. \u6211\u4eec\u53d1\u73b0\u5728\u8fd9\u79cd\u5e94\u7528\u60c5\u5883\u4e0b\uff0cfunction pointer \u662f\u5f88\u6709\u7528\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u8bd5\u60f3\uff1a\u6211\u4eec\u5bf9\u8fd9\u4e2a any_of \u5224\u65ad\u51fd\u6570\u4f20\u5165\u4e00\u4e2a\uff08\u8f93\u5165 int \u8f93\u51fa bool \u7684 function \u7684 function pointer\uff09\uff0c\u5e76\u4e14 iterate \u8fd9\u4e2a container\uff1b\u5982\u679c\u6709\u5143\u7d20\uff0c\u5728\u8f93\u5165\u8fd9\u4e2a function pointer \u6307\u5411\u7684 function \u4e4b\u540e\u8f93\u51fa\u7ed3\u679c\u4e3a true\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8fd4\u56de true. \u5982\u679c\u6211\u4eec\u4e0d\u662f\u7528 function pointer \u7684\u8bdd\uff0c\u90a3\u4e48\u6211\u4eec\u6bcf\u6b21\u6362\u4e00\u4e2a predicate \u5c31\u8981\u5199\u4e00\u4e2a\u65b0\u7684 any_of \u51fd\u6570\u3002 template <typename Iter_type> bool any_of(Iter_type begin, Iter_type end, bool (*fn)(int)) { for (Iter_type it = begin; it != end; ++it) { if (fn(*it)) {return true;} } return false;; } 23.2.4 \u4f7f\u7528\u591a\u4e2a template type \u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a template type\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u7528\u4e0d\u6b62\u5bf9 int container \u5224\u65ad\u4e00\u4e2a predicate\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u4efb\u4f55 container ADT \u5224\u65ad\u8fd9\u4e2a predicate. \u8fd9\u91cc\u6211\u4eec template\uff1a Iter_type \u4e3a\u4efb\u4f55 Iterator type\uff0c T \u4e3a\u4efb\u4f55 data type\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5199\u5165\u4e00\u4e2a\u6307\u5411\uff08\u8f93\u5165\u4e3a T& (&\u7528\u6765\u9632\u6b62\u590d\u5236\u592a\u590d\u6742\u7684\u6570\u636e)\uff0c\u8f93\u5165\u4e3a bool \u7684 function\uff09\u7684 funtion pointer fn \uff0c\u5c06\u5176\u6307\u5411\u7684 function \u4f5c\u4e3a any_of \u7684 predicate. template <typename Iter_type, typename T> bool any_of(Iter_type begin, Iter_type end, bool (*fn)(const T&)) { for (Iter_type it = begin; it != end; ++it) { if (fn(*it)) {return true;} } return false;; } \u6211\u4eec\u8fd9\u91cc\u5e94\u7528\u6211\u4eec\u521a\u624d\u5199\u7684 any_of function: bool is_odd(int x) {return x % 2 != 0;} bool greater0(double x) {return x > 0;} int main() { List<int> list; List<double list2; //...fill cout << any_of(list.begin(), list.end(), is_odd); cout << any_of(list2.begin(), list.end(), greater0); } 23.2.5 Acknowledgement: function pointer \u5728 C++ \u4e2d\u662f\u4e00\u79cd first-class object First-class objects \u5728 C++ \u4e2d\u6307\u7684\u662f\uff1a \u80fd\u591f\u88ab 1. passed as an argument; 2. returned from a function; 3. stored in a variable \u7684 object C++ \u4e2d\u7684 function pointer \u662f\u4e00\u79cd first-class object. 23.3 Functors: \u6a21\u62df function \u7684\u884c\u4e3a \u6211\u4eec\u4e4b\u524d\u5b66\u4e86 Iterator \u7684\u7406\u5ff5\uff1aiterator \u5c31\u662f\u7528\u4e00\u4e2a class \u6a21\u62df pointer \u7684\u884c\u4e3a\u3002 \u73b0\u5728\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u65b0\u7684\u7406\u5ff5 functor\uff1a\u7528\u4e00\u4e2a class \u6765\u6a21\u62df function \u7684\u884c\u4e3a\u3002\uff08\u547d\u540d\u501f\u9274\u4e8e category theory \u4e2d\u7684 functor\uff0c\u4f46\u662f\u6211\u611f\u89c9\u5728\u5b9a\u4e49\u4e0a\u6ca1\u4ec0\u4e48\u8054\u7cfb\u3002\uff09 \u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u5f15\u5165\u8fd9\u4e2a\u4e1c\u897f\u5462\uff1a\u8fd8\u662f\u4e3a\u4e86\u7f29\u77ed\u4ee3\u7801\uff0c\u51cf\u5c11 code duplication. \u6bd4\u5982\u6211\u4eec\u770b\u5230\u4e4b\u524d\u7684 greater0 \u51fd\u6570\uff0c\u6211\u4eec\u4f1a\u60f3\uff1a\u5982\u679c\u6211\u4eec\u5148\u8981\u5199\u5f88\u591a greatern \u51fd\u6570\u5462\uff1f bool greater0(double x) {return x > 0;} bool greater1(double x) {return x > 1;} bool greater2(double x) {return x > 2;} //... bool greater255(double x) {return x > 255;} \u8fd9\u662f\u4e0d\u7b26\u5408\u6211\u4eec\u5199\u4ee3\u7801\u5c3d\u91cf\u51cf\u5c11 code duplication \u7684\u539f\u5219\u7684\u3002 \u4e8e\u662f C++ \u5f15\u5165 functor \u7684\u7406\u5ff5\uff1a\u901a\u8fc7\u5199\u4e00\u4e2a class\uff0c\u7528\u8fd9\u4e2a class \u7684 date member \u6765\u6a21\u62df\u76f8\u4f3c\u51fd\u6570\u7684\u4e0d\u540c\u6761\u4ef6\uff1b constructor \u6765\u6a21\u62df\u51fd\u6570\u7684\u521b\u5efa\uff1b\u901a\u8fc7 overload the function call operator () \u6765\u6a21\u62df\u51fd\u6570\u7684\u8f93\u5165\u3002 class GreaterN { private: int threshold; public: GreaterN(int threshold_in) : threshold(threshold_in) {} bool operator()(int n) const { // overload () \u8fd9\u4e2a operator, \u53c2\u6570\u4e3a int n. return n > threshold; } } \u73b0\u5728\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a functor: functor \u5c31\u662f\u6211\u4eec\u521a\u521a\u521b\u5efa\u7528\u6765\u6a21\u62df function \u7684 class \u7684 instances. int main() { GreaterN g0(0); GreaterN g32(32); GreaterN g212(212); cout << g0(-3); // false cout << g0(3); // true cout << g32(9); // false cout << g212(189); // false } 23.3.1 \u4f7f\u7528 template class \u4f5c\u4e3a Predicate \u53c2\u6570\u4ee5\u9002\u7528\u4efb\u4f55 Functor \u6211\u4eec\u521a\u624d\u7528\u7684\u662f GreaterN \u8fd9\u4e2a functor \u4f5c\u4e3a predicate. \u8fd9\u4e2a functor class \u7684 operator() \u7684 overload \u65b9\u5f0f\u662f: return n > threshold . \u56e0\u800c\u8fd9\u4e2a functor class \u53ea\u6709\u6bd4\u8f83\u67d0\u4e2a Container \u4e2d\u7684\u5143\u7d20\u548c\u53e6\u4e00\u4e2a\u5143\u7d20\u7684\u5927\u5c0f\u8fd9\u4e00\u4e2a\u4f5c\u7528\u3002 \u90a3\u5982\u679c\u6211\u4eec\u60f3\u8981\u8fd9\u4e2a any_of functor \u53ef\u4ee5\u5d4c\u5165\u4efb\u4f55 predicate \u5462\uff1f \u6211\u4eec\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u9009\u62e9\u628a GreaterN \u8fd9\u4e2a class \u540d\u53c2\u6570\u6539\u6210\u4e00\u4e2a template class \u7684\u53c2\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba9\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u8d77\u5230\u771f\u6b63\u7684 \"any of\" \u7684\u4f5c\u7528\uff1a\u5982\u679c Container object \u4e2d\u6709\u4efb\u4f55\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u6211\u4eec\u73b0\u5728\u6307\u5b9a\u7684 predicate\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de true. template <typename Iter_type, typename Predicate> bool any_of(Iter_type begin, Iter_type end, Predicate pred) { for (Iter_type it = bein; it != end; ++it) { if (pred(*it)) {return true;} } return false; } 23.3.2 example 2 \u518d\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff1a class Duck { public: Duck() : name(\"\"), duckling_count(0) { } Duck(string name_in, int duckling_count_in) : name(name_in), duckling_count(duckling_count_in) { } const string & getName() const { return name; } const int getDucklingCount() const { return duckling_count; } private: string name; int duckling_count; }; Duck \u8fd9\u4e2a class \u6709\u4e24\u4e2a private members: \u4e00\u4e2a\u4ee3\u8868\u540d\u5b57\uff0c\u4e00\u4e2a\u4ee3\u8868\u751f\u4ea7\u6570\u91cf\u3002 \u6211\u4eec\u73b0\u5728\u5199\u4e00\u4e2a template function\uff0c\u6765\u83b7\u53d6\u4efb\u610f\u4e00\u4e2a\u88c5 Ducks \u7684 Container \u4e2d\u67d0\u4e2a\u5c5e\u6027\u6700\u5927\u7684\u9e2d\u5b50\u662f\u54ea\u4e2a\u3002 \u9996\u5148\u6211\u4eec\u5199\u4e24\u4e2a functor\uff0c\u4e00\u4e2a\u4ee3\u8868\u5bf9\u9e2d\u5b50\u540d\u5b57\u7684\u5b57\u6bcd\u987a\u5e8f\u7684\u6bd4\u8f83\u7684 predicate\uff0c\u53e6\u4e00\u4e2a\u4ee3\u8868\u5bf9\u9e2d\u5b50\u751f\u4ea7\u6570\u91cf\u7684\u6bd4\u8f83\u7684 predicate. // functor 1 class DuckNameLess { public: bool operator()(const Duck &d1, const Duck &d2) const { return d1.getName() < d2.getName(); } }; // functor 2 class DuckDucklingsLess { public: bool operator()(const Duck &d1, const Duck &d2) const { return d1.getDucklingCount() < d2.getDucklingCount(); } }; \u7136\u540e\u6211\u4eec implement \u8fd9\u4e2a\u51fd\u6570\uff1a template <typename Iter_type, typename Comparator> Iter_type max_element(Iter_type begin, Iter_type end, Comparator less) { Iter_type maxIt = begin; for (Iter_type it = begin; it != end; ++it) { if (less(*maxIt,*it)) {maxIt = it;} // \u68c0\u9a8c predicate (compare) } return maxIt; } \u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u6765\u6bd4\u8f83\u968f\u673a Container \u4e2d\u9e2d\u5b50\u5c5e\u6027\u7684\u60c5\u51b5\uff1a int main() { List<Duck> pond; // fill\u2026 cout << *max_element(pond.begin(), pond.end(), DuckNameLess()) << endl; cout << *max_element(pond.begin(), pond.end(), DuckDucklingsLess()) << endl; } 23.3.3 example 3 \u6211\u4eec\u4e4b\u524d\u5199\u7684 any_of \u51fd\u6570\u8868\u793a\uff1a\u53ea\u8981 Container \u4e2d\u6709\u4efb\u610f\u4e00\u4e2a element \u6ee1\u8db3 predicate\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de true. \u90a3\u4e48\u5982\u679c\u6211\u4eec\u8981\u5728 traversal \u6bcf\u4e00\u4e2a\u5143\u7d20\u540e\u505a\u4e00\u70b9\u4e8b\u60c5\u5462\uff1f template <typename Iter_t, typename Func_t> Func_t for_each(Iter_t begin, Iter_t end, Func_t func) { for (Iter_t it = begin; it != end; ++it) { func(*it); } return func; //We return the functor in case it contains some information about the result. } \u4f7f\u7528\uff1a template <typename T> class Printer { //\u4e00\u4e2a functor public: void operator()(const T &n) const { cout << n; } }; int main() { List<int> list; // Fill with numbers for_each(list.begin(), list.end(), Printer<int>()); }","title":"Overview"},{"location":"23-Functors-and-Imposter-Syndrome.html#23-functors-and-imposter-syndrome","text":"","title":"23 Functors and Imposter Syndrome"},{"location":"23-Functors-and-Imposter-Syndrome.html#231-template-typename-iter_type","text":"\u4e0a\u4e00\u8bb2\u8bb2\u4e86 Iterator: Iterator \u662f\u4e00\u79cd generalized pointer. \u4f46\u662f\u56de\u60f3\u8d77\u6765\uff0c\u6211\u4eec\u5199\u7684 Iterator \u662f\u5185\u5d4c\u4e8e List<T> \u7684 class\u3002\u56e0\u800c\uff1a \u6211\u4eec\u6bcf\u6b21\u5199 Iterator \u4f5c\u4e3a \u53c2\u6570\u5e76\u4e14\u7684\u51fd\u6570\u90fd\u8981 c++ template <typename T> int func(typename List<T>::Iterator, ...) \u4e0d\u4ec5\u5982\u6b64\uff0c\u6211\u4eec\u7684 Iterator \u53ea\u80fd\u7528\u4e8e List\u3002\u4f46\u662f\u5f88\u663e\u7136\uff0c\u5176\u4ed6\u4efb\u4f55 Container \u7684 Iterator \u7684\u8fd0\u884c\u903b\u8f91\u4e5f\u662f\u7c7b\u4f3c\u7684\uff0c\u6240\u4ee5\u4f1a\u5199\u4e00\u4e9b\u786e\u5b9a typename \u7684\u4ee3\u7801\uff0c\u8fd9\u4e9b\u662f\u4e0d\u9700\u8981\u7684\u3002 \u56e0\u800c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5199\u4e00\u4e2a Iterator \u7684 template function: template <typename Iter_type> Iter_type max_element(Iter_type begin, Iter_type end) { Iter_type maxIt = begin; for (Iter_type it = begin; it != end; ++it) { if (*it > *maxIt) { maxIt = it; } } return maxIt; } \u8fd9\u91cc\uff0c\u6211\u4eec\u7684 template class \u5e76\u4e0d\u662f\u67d0\u4e2a container\uff0c\u800c\u662f\u67d0\u79cd Iterator. Compiler \u4f1a\u81ea\u52a8 infer Iterator \u662f\u54ea\u4e2a Iterator. \u6bd4\u5982: int main() { List<int> list; cout << *max_element(list.begin(), list.end()) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: List<int>::Iterator List<Card> cards; cout << *max_element(cards.begin(), cards.end()) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: List<Card>::Iterator vector<int> vec; cout << *max_element(vec.begin(), vec.end()) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: vector<int>::Iterator } \u518d\u6bd4\u5982: \u771f\u6b63\u7684 pointer \u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4e4b\u7c7b\u7684 Iter_type . int main() { int const SIZE = 10; double arr[SIZE]; //array cout << *max_element(arr, arr + SIZE) << endl; // \u8fd9\u91cc compiler infers Iter_type \u4e3a: double* // }","title":"23.1 template &lt;typename Iter_type&gt;"},{"location":"23-Functors-and-Imposter-Syndrome.html#2311-exercise","text":"// REQUIRES: begin is before end (or begin == end) // EFFECTS: Returns true if any element in the // sequence [begin, end) is odd. template <typename Iter_type> bool any_of_odd(Iter_type begin, Iter_type end) { for ( ; begin != end; ++begin) { if (*begin & 2 != 0) {return true;} } return false; }","title":"23.1.1 Exercise"},{"location":"23-Functors-and-Imposter-Syndrome.html#232-function-pointer","text":"\u6211\u4eec\u76ee\u524d\u4e3a\u6b62\u4f7f\u7528\u7684 pointer \u90fd\u662f\u6307\u5411 data \u7684 pointer\uff0c\u4f46\u662f c++ \u8fd8\u652f\u6301\u6307\u5411 function \u7684 pointer\u3002 \u683c\u5f0f\u4e3a\uff1a int (*fn)(int, int) = max; \u8fd9\u91cc\u7684\u610f\u601d\u662f\uff1a fn \u662f\u4e00\u4e2a\u6307\u5411\u4e00\u4e2a \u53c2\u6570\u4e3a (int, int) \u5e76\u4e14\u8fd4\u56de\u503c\u4e3a int \u7684 function \u7684 pointer\uff1b\u5e76\u4e14\u6211\u4eec\u7ed9\u5b83\u6307\u5411\u7684\u5bf9\u8c61 assign \u4e86 max(int ..., int ...) \u8fd9\u4e2a\u51fd\u6570\u3002","title":"23.2 function pointer"},{"location":"23-Functors-and-Imposter-Syndrome.html#2321-functor-declaration-assignment-syntax","text":"\u68b3\u7406\u4e00\u4e0b\uff1a int (*fn) \u8868\u793a\uff1a\u6211\u4eec\u8fd9\u91cc declare \u4e00\u4e2a function pointer \u53eb\u505a fn \uff0c\u8fd9\u4e2a funtor \u662f\u4e00\u4e2a\u6307\u5411\u8fd4\u56de\u503c\u4e3a int \u7684 function \u7684 pointer. (int, int) \u8868\u793a\u7684\u662f\uff1a fn \u6307\u5411\u7684 function \u7684\u53c2\u6570\u7684\u7c7b\u578b\u5fc5\u987b\u662f int \u548c int . =max \u8868\u793a\u6211\u4eec\u628a max \u8fd9\u4e2a\u51fd\u6570\u4f5c\u4e3a fn \u5f53\u524d\u6307\u5411\u7684\u51fd\u6570\u3002 \u53e6\uff0c\u6ce8\u610f 1\uff1ac++ declaration \u662f inside out \u7684\u3002 [] , () \u8fd9\u79cd postfix operators \u6bd4\u8d77 prefix operators \u5982 & , * \u7b49\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002 \u6ce8\u610f 2: \u6211\u4eec\u7ed9\u666e\u901a\u7684 ptr \u6307\u5411\u7684\u5bf9\u8c61\u8d4b\u503c\u9700\u8981\u5148\u89e3\u5f15\u7528\uff0c\u6216\u8005\u628a\u9700\u8981\u6307\u5411\u7684 data object \u7684 address \u8d4b\u7ed9 ptr\uff1a int *p; *p = 1; // dereference \u4e4b\u540e assign value int a = 2; p = &a; // \u628a a \u7684 address \u8d4b\u7ed9 p \u4f46\u662f\u6211\u4eec\u7ed9 function pointer \u8d4b\u503c\u662f \u6ca1\u6709\u5148 dereference \u518d\u8d4b\u503c\u7684\u8fd9\u79cd syntax \u7684\uff0c\u53ea\u6709\u628a\u9700\u8981\u6307\u5411\u7684 function object \u7684 address \u8d4b\u7ed9 ptr \u8fd9\u79cd\u65b9\u6cd5\uff01 \uff1b \u5e76\u4e14\uff0c\u6211\u4eec\u751a\u81f3\u4e5f\u4e0d\u7528\u8fd9\u4e48\u5199\u3002 \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5199 function pointer = \u67d0\u4e2a function\uff0ccompiler \u4f1a\u81ea\u52a8\u63a8\u6d4b\u610f\u601d\uff0c\u8865\u5168\u4e3a\u628a\u8be5 function \u7684 address \u8d4b\u7ed9\u8fd9\u4e2a function pointer\uff01 int (*fn)(int, int) = nullptr; *fn = std::max; // error, \u4e0d\u652f\u6301\u8fd9\u79cd\u5199\u6cd5 int (*fn2)(int, int) = nullptr; fn2 = &std::max; // ok, \u628a std::max \u7684 address \u8d4b\u7ed9 p int (*fn3)(int, int) = nullptr; fn3 = std::max; // ok, \u8fd9\u91cc compiler \u81ea\u52a8\u7406\u89e3\u610f\u601d, \u628a std::max \u7684 address \u8d4b\u7ed9 p","title":"23.2.1 functor \u7684 declaration \u548c assignment syntax"},{"location":"23-Functors-and-Imposter-Syndrome.html#2322-function-pointers","text":"Function pointer \u4e0d\u4ec5 declaration, assignment \u548c\u666e\u901a\u7684 pointer \u6709\u533a\u522b\uff0c\u5177\u4f53\u7684\u4f7f\u7528\u4e5f\u548c\u666e\u901a\u7684 pointer \u6709\u533a\u522b\uff1a\u6211\u4eec\u4f7f\u7528 function pointer \u4e0d\u9700\u8981 dereference. int (*fn2)(int, int) = max; cout << fn2(9, 8) << endl; fn2(9, 8) \u7684\u503c\u5c31\u662f max(9, 8) \u7684\u503c\u3002 \uff08\u5176\u5b9e\u6211\u611f\u89c9 function pointer \u66f4\u50cf\u662f\u5bf9 function \u7684\u5f15\u7528\u800c\u4e0d\u50cf\u662f pointer\uff0c\u6216\u8005\u8bf4\u662f reference \u548c pointer \u7684\u7ed3\u5408\uff1apointer \u7684 declaration \u65b9\u5f0f\u548c reference \u7684\u4f7f\u7528\u65b9\u5f0f\uff09","title":"23.2.2 \u4f7f\u7528 function pointers"},{"location":"23-Functors-and-Imposter-Syndrome.html#2323-advanced-application-function-pointer-code-duplication","text":"Def: \u4e00\u4e2a predicate \u662f\u4e00\u4e2a\u8fd4\u56de bool \u503c\u7684\u51fd\u6570. \u5047\u8bbe\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u8fd9\u6837\u7684\u51fd\u6570\uff1a \u6211\u4eec\u6709\u4e00\u4e2a predicate\uff0c\u4ee5\u53ca\u4e00\u4e2a\u968f\u610f\u7684 int container\u3002\u5982\u679c\u8fd9\u4e2a container \u4e2d\u6709\u4efb\u4f55\u6ee1\u8db3\u8fd9\u4e2a predicate \u7684 data\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de true. \u6211\u4eec\u53d1\u73b0\u5728\u8fd9\u79cd\u5e94\u7528\u60c5\u5883\u4e0b\uff0cfunction pointer \u662f\u5f88\u6709\u7528\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u8bd5\u60f3\uff1a\u6211\u4eec\u5bf9\u8fd9\u4e2a any_of \u5224\u65ad\u51fd\u6570\u4f20\u5165\u4e00\u4e2a\uff08\u8f93\u5165 int \u8f93\u51fa bool \u7684 function \u7684 function pointer\uff09\uff0c\u5e76\u4e14 iterate \u8fd9\u4e2a container\uff1b\u5982\u679c\u6709\u5143\u7d20\uff0c\u5728\u8f93\u5165\u8fd9\u4e2a function pointer \u6307\u5411\u7684 function \u4e4b\u540e\u8f93\u51fa\u7ed3\u679c\u4e3a true\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8fd4\u56de true. \u5982\u679c\u6211\u4eec\u4e0d\u662f\u7528 function pointer \u7684\u8bdd\uff0c\u90a3\u4e48\u6211\u4eec\u6bcf\u6b21\u6362\u4e00\u4e2a predicate \u5c31\u8981\u5199\u4e00\u4e2a\u65b0\u7684 any_of \u51fd\u6570\u3002 template <typename Iter_type> bool any_of(Iter_type begin, Iter_type end, bool (*fn)(int)) { for (Iter_type it = begin; it != end; ++it) { if (fn(*it)) {return true;} } return false;; }","title":"23.2.3 Advanced application: \u628a function pointer \u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u4ece\u800c\u51cf\u5c11 code duplication"},{"location":"23-Functors-and-Imposter-Syndrome.html#2324-template-type","text":"\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a template type\uff0c\u8fd9\u6837\u53ef\u4ee5\u4f7f\u7528\u4e0d\u6b62\u5bf9 int container \u5224\u65ad\u4e00\u4e2a predicate\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u4efb\u4f55 container ADT \u5224\u65ad\u8fd9\u4e2a predicate. \u8fd9\u91cc\u6211\u4eec template\uff1a Iter_type \u4e3a\u4efb\u4f55 Iterator type\uff0c T \u4e3a\u4efb\u4f55 data type\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5199\u5165\u4e00\u4e2a\u6307\u5411\uff08\u8f93\u5165\u4e3a T& (&\u7528\u6765\u9632\u6b62\u590d\u5236\u592a\u590d\u6742\u7684\u6570\u636e)\uff0c\u8f93\u5165\u4e3a bool \u7684 function\uff09\u7684 funtion pointer fn \uff0c\u5c06\u5176\u6307\u5411\u7684 function \u4f5c\u4e3a any_of \u7684 predicate. template <typename Iter_type, typename T> bool any_of(Iter_type begin, Iter_type end, bool (*fn)(const T&)) { for (Iter_type it = begin; it != end; ++it) { if (fn(*it)) {return true;} } return false;; } \u6211\u4eec\u8fd9\u91cc\u5e94\u7528\u6211\u4eec\u521a\u624d\u5199\u7684 any_of function: bool is_odd(int x) {return x % 2 != 0;} bool greater0(double x) {return x > 0;} int main() { List<int> list; List<double list2; //...fill cout << any_of(list.begin(), list.end(), is_odd); cout << any_of(list2.begin(), list.end(), greater0); }","title":"23.2.4 \u4f7f\u7528\u591a\u4e2a template type"},{"location":"23-Functors-and-Imposter-Syndrome.html#2325-acknowledgement-function-pointer-c-first-class-object","text":"First-class objects \u5728 C++ \u4e2d\u6307\u7684\u662f\uff1a \u80fd\u591f\u88ab 1. passed as an argument; 2. returned from a function; 3. stored in a variable \u7684 object C++ \u4e2d\u7684 function pointer \u662f\u4e00\u79cd first-class object.","title":"23.2.5 Acknowledgement: function pointer \u5728 C++ \u4e2d\u662f\u4e00\u79cd first-class object"},{"location":"23-Functors-and-Imposter-Syndrome.html#233-functors-function","text":"\u6211\u4eec\u4e4b\u524d\u5b66\u4e86 Iterator \u7684\u7406\u5ff5\uff1aiterator \u5c31\u662f\u7528\u4e00\u4e2a class \u6a21\u62df pointer \u7684\u884c\u4e3a\u3002 \u73b0\u5728\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u65b0\u7684\u7406\u5ff5 functor\uff1a\u7528\u4e00\u4e2a class \u6765\u6a21\u62df function \u7684\u884c\u4e3a\u3002\uff08\u547d\u540d\u501f\u9274\u4e8e category theory \u4e2d\u7684 functor\uff0c\u4f46\u662f\u6211\u611f\u89c9\u5728\u5b9a\u4e49\u4e0a\u6ca1\u4ec0\u4e48\u8054\u7cfb\u3002\uff09 \u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u5f15\u5165\u8fd9\u4e2a\u4e1c\u897f\u5462\uff1a\u8fd8\u662f\u4e3a\u4e86\u7f29\u77ed\u4ee3\u7801\uff0c\u51cf\u5c11 code duplication. \u6bd4\u5982\u6211\u4eec\u770b\u5230\u4e4b\u524d\u7684 greater0 \u51fd\u6570\uff0c\u6211\u4eec\u4f1a\u60f3\uff1a\u5982\u679c\u6211\u4eec\u5148\u8981\u5199\u5f88\u591a greatern \u51fd\u6570\u5462\uff1f bool greater0(double x) {return x > 0;} bool greater1(double x) {return x > 1;} bool greater2(double x) {return x > 2;} //... bool greater255(double x) {return x > 255;} \u8fd9\u662f\u4e0d\u7b26\u5408\u6211\u4eec\u5199\u4ee3\u7801\u5c3d\u91cf\u51cf\u5c11 code duplication \u7684\u539f\u5219\u7684\u3002 \u4e8e\u662f C++ \u5f15\u5165 functor \u7684\u7406\u5ff5\uff1a\u901a\u8fc7\u5199\u4e00\u4e2a class\uff0c\u7528\u8fd9\u4e2a class \u7684 date member \u6765\u6a21\u62df\u76f8\u4f3c\u51fd\u6570\u7684\u4e0d\u540c\u6761\u4ef6\uff1b constructor \u6765\u6a21\u62df\u51fd\u6570\u7684\u521b\u5efa\uff1b\u901a\u8fc7 overload the function call operator () \u6765\u6a21\u62df\u51fd\u6570\u7684\u8f93\u5165\u3002 class GreaterN { private: int threshold; public: GreaterN(int threshold_in) : threshold(threshold_in) {} bool operator()(int n) const { // overload () \u8fd9\u4e2a operator, \u53c2\u6570\u4e3a int n. return n > threshold; } } \u73b0\u5728\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a functor: functor \u5c31\u662f\u6211\u4eec\u521a\u521a\u521b\u5efa\u7528\u6765\u6a21\u62df function \u7684 class \u7684 instances. int main() { GreaterN g0(0); GreaterN g32(32); GreaterN g212(212); cout << g0(-3); // false cout << g0(3); // true cout << g32(9); // false cout << g212(189); // false }","title":"23.3 Functors: \u6a21\u62df function \u7684\u884c\u4e3a"},{"location":"23-Functors-and-Imposter-Syndrome.html#2331-template-class-predicate-functor","text":"\u6211\u4eec\u521a\u624d\u7528\u7684\u662f GreaterN \u8fd9\u4e2a functor \u4f5c\u4e3a predicate. \u8fd9\u4e2a functor class \u7684 operator() \u7684 overload \u65b9\u5f0f\u662f: return n > threshold . \u56e0\u800c\u8fd9\u4e2a functor class \u53ea\u6709\u6bd4\u8f83\u67d0\u4e2a Container \u4e2d\u7684\u5143\u7d20\u548c\u53e6\u4e00\u4e2a\u5143\u7d20\u7684\u5927\u5c0f\u8fd9\u4e00\u4e2a\u4f5c\u7528\u3002 \u90a3\u5982\u679c\u6211\u4eec\u60f3\u8981\u8fd9\u4e2a any_of functor \u53ef\u4ee5\u5d4c\u5165\u4efb\u4f55 predicate \u5462\uff1f \u6211\u4eec\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u9009\u62e9\u628a GreaterN \u8fd9\u4e2a class \u540d\u53c2\u6570\u6539\u6210\u4e00\u4e2a template class \u7684\u53c2\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8ba9\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u8d77\u5230\u771f\u6b63\u7684 \"any of\" \u7684\u4f5c\u7528\uff1a\u5982\u679c Container object \u4e2d\u6709\u4efb\u4f55\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u6211\u4eec\u73b0\u5728\u6307\u5b9a\u7684 predicate\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de true. template <typename Iter_type, typename Predicate> bool any_of(Iter_type begin, Iter_type end, Predicate pred) { for (Iter_type it = bein; it != end; ++it) { if (pred(*it)) {return true;} } return false; }","title":"23.3.1 \u4f7f\u7528 template class \u4f5c\u4e3a Predicate \u53c2\u6570\u4ee5\u9002\u7528\u4efb\u4f55 Functor"},{"location":"23-Functors-and-Imposter-Syndrome.html#2332-example-2","text":"\u518d\u4e3e\u4e00\u4e2a\u4f8b\u5b50\uff1a class Duck { public: Duck() : name(\"\"), duckling_count(0) { } Duck(string name_in, int duckling_count_in) : name(name_in), duckling_count(duckling_count_in) { } const string & getName() const { return name; } const int getDucklingCount() const { return duckling_count; } private: string name; int duckling_count; }; Duck \u8fd9\u4e2a class \u6709\u4e24\u4e2a private members: \u4e00\u4e2a\u4ee3\u8868\u540d\u5b57\uff0c\u4e00\u4e2a\u4ee3\u8868\u751f\u4ea7\u6570\u91cf\u3002 \u6211\u4eec\u73b0\u5728\u5199\u4e00\u4e2a template function\uff0c\u6765\u83b7\u53d6\u4efb\u610f\u4e00\u4e2a\u88c5 Ducks \u7684 Container \u4e2d\u67d0\u4e2a\u5c5e\u6027\u6700\u5927\u7684\u9e2d\u5b50\u662f\u54ea\u4e2a\u3002 \u9996\u5148\u6211\u4eec\u5199\u4e24\u4e2a functor\uff0c\u4e00\u4e2a\u4ee3\u8868\u5bf9\u9e2d\u5b50\u540d\u5b57\u7684\u5b57\u6bcd\u987a\u5e8f\u7684\u6bd4\u8f83\u7684 predicate\uff0c\u53e6\u4e00\u4e2a\u4ee3\u8868\u5bf9\u9e2d\u5b50\u751f\u4ea7\u6570\u91cf\u7684\u6bd4\u8f83\u7684 predicate. // functor 1 class DuckNameLess { public: bool operator()(const Duck &d1, const Duck &d2) const { return d1.getName() < d2.getName(); } }; // functor 2 class DuckDucklingsLess { public: bool operator()(const Duck &d1, const Duck &d2) const { return d1.getDucklingCount() < d2.getDucklingCount(); } }; \u7136\u540e\u6211\u4eec implement \u8fd9\u4e2a\u51fd\u6570\uff1a template <typename Iter_type, typename Comparator> Iter_type max_element(Iter_type begin, Iter_type end, Comparator less) { Iter_type maxIt = begin; for (Iter_type it = begin; it != end; ++it) { if (less(*maxIt,*it)) {maxIt = it;} // \u68c0\u9a8c predicate (compare) } return maxIt; } \u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u6765\u6bd4\u8f83\u968f\u673a Container \u4e2d\u9e2d\u5b50\u5c5e\u6027\u7684\u60c5\u51b5\uff1a int main() { List<Duck> pond; // fill\u2026 cout << *max_element(pond.begin(), pond.end(), DuckNameLess()) << endl; cout << *max_element(pond.begin(), pond.end(), DuckDucklingsLess()) << endl; }","title":"23.3.2 example 2"},{"location":"23-Functors-and-Imposter-Syndrome.html#2333-example-3","text":"\u6211\u4eec\u4e4b\u524d\u5199\u7684 any_of \u51fd\u6570\u8868\u793a\uff1a\u53ea\u8981 Container \u4e2d\u6709\u4efb\u610f\u4e00\u4e2a element \u6ee1\u8db3 predicate\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de true. \u90a3\u4e48\u5982\u679c\u6211\u4eec\u8981\u5728 traversal \u6bcf\u4e00\u4e2a\u5143\u7d20\u540e\u505a\u4e00\u70b9\u4e8b\u60c5\u5462\uff1f template <typename Iter_t, typename Func_t> Func_t for_each(Iter_t begin, Iter_t end, Func_t func) { for (Iter_t it = begin; it != end; ++it) { func(*it); } return func; //We return the functor in case it contains some information about the result. } \u4f7f\u7528\uff1a template <typename T> class Printer { //\u4e00\u4e2a functor public: void operator()(const T &n) const { cout << n; } }; int main() { List<int> list; // Fill with numbers for_each(list.begin(), list.end(), Printer<int>()); }","title":"23.3.3 example 3"},{"location":"24-Recursion.html","text":"24 Recursion 24.1 \u5982\u4f55\u5199 Recursion 24.1.1 Some examples 24.1.2 ex2: \u901a\u8fc7 recursion \u67e5\u770b t \u662f\u5426\u5728 array \u91cc 24.1.3 ex3: \u5224\u65ad palindrome(\u56de\u6587\u6570) 24.1.4 ex4: \u5012\u8f6c array 24.1.5 Towers of Hanoi \u6c49\u8bfa\u5854 24.2 Tail Recursion: \u83b7\u5f97 Constant Space Cost 24.2.1 Space Cost of Iteration && Recursion 24.2.2 Accumulator-Passing Style: \u91cd\u5199 Factorial \u4e3a Tail Recursion 24.3 Structural Recursion 24.3.1 Recursion in Linked List 24.3.1.1 recursively \u7406\u89e3 linked list \u7684\u7ed3\u6784 24.3.1.2 recursively processing a linked list 24.3.2 \u53e6\u4e00\u79cd ADT: tree 24.3.2.1 Tree \u7684 Data Representation 24.3.2.2 \u8ba1\u7b97 Tree \u7684 size 24.3.2.3 \u8ba1\u7b97 Tree \u7684 height 24.3.2.4 \u8ba1\u7b97 Tree \u7684\u6240\u6709\u5143\u7d20\u548c 24.3.2.5 \u8ba1\u7b97 Leaves \u7684\u6570\u91cf 24.3.2.6 \u67e5\u770b tree \u4e2d\u662f\u5426\u6709\u503c\u4e3a val \u7684\u5143\u7d20 24.3.2.7 Traverse \u4e00\u4e2a tree 24.3.2.7.1 pre-order traversal 24.3.2.7.2 In-order traversal 24.3.2.7.3 Post-order traversal 24.3.2.8 Recursion \u7684\u7c7b\u578b 24 Recursion \u4e00\u4e2a Recursive definition \u6216\u79f0 Mathematical function \u6216\u79f0 Computer function \u6307\u7684\u662f\u4e00\u4e2a refers to itself \u7684 definition. \u66f4\u52a0 precisely \u5730\u8bf4\uff0crecursion \u662f\u4e00\u79cd repetition through self-reference. Recursion \u5206\u4e3a\u4e24\u90e8\u5206\uff1a Base case \u548c Recursive step. \u8bb0\u5f97\u5728 eecs 203 \u4e0a\u8bf4\u8fc7\uff1a Recursion \u5c31\u662f Mathematical Induction. void annoyingSong(int numBottles) { if (numBottles == 0) { cout << \"That's all folks!\" << endl; } else { cout << numBottles << \" bottles of beer on the wall.\" << endl; } annoyingSong(numBottles - 1); // a(n) = a(n-1) } \u518d\u6bd4\u5982\uff1afactorial $$ n! = \\begin{cases} n\\cdot (n-1)!\\;, \\;n > 0 \\ 1\\;,\\;n = 0\\end{cases} $$ int factorial(int n) { if (n == 0) return 1; else return n * factorial(n-1); } \u56e0\u800c factorial(4) \u7684 function call \u7684\u6d41\u7a0b\u5c31\u662f\u5982\u4e0b\u7684\uff1a 24.1 \u5982\u4f55\u5199 Recursion Step 1: \u5b9a\u4e49 Base Case Base case \u662f\u60c5\u51b5\u6700\u7b80\u5355\u65f6\uff08edge\uff09function \u7684\u8fd4\u56de\u503c Base case \u5fc5\u987b\u5145\u5206\u8003\u8651\uff0cdefined properly. \u901a\u5e38\u662f 0/1 \u7684\u65f6\u5019\u3002 \u6709\u65f6\u5019\u6211\u4eec\u9700\u8981 multiple base cases!!\uff08\u5982203\u5b66\u8fc7\u7684\uff09 Step 2: approch the base case \u6211\u4eec\u5199\u7684 inductive step \u5fc5\u987b\u8981 take us closer to the base case: \u6bcf\u6b21\u7ed9\u51fa\u4e00\u4e2a step \u7684 answer \u4e4b\u540e\uff0cproblem size \u5fc5\u987b\u51cf\u5c0f\u3002 Step 3: handle the one-step-smaller answer \u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u53d6\u5f97\u4e86\u4e00\u4e2a solution to the problem that is one step smaller\uff0c\u6211\u4eec\u5e94\u5f53\u5982\u4f55\u628a\u5b83\u653e\u8fdb recursive call \u4e2d\uff0c\u4ee5\u6700\u540e\u83b7\u53d6 main problem \u7684\u7b54\u6848\uff1f\uff08\u5b9e\u9645\u4e0a\u5c31\u662f\uff1a\u5047\u8bbe inductive hypothesis \u6210\u7acb\uff0c\u90a3\u4e48\u5982\u4f55\u524d\u5f80\u4e0b\u4e00\u6b65\uff09 24.1.1 Some examples exponential $$ a^n = \\begin{cases} a\\cdot a^{n-1}\\;, \\;n > 0 \\ 1\\;,\\;n = 0\\end{cases} $$ c++ int power(int a, int n) { if (n == 0) return 1; else return a * power(a, n-1); } countdown ```c++ void countdown(int n) { if (n == 0) cout << n << endl; else { cout << n << endl; countdown(n-1); // countdown from n-1 to 0 } } // \u7b2c\u4e8c\u79cd\u5199\u6cd5 void countdown(int n) { cout << n << endl; if (n > 0) coutdown(n-1); } ``` sum ```c++ // \u6b63\u786e\u7248\u672c int sum(int n) { if (n==0) return 0; else return n + sum(n-1); } // wrong 1: int sum(int n) { if (n==1) // wrong: \u6ca1\u6709 handle n==0 return 1; else return n + sum(n-1); } // wrong 2: int sum(int n) { if (n==0) return 0; else return n + (n-1) + sum(n-2); // \u53ea\u5bf9 even n \u6709\u6548\u679c } // wrong 3: int sum(int n) { if (n==0) return 0; else return sum(n); // \u6ca1\u6709 approach base case } // wrong 4: int sum(int n) { int total = 0; if (n==0) return total; else { total += n; sum(n-1); // \u6ca1\u6709\u628a inductive hypothesis \u6210\u7acb\u7684\u7ed3\u679c\u4f20\u5230 next problem \u4e2d return total; } } // wrong 5: int sum(int n) { if (n==0) return 0; else return n + sum(n--); // wrong: n--\u662f\u5148 evaluate\u518d--\u7684, \u4f1a\u628an\u4f20\u8fdb\u53bb\u518d--(\u6b64\u65f6\u5df2\u7ecf\u6ca1\u7528\u4e86), \u4e8e\u662f\u6b7b\u5faa\u73af } ``` 24.1.2 ex2: \u901a\u8fc7 recursion \u67e5\u770b t \u662f\u5426\u5728 array \u91cc \u8fd9\u91cc\u6709\u5f88\u591a\u79cd\u5199\u6cd5 // 1. yes! bool contains(int* begin, int* end, int t) { if (begin == end) return false; else return (*begin == t) || contains(begin + 1, end, t); } // 2. yes! bool contains(int* begin, int* end, int t) { if (begin == end) return false; else if (*begin == t) return true; else return contans(begin+1, end, t); } // 3. yes! bool contains(int* begin, int* end, int t) { return (begin != end) && ((*begin == t) || contains(begin+1, end, t)); } // 4. yes! bool contains(int* begin, int* end, int t) { if (begin == end) return false; else return (*(end-1) == t) || contains(begin, end-1, t); } // 5. yes! \u4ece\u4e24\u8fb9\u67e5\u770b bool contains(int* begin, int* end, int t) { if (begin >= end) return false; else { return (*begin == t) || (*(end-1) == t) || contains(begin+1, end-1, t); } } 24.1.3 ex3: \u5224\u65ad palindrome(\u56de\u6587\u6570) bool isPalindrome(string s) { if (s.size() < 2) // \u5982\u679crecur\u5230size==1, \u8bf4\u660e\u662f\u56de\u6587\u6570 return true; else return s[0]==s[s.size()-1] && isPalindrome(s.substr(1, s.size()-2)); // \u53bb\u9664\u5934\u5c3e\u7684\u5b50str } 24.1.4 ex4: \u5012\u8f6c array void swap(int* x, int* y) { int temp = *x; *x = *y; *y = temp; } void revHelp(int* left, int* right) { if (left >= right) return; else { revHelp(left+1, right-1); // rev\u53bb\u9664\u5934\u5c3e\u7684subarray swap(left, right); // swap \u5934\u5c3e } } void reverseArray(int* a, int size) { revHelp(a, a+size-1) } 24.1.5 Towers of Hanoi \u6c49\u8bfa\u5854 \u5b9e\u9645\u4e0a\uff1a\u6c49\u8bfa\u5854\u7684\u6574\u4e2a\u6d41\u7a0b\u53ef\u4ee5\u5206\u4e3a\u8fd9\u4e09\u6b65\uff1a \u5bf9\u4e8e n \u5c42\u5854 \u5148\u628a n-1 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 B \u628a\u817e\u51fa\u6765\u7684\u7b2c n \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 C \u628a B \u91cc\u9762\u7684 n-1 \u4e2a\u4e1c\u897f\u79fb\u52a8\u5230 C \u7136\u540e\u5c31\u7ed3\u675f\u4e86\u3002 \u800c\u52a0\u5165\u8fd9\u4e09\u6b65\u5176\u4e2d\u7684 recursion\uff0c\u8be6\u7ec6\u7684\u6b65\u9aa4\u662f\uff1a \u5148\u628a n-1 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 B 1.1 \u5148\u628a n-2 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 C \u200b ... 1.2 \u518d\u628a\u817e\u51fa\u6765\u7684\u7b2c n-1 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 B 1.3 \u628a C \u4e2d\u7684 n-2 \u7684\u4e1c\u897f\u79fb\u52a8\u5230 B \u200b ... \u628a\u817e\u51fa\u6765\u7684\u7b2c n \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 C \u628a B \u91cc\u9762\u7684 n-1 \u4e2a\u4e1c\u897f\u79fb\u52a8\u5230 C 3.1 \u5148\u628a n-2 \u4e2a\u4e1c\u897f\u4ece B \u4e2d\u79fb\u52a8\u5230 A \u200b ... 3.2 \u518d\u628a\u817e\u51fa\u6765\u7684\u7b2c n-1 \u4e2a\u4e1c\u897f\u4ece B \u4e2d\u79fb\u52a8\u5230 C 3.3 \u628a A \u4e2d\u7684 n-2 \u4e2a\u4e1c\u897f\u79fb\u52a8\u5230 C \u200b ... \u56e0\u800c\u6bcf\u6b21\u9012\u5f52\u5206\u4e3a\u4e24\u4e2a\u5927\u79fb\u52a8 $T(n-1)$ \u548c\u4e00\u4e2a\u5c0f\u79fb\u52a8 $T(1)$\u3002\u9012\u63a8\u516c\u5f0f\u4e3a $T(n) = 2T(n-1) + 1$\u3002 \u6211\u4eec\u63a8\u4e00\u904d $n=1,2,3$ \u65f6\u7684\u5168\u8fc7\u7a0b\uff1a \u6700\u7b80\u5355\u7684\u662f\uff1a n=1\uff0c\u6ca1\u6709 $T(n-1)$\uff0c\u76f4\u63a5\u628a n \u4ecesource \u79fb\u52a8\u5230 dest. \u7136\u540e\u662f\uff1a n=2\uff0c\u5148\u628a 1 \u4e2a\u79fb\u52a8\u5230 temp ($T(1)$)\uff0c\u518d\u628a\u4e0b\u9762\u4e00\u4e2a\u79fb\u52a8\u5230 dest ($T(1)$)\uff0c\u7136\u540e\u628a temp \u4e0a\u7684\u79fb\u52a8\u5230 dest ($T(1)$). n=3\uff0c\u5148\u628a\u4e0a\u9762\u4e24\u4e2a\u6309\u7167 n=2 \u7684\u65b9\u6cd5\u79fb\u52a8\u5230 temp ($T(2)$)\uff0c\u518d\u628a\u4e0b\u9762\u4e00\u4e2a\u79fb\u52a8\u5230 dest ($T(1)$)\uff0c\u7136\u540e\u628a temp \u4e0a\u7684\u79fb\u52a8\u5230 dest ($T(2)$). .. n=k\uff0c\u5148\u628a\u4e0a\u9762\u4e24\u4e2a\u6309\u7167 n=2 \u7684\u65b9\u6cd5\u79fb\u52a8\u5230 temp ($T(k-1)$)\uff0c\u518d\u628a\u4e0b\u9762\u4e00\u4e2a\u79fb\u52a8\u5230 dest ($T(1)$)\uff0c\u7136\u540e\u628a temp \u4e0a\u7684\u79fb\u52a8\u5230 dest ($T(k-1)$). \uff08\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u70b9\uff1a\u5728 $n-1$ \u5230 $n-2$ \u7684 recursion \u8fc7\u7a0b\u4e2d\uff1a\u5982\u679c\u6211\u4eec\u8981\u628a $[n-1]$ \u7247 \u4ece source \u79fb\u52a8\u5230 temp \u4e0a\u65f6\uff0c\u6211\u4eec\u5c31\u8981\u5148\u628a $[n-2]$ \u7247 \u4ece source \u79fb\u52a8\u5230 dest \uff0c\u7136\u540e\u628a\u7b2c $n-1$ \u7247\u4ece source \u79fb\u52a8\u5230 temp \u4e0a\uff0c\u7136\u540e\u518d\u628a $[n-2]$ \u7247\u4ece dest \u79fb\u52a8\u5230 temp \u4e0a\u3002\u8fd9\u8bf4\u660e\uff1a\u6211\u4eec\u4ece\u4e0a\u4e00\u5c42\u9012\u5f52\u5230\u4e0b\u4e00\u5c42\u9012\u5f52\u65f6\uff0c \u6211\u4eec\u7684\u4e09\u4e2a subquestion \u4e2d\u7684\u4e09\u4e2a\u67f1\u5b50\u662f\u8981\u6362\u4f4d\u7f6e\u7684\u3002 \u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\uff0c\u56e0\u4e3a recursion \u7684\u7ed3\u6784\u5df2\u7ecf\u81ea\u52a8\u5305\u542b\u4e86\u6362\u4f4d\u7684\u884c\u4e3a\u4e86\u3002\uff09 \u56e0\u800c\u6211\u4eec\u7684\u4ee3\u7801\u7ed3\u6784\u662f\uff1a void move(int n, string source, string dest, string temp) { if(n==1) cout << \"Move from \" << source << \" to \" << dest << endl; // n==1 \u8bf4\u660e\u5df2\u7ecf\u7ed3\u675f\u4e86 else { move(n-1, source, temp, dest); move(1, source, dest, temp); move(n-1, temp, dest, source); } } void printHanoi(int n) { move(n, \"A\", \"C\", \"B\"); } \u4ee5\u4e0b\u4e3a\u7b14\u8005\u642c\u6c49\u8bfa\u5854\u622a\u7684\u5173\u952e\u6b65\u9aa4\uff08\u663e\u793a\u4e86\u6362\u4f4d\uff09 24.2 Tail Recursion: \u83b7\u5f97 Constant Space Cost 24.2.1 Space Cost of Iteration && Recursion \u6211\u4eec\u770b\u4e00\u4e2a\u65e2\u53ef\u4ee5\u7528 iteration \u53c8\u53ef\u4ee5\u7528 recursion \u5199\u7684\u51fd\u6570: void revHelp(int *left, int *right) { while (left < right) { swap(left, right); ++left; --right; } } \u8fd9\u4e2a\u51fd\u6570\u7684 time complexity \u662f ${n\\over 2} \\in O(n)$, \u800c space cost \u662f $1 \\in O(1)$. \u800c\u6211\u4eec\u7528\u521a\u624d\u7684 recursion \u6765\u5199\u7684\u8bdd\uff1a void revHelp(int* left, int* right) { if (left >= right) return; else { revHelp(left+1, right-1); // rev\u53bb\u9664\u5934\u5c3e\u7684subarray swap(left, right); // swap \u5934\u5c3e } } \u8fd9\u4e2a\u51fd\u6570\u7684 time complexity \u4e5f\u662f ${n\\over 2} \\in O(n)$, \u4f46\u662f space cost \u4e5f\u662f ${n\\over2} \\in O(n)$. \u56e0\u4e3a\u6211\u4eec\u4f1a recursively build $n\\over 2$ \u4e2a stack frame\uff0c\u5e76\u4ece\u540e\u81f3\u524d\u8fdb\u884c swap\uff0cswap \u5b8c\u4e00\u4e2a\u4e4b\u540e\u5c31\u6d88\u9664\u4e00\u4e2a stack frame\uff0c\u6700\u540e\u6d88\u9664\u5b8c\u6700\u5f00\u59cb\u5efa\u7acb\u8d77\u7684\u7b2c\u4e00\u4e2a stack frame \u7ed3\u675f function call. \u4f46\u662f\u5982\u679c\u6211\u4eec\u8fd9\u6837\u5199\uff1a void revHelp(int* left, int* right) { if (left >= right) return; else { swap(left, right); revHelp(left+1, right-1); } } \u53ea\u662f\u628a\u540e\u9762\u4e24\u884c\u6362\u6389\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 $1 \\in O(1)$ \u7684 constant \u7684 space cost. \u56e0\u4e3a\u5f53\u6211\u4eec\u628a recursive call \u653e\u5728\u6574\u4e2a\u51fd\u6570\u7684\u6700\u540e\u4e00\u6b65\u6765 return \u65f6\uff0c\u6211\u4eec\u5c31\u5728 recursive call \u4e4b\u540e\u628a\u539f\u672c\u7684 stack frame \u6d88\u9664\u4e86\uff0c\u5e76\u7acb\u523b\u5728\u539f\u4f4d\u7f6e\u5efa\u7acb\u8d77\u4e86\u65b0\u7684 stack frame\u3002\u56e0\u800c\uff0c\u6574\u4e2a function call \u7684\u8fc7\u7a0b\u4e2d\u6211\u4eec\u4e00\u76f4\u4fdd\u6301\u53ea\u4f7f\u7528\u4e00\u4e2a stack frame \u7684 memory\uff0c\u6781\u5927\u5730\u51cf\u5c0f\u4e86 space cost. \u8fd9\u79cd Recursion \u5c31\u53eb\u505a Tail Recursion : \u5728\u51fd\u6570\u7684\u6700\u540e\u4e00\u6b65\u8fdb\u884c Recursive Call\uff0c\u4ece\u800c\u4ece\u59cb\u81f3\u7ec8\u53ea\u4f7f\u7528\u4e00\u4e2a stack frame. 24.2.2 Accumulator-Passing Style: \u91cd\u5199 Factorial \u4e3a Tail Recursion \u6211\u4eec\u770b\u5230\u539f\u672c\u5199\u7684 Factorial \u51fd\u6570\uff1a int factorial (int n) { if (n==0) return 1; else return n * factorial(n-1); } \u8fd9\u770b\u8d77\u6765\u662f\u4e00\u4e2a Tail Recursion \u4f46\u662f\u4e0d\u662f\uff01 \u56e0\u4e3a\u6211\u4eec recursively call factorial(n-1) \u7684\u65f6\u5019\uff0c\u6211\u4eec\u5916\u9762\u8fd8\u6709\u4e00\u4e2a n * \uff0c\u8fd9\u5c31\u5bfc\u81f4\u524d\u4e00\u4e2a stack frame \u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u6211\u4eec\u5c31\u5148\u5f15\u5165\u4e86\u540e\u4e00\u4e2a stack frame. \u6700\u540e\u4e00\u4e2a function \u4f1a\u5148 call \u51fa\u6240\u6709\u7684 $n$ \u4e2a recursive stack frame \u518d\u4e00\u4e2a\u4e00\u4e2a\u8fd0\u884c\u5e76\u4ece\u540e\u5f80\u524d\u9000\u51fa\uff0c\u56e0\u800c time complexity = $n \\in O(n)$. \u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u5f88\u597d\u89e3\u51b3 \u6211\u4eec\u901a\u8fc7\u628a\u524d\u4e00\u4e2a $n$ \u7684\u503c\u653e\u8fdb parameters \u91cc\u6765\u628a\u5b83\u6539\u6210 tail recursion\uff1a int factHelp(Int n, int prodSoFar) { if (n == 0) return prodSoFar; else return factHelp(n - 1, n * prodSoFar) } int factorial(int start) { return factHelp(start, 1); } \u8fd9\u4e2a factorial \u51fd\u6570\u7684 space cost \u4e3a $1 \\in O(1)$. \u5b83\u5bf9\u5e94\u7684 iterative solution \u4e3a\uff1a int factIter(int start) { int n = start; int prodSoFar = 1; while(true) { if (n==0) return prodSoFar; prodSoFar = n * prodSoFar; n = n-1; } } \u8fd9\u79cd revise \u4e00\u4e2a non-tail recursion \u4e3a\u4e00\u4e2a tail recursion \u7684\u65b9\u5f0f\u53eb\u505a Accumulator-passing style(APS). 24.3 Structural Recursion 24.3.1 Recursion in Linked List 24.3.1.1 recursively \u7406\u89e3 linked list \u7684\u7ed3\u6784 \u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u4e00\u4e2a list \u662f either: empty or \u4e00\u4e2a datum \u548c\u4e00\u4e2a sublist 24.3.1.2 recursively processing a linked list \u8ba1\u7b97\u6240\u6709\u5143\u7d20\u7684 sum: int sum(Node* n) { if (n == nullptr) return 0; else return n->datum + sum(n->next); } \u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff1a int lasr(Node *n) { if (n->next == nullptr) return n->datum; else return last(n->next); } \u83b7\u53d6\u503c\u4e3a val \u7684\u5143\u7d20\u4e2a\u6570\uff1a int count(Node* n, int val) { if (n == nullptr) return 0; else { int countInRest = count(n->next, val); if (n->datum == val) return 1+countInRest; else return countInRest; } } \u53e6\u4e00\u79cd\u5199\u6cd5: int count(Node* n, int val) { return (n->datum==val) + count(n->next, val); } \u83b7\u53d6\u6700\u5927\u503c int max(Node* n) { if (n->next == nullptr) return n->datum; else { int maxInRest = max(n->next); // \u7528i\u548c[1,i-1]\u4e2d\u7684max\u76f8\u6bd4, \u5f97\u5230[1,i]\u4e2d\u7684max if (n->datum > maxInRest) return n->datum; else return maxInRest; } } 24.3.2 \u53e6\u4e00\u79cd ADT: tree \u6211\u4eec\u8fd9\u91cc\u8bb2\u7684 tree \u5c40\u9650\u4e8e binary tree. \u7c7b\u4f3c\u4e8e\u5bf9 Linked list \u7684 Recursive definition\uff0c\u6211\u4eec\u8fd9\u6837 define binay tree: \u4e00\u4e2a binary tree \u4e3a either: empty or: \u4e00\u4e2a datum with left and right sub-trees. \u4e00\u4e2a tree \u6709\u4e24\u79cd measure \u65b9\u5f0f\uff1a by size \uff1atree \u4e2d elements \u7684\u4e2a\u6570 by height : \u5373 maximum depth \uff0cthe longest chain of nodes from root to leaf. 24.3.2.1 Tree \u7684 Data Representation \u4e00\u4e2a tree \u7684\u57fa\u672c\u5355\u4f4d\u662f Node: struct Node { int datum; Node *left; Node *right; } 24.3.2.2 \u8ba1\u7b97 Tree \u7684 size int size(Node *node) { if (node == nullptr) return 0; else return 1 + size(node->left) + size(node->right); } 24.3.2.3 \u8ba1\u7b97 Tree \u7684 height int height(Node *r) { if (r == nullptr) return 0; else return 1 + max(height(r->left), height(r->right)) } 24.3.2.4 \u8ba1\u7b97 Tree \u7684\u6240\u6709\u5143\u7d20\u548c int sum(Node* r) { if (r==nullptr) return 0; else return r->datum + sum(r->left) + sum(r->right) // \u672cdatum\u548c\u5de6\u53f3subtree\u7684sum\u7684\u548c } 24.3.2.5 \u8ba1\u7b97 Leaves \u7684\u6570\u91cf int numLeaves(Node* r) { if (r == nullptr) // \u8bf4\u660e\u8fd9\u4e2a Node \u662f\u7a7a\u7684, \u4e0d\u662f leaf return 0; else if ((r->left == nullptr) && (r->right = nullptr)) // \u8bf4\u660e\u8fd9\u4e2a Node \u6ca1\u6709 subtree \u4e86, \u56e0\u800c\u81ea\u8eab\u662f\u5355\u4e2a leaf return 1; else // \u8bf4\u660e\u8fd9\u4e2a Node \u8fd8\u6709 subtree, \u56e0\u800c\u662f\u5de6\u53f3 subtree \u4e2d\u7684 leaves \u603b\u6570 return numLeaveds(r->left) + numLeaves(r->right); } 24.3.2.6 \u67e5\u770b tree \u4e2d\u662f\u5426\u6709\u503c\u4e3a val \u7684\u5143\u7d20 bool contains(Node *r, int val) { if (r == nullptr) // \u641c\u7d22\u5230\u5e95\u4e86\u8fd8\u6ca1\u6709, \u8fd4\u56de false return false; else return (r->datum == val) || contains(r->left, val) || contains(r->right, val); // \u81ea\u5df1\u662f or \u5de6\u53f3subtree\u91cc\u6709 } 24.3.2.7 Traverse \u4e00\u4e2a tree \u6709\u4e09\u79cd common tree traversals: Pre-order(\u524d\u5e8f\u904d\u5386): \u5148 visit curent node \u518d visit \u5176 children in-order(\u4e2d\u5e8f\u904d\u5386): visit current node between visit \u5176 children Post-order(\u540e\u5e8f\u904d\u5386): \u5148 visit \u5176 children \u518d visit current node 24.3.2.7.1 pre-order traversal void preOrder(Node* root) { if (root != nullptr) { // here: process root preOrder(root->left); preOrder(root->right); } } 24.3.2.7.2 In-order traversal void inOrder(Node* root) { if (root != nullptr) { inOrder(root->left); // here: process root inOrder(root->right); } } 24.3.2.7.3 Post-order traversal void postOrder(Node* root) { if (root != nullptr) { postOrder(root->left); postOrder(root->right); // here: process root } } 24.3.2.8 Recursion \u7684\u7c7b\u578b \u4e00\u4e2a recursive function \u662f linear recursive \u7684\uff1aif it \u6bcf\u6b21\u81f3\u591a makes one recursive call \u4f8b\u5b50: factorial, list max tail recursive \u7684\uff1a if \u5b83\u662f linear recursive \u7684\uff0c\u5e76\u4e14\u5b83\u7684 recursion call \u662f tail recursion. tree recursive \u7684\uff1aif \u5b83\u53ef\u80fd\u4f1a make more than 1 recursive call. \u4f8b\u5b50: tree size, height \u4e0b\u9762\u662f\u4e00\u4e2a\u5178\u578b\u7684 tree recursive \u7684 function\uff1aFibonacci Sequence. int fib(int n) { if (n <= 1) return n; else return fib(n-1) + fib(n-2); } $$ F(n) = \\begin{cases} 0\\;,\\; n=0\\ 1\\;, \\;n =1 \\ F(n-1) + F(n-2)\\;,\\;n > 1\\end{cases} $$ tree recursive \u7684\u5c31\u662f\u8fc7\u7a0b\u56fe\u662f tree \u7684 recursion\uff1blinear recursive \u7684\u5c31\u662f\u8fc7\u7a0b\u56fe\u662f\u4e00\u6839\u7ebf\u7684 recursion.","title":"Overview"},{"location":"24-Recursion.html#24-recursion","text":"\u4e00\u4e2a Recursive definition \u6216\u79f0 Mathematical function \u6216\u79f0 Computer function \u6307\u7684\u662f\u4e00\u4e2a refers to itself \u7684 definition. \u66f4\u52a0 precisely \u5730\u8bf4\uff0crecursion \u662f\u4e00\u79cd repetition through self-reference. Recursion \u5206\u4e3a\u4e24\u90e8\u5206\uff1a Base case \u548c Recursive step. \u8bb0\u5f97\u5728 eecs 203 \u4e0a\u8bf4\u8fc7\uff1a Recursion \u5c31\u662f Mathematical Induction. void annoyingSong(int numBottles) { if (numBottles == 0) { cout << \"That's all folks!\" << endl; } else { cout << numBottles << \" bottles of beer on the wall.\" << endl; } annoyingSong(numBottles - 1); // a(n) = a(n-1) } \u518d\u6bd4\u5982\uff1afactorial $$ n! = \\begin{cases} n\\cdot (n-1)!\\;, \\;n > 0 \\ 1\\;,\\;n = 0\\end{cases} $$ int factorial(int n) { if (n == 0) return 1; else return n * factorial(n-1); } \u56e0\u800c factorial(4) \u7684 function call \u7684\u6d41\u7a0b\u5c31\u662f\u5982\u4e0b\u7684\uff1a","title":"24 Recursion"},{"location":"24-Recursion.html#241-recursion","text":"Step 1: \u5b9a\u4e49 Base Case Base case \u662f\u60c5\u51b5\u6700\u7b80\u5355\u65f6\uff08edge\uff09function \u7684\u8fd4\u56de\u503c Base case \u5fc5\u987b\u5145\u5206\u8003\u8651\uff0cdefined properly. \u901a\u5e38\u662f 0/1 \u7684\u65f6\u5019\u3002 \u6709\u65f6\u5019\u6211\u4eec\u9700\u8981 multiple base cases!!\uff08\u5982203\u5b66\u8fc7\u7684\uff09 Step 2: approch the base case \u6211\u4eec\u5199\u7684 inductive step \u5fc5\u987b\u8981 take us closer to the base case: \u6bcf\u6b21\u7ed9\u51fa\u4e00\u4e2a step \u7684 answer \u4e4b\u540e\uff0cproblem size \u5fc5\u987b\u51cf\u5c0f\u3002 Step 3: handle the one-step-smaller answer \u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u53d6\u5f97\u4e86\u4e00\u4e2a solution to the problem that is one step smaller\uff0c\u6211\u4eec\u5e94\u5f53\u5982\u4f55\u628a\u5b83\u653e\u8fdb recursive call \u4e2d\uff0c\u4ee5\u6700\u540e\u83b7\u53d6 main problem \u7684\u7b54\u6848\uff1f\uff08\u5b9e\u9645\u4e0a\u5c31\u662f\uff1a\u5047\u8bbe inductive hypothesis \u6210\u7acb\uff0c\u90a3\u4e48\u5982\u4f55\u524d\u5f80\u4e0b\u4e00\u6b65\uff09","title":"24.1 \u5982\u4f55\u5199 Recursion"},{"location":"24-Recursion.html#2411-some-examples","text":"exponential $$ a^n = \\begin{cases} a\\cdot a^{n-1}\\;, \\;n > 0 \\ 1\\;,\\;n = 0\\end{cases} $$ c++ int power(int a, int n) { if (n == 0) return 1; else return a * power(a, n-1); } countdown ```c++ void countdown(int n) { if (n == 0) cout << n << endl; else { cout << n << endl; countdown(n-1); // countdown from n-1 to 0 } } // \u7b2c\u4e8c\u79cd\u5199\u6cd5 void countdown(int n) { cout << n << endl; if (n > 0) coutdown(n-1); } ``` sum ```c++ // \u6b63\u786e\u7248\u672c int sum(int n) { if (n==0) return 0; else return n + sum(n-1); } // wrong 1: int sum(int n) { if (n==1) // wrong: \u6ca1\u6709 handle n==0 return 1; else return n + sum(n-1); } // wrong 2: int sum(int n) { if (n==0) return 0; else return n + (n-1) + sum(n-2); // \u53ea\u5bf9 even n \u6709\u6548\u679c } // wrong 3: int sum(int n) { if (n==0) return 0; else return sum(n); // \u6ca1\u6709 approach base case } // wrong 4: int sum(int n) { int total = 0; if (n==0) return total; else { total += n; sum(n-1); // \u6ca1\u6709\u628a inductive hypothesis \u6210\u7acb\u7684\u7ed3\u679c\u4f20\u5230 next problem \u4e2d return total; } } // wrong 5: int sum(int n) { if (n==0) return 0; else return n + sum(n--); // wrong: n--\u662f\u5148 evaluate\u518d--\u7684, \u4f1a\u628an\u4f20\u8fdb\u53bb\u518d--(\u6b64\u65f6\u5df2\u7ecf\u6ca1\u7528\u4e86), \u4e8e\u662f\u6b7b\u5faa\u73af } ```","title":"24.1.1 Some examples"},{"location":"24-Recursion.html#2412-ex2-recursion-t-array","text":"\u8fd9\u91cc\u6709\u5f88\u591a\u79cd\u5199\u6cd5 // 1. yes! bool contains(int* begin, int* end, int t) { if (begin == end) return false; else return (*begin == t) || contains(begin + 1, end, t); } // 2. yes! bool contains(int* begin, int* end, int t) { if (begin == end) return false; else if (*begin == t) return true; else return contans(begin+1, end, t); } // 3. yes! bool contains(int* begin, int* end, int t) { return (begin != end) && ((*begin == t) || contains(begin+1, end, t)); } // 4. yes! bool contains(int* begin, int* end, int t) { if (begin == end) return false; else return (*(end-1) == t) || contains(begin, end-1, t); } // 5. yes! \u4ece\u4e24\u8fb9\u67e5\u770b bool contains(int* begin, int* end, int t) { if (begin >= end) return false; else { return (*begin == t) || (*(end-1) == t) || contains(begin+1, end-1, t); } }","title":"24.1.2 ex2: \u901a\u8fc7 recursion \u67e5\u770b t \u662f\u5426\u5728 array \u91cc"},{"location":"24-Recursion.html#2413-ex3-palindrome","text":"bool isPalindrome(string s) { if (s.size() < 2) // \u5982\u679crecur\u5230size==1, \u8bf4\u660e\u662f\u56de\u6587\u6570 return true; else return s[0]==s[s.size()-1] && isPalindrome(s.substr(1, s.size()-2)); // \u53bb\u9664\u5934\u5c3e\u7684\u5b50str }","title":"24.1.3 ex3: \u5224\u65ad palindrome(\u56de\u6587\u6570)"},{"location":"24-Recursion.html#2414-ex4-array","text":"void swap(int* x, int* y) { int temp = *x; *x = *y; *y = temp; } void revHelp(int* left, int* right) { if (left >= right) return; else { revHelp(left+1, right-1); // rev\u53bb\u9664\u5934\u5c3e\u7684subarray swap(left, right); // swap \u5934\u5c3e } } void reverseArray(int* a, int size) { revHelp(a, a+size-1) }","title":"24.1.4 ex4: \u5012\u8f6c array"},{"location":"24-Recursion.html#2415-towers-of-hanoi","text":"\u5b9e\u9645\u4e0a\uff1a\u6c49\u8bfa\u5854\u7684\u6574\u4e2a\u6d41\u7a0b\u53ef\u4ee5\u5206\u4e3a\u8fd9\u4e09\u6b65\uff1a \u5bf9\u4e8e n \u5c42\u5854 \u5148\u628a n-1 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 B \u628a\u817e\u51fa\u6765\u7684\u7b2c n \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 C \u628a B \u91cc\u9762\u7684 n-1 \u4e2a\u4e1c\u897f\u79fb\u52a8\u5230 C \u7136\u540e\u5c31\u7ed3\u675f\u4e86\u3002 \u800c\u52a0\u5165\u8fd9\u4e09\u6b65\u5176\u4e2d\u7684 recursion\uff0c\u8be6\u7ec6\u7684\u6b65\u9aa4\u662f\uff1a \u5148\u628a n-1 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 B 1.1 \u5148\u628a n-2 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 C \u200b ... 1.2 \u518d\u628a\u817e\u51fa\u6765\u7684\u7b2c n-1 \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 B 1.3 \u628a C \u4e2d\u7684 n-2 \u7684\u4e1c\u897f\u79fb\u52a8\u5230 B \u200b ... \u628a\u817e\u51fa\u6765\u7684\u7b2c n \u4e2a\u4e1c\u897f\u4ece A \u4e2d\u79fb\u52a8\u5230 C \u628a B \u91cc\u9762\u7684 n-1 \u4e2a\u4e1c\u897f\u79fb\u52a8\u5230 C 3.1 \u5148\u628a n-2 \u4e2a\u4e1c\u897f\u4ece B \u4e2d\u79fb\u52a8\u5230 A \u200b ... 3.2 \u518d\u628a\u817e\u51fa\u6765\u7684\u7b2c n-1 \u4e2a\u4e1c\u897f\u4ece B \u4e2d\u79fb\u52a8\u5230 C 3.3 \u628a A \u4e2d\u7684 n-2 \u4e2a\u4e1c\u897f\u79fb\u52a8\u5230 C \u200b ... \u56e0\u800c\u6bcf\u6b21\u9012\u5f52\u5206\u4e3a\u4e24\u4e2a\u5927\u79fb\u52a8 $T(n-1)$ \u548c\u4e00\u4e2a\u5c0f\u79fb\u52a8 $T(1)$\u3002\u9012\u63a8\u516c\u5f0f\u4e3a $T(n) = 2T(n-1) + 1$\u3002 \u6211\u4eec\u63a8\u4e00\u904d $n=1,2,3$ \u65f6\u7684\u5168\u8fc7\u7a0b\uff1a \u6700\u7b80\u5355\u7684\u662f\uff1a n=1\uff0c\u6ca1\u6709 $T(n-1)$\uff0c\u76f4\u63a5\u628a n \u4ecesource \u79fb\u52a8\u5230 dest. \u7136\u540e\u662f\uff1a n=2\uff0c\u5148\u628a 1 \u4e2a\u79fb\u52a8\u5230 temp ($T(1)$)\uff0c\u518d\u628a\u4e0b\u9762\u4e00\u4e2a\u79fb\u52a8\u5230 dest ($T(1)$)\uff0c\u7136\u540e\u628a temp \u4e0a\u7684\u79fb\u52a8\u5230 dest ($T(1)$). n=3\uff0c\u5148\u628a\u4e0a\u9762\u4e24\u4e2a\u6309\u7167 n=2 \u7684\u65b9\u6cd5\u79fb\u52a8\u5230 temp ($T(2)$)\uff0c\u518d\u628a\u4e0b\u9762\u4e00\u4e2a\u79fb\u52a8\u5230 dest ($T(1)$)\uff0c\u7136\u540e\u628a temp \u4e0a\u7684\u79fb\u52a8\u5230 dest ($T(2)$). .. n=k\uff0c\u5148\u628a\u4e0a\u9762\u4e24\u4e2a\u6309\u7167 n=2 \u7684\u65b9\u6cd5\u79fb\u52a8\u5230 temp ($T(k-1)$)\uff0c\u518d\u628a\u4e0b\u9762\u4e00\u4e2a\u79fb\u52a8\u5230 dest ($T(1)$)\uff0c\u7136\u540e\u628a temp \u4e0a\u7684\u79fb\u52a8\u5230 dest ($T(k-1)$). \uff08\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u70b9\uff1a\u5728 $n-1$ \u5230 $n-2$ \u7684 recursion \u8fc7\u7a0b\u4e2d\uff1a\u5982\u679c\u6211\u4eec\u8981\u628a $[n-1]$ \u7247 \u4ece source \u79fb\u52a8\u5230 temp \u4e0a\u65f6\uff0c\u6211\u4eec\u5c31\u8981\u5148\u628a $[n-2]$ \u7247 \u4ece source \u79fb\u52a8\u5230 dest \uff0c\u7136\u540e\u628a\u7b2c $n-1$ \u7247\u4ece source \u79fb\u52a8\u5230 temp \u4e0a\uff0c\u7136\u540e\u518d\u628a $[n-2]$ \u7247\u4ece dest \u79fb\u52a8\u5230 temp \u4e0a\u3002\u8fd9\u8bf4\u660e\uff1a\u6211\u4eec\u4ece\u4e0a\u4e00\u5c42\u9012\u5f52\u5230\u4e0b\u4e00\u5c42\u9012\u5f52\u65f6\uff0c \u6211\u4eec\u7684\u4e09\u4e2a subquestion \u4e2d\u7684\u4e09\u4e2a\u67f1\u5b50\u662f\u8981\u6362\u4f4d\u7f6e\u7684\u3002 \u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\uff0c\u56e0\u4e3a recursion \u7684\u7ed3\u6784\u5df2\u7ecf\u81ea\u52a8\u5305\u542b\u4e86\u6362\u4f4d\u7684\u884c\u4e3a\u4e86\u3002\uff09 \u56e0\u800c\u6211\u4eec\u7684\u4ee3\u7801\u7ed3\u6784\u662f\uff1a void move(int n, string source, string dest, string temp) { if(n==1) cout << \"Move from \" << source << \" to \" << dest << endl; // n==1 \u8bf4\u660e\u5df2\u7ecf\u7ed3\u675f\u4e86 else { move(n-1, source, temp, dest); move(1, source, dest, temp); move(n-1, temp, dest, source); } } void printHanoi(int n) { move(n, \"A\", \"C\", \"B\"); } \u4ee5\u4e0b\u4e3a\u7b14\u8005\u642c\u6c49\u8bfa\u5854\u622a\u7684\u5173\u952e\u6b65\u9aa4\uff08\u663e\u793a\u4e86\u6362\u4f4d\uff09","title":"24.1.5 Towers of Hanoi \u6c49\u8bfa\u5854"},{"location":"24-Recursion.html#242-tail-recursion-constant-space-cost","text":"","title":"24.2 Tail Recursion: \u83b7\u5f97 Constant Space Cost"},{"location":"24-Recursion.html#2421-space-cost-of-iteration-recursion","text":"\u6211\u4eec\u770b\u4e00\u4e2a\u65e2\u53ef\u4ee5\u7528 iteration \u53c8\u53ef\u4ee5\u7528 recursion \u5199\u7684\u51fd\u6570: void revHelp(int *left, int *right) { while (left < right) { swap(left, right); ++left; --right; } } \u8fd9\u4e2a\u51fd\u6570\u7684 time complexity \u662f ${n\\over 2} \\in O(n)$, \u800c space cost \u662f $1 \\in O(1)$. \u800c\u6211\u4eec\u7528\u521a\u624d\u7684 recursion \u6765\u5199\u7684\u8bdd\uff1a void revHelp(int* left, int* right) { if (left >= right) return; else { revHelp(left+1, right-1); // rev\u53bb\u9664\u5934\u5c3e\u7684subarray swap(left, right); // swap \u5934\u5c3e } } \u8fd9\u4e2a\u51fd\u6570\u7684 time complexity \u4e5f\u662f ${n\\over 2} \\in O(n)$, \u4f46\u662f space cost \u4e5f\u662f ${n\\over2} \\in O(n)$. \u56e0\u4e3a\u6211\u4eec\u4f1a recursively build $n\\over 2$ \u4e2a stack frame\uff0c\u5e76\u4ece\u540e\u81f3\u524d\u8fdb\u884c swap\uff0cswap \u5b8c\u4e00\u4e2a\u4e4b\u540e\u5c31\u6d88\u9664\u4e00\u4e2a stack frame\uff0c\u6700\u540e\u6d88\u9664\u5b8c\u6700\u5f00\u59cb\u5efa\u7acb\u8d77\u7684\u7b2c\u4e00\u4e2a stack frame \u7ed3\u675f function call. \u4f46\u662f\u5982\u679c\u6211\u4eec\u8fd9\u6837\u5199\uff1a void revHelp(int* left, int* right) { if (left >= right) return; else { swap(left, right); revHelp(left+1, right-1); } } \u53ea\u662f\u628a\u540e\u9762\u4e24\u884c\u6362\u6389\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 $1 \\in O(1)$ \u7684 constant \u7684 space cost. \u56e0\u4e3a\u5f53\u6211\u4eec\u628a recursive call \u653e\u5728\u6574\u4e2a\u51fd\u6570\u7684\u6700\u540e\u4e00\u6b65\u6765 return \u65f6\uff0c\u6211\u4eec\u5c31\u5728 recursive call \u4e4b\u540e\u628a\u539f\u672c\u7684 stack frame \u6d88\u9664\u4e86\uff0c\u5e76\u7acb\u523b\u5728\u539f\u4f4d\u7f6e\u5efa\u7acb\u8d77\u4e86\u65b0\u7684 stack frame\u3002\u56e0\u800c\uff0c\u6574\u4e2a function call \u7684\u8fc7\u7a0b\u4e2d\u6211\u4eec\u4e00\u76f4\u4fdd\u6301\u53ea\u4f7f\u7528\u4e00\u4e2a stack frame \u7684 memory\uff0c\u6781\u5927\u5730\u51cf\u5c0f\u4e86 space cost. \u8fd9\u79cd Recursion \u5c31\u53eb\u505a Tail Recursion : \u5728\u51fd\u6570\u7684\u6700\u540e\u4e00\u6b65\u8fdb\u884c Recursive Call\uff0c\u4ece\u800c\u4ece\u59cb\u81f3\u7ec8\u53ea\u4f7f\u7528\u4e00\u4e2a stack frame.","title":"24.2.1 Space Cost of Iteration &amp;&amp; Recursion"},{"location":"24-Recursion.html#2422-accumulator-passing-style-factorial-tail-recursion","text":"\u6211\u4eec\u770b\u5230\u539f\u672c\u5199\u7684 Factorial \u51fd\u6570\uff1a int factorial (int n) { if (n==0) return 1; else return n * factorial(n-1); } \u8fd9\u770b\u8d77\u6765\u662f\u4e00\u4e2a Tail Recursion \u4f46\u662f\u4e0d\u662f\uff01 \u56e0\u4e3a\u6211\u4eec recursively call factorial(n-1) \u7684\u65f6\u5019\uff0c\u6211\u4eec\u5916\u9762\u8fd8\u6709\u4e00\u4e2a n * \uff0c\u8fd9\u5c31\u5bfc\u81f4\u524d\u4e00\u4e2a stack frame \u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u6211\u4eec\u5c31\u5148\u5f15\u5165\u4e86\u540e\u4e00\u4e2a stack frame. \u6700\u540e\u4e00\u4e2a function \u4f1a\u5148 call \u51fa\u6240\u6709\u7684 $n$ \u4e2a recursive stack frame \u518d\u4e00\u4e2a\u4e00\u4e2a\u8fd0\u884c\u5e76\u4ece\u540e\u5f80\u524d\u9000\u51fa\uff0c\u56e0\u800c time complexity = $n \\in O(n)$. \u4f46\u662f\u8fd9\u4e2a\u95ee\u9898\u5f88\u597d\u89e3\u51b3 \u6211\u4eec\u901a\u8fc7\u628a\u524d\u4e00\u4e2a $n$ \u7684\u503c\u653e\u8fdb parameters \u91cc\u6765\u628a\u5b83\u6539\u6210 tail recursion\uff1a int factHelp(Int n, int prodSoFar) { if (n == 0) return prodSoFar; else return factHelp(n - 1, n * prodSoFar) } int factorial(int start) { return factHelp(start, 1); } \u8fd9\u4e2a factorial \u51fd\u6570\u7684 space cost \u4e3a $1 \\in O(1)$. \u5b83\u5bf9\u5e94\u7684 iterative solution \u4e3a\uff1a int factIter(int start) { int n = start; int prodSoFar = 1; while(true) { if (n==0) return prodSoFar; prodSoFar = n * prodSoFar; n = n-1; } } \u8fd9\u79cd revise \u4e00\u4e2a non-tail recursion \u4e3a\u4e00\u4e2a tail recursion \u7684\u65b9\u5f0f\u53eb\u505a Accumulator-passing style(APS).","title":"24.2.2 Accumulator-Passing Style: \u91cd\u5199 Factorial \u4e3a Tail Recursion"},{"location":"24-Recursion.html#243-structural-recursion","text":"","title":"24.3 Structural Recursion"},{"location":"24-Recursion.html#2431-recursion-in-linked-list","text":"","title":"24.3.1 Recursion in Linked List"},{"location":"24-Recursion.html#24311-recursively-linked-list","text":"\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u4e00\u4e2a list \u662f either: empty or \u4e00\u4e2a datum \u548c\u4e00\u4e2a sublist","title":"24.3.1.1 recursively \u7406\u89e3 linked list \u7684\u7ed3\u6784"},{"location":"24-Recursion.html#24312-recursively-processing-a-linked-list","text":"\u8ba1\u7b97\u6240\u6709\u5143\u7d20\u7684 sum: int sum(Node* n) { if (n == nullptr) return 0; else return n->datum + sum(n->next); } \u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff1a int lasr(Node *n) { if (n->next == nullptr) return n->datum; else return last(n->next); } \u83b7\u53d6\u503c\u4e3a val \u7684\u5143\u7d20\u4e2a\u6570\uff1a int count(Node* n, int val) { if (n == nullptr) return 0; else { int countInRest = count(n->next, val); if (n->datum == val) return 1+countInRest; else return countInRest; } } \u53e6\u4e00\u79cd\u5199\u6cd5: int count(Node* n, int val) { return (n->datum==val) + count(n->next, val); } \u83b7\u53d6\u6700\u5927\u503c int max(Node* n) { if (n->next == nullptr) return n->datum; else { int maxInRest = max(n->next); // \u7528i\u548c[1,i-1]\u4e2d\u7684max\u76f8\u6bd4, \u5f97\u5230[1,i]\u4e2d\u7684max if (n->datum > maxInRest) return n->datum; else return maxInRest; } }","title":"24.3.1.2 recursively processing a linked list"},{"location":"24-Recursion.html#2432-adt-tree","text":"\u6211\u4eec\u8fd9\u91cc\u8bb2\u7684 tree \u5c40\u9650\u4e8e binary tree. \u7c7b\u4f3c\u4e8e\u5bf9 Linked list \u7684 Recursive definition\uff0c\u6211\u4eec\u8fd9\u6837 define binay tree: \u4e00\u4e2a binary tree \u4e3a either: empty or: \u4e00\u4e2a datum with left and right sub-trees. \u4e00\u4e2a tree \u6709\u4e24\u79cd measure \u65b9\u5f0f\uff1a by size \uff1atree \u4e2d elements \u7684\u4e2a\u6570 by height : \u5373 maximum depth \uff0cthe longest chain of nodes from root to leaf.","title":"24.3.2 \u53e6\u4e00\u79cd ADT: tree"},{"location":"24-Recursion.html#24321-tree-data-representation","text":"\u4e00\u4e2a tree \u7684\u57fa\u672c\u5355\u4f4d\u662f Node: struct Node { int datum; Node *left; Node *right; }","title":"24.3.2.1 Tree \u7684 Data Representation"},{"location":"24-Recursion.html#24322-tree-size","text":"int size(Node *node) { if (node == nullptr) return 0; else return 1 + size(node->left) + size(node->right); }","title":"24.3.2.2 \u8ba1\u7b97 Tree \u7684 size"},{"location":"24-Recursion.html#24323-tree-height","text":"int height(Node *r) { if (r == nullptr) return 0; else return 1 + max(height(r->left), height(r->right)) }","title":"24.3.2.3 \u8ba1\u7b97 Tree \u7684 height"},{"location":"24-Recursion.html#24324-tree","text":"int sum(Node* r) { if (r==nullptr) return 0; else return r->datum + sum(r->left) + sum(r->right) // \u672cdatum\u548c\u5de6\u53f3subtree\u7684sum\u7684\u548c }","title":"24.3.2.4 \u8ba1\u7b97 Tree \u7684\u6240\u6709\u5143\u7d20\u548c"},{"location":"24-Recursion.html#24325-leaves","text":"int numLeaves(Node* r) { if (r == nullptr) // \u8bf4\u660e\u8fd9\u4e2a Node \u662f\u7a7a\u7684, \u4e0d\u662f leaf return 0; else if ((r->left == nullptr) && (r->right = nullptr)) // \u8bf4\u660e\u8fd9\u4e2a Node \u6ca1\u6709 subtree \u4e86, \u56e0\u800c\u81ea\u8eab\u662f\u5355\u4e2a leaf return 1; else // \u8bf4\u660e\u8fd9\u4e2a Node \u8fd8\u6709 subtree, \u56e0\u800c\u662f\u5de6\u53f3 subtree \u4e2d\u7684 leaves \u603b\u6570 return numLeaveds(r->left) + numLeaves(r->right); }","title":"24.3.2.5 \u8ba1\u7b97 Leaves \u7684\u6570\u91cf"},{"location":"24-Recursion.html#24326-tree-val","text":"bool contains(Node *r, int val) { if (r == nullptr) // \u641c\u7d22\u5230\u5e95\u4e86\u8fd8\u6ca1\u6709, \u8fd4\u56de false return false; else return (r->datum == val) || contains(r->left, val) || contains(r->right, val); // \u81ea\u5df1\u662f or \u5de6\u53f3subtree\u91cc\u6709 }","title":"24.3.2.6 \u67e5\u770b tree \u4e2d\u662f\u5426\u6709\u503c\u4e3a val \u7684\u5143\u7d20"},{"location":"24-Recursion.html#24327-traverse-tree","text":"\u6709\u4e09\u79cd common tree traversals: Pre-order(\u524d\u5e8f\u904d\u5386): \u5148 visit curent node \u518d visit \u5176 children in-order(\u4e2d\u5e8f\u904d\u5386): visit current node between visit \u5176 children Post-order(\u540e\u5e8f\u904d\u5386): \u5148 visit \u5176 children \u518d visit current node","title":"24.3.2.7 Traverse \u4e00\u4e2a tree"},{"location":"24-Recursion.html#243271-pre-order-traversal","text":"void preOrder(Node* root) { if (root != nullptr) { // here: process root preOrder(root->left); preOrder(root->right); } }","title":"24.3.2.7.1 pre-order traversal"},{"location":"24-Recursion.html#243272-in-order-traversal","text":"void inOrder(Node* root) { if (root != nullptr) { inOrder(root->left); // here: process root inOrder(root->right); } }","title":"24.3.2.7.2 In-order traversal"},{"location":"24-Recursion.html#243273-post-order-traversal","text":"void postOrder(Node* root) { if (root != nullptr) { postOrder(root->left); postOrder(root->right); // here: process root } }","title":"24.3.2.7.3 Post-order traversal"},{"location":"24-Recursion.html#24328-recursion","text":"\u4e00\u4e2a recursive function \u662f linear recursive \u7684\uff1aif it \u6bcf\u6b21\u81f3\u591a makes one recursive call \u4f8b\u5b50: factorial, list max tail recursive \u7684\uff1a if \u5b83\u662f linear recursive \u7684\uff0c\u5e76\u4e14\u5b83\u7684 recursion call \u662f tail recursion. tree recursive \u7684\uff1aif \u5b83\u53ef\u80fd\u4f1a make more than 1 recursive call. \u4f8b\u5b50: tree size, height \u4e0b\u9762\u662f\u4e00\u4e2a\u5178\u578b\u7684 tree recursive \u7684 function\uff1aFibonacci Sequence. int fib(int n) { if (n <= 1) return n; else return fib(n-1) + fib(n-2); } $$ F(n) = \\begin{cases} 0\\;,\\; n=0\\ 1\\;, \\;n =1 \\ F(n-1) + F(n-2)\\;,\\;n > 1\\end{cases} $$ tree recursive \u7684\u5c31\u662f\u8fc7\u7a0b\u56fe\u662f tree \u7684 recursion\uff1blinear recursive \u7684\u5c31\u662f\u8fc7\u7a0b\u56fe\u662f\u4e00\u6839\u7ebf\u7684 recursion.","title":"24.3.2.8 Recursion \u7684\u7c7b\u578b"},{"location":"25-BST-and-Maps.html","text":"25 Binary Search Tree 25.1 BST \u7684\u5b9a\u4e49\u53ca\u5982\u4f55\u68c0\u6d4b\u4e00\u4e2a tree \u662f\u5426\u662f BST 25.1.1 Def of BST 25.1.2 Thm1: \u5982\u4f55 check \u4e00\u68f5 tree \u662f\u5426\u662f BST 25.2 BST methods 25.2.1 BST max 25.2.2 BST contains 25.2.3 \u63d0\u4e00\u5634: std::less<T> 25.2.4 BST interface 25.2.5 contains \u53ca\u5176 helper function contains_impl 25.3 Set ADT implemented with a BST 25.4 Another ADT: Map 25.4.1 Map 25.4.1.1 \u8868\u793a key-value pair: std::pair 25.4.2 \u4f7f\u7528 BST \u4f5c\u4e3a map \u7684 data representation 25.4.3 \u5e94\u7528: \u4f7f\u7528 map \u8fdb\u884c Word Count 25.4.4 \u9898\u5916\u8bdd: range-based loop 25 Binary Search Tree 25.1 BST \u7684\u5b9a\u4e49\u53ca\u5982\u4f55\u68c0\u6d4b\u4e00\u4e2a tree \u662f\u5426\u662f BST 25.1.1 Def of BST \u56de\u987e\uff1a \u6211\u4eec recursively \u5b9a\u4e49\u4e86\u4e00\u4e2a binary tree \u662f either\uff1a empty \u7684 Or: \u4e00\u4e2a root datum + \u5de6\u53f3\u4e24\u4e2a binary tree as subtree \u73b0\u5728\u6211\u4eec recursively \u5b9a\u4e49 Binary Search Tree : \u4e00\u68f5 binary tree \u662f\u4e00\u68f5 binary search tree, \u5982\u679c\u5b83\u662f either\uff1a Empty \u7684 Or: \u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a (1) Left subtree \u4e2d\u6240\u6709 Elements \u90fd\u6bd4 root datum \u5c0f (2) Right subtree \u4e2d\u6240\u6709 elements \u90fd\u6bd4 root datum \u5927 (3) Left subtree \u548c Right 25.1.2 Thm1: \u5982\u4f55 check \u4e00\u68f5 tree \u662f\u5426\u662f BST Thm: \u4e00\u9897 tree \u4e3a\u4e00\u68f5 Binary Search Tree\uff0c \u5f53\u4e14\u4ec5\u5f53 \u5b83\u7684 in-order traversal(\u4e2d\u5e8f\u904d\u5386) \u662f increasing order \u7684\u3002 25.2 BST methods 25.2.1 BST max By Thm 1\uff0c\u5bb9\u6613\u8bc1\u660e\uff0cBST \u4e2d\u6700\u5927\u7684\u5143\u7d20\u5c31\u662f\u6700\u53f3\u8fb9\u7684\u5143\u7d20\u3002 \u56e0\u800c BST.max \u51fd\u6570\u5c31\u662f\u8fd4\u56de\u6700\u53f3\u8fb9\u7684 datum. \u4e5f\u5c31\u662f\u4ece\u6574\u4e2a BST \u7684 root \u5f00\u59cb\uff0crecursively \u8f6c\u5230\u53f3\u5b50\u6811\u7684 root\uff0c\u76f4\u5230\u53f3\u5b50\u6811\u7684 root \u4e3a nullptr\uff0c\u8bf4\u660e\u8fd9\u91cc\u662f\u6700\u53f3\u8fb9\u7684\u5143\u7d20\u3002 // REQUIRES: 'node' must be a binary search tree that // is not empty (i.e. 'node' is not null) // EFFECTS: Returns the largest element in the tree. int max(Node *node) { if (node->right == nullptr) return node->datum; else return max(node->right); } 25.2.2 BST contains By Thm1\uff0c \u5982\u679c item \u6bd4\u73b0\u5728\u7684 Node \u4e0a\u7684 datum \u5c0f\uff0c\u90a3\u4e48\u5e94\u8be5\u5f80\u5de6\u641c\uff1b \u5982\u679c item \u6bd4\u73b0\u5728\u7684 Node \u4e0a\u7684 datum \u5927\uff0c\u90a3\u4e48\u5e94\u8be5\u5f80\u53f3\u641c\uff1b \u627e\u5230\u5c31 return\uff1b \u5982\u679c\u8fd9\u6837\u627e\u6700\u540e\u53d1\u73b0\u5e94\u8be5\u627e\u7684\u65b9\u5411\u4e0a\u7684\u4e0b\u4e2a Node \u5df2\u7ecf\u662f\u7a7a\u7684\u4e86\uff0c\u90a3\u4e48\u8bf4\u660e BST \u91cc\u9762\u5e76\u6ca1\u6709\u6211\u4eec\u8981\u627e\u7684\u5143\u7d20\uff0c\u5219\u8fd4\u56de false. // REQUIRES: 'node' must be a binary search tree // EFFECTS: Returns whether or not the tree contains the given item. bool contains(Node *node, int item) { if (node == nullptr) return false; else if (item == node->datum) return true; else if (item < node->datum) return contains(node->left, item); else return contains(node->right, item); } 25.2.3 \u63d0\u4e00\u5634: std::less<T> \u901a\u8fc7 #include <functional> \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a std library \u4e2d\u7684\u5b98\u65b9 functor: less . \u56de\u987e\uff1afunctor \u662f\u4e00\u79cd class\uff0c\u901a\u8fc7 overload operator() \u4f7f\u5176 object \u53ef\u4ee5\u8d77\u5230\u51fd\u6570\u4e00\u6837\u7684\u4f5c\u7528\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5efa\u7acb less<Person> \u7684 instance \u6765\u5efa\u7acb\u8d77\u6bd4\u8f83 Person \u7684 functor object. \u5b83\u4f7f\u7528\u7684\u662f\u6211\u4eec\u5728 Person \u4e2d overload \u7684 operator< \uff08\u6211\u4eec\u5fc5\u987b\u8981\u5148\u81ea\u5df1 overload \u624d\u80fd\u7528\uff09 \uff08\u90a3\u4e48\u65e2\u7136\u6211\u4eec\u5df2\u7ecf overload \u4e86 operator< \u4e86\u4e3a\u4ec0\u4e48\u6211\u4eec\u8fd8\u9700\u8981\u8fd9\u4e2a\u591a\u6b64\u4e00\u4e3e\u7684 comparator \u5462\uff1f\u5927\u6982\u662f\u4e3a\u4e86\u4ee3\u7801\u53ef\u8bfb\u6027\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u80fd\u8981\u5728\u540c\u4e00\u4e2a Container \u91cc\u6bd4\u8f83\u4e0d\u540c\u7c7b\u7684 members\u3002\uff09 class Person { private: string name; int age; public: Person(string name_in, int age_in) : name(name_in), age(age_in) { } bool operator<(const Person & other) const { return this->name < other.name; } }; int main() { int x = 5; int y = 6; // \u5efa\u7acb\u4e00\u4e2a less<int> \u7c7b\u7684 int comparator less<int> intComparator; // \u4e0b\u9762\u4e24\u4e2a\u7ed3\u679c\u662f\u4e00\u6837\u7684 cout << intComparator(x, y); cout << (x < y); Person p1(\"Alice\", 20); Person p2(\"Bob\", 18); // \u5efa\u7acb\u4e00\u4e2a less<Person> \u7c7b\u7684 Person comparator less<Person> personComparator; // \u4e0b\u9762\u4e24\u4e2a\u7ed3\u679c\u662f\u4e00\u6837\u7684 cout << personComparator(p1, p2); cout << (p1 < p2); return 0; } 25.2.4 BST interface \u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u6240\u6709\u7684 preliminary\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u6784\u5efa BST \u7684 interface. \u6ce8\u610f\u5230\uff0c\u6211\u4eec\u8fd9\u91cc\u5199\u7684 BST \u5199\u4e86\u4e24\u4e2a template parameter\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u53ea\u6709\u4e00\u4e2a\u3002\u7b2c\u4e00\u4e2a\u662f Container \u91cc\u7684\u6570\u636e\u7c7b\u578b T \uff0c\u53e6\u4e00\u4e2a\u662f\u5b83\u7684 Comparator std::less<T> .\uff0c\u4f46\u662f\u540e\u9762\u7684 std::less<T> \u4e5f\u662f\u53d6\u51b3\u4e8e\u7b2c\u4e00\u4e2a\u53c2\u6570 T \u7684\uff0c\u56e0\u800c\u53ea\u6709 T \u8d77\u5230\u4f5c\u7528\u3002 \u8fd9\u91cc\u5199\u4e24\u4e2a parameter \u7684\u4f5c\u7528\u662f\u76f4\u63a5\u628a\u7b2c\u4e8c\u4e2a\u5b9a\u4e49\u4e3a Compare = std::less<T> \uff0c\u4e8e\u662f\u589e\u52a0\u4e86\u4ee3\u7801\u53ef\u8bfb\u6027\uff1a\u5728 implementation \u4e2d\u4e0d\u9700\u8981 declare \u5f62\u5982 std::less<T> less \u800c\u662f\u76f4\u63a5\u4f7f\u7528 Compare less; \u8fd9\u79cd\u5f62\u5f0f\u6765 declare \u4e00\u4e2a Comparator object. \u5e76\u4e14\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u7c7b\u4f3c\u5b8f\u7684\u5b9a\u4e49\uff0c\u6211\u4eec declare \u4e00\u4e2a BST object \u5e76\u4e0d\u9700\u8981\u5199\u5f62\u5982 BinarySearchTree<something, std::less<something>> tree; \u8fd9\u6837\u5b50\u7684\u5f62\u5f0f\uff0c\u800c\u662f\u4e0d\u8bba Container \u91cc\u9762\u7684\u6570\u636e\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u4f7f\u7528 BinarySearchTree<something, Compare> tree; \u8fd9\u79cd\u5f62\u5f0f\u5c31\u53ef\u4ee5 template <typename T, typename Compare=std::less<T> > class BinarySearchTree { public: BinarySearchTree(); // \u4ee5\u4e0b\u4e3a Big Three BinarySearchTree(const BinarySearchTree &other); BinarySearchTree & operator=(const BinarySearchTree &other); ~BinarySearchTree(); // \u4ee5\u4e0b\u4e3a 4 \u4e2a usage functions bool empty() const; int size() const; bool contains(const T &item) const; void insert(const T &item); private: // 1. Node \u7ed3\u6784 struct Node { T datum; Node *left, *right; }; // 2. \u6574\u4e2a BST \u7684 root* Node *root; // 3. \u4e00\u4e2a Comparator, \u5df2\u7ecf\u5728 typename \u4e2d\u58f0\u660e\u4e86 Compare=std::less<T>, \u53d6\u51b3\u4e8e T Compare less; // 4. contains() \u7684 helper function static bool contains_impl(Node *node, const T &item, Compare less); }; 25.2.5 contains \u53ca\u5176 helper function contains_impl \u6211\u4eec\u9700\u8981 helper function \u7684\u539f\u56e0\u662f\u4e3a\u4e86\u8282\u7701 space cost. \u56e0\u4e3a\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u6ca1\u6709 helper function\uff0c\u90a3\u4e48 contains \u8981\u5224\u65ad\u4e09\u79cd\u60c5\u51b5\uff0c\u56e0\u800c\u5b83\u4e0d\u662f tail recursion\uff08stack frame \u4e0d\u5f97\u4e0d\u540c\u65f6\u5b58\u5728\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u91c7\u7528 helper function \u6765\u4f18\u5316 contains \u7684 space cost \u4e3a $O(1)$. \u5199\u4e0b\u8fd9\u4e2a helper function comtains_impl . template <typename T, typename Compare> bool BinarySearchTree<T, Complare>::contains_impl(Node *node, const T &item, Compare less) { if (node == nullptr) return false; else if (less(item, node-> datum)) return contains_impl(node->left, item, less); else if (less(node->datum, item)) return contains_impl(node->right, item, less); else return true; // \u56e0\u4e3a\u6ca1\u6709 overload operator==, \u628a found item \u4f5c\u4e3a else } \u4e8e\u662f\u6211\u4eec\u5c31\u628a contains \u4f18\u5316\u6210\u4e86 time complexity \u4e0d\u53d8\u4f46\u662f space cost \u51cf\u5c11\u4e3a\u4e86 $O(1)$ \u7684 tail recursion function\u3002 template <typename T, typename Compare> bool BinarySearchTree<T, Compare>::contains(const T &item) const { return contains_impl(root, item, less); } 25.3 Set ADT implemented with a BST \u539f\u672c\u7684 UnsortedSet \u548c SortedSet \u90fd\u662f\u4f7f\u7528 Dynamic Array \u5b9e\u73b0\u7684\uff0c\u800c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u4f7f\u7528 BST \u5b9e\u73b0\u7684 BST Set. \u4e5f\u5c31\u662f\u8bf4\uff1a\u6211\u4eec\u7528\u4e00\u4e2a BST \u4f5c\u4e3a data representation \u6765\u5b58\u50a8\u8fd9\u4e2a Set \u7684\u5185\u90e8\u6570\u636e\uff1b\u4f7f\u7528 BST methods \u6765 implement set \u7684\u5404\u79cd\u51fd\u6570\u3002 template <typename T> class BSTSet { public: void insert(const T &v) { if (!elts.contains(v)) elts.insert(v); } bool contains(const T &v) const { return elts.contains(v); } int size() const { return elts.size(); } private: BinarySearchTree<T> elts; }; \u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff1a 25.4 Another ADT: Map 25.4.1 Map Map \u5c31\u50cf\u662f Python \u4e2d\u7684 dictionary\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a key-value pair. key \u662f\u7528\u6765 look up item \u4ee5\u53ca insert item \u7684\uff0c\u800c value \u5219\u662f item \u7684\u503c\u3002 \u6211\u4eec\u53ef\u4ee5\u5199 template map\uff0c\u8fd9\u6837 key \u548c value \u7684\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u4efb\u9009\u3002 \u6bd4\u5982: \u5e76\u4e14 map \u7684\u65b9\u4fbf\u4e4b\u5904\u5728\u4e8e\u63d2\u5165 data \u548c\u67e5\u8be2 data \u7684\u65b9\u5f0f\u90fd\u662f somemap[\"somekey\"] = somevalue \uff0c\u548c Python \u91cc\u4e00\u6837\u3002 int main() { map<string, int> scores; scores[\"aliceywu\"] = 100; scores[\"akamil\"] = 23; scores[\"taligoro\"] = 100; scores[\"jjuett\"] = 73; cout << scores[\"akamil\"] << endl; cout << scores[\"aliceywu\"] << endl; } 25.4.1.1 \u8868\u793a key-value pair: std::pair std::pair \u662f\u4e00\u4e2a STL class template\uff0c\u7528\u6765\u5b58\u50a8 a pair of objects\uff0c \u53ef\u4ee5\u662f\u4e0d\u540c\u7684 type. \u6211\u4eec\u5728 declare \u7684\u65f6\u5019\u7528 std::pair<type1, type2> \u5206\u522b\u8868\u793a\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e8c\u4e2a\u6570\u636e\u7684\u7c7b\u578b\u3002 access \u7b2c\u4e00\uff0c\u7b2c\u4e8c\u4e2a\u5143\u7d20\u7684\u65b9\u6cd5\u5c31\u662f\u5c31\u662f .first \u548c .second . std::pair<int, bool> p1; p1.first = 5; p1.second = false; std::pair<string, int> p2; p2.first = \"hello\"; p2.second = 4; 25.4.2 \u4f7f\u7528 BST \u4f5c\u4e3a map \u7684 data representation \u6211\u4eec\u7528 string \u4e2d\u7684\u5b57\u6bcd\u5927\u5c0f\u4f5c\u4e3a BST \u7684 Compare \u5bf9\u5e94\u7684\u7c7b\u578b\uff0c\u4ee5\u4f7f\u7528 BST \u6765\u5b58\u50a8\u4e00\u4e2a map. template <typename Key_type, typename Value_type, typename Key_compare=std::less<Key_type> // default argument > class Map { private: using Pair_type = std::pair<Key_type, Value_type>; class PairComp { private: Key_compare lessTo; public: bool operator() (Pair_type lhs, Pair_type rhs) { return lessTo(lhs.first, rhs.first); } }; public: using Iterator = typename BinarySearchTree<Pair_type, PairComp>::Iterator; // EFFECTS : Returns whether this Map is empty. bool empty() const { return bst.empty(); } // EFFECTS : Returns the number of elements in this Map. // NOTE : size_t is an integral type from the STL size_t size() const { return bst.size(); } // EFFECTS : Searches this Map for an element with a key equivalent // to k and returns an Iterator to the associated value if found, // otherwise returns an end Iterator. // // HINT: Since Map is implemented using a BinarySearchTree that stores // (key, value) pairs, you'll need to construct a dummy value // using \"Value_type()\". Iterator find(const Key_type& k) const { Pair_type soldier = {k, Value_type()}; return bst.find(soldier); } // MODIFIES: this // EFFECTS : Returns a reference to the mapped value for the given // key. If k matches the key of an element in the // container, the function returns a reference to its // mapped value. If k does not match the key of any // element in the container, the function inserts a new // element with that key and a value-initialized mapped // value and returns a reference to the mapped value. // Note: value-initialization for numeric types guarantees the // value will be 0 (rather than memory junk). Value_type& operator[](const Key_type& k) { Iterator thing = find(k); if (thing != end()) { return find(k)->second; } else { Pair_type p = {k, Value_type()}; Iterator i = bst.insert(p); return i->second; } } // MODIFIES: this // EFFECTS : Inserts the given element into this Map if the given key // is not already contained in the Map. If the key is // already in the Map, returns an iterator to the // corresponding existing element, along with the value // false. Otherwise, inserts the given element and returns // an iterator to the newly inserted element, along with // the value true. std::pair<Iterator, bool> insert(const Pair_type &val) { Iterator thing = find(val.first); if (thing != end()) { return {find(val.first), false}; } else { return {bst.insert(val), true}; } } // EFFECTS : Returns an iterator to the first key-value pair in this Map. Iterator begin() const { return bst.begin(); } // EFFECTS : Returns an iterator to \"past-the-end\". Iterator end() const { return bst.end(); } private: // Add a BinarySearchTree private member HERE. BinarySearchTree<Pair_type, PairComp> bst; }; 25.4.3 \u5e94\u7528: \u4f7f\u7528 map \u8fdb\u884c Word Count void printWordCounts(const vector<string> &words) { std::map<string, int> wordCounts; // Each time a word is seen, add 1 to its entry in // the map. If it wasn't there, make a 0 // placeholder and then immediately add 1 to that for (const auto &word : words) { wordCounts[word] += 1; } // Print out results by iterating through the map for (const auto &kv : wordCounts) { const auto &word = kv.first; const auto &count = kv.second; cout << word << \"occurred \" << count << \" times.\" << endl; } } 25.4.4 \u9898\u5916\u8bdd: range-based loop for T item : someContainer \u662f c++ \u7684 range-based loop \u7684\u65b9\u6cd5 \u5b83\u4f1a\u81ea\u52a8\uff1a \u8c03\u7528 someContainer \u7684 class \u7684 begin() \u548c end() \u51fd\u6570\u6765\u83b7\u53d6\u8be5 class \u7684 start \u548c end iterator \u81ea\u52a8 initialize local variable item \uff0c\u6bcf iterate \u4e00\u4e2a someContainer \u4e2d\u7684\u5143\u7d20\u5c31 dereference \u5b83\uff0c\u628a\u8fd9\u4e2a\u5143\u7d20\u7684\u503c\u8d4b\u7ed9 item \uff08\u6ca1\u6709\u5f15\u7528\uff09 \u81ea\u52a8 increment iterator \u4ee5\u4e0b\u4e24\u4e2a\u8868\u8fbe\u7b49\u4ef7\uff1a // usual auto it = vec.begin(); auto end_it = vec.end(); for (; it !=end_it; ++it) { int item = *it; cout << item << endl; } // range-based for (int item : vec) { cout << item << endl; } \u5b83\u4e0d\u540c\u4e8e\u4f7f\u7528 [] \u7b26\u53f7\u7684\u904d\u5386\uff0c\u5982\u679c\u4e0d\u6dfb\u52a0 & \u662f\u4e0d\u4f1a\u6539\u53d8\u539f\u5143\u7d20\u7684\uff0c\u800c\u662f\u5bf9\u6bcf\u4e2a\u5143\u7d20\u521b\u5efa\u4e00\u4efd\u4e34\u65f6\u7684 copy. \u6dfb\u52a0 & \u4e4b\u540e\uff0c for & T item: someContainer \u548c for (it = someContainer.begin(); it != someContainer.end(); ++it) \u662f\u7b49\u4ef7\u7684. int main() { vector<int> vec(5); // vector ctor \u4f1a initialize elements \u503c\u4e3a 0 for (int item : vec) { //\u904d\u5386 vec \u7684\u6bcf\u4e2a\u5143\u7d20\u5e76**\u521b\u5efa\u4e00\u4e2acopy**, \u5bf9 copy \u64cd\u4f5c item = 42; // copy \u7684\u503c\u53d8\u4e86, \u5e76\u6ca1\u6709\u771f\u6b63\u6539\u53d8 vec \u4e2d\u5143\u7d20\u7684\u503c } for (int item : vec) { cout << item << \" \"; // 0 0 0 0 0 } for (int & item : vec) { // \u6dfb\u52a0 &: \u5f15\u7528 Container\u4e2d\u539f\u672c\u7684\u5143\u7d20\u6765\u64cd\u4f5c item = 42; } for (int item : vec) { cout << item << \" \"; // 42 42 42 42 42 } }","title":"Overview"},{"location":"25-BST-and-Maps.html#25-binary-search-tree","text":"","title":"25 Binary Search Tree"},{"location":"25-BST-and-Maps.html#251-bst-tree-bst","text":"","title":"25.1 BST \u7684\u5b9a\u4e49\u53ca\u5982\u4f55\u68c0\u6d4b\u4e00\u4e2a tree \u662f\u5426\u662f BST"},{"location":"25-BST-and-Maps.html#2511-def-of-bst","text":"\u56de\u987e\uff1a \u6211\u4eec recursively \u5b9a\u4e49\u4e86\u4e00\u4e2a binary tree \u662f either\uff1a empty \u7684 Or: \u4e00\u4e2a root datum + \u5de6\u53f3\u4e24\u4e2a binary tree as subtree \u73b0\u5728\u6211\u4eec recursively \u5b9a\u4e49 Binary Search Tree : \u4e00\u68f5 binary tree \u662f\u4e00\u68f5 binary search tree, \u5982\u679c\u5b83\u662f either\uff1a Empty \u7684 Or: \u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a (1) Left subtree \u4e2d\u6240\u6709 Elements \u90fd\u6bd4 root datum \u5c0f (2) Right subtree \u4e2d\u6240\u6709 elements \u90fd\u6bd4 root datum \u5927 (3) Left subtree \u548c Right","title":"25.1.1 Def of BST"},{"location":"25-BST-and-Maps.html#2512-thm1-check-tree-bst","text":"Thm: \u4e00\u9897 tree \u4e3a\u4e00\u68f5 Binary Search Tree\uff0c \u5f53\u4e14\u4ec5\u5f53 \u5b83\u7684 in-order traversal(\u4e2d\u5e8f\u904d\u5386) \u662f increasing order \u7684\u3002","title":"25.1.2 Thm1: \u5982\u4f55 check \u4e00\u68f5 tree \u662f\u5426\u662f BST"},{"location":"25-BST-and-Maps.html#252-bst-methods","text":"","title":"25.2 BST methods"},{"location":"25-BST-and-Maps.html#2521-bst-max","text":"By Thm 1\uff0c\u5bb9\u6613\u8bc1\u660e\uff0cBST \u4e2d\u6700\u5927\u7684\u5143\u7d20\u5c31\u662f\u6700\u53f3\u8fb9\u7684\u5143\u7d20\u3002 \u56e0\u800c BST.max \u51fd\u6570\u5c31\u662f\u8fd4\u56de\u6700\u53f3\u8fb9\u7684 datum. \u4e5f\u5c31\u662f\u4ece\u6574\u4e2a BST \u7684 root \u5f00\u59cb\uff0crecursively \u8f6c\u5230\u53f3\u5b50\u6811\u7684 root\uff0c\u76f4\u5230\u53f3\u5b50\u6811\u7684 root \u4e3a nullptr\uff0c\u8bf4\u660e\u8fd9\u91cc\u662f\u6700\u53f3\u8fb9\u7684\u5143\u7d20\u3002 // REQUIRES: 'node' must be a binary search tree that // is not empty (i.e. 'node' is not null) // EFFECTS: Returns the largest element in the tree. int max(Node *node) { if (node->right == nullptr) return node->datum; else return max(node->right); }","title":"25.2.1 BST max"},{"location":"25-BST-and-Maps.html#2522-bst-contains","text":"By Thm1\uff0c \u5982\u679c item \u6bd4\u73b0\u5728\u7684 Node \u4e0a\u7684 datum \u5c0f\uff0c\u90a3\u4e48\u5e94\u8be5\u5f80\u5de6\u641c\uff1b \u5982\u679c item \u6bd4\u73b0\u5728\u7684 Node \u4e0a\u7684 datum \u5927\uff0c\u90a3\u4e48\u5e94\u8be5\u5f80\u53f3\u641c\uff1b \u627e\u5230\u5c31 return\uff1b \u5982\u679c\u8fd9\u6837\u627e\u6700\u540e\u53d1\u73b0\u5e94\u8be5\u627e\u7684\u65b9\u5411\u4e0a\u7684\u4e0b\u4e2a Node \u5df2\u7ecf\u662f\u7a7a\u7684\u4e86\uff0c\u90a3\u4e48\u8bf4\u660e BST \u91cc\u9762\u5e76\u6ca1\u6709\u6211\u4eec\u8981\u627e\u7684\u5143\u7d20\uff0c\u5219\u8fd4\u56de false. // REQUIRES: 'node' must be a binary search tree // EFFECTS: Returns whether or not the tree contains the given item. bool contains(Node *node, int item) { if (node == nullptr) return false; else if (item == node->datum) return true; else if (item < node->datum) return contains(node->left, item); else return contains(node->right, item); }","title":"25.2.2 BST contains"},{"location":"25-BST-and-Maps.html#2523-stdlesst","text":"\u901a\u8fc7 #include <functional> \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a std library \u4e2d\u7684\u5b98\u65b9 functor: less . \u56de\u987e\uff1afunctor \u662f\u4e00\u79cd class\uff0c\u901a\u8fc7 overload operator() \u4f7f\u5176 object \u53ef\u4ee5\u8d77\u5230\u51fd\u6570\u4e00\u6837\u7684\u4f5c\u7528\u3002 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5efa\u7acb less<Person> \u7684 instance \u6765\u5efa\u7acb\u8d77\u6bd4\u8f83 Person \u7684 functor object. \u5b83\u4f7f\u7528\u7684\u662f\u6211\u4eec\u5728 Person \u4e2d overload \u7684 operator< \uff08\u6211\u4eec\u5fc5\u987b\u8981\u5148\u81ea\u5df1 overload \u624d\u80fd\u7528\uff09 \uff08\u90a3\u4e48\u65e2\u7136\u6211\u4eec\u5df2\u7ecf overload \u4e86 operator< \u4e86\u4e3a\u4ec0\u4e48\u6211\u4eec\u8fd8\u9700\u8981\u8fd9\u4e2a\u591a\u6b64\u4e00\u4e3e\u7684 comparator \u5462\uff1f\u5927\u6982\u662f\u4e3a\u4e86\u4ee3\u7801\u53ef\u8bfb\u6027\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u80fd\u8981\u5728\u540c\u4e00\u4e2a Container \u91cc\u6bd4\u8f83\u4e0d\u540c\u7c7b\u7684 members\u3002\uff09 class Person { private: string name; int age; public: Person(string name_in, int age_in) : name(name_in), age(age_in) { } bool operator<(const Person & other) const { return this->name < other.name; } }; int main() { int x = 5; int y = 6; // \u5efa\u7acb\u4e00\u4e2a less<int> \u7c7b\u7684 int comparator less<int> intComparator; // \u4e0b\u9762\u4e24\u4e2a\u7ed3\u679c\u662f\u4e00\u6837\u7684 cout << intComparator(x, y); cout << (x < y); Person p1(\"Alice\", 20); Person p2(\"Bob\", 18); // \u5efa\u7acb\u4e00\u4e2a less<Person> \u7c7b\u7684 Person comparator less<Person> personComparator; // \u4e0b\u9762\u4e24\u4e2a\u7ed3\u679c\u662f\u4e00\u6837\u7684 cout << personComparator(p1, p2); cout << (p1 < p2); return 0; }","title":"25.2.3 \u63d0\u4e00\u5634: std::less&lt;T&gt;"},{"location":"25-BST-and-Maps.html#2524-bst-interface","text":"\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u6240\u6709\u7684 preliminary\uff0c\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u6784\u5efa BST \u7684 interface. \u6ce8\u610f\u5230\uff0c\u6211\u4eec\u8fd9\u91cc\u5199\u7684 BST \u5199\u4e86\u4e24\u4e2a template parameter\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u53ea\u6709\u4e00\u4e2a\u3002\u7b2c\u4e00\u4e2a\u662f Container \u91cc\u7684\u6570\u636e\u7c7b\u578b T \uff0c\u53e6\u4e00\u4e2a\u662f\u5b83\u7684 Comparator std::less<T> .\uff0c\u4f46\u662f\u540e\u9762\u7684 std::less<T> \u4e5f\u662f\u53d6\u51b3\u4e8e\u7b2c\u4e00\u4e2a\u53c2\u6570 T \u7684\uff0c\u56e0\u800c\u53ea\u6709 T \u8d77\u5230\u4f5c\u7528\u3002 \u8fd9\u91cc\u5199\u4e24\u4e2a parameter \u7684\u4f5c\u7528\u662f\u76f4\u63a5\u628a\u7b2c\u4e8c\u4e2a\u5b9a\u4e49\u4e3a Compare = std::less<T> \uff0c\u4e8e\u662f\u589e\u52a0\u4e86\u4ee3\u7801\u53ef\u8bfb\u6027\uff1a\u5728 implementation \u4e2d\u4e0d\u9700\u8981 declare \u5f62\u5982 std::less<T> less \u800c\u662f\u76f4\u63a5\u4f7f\u7528 Compare less; \u8fd9\u79cd\u5f62\u5f0f\u6765 declare \u4e00\u4e2a Comparator object. \u5e76\u4e14\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u7c7b\u4f3c\u5b8f\u7684\u5b9a\u4e49\uff0c\u6211\u4eec declare \u4e00\u4e2a BST object \u5e76\u4e0d\u9700\u8981\u5199\u5f62\u5982 BinarySearchTree<something, std::less<something>> tree; \u8fd9\u6837\u5b50\u7684\u5f62\u5f0f\uff0c\u800c\u662f\u4e0d\u8bba Container \u91cc\u9762\u7684\u6570\u636e\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u4f7f\u7528 BinarySearchTree<something, Compare> tree; \u8fd9\u79cd\u5f62\u5f0f\u5c31\u53ef\u4ee5 template <typename T, typename Compare=std::less<T> > class BinarySearchTree { public: BinarySearchTree(); // \u4ee5\u4e0b\u4e3a Big Three BinarySearchTree(const BinarySearchTree &other); BinarySearchTree & operator=(const BinarySearchTree &other); ~BinarySearchTree(); // \u4ee5\u4e0b\u4e3a 4 \u4e2a usage functions bool empty() const; int size() const; bool contains(const T &item) const; void insert(const T &item); private: // 1. Node \u7ed3\u6784 struct Node { T datum; Node *left, *right; }; // 2. \u6574\u4e2a BST \u7684 root* Node *root; // 3. \u4e00\u4e2a Comparator, \u5df2\u7ecf\u5728 typename \u4e2d\u58f0\u660e\u4e86 Compare=std::less<T>, \u53d6\u51b3\u4e8e T Compare less; // 4. contains() \u7684 helper function static bool contains_impl(Node *node, const T &item, Compare less); };","title":"25.2.4 BST interface"},{"location":"25-BST-and-Maps.html#2525-contains-helper-function-contains_impl","text":"\u6211\u4eec\u9700\u8981 helper function \u7684\u539f\u56e0\u662f\u4e3a\u4e86\u8282\u7701 space cost. \u56e0\u4e3a\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u6ca1\u6709 helper function\uff0c\u90a3\u4e48 contains \u8981\u5224\u65ad\u4e09\u79cd\u60c5\u51b5\uff0c\u56e0\u800c\u5b83\u4e0d\u662f tail recursion\uff08stack frame \u4e0d\u5f97\u4e0d\u540c\u65f6\u5b58\u5728\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u91c7\u7528 helper function \u6765\u4f18\u5316 contains \u7684 space cost \u4e3a $O(1)$. \u5199\u4e0b\u8fd9\u4e2a helper function comtains_impl . template <typename T, typename Compare> bool BinarySearchTree<T, Complare>::contains_impl(Node *node, const T &item, Compare less) { if (node == nullptr) return false; else if (less(item, node-> datum)) return contains_impl(node->left, item, less); else if (less(node->datum, item)) return contains_impl(node->right, item, less); else return true; // \u56e0\u4e3a\u6ca1\u6709 overload operator==, \u628a found item \u4f5c\u4e3a else } \u4e8e\u662f\u6211\u4eec\u5c31\u628a contains \u4f18\u5316\u6210\u4e86 time complexity \u4e0d\u53d8\u4f46\u662f space cost \u51cf\u5c11\u4e3a\u4e86 $O(1)$ \u7684 tail recursion function\u3002 template <typename T, typename Compare> bool BinarySearchTree<T, Compare>::contains(const T &item) const { return contains_impl(root, item, less); }","title":"25.2.5 contains \u53ca\u5176 helper function contains_impl"},{"location":"25-BST-and-Maps.html#253-set-adt-implemented-with-a-bst","text":"\u539f\u672c\u7684 UnsortedSet \u548c SortedSet \u90fd\u662f\u4f7f\u7528 Dynamic Array \u5b9e\u73b0\u7684\uff0c\u800c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u4f7f\u7528 BST \u5b9e\u73b0\u7684 BST Set. \u4e5f\u5c31\u662f\u8bf4\uff1a\u6211\u4eec\u7528\u4e00\u4e2a BST \u4f5c\u4e3a data representation \u6765\u5b58\u50a8\u8fd9\u4e2a Set \u7684\u5185\u90e8\u6570\u636e\uff1b\u4f7f\u7528 BST methods \u6765 implement set \u7684\u5404\u79cd\u51fd\u6570\u3002 template <typename T> class BSTSet { public: void insert(const T &v) { if (!elts.contains(v)) elts.insert(v); } bool contains(const T &v) const { return elts.contains(v); } int size() const { return elts.size(); } private: BinarySearchTree<T> elts; }; \u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff1a","title":"25.3 Set ADT implemented with a BST"},{"location":"25-BST-and-Maps.html#254-another-adt-map","text":"","title":"25.4 Another ADT: Map"},{"location":"25-BST-and-Maps.html#2541-map","text":"Map \u5c31\u50cf\u662f Python \u4e2d\u7684 dictionary\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a key-value pair. key \u662f\u7528\u6765 look up item \u4ee5\u53ca insert item \u7684\uff0c\u800c value \u5219\u662f item \u7684\u503c\u3002 \u6211\u4eec\u53ef\u4ee5\u5199 template map\uff0c\u8fd9\u6837 key \u548c value \u7684\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u4efb\u9009\u3002 \u6bd4\u5982: \u5e76\u4e14 map \u7684\u65b9\u4fbf\u4e4b\u5904\u5728\u4e8e\u63d2\u5165 data \u548c\u67e5\u8be2 data \u7684\u65b9\u5f0f\u90fd\u662f somemap[\"somekey\"] = somevalue \uff0c\u548c Python \u91cc\u4e00\u6837\u3002 int main() { map<string, int> scores; scores[\"aliceywu\"] = 100; scores[\"akamil\"] = 23; scores[\"taligoro\"] = 100; scores[\"jjuett\"] = 73; cout << scores[\"akamil\"] << endl; cout << scores[\"aliceywu\"] << endl; }","title":"25.4.1 Map"},{"location":"25-BST-and-Maps.html#25411-key-value-pair-stdpair","text":"std::pair \u662f\u4e00\u4e2a STL class template\uff0c\u7528\u6765\u5b58\u50a8 a pair of objects\uff0c \u53ef\u4ee5\u662f\u4e0d\u540c\u7684 type. \u6211\u4eec\u5728 declare \u7684\u65f6\u5019\u7528 std::pair<type1, type2> \u5206\u522b\u8868\u793a\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e8c\u4e2a\u6570\u636e\u7684\u7c7b\u578b\u3002 access \u7b2c\u4e00\uff0c\u7b2c\u4e8c\u4e2a\u5143\u7d20\u7684\u65b9\u6cd5\u5c31\u662f\u5c31\u662f .first \u548c .second . std::pair<int, bool> p1; p1.first = 5; p1.second = false; std::pair<string, int> p2; p2.first = \"hello\"; p2.second = 4;","title":"25.4.1.1 \u8868\u793a key-value pair: std::pair"},{"location":"25-BST-and-Maps.html#2542-bst-map-data-representation","text":"\u6211\u4eec\u7528 string \u4e2d\u7684\u5b57\u6bcd\u5927\u5c0f\u4f5c\u4e3a BST \u7684 Compare \u5bf9\u5e94\u7684\u7c7b\u578b\uff0c\u4ee5\u4f7f\u7528 BST \u6765\u5b58\u50a8\u4e00\u4e2a map. template <typename Key_type, typename Value_type, typename Key_compare=std::less<Key_type> // default argument > class Map { private: using Pair_type = std::pair<Key_type, Value_type>; class PairComp { private: Key_compare lessTo; public: bool operator() (Pair_type lhs, Pair_type rhs) { return lessTo(lhs.first, rhs.first); } }; public: using Iterator = typename BinarySearchTree<Pair_type, PairComp>::Iterator; // EFFECTS : Returns whether this Map is empty. bool empty() const { return bst.empty(); } // EFFECTS : Returns the number of elements in this Map. // NOTE : size_t is an integral type from the STL size_t size() const { return bst.size(); } // EFFECTS : Searches this Map for an element with a key equivalent // to k and returns an Iterator to the associated value if found, // otherwise returns an end Iterator. // // HINT: Since Map is implemented using a BinarySearchTree that stores // (key, value) pairs, you'll need to construct a dummy value // using \"Value_type()\". Iterator find(const Key_type& k) const { Pair_type soldier = {k, Value_type()}; return bst.find(soldier); } // MODIFIES: this // EFFECTS : Returns a reference to the mapped value for the given // key. If k matches the key of an element in the // container, the function returns a reference to its // mapped value. If k does not match the key of any // element in the container, the function inserts a new // element with that key and a value-initialized mapped // value and returns a reference to the mapped value. // Note: value-initialization for numeric types guarantees the // value will be 0 (rather than memory junk). Value_type& operator[](const Key_type& k) { Iterator thing = find(k); if (thing != end()) { return find(k)->second; } else { Pair_type p = {k, Value_type()}; Iterator i = bst.insert(p); return i->second; } } // MODIFIES: this // EFFECTS : Inserts the given element into this Map if the given key // is not already contained in the Map. If the key is // already in the Map, returns an iterator to the // corresponding existing element, along with the value // false. Otherwise, inserts the given element and returns // an iterator to the newly inserted element, along with // the value true. std::pair<Iterator, bool> insert(const Pair_type &val) { Iterator thing = find(val.first); if (thing != end()) { return {find(val.first), false}; } else { return {bst.insert(val), true}; } } // EFFECTS : Returns an iterator to the first key-value pair in this Map. Iterator begin() const { return bst.begin(); } // EFFECTS : Returns an iterator to \"past-the-end\". Iterator end() const { return bst.end(); } private: // Add a BinarySearchTree private member HERE. BinarySearchTree<Pair_type, PairComp> bst; };","title":"25.4.2 \u4f7f\u7528 BST \u4f5c\u4e3a map \u7684 data representation"},{"location":"25-BST-and-Maps.html#2543-map-word-count","text":"void printWordCounts(const vector<string> &words) { std::map<string, int> wordCounts; // Each time a word is seen, add 1 to its entry in // the map. If it wasn't there, make a 0 // placeholder and then immediately add 1 to that for (const auto &word : words) { wordCounts[word] += 1; } // Print out results by iterating through the map for (const auto &kv : wordCounts) { const auto &word = kv.first; const auto &count = kv.second; cout << word << \"occurred \" << count << \" times.\" << endl; } }","title":"25.4.3 \u5e94\u7528: \u4f7f\u7528 map \u8fdb\u884c Word Count"},{"location":"25-BST-and-Maps.html#2544-range-based-loop","text":"for T item : someContainer \u662f c++ \u7684 range-based loop \u7684\u65b9\u6cd5 \u5b83\u4f1a\u81ea\u52a8\uff1a \u8c03\u7528 someContainer \u7684 class \u7684 begin() \u548c end() \u51fd\u6570\u6765\u83b7\u53d6\u8be5 class \u7684 start \u548c end iterator \u81ea\u52a8 initialize local variable item \uff0c\u6bcf iterate \u4e00\u4e2a someContainer \u4e2d\u7684\u5143\u7d20\u5c31 dereference \u5b83\uff0c\u628a\u8fd9\u4e2a\u5143\u7d20\u7684\u503c\u8d4b\u7ed9 item \uff08\u6ca1\u6709\u5f15\u7528\uff09 \u81ea\u52a8 increment iterator \u4ee5\u4e0b\u4e24\u4e2a\u8868\u8fbe\u7b49\u4ef7\uff1a // usual auto it = vec.begin(); auto end_it = vec.end(); for (; it !=end_it; ++it) { int item = *it; cout << item << endl; } // range-based for (int item : vec) { cout << item << endl; } \u5b83\u4e0d\u540c\u4e8e\u4f7f\u7528 [] \u7b26\u53f7\u7684\u904d\u5386\uff0c\u5982\u679c\u4e0d\u6dfb\u52a0 & \u662f\u4e0d\u4f1a\u6539\u53d8\u539f\u5143\u7d20\u7684\uff0c\u800c\u662f\u5bf9\u6bcf\u4e2a\u5143\u7d20\u521b\u5efa\u4e00\u4efd\u4e34\u65f6\u7684 copy. \u6dfb\u52a0 & \u4e4b\u540e\uff0c for & T item: someContainer \u548c for (it = someContainer.begin(); it != someContainer.end(); ++it) \u662f\u7b49\u4ef7\u7684. int main() { vector<int> vec(5); // vector ctor \u4f1a initialize elements \u503c\u4e3a 0 for (int item : vec) { //\u904d\u5386 vec \u7684\u6bcf\u4e2a\u5143\u7d20\u5e76**\u521b\u5efa\u4e00\u4e2acopy**, \u5bf9 copy \u64cd\u4f5c item = 42; // copy \u7684\u503c\u53d8\u4e86, \u5e76\u6ca1\u6709\u771f\u6b63\u6539\u53d8 vec \u4e2d\u5143\u7d20\u7684\u503c } for (int item : vec) { cout << item << \" \"; // 0 0 0 0 0 } for (int & item : vec) { // \u6dfb\u52a0 &: \u5f15\u7528 Container\u4e2d\u539f\u672c\u7684\u5143\u7d20\u6765\u64cd\u4f5c item = 42; } for (int item : vec) { cout << item << \" \"; // 42 42 42 42 42 } }","title":"25.4.4 \u9898\u5916\u8bdd: range-based loop"},{"location":"280-midterm-cheatsheet.html","text":"1. Array and Pointer p[i] \u7b49\u4e8e *(p + i) \u7b49\u4e8e i[p] *(ptr + x) \u662f\u5728 *ptr \u7684\u524d\u65b9\u7b2c x \u4e2a *ptr \u7c7b\u578b\u7684 object\uff0c\u4e5f\u5c31\u662f\u524d\u65b9 sizeof(*ptr) \u4e2a\u5730\u5740\u4e0a\u7684 object. ptr1 - ptr2 \u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a ptr1 \u548c ptr2 \u50a8\u5b58\u7684\u5730\u5740\u4e4b\u95f4\u6709\u591a\u5c11\u4e2a *ptr \u7c7b\u578b\u7684 object. pointer \u7684 > , < , == \u6bd4\u8f83\u7684\u662f\u5730\u5740\u5927\u5c0f\uff0c\u5730\u5740\u8d8a\u5f80\u540e\u8d8a\u5927. \u5bf9\u4e8e\u4e24\u4e2a array\uff0c arr1 = arr2 \u662f\u62a5\u9519\u7684\uff0c\u56e0\u4e3a\u53f3\u8fb9 array decay \u6210\u4e86\u4e00\u4e2a\u6307\u5411\u5176\u9996\u5143\u7d20\u7684 pointer\uff0c\u800c\u5de6\u8fb9\u662f\u4e00\u4e2a array. std \u6ca1\u6709\u8fd9\u6837\u7684 operator= overload. 2. const keyword const forbids assignment\uff0c\u4ec5\u652f\u6301 Initialization const pointer : \u5f62\u5982 int * const ptr = &x; \uff0c\u503c\u5728 initialization \u4e4b\u540e\u5c31\u4e0d\u80fd\u53d8\u4e86. \u4e5f\u5c31\u662f \u5b83\u88c5\u7684 address \u4e0d\u80fd\u53d8 \uff0c\u4f46\u662f\u5b83\u88c5\u7684 address \u4e0b\u7684\u53d8\u91cf\u662f\u53ef\u4ee5\u53d8\u7684\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u89e3\u5f15\u7528\u5b83\u6765\u66f4\u6539\u5b83\u6307\u5411\u7684 object \u7684\u503c pointer to const : \u5f62\u5982 const int * ptr = &x; \u6216 int const * ptr = &x \uff0c\u503c\u53ef\u4ee5\u53d8\uff0c\u4e5f\u5c31\u662f\u5b83\u53ef\u4ee5\u91cd\u65b0\u6307\u5411\u522b\u7684\u5730\u5740\uff0c\u4f46\u662f\u8fd9\u4e2a\u6307\u5411\u7684\u884c\u4e3a\u662f const \u7684 x \u4e0d\u662f const \u53d8\u91cf\uff0c\u8fd8\u662f\u53ef\u4ee5\u6539\u53d8 x \u7684\u503c\uff0c\u4f46\u662f \u4e0d\u80fd dereference ptr \u6765\u6539\u53d8 x \u7684\u503c. \u5982\u679c\u8981\u6307\u5411\u4e00\u4e2a const variable\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528 ptr-to-const \u4e0d\u5141\u8bb8\u628a\u4e00\u4e2a pointer-to-const \u6216\u8005 const pointer \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a \u666e\u901a\u7684 pointer\u3002\uff08\u628a const int \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a\u666e\u901a int \u662f\u53ef\u4ee5\u7684\uff09 c++ void func1(const int *ptr) { // ptr-to-const, \u4e0d\u80fd\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c } void func2(int * const ptr) { // const ptr, \u6307\u5411\u7684\u5730\u5740\u4e0d\u80fd\u6539\u53d8, \u53ef\u4ee5\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c } /* 1. \u5c06\u666e\u901a\u6307\u9488\u4f20\u7ed9\u8981\u6c42 pointer-to-const \u7684\u51fd\u6570, \u51fd\u6570\u5185\u90e8\u65e0\u6cd5\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u4fee\u6539\u6570\u636e. \u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5; 2. \u5c06\u666e\u901a\u6307\u9488\u4f20\u9012\u7ed9\u8981\u6c42 const pointer \u7684\u51fd\u6570, \u51fd\u6570\u5185\u90e8\u4e0d\u80fd\u6539\u53d8\u6307\u9488\u7684\u503c\uff0c\u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5; 3. \u628a const variable \u4f20\u7ed9\u53c2\u6570\u4e0d\u662f const \u7684\u51fd\u6570\uff1aerror */ reference to const: \u5f62\u5982 int const &ref = x; \uff0c\u4e0d\u80fd\u7528\u5b83\u6765 change object \u503c\uff0c\u4f46\u4ecd\u53ef\u4ee5\u7528\u8fd9\u4e2a object \u7684\u975e const variable \u6539 object \u503c. const int func() return \u4e00\u4e2a const \uff0c\u800c member function int func() const \u8868\u793a\u8fd9\u4e2a member function \u4e0d\u80fd\u6539\u53d8 member \u7684\u503c. 3. struct (C-style-ADT) new \u5728 dunamic memory \u4e2d \u521b\u9020\u4e00\u4e2a object\uff0c\u5e76 return \u6307\u5411\u8fd9\u4e2a object \u7684\u4e00\u4e2a pointer. delete z \uff0c z \u662f\u4e00\u4e2a local pointer variable\uff0c\u505a\u7684\u662f destroy z \u6240\u6307\u5411\u7684 dynamic memory \u4e2d\u7684 dynamic object . \u5728 delete \u4e4b\u540e z \u4ecd\u7136\u6307\u5411 heap \u4e2d\u7684\u540c\u4e00\u4f4d\u7f6e\uff0c z \u7684\u503c\u5e76\u4e0d\u4f1a\u6539\u53d8\uff01 \u4f46\u6b64\u65f6\u5df2\u7ecf\u4e0d\u80fd dereference \u5b83 (\u5bfc\u81f4UB)\uff0c\u4f46\u53ef\u4ee5\u91cd\u65b0\u7ed9 z \u8d4b\u503c. 4. Stream \u548c C-string C-style strings \u5c31\u662f\u672b\u5c3e\u52a0\u4e0a null \\0 \u7684 char array. \\0 \u662f null\uff0c\u5b83\u7684 ASCII value \u4e3a 0. c++ char str1[6] = {'h', 'e', 'l', 'l', 'o', '\\0'}; char str2[6] = \"hello\"; // \u7b49\u4ef7 const char *ptr = \"hello\"; // \u7b49\u4ef7, \u4f46\u6ce8\u610f\u5fc5\u987b\u8981 const, \u56e0\u4e3a array \u7684\u9996\u5143\u7d20\u5730\u5740\u662f const \u7684 \u5982\u679c\u4ece \"\" \u5f62\u5f0f initialize\uff0c \\0 \u4f1a\u88ab\u81ea\u52a8\u52a0\u4e0a\uff0c\u4f46 \u5982\u679c\u4ece array \u5f62\u5f0f initialize\uff0c\u6211\u4eec\u5fc5\u987b\u5728\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u540e\u624b\u52a8\u52a0\u4e0a '\\0' cout \u7531 char array \u540d\u5b57 decay \u5f62\u6210\u7684 char* \u4f1a cout \u6574\u4e2a char array \u800c\u4e0d\u662f\u9996\u5143\u7d20\u5730\u5740, \u8fd9\u662f\u4e00\u4e2a standard overload. \u4e0d\u8981 out \u5e76\u975e\u6307\u5411\u4e00\u4e2a C string \u7684 char* \u578b\u53d8\u91cf. \u5b83\u4e5f\u4f1a\u7531\u4e8e overload \u4e00\u76f4\u8f93\u51fa\u5230\u627e\u5230 null \u4e3a\u6b62 x += 1 \u548c ++x \u662f\u7b49\u4ef7\uff0c\u5148 +1 \u518d evaluate expression\uff1b\u548c x++ \u4e0d\u7b49\u4ef7\u7684. \u628astring \u8f6c\u5316\u6210 int/double\uff1a stoi() \u548c stod() for c++-string \u4ee5\u53ca atoi() , atof() for c-string. main \u683c\u5f0f: int main(int argc, char *argv[]) {} . cout << argv[1] \u7684\u65f6\u5019\uff0c argv[1] \u662f\u4e00\u4e2a\u5730\u5740\uff0c\u4f46\u662f\u6211\u4eec cout \u7684\u662f\u4e00\u6574\u4e2a argument, \u7531\u4e8e c-stirng \u7684 cout overload. \u628a C++ string \u8f6c\u6210 C string const char *cstr = str.c_str(); \uff0c\u628a C string \u8f6c\u6210 C++ string: string str = string(cstr); strcpy \u7684\u4f5c\u7528\u662f\u628a\u7b2c\u4e8c\u4e2a cstr \u7684\u503c\u4f20\u7ed9\u7b2c\u4e00\u4e2a. c++ void strcpy(char *dst, const char *src) { while (*dst++ = *src++) {} } Concatenate: strcat(cstr1, cstr2) for c-string \u4ee5\u53ca str1 += str2 for c++-stirng. compare: strcmp(A,B) return \u7b2c\u4e00\u4e2a\u4e0d\u4e00\u6837\u7684\u5b57\u6bcd\u7684 ascii \u7801\u7684\u5927\u5c0f\u5dee\u8ddd. (A \u6bd4 B \u5c0f\u5c31\u8fd4\u56de\u8d1f\u503c) \u6bd4\u8f83 c-string: c++ if (argv[1] == \"--debug\") { ... } // BAD, compares addresses if (argv[1] == argv[2]) { ... } // BAD, compares addresses if (std::string(argv[1]) == \"--debug\") { ... } // OK, wrap one in a std::string if (argv[1] == \"--debug\"s) { ... } // OK, \"\"s suffix creates a std::string \u7528 stream \u578b objects \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6 c++ ifstream fin(\"order.txt\"); ofstream fout(\"output.txt\"); cin >> word \u4f1a\u65e0\u89c6 newline\uff0c\u4e14\u4f1a leave newline in the stream\uff0c\u800c getline() \u4f1a reads a blank line. commandline input/output Redirection: > / < shell ./game.exe < choices.txt #input in.txt > ./game.exe #output Pipeline | : \u628a\u4e00\u4e2a program \u7684 stdout \u4f5c\u4e3a stdin \u8f93\u5165\u5230\u53e6\u4e00\u4e2a program. c++ ./game.exe | grep 'battle' > battles.log \u6309\u81ea\u7136\u987a\u5e8f\uff0c\u6ca1\u6709\u4f18\u5148\u7ea7 main \u7684 return \u503c\uff1a0 \u8868\u793a\u8fd0\u884c\u6b63\u5e38\uff1b1 \u8868\u793a\u901a\u7528\u7684\u672a\u77e5\u9519\u8bef\uff0c2 \u8868\u793a\u7528\u4e8e\u547d\u4ee4\u884c\u8bed\u6cd5\u9519\u8bef\uff0c126 \u8868\u793a\u547d\u4ee4\u4e0d\u53ef\u6267\u884c\uff0c127 \u8868\u793a\u627e\u4e0d\u5230\u547d\u4ee4\uff0c128 \u8868\u793a\u65e0\u6548\u7684\u9000\u51fa\u53c2\u6570\uff0c128 + N \u8868\u793a\u901a\u8fc7\u4fe1\u53f7 N \u7ec8\u6b62\u7684\u8fdb\u7a0b\uff0c255 \u8868\u793a\u9000\u51fa\u72b6\u6001\u8d85\u51fa\u8303\u56f4. 5. class (C++-style-ADT) and derived class this \u4e0d\u4ec5\u53ef\u4ee5 -> member variable \u8fd8\u53ef\u4ee5 -> member function. this -> scale() \u5c31\u662f *(this).scale() . \u53ef\u4ee5\u4e0d\u5199 this \u8ba9 compiler \u81ea\u52a8\u9ed8\u8ba4\u3002 const \u7684 object \u4e0d\u80fd\u4f7f\u7528\u975e const \u7684 member function const Triangle t1(3, 4, 5); t1.scale(); // error **\u53ea\u8981\u662f\u540c\u4e00\u4e2a class\uff0c\u90a3\u4e48\u8fd9\u4e2a class \u5176\u4ed6 object \u7684 member \u4e5f\u53ef\u4ee5\u7531\u8fd9\u4e2a object \u7684 member function access. ** \u4e00\u65e6\u81ea\u5df1\u5199\u4e86\u5176\u4ed6 ctor\uff0ccompiler \u81ea\u52a8\u6dfb\u52a0\u7684 default ctors \u5c31\u5931\u6548 Atomic objects (int, double, bool, char, pointers) default initialization \u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c\uff0c Array objects default initialization \u7ed9\u6bcf\u4e2a\u5143\u7d20\u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c. member initializer list: c++ Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) {} \u5982\u679c\u4e0d\u4f7f\u7528 initializer list\uff0c\u5f53 class \u7684\u6210\u5458\u4e2d\u5305\u62ec\u4e86\u53e6\u4e00\u4e2a class\uff0ccompiler \u5c31\u4f1a\u81ea\u52a8\u8c03\u7528\u8fd9\u4e2a\u53e6\u4e00\u4e2a class \u7684 default constructor \uff0c\u800c\u5b83\u6709\u53ef\u80fd\u5df2\u7ecf\u6ca1\u6709 default constructor \u4e86\uff0c\u90a3\u4e48\u5c31\u4f1a error. \u4f7f\u7528 initializer list \u53ef\u4ee5\u907f\u514d\u8fd9\u4e2a\u9519\u8bef. derived class: \u5f62\u5982 class Bicycle: public Vehicle {}; Derived class \u81ea\u52a8\u7ee7\u627f base class \u7684\u6240\u6709 member variables \u4ee5\u53ca functions\uff0c\u4f46 Derived Class \u65e0\u6cd5 assess Base Class \u4e2d\u7684 Private members . \u5fc5\u987b\u901a\u8fc7 base class \u7684 public function \u6765 access. protected variables \u8868\u793a\u5b50\u7c7b access \u7684 private member. c++ class Vehicle { protected: /*..*/ private: /*..*/ }; Enum: \u7528\u4ee5\u5b58\u50a8 named int constants. \u5f62\u5982\u4e0b. \u6211\u4eec\u53ef\u4ee5\u7ed9\u5176\u4e2d\u7684 constants \u5206\u914d\u7684 int \u503c\uff0c\u5982\u679c\u4e0d specify \u5219\u4f1a\u88ab\u81ea\u52a8\u5206\u914d 0, 1, 2, ... \u7684\u503c. c++ enum Bicycletype {MOUNTAIN, ROAD, ELECTRIC, RACING}; Derived class \u7684 Constructor \u4f1a implicitly \u5728 initializer list \u4e2d \u81ea\u52a8\u8c03\u7528 Base Class \u7684 default constructor . \u4e5f\u53ef\u4ee5\u76f4\u63a5\u81ea\u5df1 custom call. c++ Bicycle::Bicycle() :Vehicle(2, \"black\", 2023), type(MOUNTAIN) {} 6. Polymorphism \u53ea\u6709 1. pointer \u7c7b\u578b\u4ee5\u53ca 2. \u4f5c\u4e3a\u5f15\u7528\u7684 variables \u624d\u4f1a\u6709 dynamic type\uff01\uff01 \u4e00\u4e2a variable \u7684 static type \u6307\u5b83 compile time \u7684 type\uff0c\u4e5f\u5c31\u662f\u6211\u4eec declare \u7684 type\uff1b dynamic type \u662f runtime \u65f6\u7684 type. c++ Animal* animal = new Dog(); static type \u662f Animal * , dynamic type \u662f Dog * . \u4f5c\u4e3a\u51fd\u6570\u7684\u53c2\u6570\u7684\u53d8\u91cf\u7684 dynamic type \u53d6\u51b3\u4e8e what is passed. c++ void fp(Vehicle *vp) {cout << vp -> get_insurance_amount() << endl;} //vp \u7684 static type \u662f Vehicle *, \u56e0\u4e3a\u6211\u4eec\u8fd9\u6837 declare int main() {Car mc; fp(&mc);} //\u8fd9\u91cc parameter vp \u7684 dynamic type \u662f Car *, \u56e0\u4e3a compile \u65f6\u4f20\u8fdb\u53bb\u7684\u7c7b\u578b\u662f\u4e2a Car * C++ \u4e2d\uff0cby default\uff0c\u4f7f\u7528\u7684\u662f\u5b83\u7684 static type \u5bf9\u5e94\u7684 class \u7684\u6210\u5458\u548c\u65b9\u6cd5\uff08Static Binding\uff09. \u6210\u5458\u51fd\u6570\u4e5f\u53ea\u80fd\u63a5\u89e6\u5b83 static type \u7684\u6210\u5458. \u7ed9 member function \u52a0\u4e0a virtual \u4e4b\u540e\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a dynamic binding \u7684\u51fd\u6570\uff0c virtual \u5fc5\u987b\u4ece base class \u5f00\u59cb \uff0c\u4e0d\u5b58\u5728 derived class \u7684 override \u4e2d\u8fd9\u4e2a function \u662f virtual \u7684\u4f46\u662f base class \u4e2d\u540c\u4e00\u4e2a function \u5374\u4e0d\u662f\uff0c\u8fd9\u79cd\u53ef\u80fd\u6027\u3002\u5305\u62ec ctor. \u5bf9 virtual derived member function \u4f7f\u7528 override \uff0ccompiler \u4f1a\u68c0\u67e5\u8be5\u51fd\u6570\u662f\u5426\u771f\u7684\u7ee7\u627f\u4e86\u4e2a virtual function\uff0c\u5982\u679c\u6ca1\u6709\u4f1a\u62a5\u9519; \u4f7f\u7528 final \u53ef\u4ee5\u963b\u6b62\u8fdb\u4e00\u6b65\u7684\u7ee7\u627f\u3002 \u4e00\u65e6 base class \u4e2d\u4e00\u4e2a member function \u662f virtual \u7684\uff0c\u90a3\u4e48\u5b83\u7684 derived class \u4e2d\u6240\u6709\u8fd9\u4e2a\u51fd\u6570\u7684 override \u51fd\u6570\u81ea\u52a8\u53d8\u6210 virtual \u7684 \uff0c\u4e0d\u9700\u8981\u52a0\u4e0a virtual \u5173\u952e\u8bcd\u3002 \u4e00\u4e2a pure virtual function \u6307\u7684\u662f\u4e00\u4e2a\u4ee5 =0 \u4e3a\u7ed3\u5c3e declare \u7684 function\u3002\u8868\u793a\u8fd9\u4e2a function \u662f\u6ca1\u6709\u5b9a\u4e49\u7684. \u4e00\u4e2a abstract class \u6307\u5305\u542b\u81f3\u5c11\u4e00\u4e2a pure virtual function \u7684 class\uff0c\u4e0d\u80fd instantiate\uff0c\u4f46\u5982\u679c\u6709 data member\uff0c\u5219\u4ecd\u7136\u9700\u8981\u4e00\u4e2a constructor\u3002 pure abstract class \uff0c\u6307 \u6240\u6709\u51fd\u6570\u90fd\u662f abstract functions\uff0c\u5e76\u4e14\u6ca1\u6709 data members \u7684 class \uff0c\u4e0d\u9700\u8981\u5199 constructor\uff1b\u4e14 compiler \u4f1a\u81ea\u52a8\u4e3a pure abstract class \u63d0\u4f9b default constructor\u3002 c++ Bicycle b; Vehicle* vp = &b; //upcasting Bicycle* bp = vp; //\u4e0d\u80fd\u8fd9\u6837 donwcast, error Bicycle* bp = dynamic_cast<Bicycle*>(vp); //downcast 7. Container ADT \u4e00\u4e2a class \u7684 static variable \u662f\u4e00\u4e2a private to \u8fd9\u4e2a class \u7684 global variable. operator overload: ```c++ template void Set ::print(std::ostream &os) const { os << \"{\"; for (int i = 0; i < elts_size - 1; ++i) os << elts[i] << \", \"; os << elts[elts_size - 1] << \"} \"; } template std::ostream &operator<<(std::ostream &os, const Set &s) { s.print(os); return os; } ``` \u6211\u4eec\u53ef\u4ee5\u5728 class \u5185\u58f0\u660e\u4e00\u4e2a friend function. \u8868\u793a\u8fd9\u4e2a function \u662f class \u5916\u7684 \uff08\u5e76\u4e0d\u662f set::... \u7684 function\uff09\uff0c\u4f46\u662f\u5b83\u88ab\u5141\u8bb8 access \u8fd9\u4e2a class \u7684 private \u548c protected \u7684 members. template: For func c++ template <typename T> T max(T a, T b) {return a > b ? a : b; /* > ? : \u771f\u5c31\u8fd4\u56de1\u7684\u7ed3\u679c, \u5047\u5c31\u8fd4\u56de2\u7684\u7ed3\u679c*/} For class: c++ template <typename T> class Set{/*...*/}; \u6bcf\u4e2a member variable \u7684\u6846\u4f53\u5916 definition \u90fd\u8981\u52a0\u4e0a template. c++ template <typename T> bool Set<T>::contains(T e) const { return index_of(e) != -1; } include guard: c++ #ifndef SOMETHING.hpp #define SOMETHING.hpp //... #endif template class \u7684 declarations \u548c definitions \u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u6587\u4ef6 binary search: $O(log\\; n)$ c++ int binarySearch(int arr[], int size, int target) { int left = 0; int right = size - 1; while (left <= right) { int mid = (left + right) / 2; // binary split! if (arr[left] == target) {return mid;} // found! if (arr[mid] < target) {left = mid + 1;} // not found: move side else {right = mid - 1;} } return -1; // if not found: not in the array } \u5176\u4ed6 operator overload ```c++ bool operator==(const Person &p1, const Person &p2) { return p1.name == p2.name; } template ordered_set & ordered_set ::operator=(const ordered_set & rhs) { if (this != &rhs) { // \u5224\u65ad\u662f\u5426\u662f\u7ed9\u81ea\u5df1\u8d4b\u503c, \u8fd9\u975e\u5e38\u91cd\u8981! delete[] elts; // delete old dynamic array this is pointing to. elts = new T[rhs.current_capacity]; // make a new dynamic array // copy all attributes current_capacity = rhs.current_capacity; size = rhs.size; for (int i = 0; i < size; i++) { ele[i] = rhs.ele[i]; } return *this; } } ```","title":"Overview"},{"location":"280-midterm-cheatsheet.html#1-array-and-pointer","text":"p[i] \u7b49\u4e8e *(p + i) \u7b49\u4e8e i[p] *(ptr + x) \u662f\u5728 *ptr \u7684\u524d\u65b9\u7b2c x \u4e2a *ptr \u7c7b\u578b\u7684 object\uff0c\u4e5f\u5c31\u662f\u524d\u65b9 sizeof(*ptr) \u4e2a\u5730\u5740\u4e0a\u7684 object. ptr1 - ptr2 \u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a ptr1 \u548c ptr2 \u50a8\u5b58\u7684\u5730\u5740\u4e4b\u95f4\u6709\u591a\u5c11\u4e2a *ptr \u7c7b\u578b\u7684 object. pointer \u7684 > , < , == \u6bd4\u8f83\u7684\u662f\u5730\u5740\u5927\u5c0f\uff0c\u5730\u5740\u8d8a\u5f80\u540e\u8d8a\u5927. \u5bf9\u4e8e\u4e24\u4e2a array\uff0c arr1 = arr2 \u662f\u62a5\u9519\u7684\uff0c\u56e0\u4e3a\u53f3\u8fb9 array decay \u6210\u4e86\u4e00\u4e2a\u6307\u5411\u5176\u9996\u5143\u7d20\u7684 pointer\uff0c\u800c\u5de6\u8fb9\u662f\u4e00\u4e2a array. std \u6ca1\u6709\u8fd9\u6837\u7684 operator= overload.","title":"1. Array and Pointer"},{"location":"280-midterm-cheatsheet.html#2-const-keyword","text":"const forbids assignment\uff0c\u4ec5\u652f\u6301 Initialization const pointer : \u5f62\u5982 int * const ptr = &x; \uff0c\u503c\u5728 initialization \u4e4b\u540e\u5c31\u4e0d\u80fd\u53d8\u4e86. \u4e5f\u5c31\u662f \u5b83\u88c5\u7684 address \u4e0d\u80fd\u53d8 \uff0c\u4f46\u662f\u5b83\u88c5\u7684 address \u4e0b\u7684\u53d8\u91cf\u662f\u53ef\u4ee5\u53d8\u7684\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u89e3\u5f15\u7528\u5b83\u6765\u66f4\u6539\u5b83\u6307\u5411\u7684 object \u7684\u503c pointer to const : \u5f62\u5982 const int * ptr = &x; \u6216 int const * ptr = &x \uff0c\u503c\u53ef\u4ee5\u53d8\uff0c\u4e5f\u5c31\u662f\u5b83\u53ef\u4ee5\u91cd\u65b0\u6307\u5411\u522b\u7684\u5730\u5740\uff0c\u4f46\u662f\u8fd9\u4e2a\u6307\u5411\u7684\u884c\u4e3a\u662f const \u7684 x \u4e0d\u662f const \u53d8\u91cf\uff0c\u8fd8\u662f\u53ef\u4ee5\u6539\u53d8 x \u7684\u503c\uff0c\u4f46\u662f \u4e0d\u80fd dereference ptr \u6765\u6539\u53d8 x \u7684\u503c. \u5982\u679c\u8981\u6307\u5411\u4e00\u4e2a const variable\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528 ptr-to-const \u4e0d\u5141\u8bb8\u628a\u4e00\u4e2a pointer-to-const \u6216\u8005 const pointer \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a \u666e\u901a\u7684 pointer\u3002\uff08\u628a const int \u7684\u503c\u4f20\u7ed9\u4e00\u4e2a\u666e\u901a int \u662f\u53ef\u4ee5\u7684\uff09 c++ void func1(const int *ptr) { // ptr-to-const, \u4e0d\u80fd\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c } void func2(int * const ptr) { // const ptr, \u6307\u5411\u7684\u5730\u5740\u4e0d\u80fd\u6539\u53d8, \u53ef\u4ee5\u6539\u53d8\u6307\u5411\u5bf9\u8c61\u503c } /* 1. \u5c06\u666e\u901a\u6307\u9488\u4f20\u7ed9\u8981\u6c42 pointer-to-const \u7684\u51fd\u6570, \u51fd\u6570\u5185\u90e8\u65e0\u6cd5\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u4fee\u6539\u6570\u636e. \u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5; 2. \u5c06\u666e\u901a\u6307\u9488\u4f20\u9012\u7ed9\u8981\u6c42 const pointer \u7684\u51fd\u6570, \u51fd\u6570\u5185\u90e8\u4e0d\u80fd\u6539\u53d8\u6307\u9488\u7684\u503c\uff0c\u4f46\u662f\u539f\u6307\u9488\u53ef\u4ee5; 3. \u628a const variable \u4f20\u7ed9\u53c2\u6570\u4e0d\u662f const \u7684\u51fd\u6570\uff1aerror */ reference to const: \u5f62\u5982 int const &ref = x; \uff0c\u4e0d\u80fd\u7528\u5b83\u6765 change object \u503c\uff0c\u4f46\u4ecd\u53ef\u4ee5\u7528\u8fd9\u4e2a object \u7684\u975e const variable \u6539 object \u503c. const int func() return \u4e00\u4e2a const \uff0c\u800c member function int func() const \u8868\u793a\u8fd9\u4e2a member function \u4e0d\u80fd\u6539\u53d8 member \u7684\u503c.","title":"2. const keyword"},{"location":"280-midterm-cheatsheet.html#3-struct-c-style-adt","text":"new \u5728 dunamic memory \u4e2d \u521b\u9020\u4e00\u4e2a object\uff0c\u5e76 return \u6307\u5411\u8fd9\u4e2a object \u7684\u4e00\u4e2a pointer. delete z \uff0c z \u662f\u4e00\u4e2a local pointer variable\uff0c\u505a\u7684\u662f destroy z \u6240\u6307\u5411\u7684 dynamic memory \u4e2d\u7684 dynamic object . \u5728 delete \u4e4b\u540e z \u4ecd\u7136\u6307\u5411 heap \u4e2d\u7684\u540c\u4e00\u4f4d\u7f6e\uff0c z \u7684\u503c\u5e76\u4e0d\u4f1a\u6539\u53d8\uff01 \u4f46\u6b64\u65f6\u5df2\u7ecf\u4e0d\u80fd dereference \u5b83 (\u5bfc\u81f4UB)\uff0c\u4f46\u53ef\u4ee5\u91cd\u65b0\u7ed9 z \u8d4b\u503c.","title":"3. struct (C-style-ADT)"},{"location":"280-midterm-cheatsheet.html#4-stream-c-string","text":"C-style strings \u5c31\u662f\u672b\u5c3e\u52a0\u4e0a null \\0 \u7684 char array. \\0 \u662f null\uff0c\u5b83\u7684 ASCII value \u4e3a 0. c++ char str1[6] = {'h', 'e', 'l', 'l', 'o', '\\0'}; char str2[6] = \"hello\"; // \u7b49\u4ef7 const char *ptr = \"hello\"; // \u7b49\u4ef7, \u4f46\u6ce8\u610f\u5fc5\u987b\u8981 const, \u56e0\u4e3a array \u7684\u9996\u5143\u7d20\u5730\u5740\u662f const \u7684 \u5982\u679c\u4ece \"\" \u5f62\u5f0f initialize\uff0c \\0 \u4f1a\u88ab\u81ea\u52a8\u52a0\u4e0a\uff0c\u4f46 \u5982\u679c\u4ece array \u5f62\u5f0f initialize\uff0c\u6211\u4eec\u5fc5\u987b\u5728\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u540e\u624b\u52a8\u52a0\u4e0a '\\0' cout \u7531 char array \u540d\u5b57 decay \u5f62\u6210\u7684 char* \u4f1a cout \u6574\u4e2a char array \u800c\u4e0d\u662f\u9996\u5143\u7d20\u5730\u5740, \u8fd9\u662f\u4e00\u4e2a standard overload. \u4e0d\u8981 out \u5e76\u975e\u6307\u5411\u4e00\u4e2a C string \u7684 char* \u578b\u53d8\u91cf. \u5b83\u4e5f\u4f1a\u7531\u4e8e overload \u4e00\u76f4\u8f93\u51fa\u5230\u627e\u5230 null \u4e3a\u6b62 x += 1 \u548c ++x \u662f\u7b49\u4ef7\uff0c\u5148 +1 \u518d evaluate expression\uff1b\u548c x++ \u4e0d\u7b49\u4ef7\u7684. \u628astring \u8f6c\u5316\u6210 int/double\uff1a stoi() \u548c stod() for c++-string \u4ee5\u53ca atoi() , atof() for c-string. main \u683c\u5f0f: int main(int argc, char *argv[]) {} . cout << argv[1] \u7684\u65f6\u5019\uff0c argv[1] \u662f\u4e00\u4e2a\u5730\u5740\uff0c\u4f46\u662f\u6211\u4eec cout \u7684\u662f\u4e00\u6574\u4e2a argument, \u7531\u4e8e c-stirng \u7684 cout overload. \u628a C++ string \u8f6c\u6210 C string const char *cstr = str.c_str(); \uff0c\u628a C string \u8f6c\u6210 C++ string: string str = string(cstr); strcpy \u7684\u4f5c\u7528\u662f\u628a\u7b2c\u4e8c\u4e2a cstr \u7684\u503c\u4f20\u7ed9\u7b2c\u4e00\u4e2a. c++ void strcpy(char *dst, const char *src) { while (*dst++ = *src++) {} } Concatenate: strcat(cstr1, cstr2) for c-string \u4ee5\u53ca str1 += str2 for c++-stirng. compare: strcmp(A,B) return \u7b2c\u4e00\u4e2a\u4e0d\u4e00\u6837\u7684\u5b57\u6bcd\u7684 ascii \u7801\u7684\u5927\u5c0f\u5dee\u8ddd. (A \u6bd4 B \u5c0f\u5c31\u8fd4\u56de\u8d1f\u503c) \u6bd4\u8f83 c-string: c++ if (argv[1] == \"--debug\") { ... } // BAD, compares addresses if (argv[1] == argv[2]) { ... } // BAD, compares addresses if (std::string(argv[1]) == \"--debug\") { ... } // OK, wrap one in a std::string if (argv[1] == \"--debug\"s) { ... } // OK, \"\"s suffix creates a std::string \u7528 stream \u578b objects \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6 c++ ifstream fin(\"order.txt\"); ofstream fout(\"output.txt\"); cin >> word \u4f1a\u65e0\u89c6 newline\uff0c\u4e14\u4f1a leave newline in the stream\uff0c\u800c getline() \u4f1a reads a blank line. commandline input/output Redirection: > / < shell ./game.exe < choices.txt #input in.txt > ./game.exe #output Pipeline | : \u628a\u4e00\u4e2a program \u7684 stdout \u4f5c\u4e3a stdin \u8f93\u5165\u5230\u53e6\u4e00\u4e2a program. c++ ./game.exe | grep 'battle' > battles.log \u6309\u81ea\u7136\u987a\u5e8f\uff0c\u6ca1\u6709\u4f18\u5148\u7ea7 main \u7684 return \u503c\uff1a0 \u8868\u793a\u8fd0\u884c\u6b63\u5e38\uff1b1 \u8868\u793a\u901a\u7528\u7684\u672a\u77e5\u9519\u8bef\uff0c2 \u8868\u793a\u7528\u4e8e\u547d\u4ee4\u884c\u8bed\u6cd5\u9519\u8bef\uff0c126 \u8868\u793a\u547d\u4ee4\u4e0d\u53ef\u6267\u884c\uff0c127 \u8868\u793a\u627e\u4e0d\u5230\u547d\u4ee4\uff0c128 \u8868\u793a\u65e0\u6548\u7684\u9000\u51fa\u53c2\u6570\uff0c128 + N \u8868\u793a\u901a\u8fc7\u4fe1\u53f7 N \u7ec8\u6b62\u7684\u8fdb\u7a0b\uff0c255 \u8868\u793a\u9000\u51fa\u72b6\u6001\u8d85\u51fa\u8303\u56f4.","title":"4. Stream \u548c C-string"},{"location":"280-midterm-cheatsheet.html#5-class-c-style-adt-and-derived-class","text":"this \u4e0d\u4ec5\u53ef\u4ee5 -> member variable \u8fd8\u53ef\u4ee5 -> member function. this -> scale() \u5c31\u662f *(this).scale() . \u53ef\u4ee5\u4e0d\u5199 this \u8ba9 compiler \u81ea\u52a8\u9ed8\u8ba4\u3002 const \u7684 object \u4e0d\u80fd\u4f7f\u7528\u975e const \u7684 member function const Triangle t1(3, 4, 5); t1.scale(); // error **\u53ea\u8981\u662f\u540c\u4e00\u4e2a class\uff0c\u90a3\u4e48\u8fd9\u4e2a class \u5176\u4ed6 object \u7684 member \u4e5f\u53ef\u4ee5\u7531\u8fd9\u4e2a object \u7684 member function access. ** \u4e00\u65e6\u81ea\u5df1\u5199\u4e86\u5176\u4ed6 ctor\uff0ccompiler \u81ea\u52a8\u6dfb\u52a0\u7684 default ctors \u5c31\u5931\u6548 Atomic objects (int, double, bool, char, pointers) default initialization \u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c\uff0c Array objects default initialization \u7ed9\u6bcf\u4e2a\u5143\u7d20\u81ea\u52a8\u8d4b\u4e00\u4e2a junk \u503c. member initializer list: c++ Triangle(double a_in, double b_in, double c_in) : a(a_in), b(b_in), c(c_in) {} \u5982\u679c\u4e0d\u4f7f\u7528 initializer list\uff0c\u5f53 class \u7684\u6210\u5458\u4e2d\u5305\u62ec\u4e86\u53e6\u4e00\u4e2a class\uff0ccompiler \u5c31\u4f1a\u81ea\u52a8\u8c03\u7528\u8fd9\u4e2a\u53e6\u4e00\u4e2a class \u7684 default constructor \uff0c\u800c\u5b83\u6709\u53ef\u80fd\u5df2\u7ecf\u6ca1\u6709 default constructor \u4e86\uff0c\u90a3\u4e48\u5c31\u4f1a error. \u4f7f\u7528 initializer list \u53ef\u4ee5\u907f\u514d\u8fd9\u4e2a\u9519\u8bef. derived class: \u5f62\u5982 class Bicycle: public Vehicle {}; Derived class \u81ea\u52a8\u7ee7\u627f base class \u7684\u6240\u6709 member variables \u4ee5\u53ca functions\uff0c\u4f46 Derived Class \u65e0\u6cd5 assess Base Class \u4e2d\u7684 Private members . \u5fc5\u987b\u901a\u8fc7 base class \u7684 public function \u6765 access. protected variables \u8868\u793a\u5b50\u7c7b access \u7684 private member. c++ class Vehicle { protected: /*..*/ private: /*..*/ }; Enum: \u7528\u4ee5\u5b58\u50a8 named int constants. \u5f62\u5982\u4e0b. \u6211\u4eec\u53ef\u4ee5\u7ed9\u5176\u4e2d\u7684 constants \u5206\u914d\u7684 int \u503c\uff0c\u5982\u679c\u4e0d specify \u5219\u4f1a\u88ab\u81ea\u52a8\u5206\u914d 0, 1, 2, ... \u7684\u503c. c++ enum Bicycletype {MOUNTAIN, ROAD, ELECTRIC, RACING}; Derived class \u7684 Constructor \u4f1a implicitly \u5728 initializer list \u4e2d \u81ea\u52a8\u8c03\u7528 Base Class \u7684 default constructor . \u4e5f\u53ef\u4ee5\u76f4\u63a5\u81ea\u5df1 custom call. c++ Bicycle::Bicycle() :Vehicle(2, \"black\", 2023), type(MOUNTAIN) {}","title":"5. class (C++-style-ADT) and derived class"},{"location":"280-midterm-cheatsheet.html#6-polymorphism","text":"\u53ea\u6709 1. pointer \u7c7b\u578b\u4ee5\u53ca 2. \u4f5c\u4e3a\u5f15\u7528\u7684 variables \u624d\u4f1a\u6709 dynamic type\uff01\uff01 \u4e00\u4e2a variable \u7684 static type \u6307\u5b83 compile time \u7684 type\uff0c\u4e5f\u5c31\u662f\u6211\u4eec declare \u7684 type\uff1b dynamic type \u662f runtime \u65f6\u7684 type. c++ Animal* animal = new Dog(); static type \u662f Animal * , dynamic type \u662f Dog * . \u4f5c\u4e3a\u51fd\u6570\u7684\u53c2\u6570\u7684\u53d8\u91cf\u7684 dynamic type \u53d6\u51b3\u4e8e what is passed. c++ void fp(Vehicle *vp) {cout << vp -> get_insurance_amount() << endl;} //vp \u7684 static type \u662f Vehicle *, \u56e0\u4e3a\u6211\u4eec\u8fd9\u6837 declare int main() {Car mc; fp(&mc);} //\u8fd9\u91cc parameter vp \u7684 dynamic type \u662f Car *, \u56e0\u4e3a compile \u65f6\u4f20\u8fdb\u53bb\u7684\u7c7b\u578b\u662f\u4e2a Car * C++ \u4e2d\uff0cby default\uff0c\u4f7f\u7528\u7684\u662f\u5b83\u7684 static type \u5bf9\u5e94\u7684 class \u7684\u6210\u5458\u548c\u65b9\u6cd5\uff08Static Binding\uff09. \u6210\u5458\u51fd\u6570\u4e5f\u53ea\u80fd\u63a5\u89e6\u5b83 static type \u7684\u6210\u5458. \u7ed9 member function \u52a0\u4e0a virtual \u4e4b\u540e\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a dynamic binding \u7684\u51fd\u6570\uff0c virtual \u5fc5\u987b\u4ece base class \u5f00\u59cb \uff0c\u4e0d\u5b58\u5728 derived class \u7684 override \u4e2d\u8fd9\u4e2a function \u662f virtual \u7684\u4f46\u662f base class \u4e2d\u540c\u4e00\u4e2a function \u5374\u4e0d\u662f\uff0c\u8fd9\u79cd\u53ef\u80fd\u6027\u3002\u5305\u62ec ctor. \u5bf9 virtual derived member function \u4f7f\u7528 override \uff0ccompiler \u4f1a\u68c0\u67e5\u8be5\u51fd\u6570\u662f\u5426\u771f\u7684\u7ee7\u627f\u4e86\u4e2a virtual function\uff0c\u5982\u679c\u6ca1\u6709\u4f1a\u62a5\u9519; \u4f7f\u7528 final \u53ef\u4ee5\u963b\u6b62\u8fdb\u4e00\u6b65\u7684\u7ee7\u627f\u3002 \u4e00\u65e6 base class \u4e2d\u4e00\u4e2a member function \u662f virtual \u7684\uff0c\u90a3\u4e48\u5b83\u7684 derived class \u4e2d\u6240\u6709\u8fd9\u4e2a\u51fd\u6570\u7684 override \u51fd\u6570\u81ea\u52a8\u53d8\u6210 virtual \u7684 \uff0c\u4e0d\u9700\u8981\u52a0\u4e0a virtual \u5173\u952e\u8bcd\u3002 \u4e00\u4e2a pure virtual function \u6307\u7684\u662f\u4e00\u4e2a\u4ee5 =0 \u4e3a\u7ed3\u5c3e declare \u7684 function\u3002\u8868\u793a\u8fd9\u4e2a function \u662f\u6ca1\u6709\u5b9a\u4e49\u7684. \u4e00\u4e2a abstract class \u6307\u5305\u542b\u81f3\u5c11\u4e00\u4e2a pure virtual function \u7684 class\uff0c\u4e0d\u80fd instantiate\uff0c\u4f46\u5982\u679c\u6709 data member\uff0c\u5219\u4ecd\u7136\u9700\u8981\u4e00\u4e2a constructor\u3002 pure abstract class \uff0c\u6307 \u6240\u6709\u51fd\u6570\u90fd\u662f abstract functions\uff0c\u5e76\u4e14\u6ca1\u6709 data members \u7684 class \uff0c\u4e0d\u9700\u8981\u5199 constructor\uff1b\u4e14 compiler \u4f1a\u81ea\u52a8\u4e3a pure abstract class \u63d0\u4f9b default constructor\u3002 c++ Bicycle b; Vehicle* vp = &b; //upcasting Bicycle* bp = vp; //\u4e0d\u80fd\u8fd9\u6837 donwcast, error Bicycle* bp = dynamic_cast<Bicycle*>(vp); //downcast","title":"6. Polymorphism"},{"location":"280-midterm-cheatsheet.html#7-container-adt","text":"\u4e00\u4e2a class \u7684 static variable \u662f\u4e00\u4e2a private to \u8fd9\u4e2a class \u7684 global variable. operator overload: ```c++ template void Set ::print(std::ostream &os) const { os << \"{\"; for (int i = 0; i < elts_size - 1; ++i) os << elts[i] << \", \"; os << elts[elts_size - 1] << \"} \"; } template std::ostream &operator<<(std::ostream &os, const Set &s) { s.print(os); return os; } ``` \u6211\u4eec\u53ef\u4ee5\u5728 class \u5185\u58f0\u660e\u4e00\u4e2a friend function. \u8868\u793a\u8fd9\u4e2a function \u662f class \u5916\u7684 \uff08\u5e76\u4e0d\u662f set::... \u7684 function\uff09\uff0c\u4f46\u662f\u5b83\u88ab\u5141\u8bb8 access \u8fd9\u4e2a class \u7684 private \u548c protected \u7684 members. template: For func c++ template <typename T> T max(T a, T b) {return a > b ? a : b; /* > ? : \u771f\u5c31\u8fd4\u56de1\u7684\u7ed3\u679c, \u5047\u5c31\u8fd4\u56de2\u7684\u7ed3\u679c*/} For class: c++ template <typename T> class Set{/*...*/}; \u6bcf\u4e2a member variable \u7684\u6846\u4f53\u5916 definition \u90fd\u8981\u52a0\u4e0a template. c++ template <typename T> bool Set<T>::contains(T e) const { return index_of(e) != -1; } include guard: c++ #ifndef SOMETHING.hpp #define SOMETHING.hpp //... #endif template class \u7684 declarations \u548c definitions \u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u6587\u4ef6 binary search: $O(log\\; n)$ c++ int binarySearch(int arr[], int size, int target) { int left = 0; int right = size - 1; while (left <= right) { int mid = (left + right) / 2; // binary split! if (arr[left] == target) {return mid;} // found! if (arr[mid] < target) {left = mid + 1;} // not found: move side else {right = mid - 1;} } return -1; // if not found: not in the array } \u5176\u4ed6 operator overload ```c++ bool operator==(const Person &p1, const Person &p2) { return p1.name == p2.name; } template ordered_set & ordered_set ::operator=(const ordered_set & rhs) { if (this != &rhs) { // \u5224\u65ad\u662f\u5426\u662f\u7ed9\u81ea\u5df1\u8d4b\u503c, \u8fd9\u975e\u5e38\u91cd\u8981! delete[] elts; // delete old dynamic array this is pointing to. elts = new T[rhs.current_capacity]; // make a new dynamic array // copy all attributes current_capacity = rhs.current_capacity; size = rhs.size; for (int i = 0; i < size; i++) { ele[i] = rhs.ele[i]; } return *this; } } ```","title":"7. Container ADT"}]}